---
layout: post
categories: BayesianML
tag: []
date: 2018-04-05
---



# Bayes Rule!

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjuthg4w9nj30jw096ac1.jpg" alt="image-20201019182601639" style="zoom: 33%;" />

## Prob. & Bayes Rule

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjutlf6i9bj30za0ig404.jpg" alt="image-20201019182858873" style="zoom:50%;" />



### Discrete

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjutlaybhrj30xk0ds775.jpg" alt="image-20201019182944310" style="zoom:50%;" />

#### Conditional Distribution

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjutmo75ezj30zm0doq6l.jpg" alt="image-20201019183102856" style="zoom:50%;" />



#### Conditional fr Conditional!

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjutpnue79j310e0j2wk1.jpg" alt="image-20201019183355332" style="zoom:50%;" />



### Continuous

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjutryhh9gj30zo0gkq7e.jpg" alt="image-20201019183607220" style="zoom:50%;" />

#### Conditional Distribution

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjutu27glcj30vk0isq6r.jpg" alt="image-20201019183809083" style="zoom: 50%;" />

### Bayes' Rule !!! --> CONTINUOUS !!!

![image-20201019184002424](https://tva1.sinaimg.cn/large/007S8ZIlgy1gjutw112d9j31080ia0yf.jpg)



## Calculating Probabilities w/ Case!

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvoqv9k8gj310q0j4n2z.jpg" alt="image-20201020122737975" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvosiz527j31140k0n7d.jpg" alt="image-20201020122914649" style="zoom:50%;" />

### Condition = Join divided by Marginal



### Alternate Calculation

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvscjxadvj30zy0k879l.jpg" alt="image-20201020143217030" style="zoom:50%;" />

### IDD - Independence

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvsdknfhxj30xc0nitci.jpg" alt="image-20201020143316361" style="zoom:50%;" />





![image-20201020143449798](https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvsf78jyyj31040isq99.jpg)



#### Independence for Conditional 

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvsiyhxnzj311e0ow7ah.jpg" alt="image-20201020143826804" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvslhssd9j30zk0oin1u.jpg" alt="image-20201020144053289" style="zoom:50%;" />![image-20201020145130551](https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvswjxwcdj30vw03ejrz.jpg)



- ***This is EQUAL to all of the distributions conditioned on country as per our definition of independence!***

  ∴ for this dataset, **BUY** isindependent of **COUNTRY**



## Gambler's Fallacy

### IID -- independent & identically distributed

- Each outcome is independent and they all came from the same distribution



<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h3812w01rgj211k0nggp0.jpg" alt="image-20201020145807892" style="zoom:50%;" />



#### Ans 1 & 2

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvt58y2dcj311o0najyx.jpg" alt="image-20201020145952243" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h3815zsvfoj211e0nsmz9.jpg" alt="image-20201020150125934" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h3812z9a5lj21160k6mzi.jpg" alt="image-20201020150422562" style="zoom:50%;" />



## Monty Hall Problem

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvtai5bimj30yq0jm45d.jpg" alt="image-20201020150454973" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h38133wkrvj20ym0oiq5e.jpg" alt="image-20201020150640460" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvtd1iyq8j311k0jkjyg.jpg" alt="image-20201020150721160" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvtgs19r7j311y0k8dlp.jpg" alt="image-20201020151056561" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvtkqxcd2j31260oe45b.jpg" alt="image-20201020151445468" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h3813bdua6j212o0nc76r.jpg" alt="image-20201020151512849" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h3813fhc3gj212k0eyt9g.jpg" alt="image-20201020151617547" style="zoom:50%;" />

#### Conclusion

- Change



## Maximum Likelihood

for stat modeling!

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvtom8ogbj311s0k0wlr.jpg" alt="image-20201020151829253" style="zoom:50%;" />



### Bernoulli Distribution

e.g. P(head) = 0.6; 

<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h3813j8s2wj210g0k20tz.jpg" alt="image-20201020152029033" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h3816amckoj210607ujs0.jpg" alt="image-20201020152128697" style="zoom: 50%;" />

##### P(x) --> P(Xi|θ) 

![image-20201020152550239](https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvtw9rslyj310m0o2aey.jpg)

- Assuming that each coin toss was ***IID***



![image-20201020152808080](https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvtynrsllj30x40iqwjs.jpg)



- ***want to find which value of theta will maxmize it!*** --> What theta maxmize the "**Likelihood**" ?

<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h3813qd057j21100oygof.jpg" alt="image-20201020153036284" style="zoom:50%;" />



### Q: Using the likelihood function, can we maximize it so that we find a value of θ that make sense?

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvu39wkmcj310w0jywjf.jpg" alt="image-20201020153234485" style="zoom:50%;" />

#### Log-Likelihood

<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h3813vo1x0j21200k80up.jpg" alt="image-20201020153358064" style="zoom:50%;" />

#### Mechanical Work...

![image-20201020153503832](https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvu5vjqhdj30yg0om78i.jpg)



<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvu77cgtlj311c0jon1o.jpg" alt="image-20201020153620832" />



<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvu7spjnrj30xi0g8whm.jpg" alt="image-20201020153655026" style="zoom:50%;" />



#### Common Mistake ! -- w/ Binomial Distribution (in any order)

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvv92z2xtj30ze0oqwix.jpg" alt="image-20201020161244820" />

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvvbzrpclj30zg0gqq9f.jpg" alt="image-20201020161532486" style="zoom:50%;" />



## CTR (Click-Through Rate)

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvvfh826cj30zs0j67b1.jpg" alt="image-20201020161853475" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvvhk1or3j310u0ogq8q.jpg" alt="image-20201020162053806" style="zoom:50%;" />



## Maximum Likelihood - Gaussian

<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h38145angkj20ww0jctad.jpg" alt="image-20201020172125730" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h381494025j210y0nyn0d.jpg" alt="image-20201020172214965" style="zoom:50%;" />



#### Application

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvxawbdmkj31160o448n.jpg" alt="image-20201020172341759" style="zoom:50%;" />

- But I can choose anything + still use MLE!



#### 

#### Likelihood & PDFs, Problem Setup

![image-20201020172805561](https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvxfhffnpj31160fq7bh.jpg)

#### PDF of Gaussian

![image-20201020172958585](https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvxhfw3enj31040k0426.jpg)

- normalizing coeff
- symmetric about mu
- bellcurve, same on both sides



#### Maximum Likelihood Estimation

- **want to find the parameters that best describe the data**
- In other words, what values of MU and Sigma make the most sense given the data that we collected? 
  - These values will MAXimize the likelihood
- if taking mu=100, BAD!
- The balue that is a greate choice would be the one that maximizes the likelihood

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvxiko4ncj310a0ny7cr.jpg" alt="image-20201020173103845" style="zoom:50%;" />



#### Calculus Solution

![image-20201020173219504](https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvxjvzencj30xw0j80wm.jpg)





<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjvxkf1u5rj30wo0jeae3.jpg" alt="image-20201020173250508" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjw2xx8m7lj30y80jsdkm.jpg" alt="image-20201020203848650" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjw2zsdqglj310u0i40wg.jpg" alt="image-20201020204036228" style="zoom:50%;" />

#### 求極值

![image-20201020204250076](https://tva1.sinaimg.cn/large/007S8ZIlgy1gjw3259alwj310i0oe78g.jpg)





## MLE - Gaussian (Cont.)



<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h3814n3hgpj212w0hmq4d.jpg" alt="image-20201103143424629" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkbz3vhorbj310s0jotcb.jpg" alt="image-20201103143510302" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkbz48ntfmj312q0jkwk0.jpg" alt="image-20201103143532030" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkbz4p4jsrj30tw0hejtv.jpg" alt="image-20201103143557818" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkbz77cglkj312q0k8gtp.jpg" alt="image-20201103143822568" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkbz82u08qj30xo0k078h.jpg" alt="image-20201103143912789" style="zoom:50%;" />



![image-20201103143957420](https://tva1.sinaimg.cn/large/0081Kckwgy1gkbz8uvrd8j310q0jg0yd.jpg)



<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkbza9xecyj31220jwq81.jpg" alt="image-20201103144119703" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkbzas6cudj311k0ge0xh.jpg" alt="image-20201103144148666" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkbzc22tc1j31200okdn5.jpg" alt="image-20201103144302495" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkbzd2ztvaj31100jmdkq.jpg" alt="image-20201103144401675" style="zoom:50%;" />



## CDF & Percentile

<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkbzepl1ahj30vs0iyn00.jpg" alt="image-20201103144535442" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h3814zs65nj20t00l20uc.jpg" alt="image-20201103144950868" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h38152h622j20ry092t9d.jpg" alt="image-20201103145109365" style="zoom: 50%;" />



![image-20201103145155479](https://tva1.sinaimg.cn/large/0081Kckwgy1gkbzlb3tggj312g0kgwn3.jpg)

`

<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkbzn507t3j311a0k4wks.jpg" alt="image-20201103145341619" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h381586efaj21360kwtav.jpg" alt="image-20201103145445509" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkbzoqzptsj30yc0kmn3e.jpg" alt="image-20201103145514197" style="zoom:50%;" />





## Probability Review in Code

[my practice](https://colab.research.google.com/drive/16LTMN0IT2a7YZ2gZpdTq48VB2Cxt0Eim?usp=sharing)



## Sum

<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkc1ofqxszj310m0gy110.jpg" alt="image-20201103160407621" style="zoom:50%;" />



![image-20201103160715036](https://tva1.sinaimg.cn/large/0081Kckwgy1gkc1ropx0kj310q0jswmk.jpg)



![image-20201103160936663](https://tva1.sinaimg.cn/large/0081Kckwgy1gkc1u4zi3dj310w0j2dmu.jpg)



<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h3815gm04aj210c0nwacw.jpg" alt="image-20201103161401713" style="zoom:50%;" />



## Fix: Stat. VS ML

### Misconceptions!

<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkc2082jmkj30zu0jqaiq.jpg" alt="image-20201103161527998" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkc219y77jj31160ju7f1.jpg" alt="image-20201103161627484" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkc21omb3hj30ya0i00xg.jpg" alt="image-20201103161651349" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkc24bntvwj310c09en0r.jpg" alt="image-20201103161924480" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkc262rj7rj311o0hewj1.jpg" alt="image-20201103162105450" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gkc270n12qj31000iy12p.jpg" alt="image-20201103162159015" style="zoom:50%;" />

![image-20201103162554052](https://tva1.sinaimg.cn/large/0081Kckwgy1gkc2b37yzkj31080duguk.jpg)

