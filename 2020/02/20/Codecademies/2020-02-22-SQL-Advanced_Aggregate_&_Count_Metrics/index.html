<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Codecademies/2020-02-22-SQL-Advanced_Aggregate_&amp;_Count_Metrics"><meta name="keywords" content=""><meta name="author" content="Joe Huang"><meta name="copyright" content="Joe Huang"><title>Codecademies/2020-02-22-SQL-Advanced_Aggregate_&amp;_Count_Metrics | Awaken Desparado</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-180692466-1', 'auto');
ga('send', 'pageview');</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.2.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Advanced-Aggregate"><span class="toc-number">1.</span> <span class="toc-text">Advanced Aggregate</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Database-Schema"><span class="toc-number">1.1.</span> <span class="toc-text">Database Schema</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Percentage"><span class="toc-number">1.2.</span> <span class="toc-text">Percentage</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Query-Results"><span class="toc-number">1.2.1.</span> <span class="toc-text">Query Results</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Grouping-with-Case-Statements"><span class="toc-number">1.3.</span> <span class="toc-text">Grouping with Case Statements</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Query-Results-1"><span class="toc-number">1.3.1.</span> <span class="toc-text">Query Results</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reorder-Rates"><span class="toc-number">1.4.</span> <span class="toc-text">Reorder Rates</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">1.5.</span> <span class="toc-text">Conclusion</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion-1"><span class="toc-number">1.6.</span> <span class="toc-text">Conclusion</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Count-Metrics"><span class="toc-number">2.</span> <span class="toc-text">Count Metrics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Query-Results-2"><span class="toc-number">2.0.1.</span> <span class="toc-text">Query Results</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Database-Schema-1"><span class="toc-number">2.0.2.</span> <span class="toc-text">Database Schema</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Daily-Active-Users"><span class="toc-number">2.1.</span> <span class="toc-text">Daily Active Users</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Daily-Active-Users-2"><span class="toc-number">2.2.</span> <span class="toc-text">Daily Active Users 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Daily-Average-Revenue-Per-Purchasing-User"><span class="toc-number">2.3.</span> <span class="toc-text">Daily Average Revenue Per Purchasing User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Daily-Average-Revenue-Per-User"><span class="toc-number">2.4.</span> <span class="toc-text">Daily Average Revenue Per User</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ARPU-2"><span class="toc-number">2.5.</span> <span class="toc-text">ARPU 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1Day-Retention"><span class="toc-number">2.6.</span> <span class="toc-text">1Day Retention</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Day-Retention"><span class="toc-number">3.</span> <span class="toc-text">1 Day Retention</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Cont"><span class="toc-number">3.0.0.1.</span> <span class="toc-text">Cont.</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Common-Metrics-Conclusion"><span class="toc-number">3.1.</span> <span class="toc-text">Common Metrics Conclusion</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Joe Huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">395</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">26</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">69</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Awaken Desparado</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">Codecademies/2020-02-22-SQL-Advanced_Aggregate_&amp;_Count_Metrics</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-20</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/SQL/">SQL</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="Advanced-Aggregate"><a href="#Advanced-Aggregate" class="headerlink" title="Advanced Aggregate"></a>Advanced Aggregate</h1><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcv26l5ilkj31bm0jcn1v.jpg" alt="image-20200316000428263" style="zoom:67%;" />



<h2 id="Database-Schema"><a href="#Database-Schema" class="headerlink" title="Database Schema"></a>Database Schema</h2><table>
<thead>
<tr>
<th align="center">orders4999 rows</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td>int</td>
</tr>
<tr>
<td align="center">ordered_at</td>
<td>text</td>
</tr>
<tr>
<td align="center">delivered_at</td>
<td>text</td>
</tr>
<tr>
<td align="center">delivered_to</td>
<td>int</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">order_items20000 rows</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td>int</td>
</tr>
<tr>
<td align="center">order_id</td>
<td>int</td>
</tr>
<tr>
<td align="center">name</td>
<td>text</td>
</tr>
<tr>
<td align="center">amount_paid</td>
<td>real</td>
</tr>
</tbody></table>
<h2 id="Percentage"><a href="#Percentage" class="headerlink" title="Percentage"></a>Percentage</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>, <span class="keyword">round</span>(<span class="keyword">sum</span>(amount_paid)/</span><br><span class="line">(</span><br><span class="line">  <span class="keyword">select</span> <span class="keyword">sum</span>(amount_paid) <span class="keyword">from</span> order_items</span><br><span class="line">) *<span class="number">100.0</span>, <span class="number">2</span>) <span class="keyword">as</span> pct</span><br><span class="line"><span class="keyword">from</span> order_items</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span> <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Query-Results"><a href="#Query-Results" class="headerlink" title="Query Results"></a>Query Results</h3><table>
<thead>
<tr>
<th align="center">name</th>
<th align="center">%</th>
</tr>
</thead>
<tbody><tr>
<td align="center">tikka-masala</td>
<td align="center">31.7</td>
</tr>
<tr>
<td align="center">grilled-cheese</td>
<td align="center">21.6</td>
</tr>
<tr>
<td align="center">chicken-parm</td>
<td align="center">19.95</td>
</tr>
<tr>
<td align="center">blt</td>
<td align="center">14.75</td>
</tr>
<tr>
<td align="center">soda</td>
<td align="center">5.48</td>
</tr>
<tr>
<td align="center">orange-juice</td>
<td align="center">2.94</td>
</tr>
<tr>
<td align="center">cake</td>
<td align="center">2.71</td>
</tr>
<tr>
<td align="center">banana-smoothie</td>
<td align="center">0.53</td>
</tr>
<tr>
<td align="center">kale-smoothie</td>
<td align="center">0.35</td>
</tr>
</tbody></table>
<h2 id="Grouping-with-Case-Statements"><a href="#Grouping-with-Case-Statements" class="headerlink" title="Grouping with Case Statements"></a>Grouping with Case Statements</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="comment">/**/</span></span><br><span class="line">  <span class="keyword">case</span> <span class="keyword">name</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'kale-smoothie'</span>    <span class="keyword">then</span> <span class="string">'smoothie'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'banana-smoothie'</span>  <span class="keyword">then</span> <span class="string">'smoothie'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'orange-juice'</span>     <span class="keyword">then</span> <span class="string">'drink'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'soda'</span>             <span class="keyword">then</span> <span class="string">'drink'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'blt'</span>              <span class="keyword">then</span> <span class="string">'sandwich'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'grilled-cheese'</span>   <span class="keyword">then</span> <span class="string">'sandwich'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'tikka-masala'</span>     <span class="keyword">then</span> <span class="string">'dinner'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'chicken-parm'</span>     <span class="keyword">then</span> <span class="string">'dinner'</span></span><br><span class="line">     <span class="keyword">else</span> <span class="string">'other'</span></span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">as</span> <span class="keyword">category</span>, </span><br><span class="line">  <span class="keyword">round</span>(<span class="number">1.0</span> * <span class="keyword">sum</span>(amount_paid) / </span><br><span class="line">          (</span><br><span class="line">            <span class="keyword">select</span> <span class="keyword">sum</span>(amount_paid) <span class="keyword">from</span> order_items</span><br><span class="line">          ) * <span class="number">100</span>, <span class="number">2</span></span><br><span class="line">       ) <span class="keyword">as</span> <span class="string">'%'</span></span><br><span class="line"><span class="keyword">from</span> order_items</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span> <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Query-Results-1"><a href="#Query-Results-1" class="headerlink" title="Query Results"></a>Query Results</h3><table>
<thead>
<tr>
<th align="center">category</th>
<th align="center">round(1.0 * sum(amount_paid) / ( select sum(amount_paid) from order_items ) * 100, 2 )</th>
</tr>
</thead>
<tbody><tr>
<td align="center">dinner</td>
<td align="center">51.64</td>
</tr>
<tr>
<td align="center">sandwich</td>
<td align="center">36.34</td>
</tr>
<tr>
<td align="center">drink</td>
<td align="center">8.42</td>
</tr>
<tr>
<td align="center">other</td>
<td align="center">2.71</td>
</tr>
<tr>
<td align="center">smoothie</td>
<td align="center">0.88</td>
</tr>
</tbody></table>
<h2 id="Reorder-Rates"><a href="#Reorder-Rates" class="headerlink" title="Reorder Rates"></a>Reorder Rates</h2><p>“While we do know that kale smoothies (and drinks overall) are not driving a lot of revenue, we don’t know why. A big part of data analysis is implementing your own metrics to get information out of the piles of data in your database.</p>
<p>In our case, the reason could be that no one likes kale, but it could be something else entirely. To find out, we’ll create a metric called <em>reorder rate</em> and see how that compares to the other products at SpeedySpoon.</p>
<p>We’ll define <em>reorder rate</em> as the ratio of the total number of orders to the number of people making those orders. A higher ratio means most of the orders are reorders. A lower ratio means more of the orders are first purchases.”</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcvlv4b5ldj327o0s4wkh.jpg" alt="image-20200316112531249"></p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcvm0mdyqsj324j0u0k30.jpg" alt="image-20200316113051990"></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><h2 id="Conclusion-1"><a href="#Conclusion-1" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Wow! That’s unexpected. While smoothies aren’t making a lot of money for SpeedySpoon, they have a very high reorder rate. That means these smoothie customers are strong repeat customers.</p>
<p>Instead of recommending smoothies be taken off the menu, we should talk to the smoothie customers and see what they like so much about these smoothies. There could be an opportunity here to expand the product line, or get other customers as excited as these kale fanatics. Nice work!</p>
<p>Let’s generalize what we’ve learned so far:</p>
<ul>
<li><em>Data aggregation</em> is the grouping of data in summary form.</li>
<li><em>Daily Count</em> is the count of orders in a day.</li>
<li><em>Daily Revenue Count</em> is the revenue on orders per day.</li>
<li><em>Product Sum</em> is the total revenue of a product.</li>
<li><em>Subqueries</em> can be used to perform complicated calculations and create filtered or aggregate tables on the fly.</li>
<li><em>Reorder Rate</em> is the ratio of the total number of orders to the number of people making orders.</li>
</ul>
<h1 id="Count-Metrics"><a href="#Count-Metrics" class="headerlink" title="Count Metrics"></a>Count Metrics</h1><h3 id="Query-Results-2"><a href="#Query-Results-2" class="headerlink" title="Query Results"></a>Query Results</h3><table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">user_id</th>
<th align="center">price</th>
<th align="center">refunded_at</th>
<th align="center">created_at</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0</td>
<td align="center">255</td>
<td align="center">1.5</td>
<td align="center"></td>
<td align="center">2015-10-04 14:39:46</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">448</td>
<td align="center">0.5</td>
<td align="center"></td>
<td align="center">2015-09-11 17:33:06</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">237</td>
<td align="center">4.5</td>
<td align="center"></td>
<td align="center">2015-08-17 23:13:32</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">468</td>
<td align="center">3.5</td>
<td align="center"></td>
<td align="center">2015-08-08 16:25:59</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">50</td>
<td align="center">4.5</td>
<td align="center"></td>
<td align="center">2015-08-18 02:36:17</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">86</td>
<td align="center">1.5</td>
<td align="center">2015-11-19 10:02:31</td>
<td align="center">2015-11-19 05:16:54</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">384</td>
<td align="center">4.5</td>
<td align="center"></td>
<td align="center">2015-08-21 14:35:02</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">490</td>
<td align="center">1.5</td>
<td align="center"></td>
<td align="center">2015-10-08 01:09:32</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">454</td>
<td align="center">1.5</td>
<td align="center"></td>
<td align="center">2015-10-24 12:26:39</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">280</td>
<td align="center">1.5</td>
<td align="center"></td>
<td align="center">2015-08-24 15:19:00</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">user_id</th>
<th align="center">created_at</th>
<th align="center">platform</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0</td>
<td align="center">225</td>
<td align="center">2015-11-25 20:06:36</td>
<td align="center">Web</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">175</td>
<td align="center">2015-08-08 12:39:30</td>
<td align="center">iOS</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">453</td>
<td align="center">2015-11-11 05:44:58</td>
<td align="center">Web</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">438</td>
<td align="center">2015-10-27 07:26:07</td>
<td align="center">Android</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">413</td>
<td align="center">2015-11-12 19:47:57</td>
<td align="center">iOS</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">424</td>
<td align="center">2015-11-10 23:23:49</td>
<td align="center">Android</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">55</td>
<td align="center">2015-09-13 14:49:09</td>
<td align="center">iOS</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">285</td>
<td align="center">2015-08-31 18:32:49</td>
<td align="center">Web</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">28</td>
<td align="center">2015-08-16 00:34:09</td>
<td align="center">iOS</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">22</td>
<td align="center">2015-08-11 23:53:11</td>
<td align="center">iOS</td>
</tr>
</tbody></table>
<h3 id="Database-Schema-1"><a href="#Database-Schema-1" class="headerlink" title="Database Schema"></a>Database Schema</h3><table>
<thead>
<tr>
<th align="center">purchases2000 rows</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td>int</td>
</tr>
<tr>
<td align="center">user_id</td>
<td>int</td>
</tr>
<tr>
<td align="center">price</td>
<td>real</td>
</tr>
<tr>
<td align="center">refunded_at</td>
<td>text</td>
</tr>
<tr>
<td align="center">created_at</td>
<td>text</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">gameplays14000 rows</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td>int</td>
</tr>
<tr>
<td align="center">user_id</td>
<td>int</td>
</tr>
<tr>
<td align="center">created_at</td>
<td>text</td>
</tr>
<tr>
<td align="center">platform</td>
<td>text</td>
</tr>
</tbody></table>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcvmo5pnolj32660lugq8.jpg" alt="image-20200316115322516"></p>
<h2 id="Daily-Active-Users"><a href="#Daily-Active-Users" class="headerlink" title="Daily Active Users"></a>Daily Active Users</h2><p>Mineblocks is a game, and one of the core metrics to any game is the number of people who play each day. That KPI is called <em>Daily Active Users</em>, or <em>DAU</em>.</p>
<p><em>DAU</em> is defined as the number of unique players seen in-game each day. It’s important not to double count users who played multiple times, so we’ll use <code>distinct</code> in our <code>count</code> function.</p>
<p>Likewise, Weekly Active Users (WAU) and Monthly Active Users (MAU) are in the same family.</p>
<ol>
<li><p>For Mineblocks, we’ll use the <code>gameplays</code> table to calculate DAU. Each time a user plays the game, their session is recorded in <code>gameplays</code>. Thus, a distinct count of users per day from gameplays will give us DAU.</p>
<p>Calculate Daily Active Users for Mineblocks. Complete the query’s <code>count</code> function by passing in the <code>distinct</code> keyword and the <code>user_id</code> column name.</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(created_at), </span><br><span class="line">  <span class="keyword">count</span>(<span class="keyword">distinct</span> user_id<span class="comment">/**/</span>) <span class="keyword">as</span> dau</span><br><span class="line"><span class="keyword">from</span> gameplays</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<h2 id="Daily-Active-Users-2"><a href="#Daily-Active-Users-2" class="headerlink" title="Daily Active Users 2"></a>Daily Active Users 2</h2><p><strong>1.</strong></p>
<p>Previously we calculated DAU only per day, so the output we wanted was <code>[date, dau_count]</code>. Now we want DAU per platform, making the desired output <code>[date, platform, dau_count]</code>.</p>
<p>Calculate DAU for Mineblocks per-platform. Complete the query below. You will need to select the <code>platform</code> column and add a <code>count</code> function by passing in the <code>distinct</code> keyword and the <code>user_id</code> column name.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(created_at), </span><br><span class="line">  platform,</span><br><span class="line">  <span class="keyword">count</span>(<span class="keyword">distinct</span> user_id<span class="comment">/**/</span>) <span class="keyword">as</span> dau</span><br><span class="line"><span class="keyword">from</span> gameplays</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>, <span class="number">2</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>, <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">P.S. IF NO 2nd group by , diff platforms collapse into the same day</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>date(created_at)</th>
<th>platform</th>
<th>dau</th>
</tr>
</thead>
<tbody><tr>
<td>2015-08-08</td>
<td>Android</td>
<td>39</td>
</tr>
<tr>
<td>2015-08-08</td>
<td>Web</td>
<td>43</td>
</tr>
<tr>
<td>2015-08-08</td>
<td>iOS</td>
<td>25</td>
</tr>
<tr>
<td>2015-08-09</td>
<td>Android</td>
<td>55</td>
</tr>
<tr>
<td>2015-08-09</td>
<td>Web</td>
<td>44</td>
</tr>
<tr>
<td>2015-08-09</td>
<td>iOS</td>
<td>37</td>
</tr>
<tr>
<td>2015-08-10</td>
<td>Android</td>
<td>38</td>
</tr>
</tbody></table>
<h2 id="Daily-Average-Revenue-Per-Purchasing-User"><a href="#Daily-Average-Revenue-Per-Purchasing-User" class="headerlink" title="Daily Average Revenue Per Purchasing User"></a>Daily Average Revenue Per Purchasing User</h2><p>We’ve looked at DAU and Daily Revenue in Mineblocks. Now we must understand the purchasing habits of our users.</p>
<p>Mineblocks, like every freemium game, has two types of users:</p>
<ul>
<li>purchasers: users who have bought things in the game</li>
<li>players: users who play the game but have not yet purchased</li>
</ul>
<p>The next KPI we’ll look at <em>Daily ARPPU</em> - Average Revenue Per Purchasing User. This metric shows if the average amount of money spent by purchasers is going up over time.</p>
<p><em>Daily ARPPU</em> is defined as the sum of revenue divided by the number of purchasers per day.</p>
<p><strong>1.</strong></p>
<p>To get Daily ARPPU, modify the daily revenue query from earlier to divide by the number of purchasers.</p>
<p>Complete the query by adding a numerator and a denominator. The numerator will display daily revenue, or <code>sum</code> the <code>price</code> columns. The denominator will display the number of purchasers by passing the <code>distinct</code> keyword and the <code>user_id</code> column name into the <code>count</code> function.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(created_at),</span><br><span class="line">  <span class="keyword">round</span>(<span class="comment">/**/</span><span class="keyword">sum</span>(price) / <span class="keyword">count</span>(<span class="keyword">distinct</span> user_id<span class="comment">/**/</span>), <span class="number">2</span>) <span class="keyword">as</span> arppu</span><br><span class="line"><span class="keyword">from</span> purchases</span><br><span class="line"><span class="keyword">where</span> refunded_at <span class="keyword">is</span> <span class="literal">null</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">date(created_at)</th>
<th align="center">arppu</th>
</tr>
</thead>
<tbody><tr>
<td align="center">2015-08-04</td>
<td align="center">3.46</td>
</tr>
<tr>
<td align="center">2015-08-05</td>
<td align="center">2.65</td>
</tr>
<tr>
<td align="center">2015-08-06</td>
<td align="center">1.44</td>
</tr>
<tr>
<td align="center">2015-08-07</td>
<td align="center">2.32</td>
</tr>
<tr>
<td align="center">2015-08-08</td>
<td align="center">2.53</td>
</tr>
<tr>
<td align="center">2015-08-09</td>
<td align="center">1.75</td>
</tr>
<tr>
<td align="center">2015-08-10</td>
<td align="center">3.0</td>
</tr>
<tr>
<td align="center">2015-08-11</td>
<td align="center">2.25</td>
</tr>
<tr>
<td align="center">2015-08-12</td>
<td align="center">2.78</td>
</tr>
<tr>
<td align="center">2015-08-13</td>
<td align="center">2.83</td>
</tr>
<tr>
<td align="center">2015-08-14</td>
<td align="center">2.7</td>
</tr>
</tbody></table>
<h2 id="Daily-Average-Revenue-Per-User"><a href="#Daily-Average-Revenue-Per-User" class="headerlink" title="Daily Average Revenue Per User"></a>Daily Average Revenue Per User</h2><p>The more popular (and difficult) cousin to Daily ARPPU is <em>Daily ARPU</em>, Average Revenue Per User. ARPU measures the average amount of money we’re getting across all players, <strong><em>whether or not they’ve purchased.</em></strong></p>
<p>ARPPU increases if purchasers are spending more money. ARPU increases if more players are choosing to purchase, even if the purchase size stays consistent.</p>
<p><strong><em>No one metric can tell the whole story.</em></strong> That’s why it’s so helpful to have many KPIs on the same dashboard.</p>
<h2 id="ARPU-2"><a href="#ARPU-2" class="headerlink" title="ARPU 2"></a>ARPU 2</h2><p>Daily ARPU is defined as revenue divided by the number of players, per-day. To get that, we’ll need to calculate the daily revenue and daily active users separately, and then join them on their dates.</p>
<p>One way to easily create and organize temporary results in a query is with <em>CTEs</em>, <em>Common Table Expressions</em>, also known as <code>with</code> clauses. The <code>with</code> clauses make it easy to define and use results in a more organized way than subqueries.</p>
<p>These clauses usually look like this:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**/</span><span class="keyword">with</span>  daily_revenue <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span></span><br><span class="line">    <span class="built_in">date</span>(created_at) <span class="keyword">as</span> dt,</span><br><span class="line">    <span class="keyword">round</span>(<span class="keyword">sum</span>(price), <span class="number">2</span>) <span class="keyword">as</span> rev</span><br><span class="line">  <span class="keyword">from</span> purchases</span><br><span class="line">  <span class="keyword">where</span> refunded_at <span class="keyword">is</span> <span class="literal">null</span></span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> daily_revenue <span class="keyword">order</span> <span class="keyword">by</span> dt;</span><br></pre></td></tr></table></figure>

<p><strong>2.</strong></p>
<p>Now that we have the revenue and DAU, join them on their dates and calculate daily ARPU. Complete the query by adding the keyword <code>using</code> in the <code>join</code> clause.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**/</span> <span class="keyword">with</span>  daily_revenue <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span></span><br><span class="line">    <span class="built_in">date</span>(created_at) <span class="keyword">as</span> dt,</span><br><span class="line">    <span class="keyword">round</span>(<span class="keyword">sum</span>(price), <span class="number">2</span>) <span class="keyword">as</span> rev</span><br><span class="line">  <span class="keyword">from</span> purchases</span><br><span class="line">  <span class="keyword">where</span> refunded_at <span class="keyword">is</span> <span class="literal">null</span></span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">),</span><br><span class="line">daily_players <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span></span><br><span class="line">    <span class="comment">/**/</span><span class="built_in">date</span>(created_at) <span class="keyword">as</span> dt,</span><br><span class="line">    <span class="comment">/**/</span><span class="keyword">count</span>(<span class="keyword">distinct</span> user_id) <span class="keyword">as</span> players</span><br><span class="line">  <span class="keyword">from</span> gameplays</span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">  daily_revenue.dt, </span><br><span class="line">  daily_revenue.rev / daily_players.players</span><br><span class="line"><span class="keyword">from</span> daily_revenue</span><br><span class="line">  <span class="keyword">join</span> daily_players <span class="keyword">using</span> (dt);</span><br></pre></td></tr></table></figure>

<p>In the final <code>select</code> statement, <code>daily_revenue.dt</code> represents the date, while <code>daily_revenue.rev / daily_players.players</code> is the daily revenue divided by the number of players that day. In full, it represents how much the company is making per player, per day.</p>
<p>When the columns to join have the same name in both tables you can use <code>using</code> instead of <code>on</code>. Our use of the <code>using</code> keyword is in this case equivalent to this clause:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from daily_revenue</span><br><span class="line">  join daily_players on</span><br><span class="line">    daily_revenue.dt = daily_players.dt;</span><br></pre></td></tr></table></figure>



<h2 id="1Day-Retention"><a href="#1Day-Retention" class="headerlink" title="1Day Retention"></a>1Day Retention</h2><h1 id="1-Day-Retention"><a href="#1-Day-Retention" class="headerlink" title="1 Day Retention"></a>1 Day Retention</h1><p>Now let’s find out what percent of Mineblock players are returning to play the next day. This KPI is called <em>1 Day Retention</em>.</p>
<p><em>Retention</em> can be defined many different ways, but we’ll stick to the most basic definition. For all players on Day N, we’ll consider them retained if they came back to play again on Day N+1.</p>
<p>This will let us track whether or not Mineblocks is getting “stickier” over time. The stickier our game, the more days players will spend in-game.</p>
<p>And more time in-game means more opportunities to monetize and grow our business.</p>
<h4 id="Cont"><a href="#Cont" class="headerlink" title="Cont."></a>Cont.</h4><p>Before we can calculate retention we need to get our data formatted in a way where we can determine if a user returned.</p>
<p>Currently the <code>gameplays</code> table is a list of when the user played, and it’s not easy to see if any user came back.</p>
<p>By using a <code>self-join</code>, we can make multiple gameplays available on the same row of results. This will enable us to calculate retention.</p>
<p>The power of <code>self-join</code> comes from joining every row to every other row. This makes it possible to compare values from two different rows in the new result set. In our case, we’ll compare rows that are one date apart from each user.</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcw6v3ohoqj30dj0a3q3j.jpg" alt="SQL join types"></p>
<p>Now that we have our <code>gameplays</code> table joined to itself, we can start to calculate retention.</p>
<p>1 Day Retention is defined as the number of players who returned the next day divided by the number of original players, per day. Suppose 10 players played Mineblocks on Dec 10th. If 4 of them play on Dec 11th, the 1 day retention for Dec 10th is 40%.</p>
<p>Instructions</p>
<p><strong>1.</strong></p>
<p>The previous query joined all rows in gameplays against all other rows for each user, making a massive result set that we don’t need.</p>
<p>We’ll need to modify this query.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(g1.created_at) <span class="keyword">as</span> dt,</span><br><span class="line">  g1.user_id, </span><br><span class="line">  g2.user_id</span><br><span class="line"><span class="keyword">from</span> gameplays <span class="keyword">as</span> g1</span><br><span class="line">  <span class="comment">/**/</span> <span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">    gameplays <span class="keyword">as</span> g2 <span class="keyword">on</span></span><br><span class="line">    g1.user_id = g2.user_id</span><br><span class="line">    <span class="keyword">and</span> <span class="built_in">date</span>(g1.created_at) = <span class="built_in">date</span>(datetime(g2.created_at, <span class="string">'-1 day'</span>))</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">limit</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>



<p><strong>2.</strong></p>
<p>The query above won’t return meaningful results because we’re using an <code>inner join</code>. This type of join requires that the condition be met for all rows, effectively limiting our selection to only the users that have returned.</p>
<p>Instead, we want to use a <code>left join</code>, this way all rows in <code>g1</code> are preserved, leaving nulls in the rows from <code>g2</code> where users did not return to play the next day.</p>
<p>Change the <code>join</code> clause to use <code>left join</code> and count the distinct number of users from <code>g1</code> and <code>g2</code> per date.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(g1.created_at) <span class="keyword">as</span> dt,</span><br><span class="line">  <span class="comment">-- g1.user_id, </span></span><br><span class="line">  <span class="comment">-- g2.user_id</span></span><br><span class="line">  <span class="keyword">count</span>(<span class="keyword">distinct</span> g1.user_id) <span class="keyword">as</span> total_users,</span><br><span class="line">  <span class="keyword">count</span>(<span class="keyword">distinct</span> g2.user_id) <span class="keyword">as</span> retained_users </span><br><span class="line"><span class="keyword">from</span> gameplays <span class="keyword">as</span> g1</span><br><span class="line">  <span class="comment">/**/</span> <span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">    gameplays <span class="keyword">as</span> g2 <span class="keyword">on</span></span><br><span class="line">    g1.user_id = g2.user_id</span><br><span class="line">    <span class="keyword">and</span> <span class="built_in">date</span>(g1.created_at) = <span class="built_in">date</span>(datetime(g2.created_at, <span class="string">'-1 day'</span>))</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">limit</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>dt</th>
<th>total_users</th>
<th>retained_users</th>
</tr>
</thead>
<tbody><tr>
<td>2015-08-19</td>
<td>111</td>
<td>26</td>
</tr>
<tr>
<td>2015-08-20</td>
<td>117</td>
<td>31</td>
</tr>
<tr>
<td>2015-08-21</td>
<td>112</td>
<td>27</td>
</tr>
<tr>
<td>2015-08-22</td>
<td>117</td>
<td>24</td>
</tr>
<tr>
<td>2015-08-23</td>
<td>94</td>
<td>23</td>
</tr>
<tr>
<td>2015-08-24</td>
<td>108</td>
<td>23</td>
</tr>
<tr>
<td>2015-08-25</td>
<td>120</td>
<td>23</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(g1.created_at) <span class="keyword">as</span> dt,</span><br><span class="line">  <span class="comment">-- g1.user_id, </span></span><br><span class="line">  <span class="comment">-- g2.user_id</span></span><br><span class="line">  <span class="keyword">round</span>(<span class="number">100</span> * <span class="keyword">count</span>(<span class="keyword">distinct</span> g1.user_id) <span class="keyword">as</span> total_users /</span><br><span class="line">  <span class="keyword">count</span>(<span class="keyword">distinct</span> g2.user_id)) <span class="keyword">as</span> <span class="keyword">retention</span></span><br><span class="line"><span class="keyword">from</span> gameplays <span class="keyword">as</span> g1</span><br><span class="line">  <span class="comment">/**/</span> <span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">    gameplays <span class="keyword">as</span> g2 <span class="keyword">on</span></span><br><span class="line">    g1.user_id = g2.user_id</span><br><span class="line">    <span class="keyword">and</span> <span class="built_in">date</span>(g1.created_at) = <span class="built_in">date</span>(datetime(g2.created_at, <span class="string">'-1 day'</span>))</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">limit</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(g1.created_at) <span class="keyword">as</span> dt,</span><br><span class="line">  <span class="keyword">round</span>(<span class="number">100</span> * <span class="keyword">count</span>(<span class="keyword">distinct</span> g2.user_id) /</span><br><span class="line">    <span class="keyword">count</span>(<span class="keyword">distinct</span> g1.user_id)) <span class="keyword">as</span> <span class="keyword">retention</span></span><br><span class="line"><span class="keyword">from</span> gameplays <span class="keyword">as</span> g1</span><br><span class="line">  <span class="keyword">left</span> <span class="keyword">join</span> gameplays <span class="keyword">as</span> g2 <span class="keyword">on</span></span><br><span class="line">    g1.user_id = g2.user_id</span><br><span class="line">    <span class="keyword">and</span> <span class="built_in">date</span>(g1.created_at) = <span class="built_in">date</span>(datetime(g2.created_at, <span class="string">'-1 day'</span>))</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">limit</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>



<h2 id="Common-Metrics-Conclusion"><a href="#Common-Metrics-Conclusion" class="headerlink" title="Common Metrics Conclusion"></a>Common Metrics Conclusion</h2><p>While every business has different metrics to track their success, most are based on revenue and usage.</p>
<p>The metrics in this lesson are merely a starting point, and from here you’ll be able to create and customize metrics to track whatever is most important to your company.</p>
<p>And remember, data science is exploratory! The current set of metrics can always be improved and there’s usually more to any spike or dip than what immediately meets the eye.</p>
<p>Let’s generalize what we’ve learned so far:</p>
<ul>
<li><em>Key Performance Indicators</em> are high level health metrics for a business.</li>
<li><em>Daily Revenue</em> is the sum of money made per day.</li>
<li><em>Daily Active Users</em> are the number of unique users seen each day</li>
<li><em>Daily Average Revenue Per Purchasing User (ARPPU)</em> is the average amount of money spent by purchasers each day.</li>
<li><em>Daily Average Revenue Per User (ARPU)</em> is the average amount of money across all users.</li>
<li><em>1 Day Retention</em> is defined as the number of players from Day N who came back to play again on Day N+1.</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Joe Huang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/02/20/Codecademies/2020-02-22-SQL-Advanced_Aggregate_&amp;_Count_Metrics/">http://yoursite.com/2020/02/20/Codecademies/2020-02-22-SQL-Advanced_Aggregate_&amp;_Count_Metrics/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2020/02/21/SQL/2020-02-21-SQL-UTM%20with%20Case/"><i class="fa fa-chevron-left">  </i><span>SQL/2020-02-21-SQL-UTM with Case</span></a></div><div class="next-post pull-right"><a href="/2020/02/20/SQL/2020-02-20-SQL-Create%20Table/"><span>SQL/2020-02-20-SQL-Create Table</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2023 By Joe Huang</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>