<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="Joe Huang"><meta name="copyright" content="Joe Huang"><title>Awaken Desparado</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.1.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Joe Huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">249</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">24</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">36</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Awaken Desparado</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Awaken Desparado</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2020/03/28/NLP/2020-03-28-NLP_nltk_0/">NLP/2020-03-28-NLP_nltk_0</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-03-28</time><div class="content"><h3 id="Text-Preprocessing"><a href="#Text-Preprocessing" class="headerlink" title="Text Preprocessing"></a>Text Preprocessing</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># regex for removing punctuation!</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment"># nltk preprocessing magic</span></span><br><span class="line"><span class="keyword">import</span> nltk</span><br><span class="line"><span class="keyword">from</span> nltk.tokenize <span class="keyword">import</span> word_tokenize</span><br><span class="line"><span class="keyword">from</span> nltk.stem <span class="keyword">import</span> PorterStemmer</span><br><span class="line"><span class="keyword">from</span> nltk.stem <span class="keyword">import</span> WordNetLemmatizer</span><br><span class="line"><span class="comment"># grabbing a part of speech function:</span></span><br><span class="line"><span class="keyword">from</span> part_of_speech <span class="keyword">import</span> get_part_of_speech</span><br><span class="line"></span><br><span class="line">text = <span class="string">"So many squids are jumping out of suitcases these days that you can barely go anywhere without seeing one burst forth from a tightly packed valise. I went to the dentist the other day, and sure enough I saw an angry one jump out of my dentist's bag within minutes of arriving. She hardly even noticed."</span></span><br><span class="line"></span><br><span class="line">cleaned = re.sub(<span class="string">'\W+'</span>, <span class="string">' '</span>, text)</span><br><span class="line">tokenized = word_tokenize(cleaned)</span><br><span class="line"></span><br><span class="line">stemmer = PorterStemmer()</span><br><span class="line">stemmed = [stemmer.stem(token) <span class="keyword">for</span> token <span class="keyword">in</span> tokenized]</span><br><span class="line"></span><br><span class="line"><span class="comment">## -- CHANGE these -- ##</span></span><br><span class="line">lemmatizer = WordNetLemmatizer()</span><br><span class="line">lemmatized = [lemmatizer.lemmatize(token, get_part_of_speech(token)) <span class="keyword">for</span> token <span class="keyword">in</span> tokenized]</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Stemmed text:"</span>)</span><br><span class="line">print(stemmed)</span><br><span class="line">print(<span class="string">"\nLemmatized text:"</span>)</span><br><span class="line">print(lemmatized)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Stemmed text:</span><br><span class="line">[<span class="string">'So'</span>, <span class="string">'mani'</span>, <span class="string">'squid'</span>, <span class="string">'are'</span>, <span class="string">'jump'</span>, <span class="string">'out'</span>, <span class="string">'of'</span>, <span class="string">'suitcas'</span>, <span class="string">'these'</span>, <span class="string">'day'</span>, <span class="string">'that'</span>, <span class="string">'you'</span>, <span class="string">'can'</span>, <span class="string">'bare'</span>, <span class="string">'go'</span>, <span class="string">'anywher'</span>, <span class="string">'without'</span>, <span class="string">'see'</span>, <span class="string">'one'</span>, <span class="string">'burst'</span>, <span class="string">'forth'</span>, <span class="string">'from'</span>, <span class="string">'a'</span>, <span class="string">'tightli'</span>, <span class="string">'pack'</span>, <span class="string">'valis'</span>, <span class="string">'I'</span>, <span class="string">'went'</span>, <span class="string">'to'</span>, <span class="string">'the'</span>, <span class="string">'dentist'</span>, <span class="string">'the'</span>, <span class="string">'other'</span>, <span class="string">'day'</span>, <span class="string">'and'</span>, <span class="string">'sure'</span>, <span class="string">'enough'</span>, <span class="string">'I'</span>, <span class="string">'saw'</span>, <span class="string">'an'</span>, <span class="string">'angri'</span>, <span class="string">'one'</span>, <span class="string">'jump'</span>, <span class="string">'out'</span>, <span class="string">'of'</span>, <span class="string">'my'</span>, <span class="string">'dentist'</span>, <span class="string">'s'</span>, <span class="string">'bag'</span>, <span class="string">'within'</span>, <span class="string">'minut'</span>, <span class="string">'of'</span>, <span class="string">'arriv'</span>, <span class="string">'she'</span>, <span class="string">'hardli'</span>, <span class="string">'even'</span>, <span class="string">'notic'</span>]</span><br><span class="line"></span><br><span class="line">Lemmatized text:</span><br><span class="line">[<span class="string">'So'</span>, <span class="string">'many'</span>, <span class="string">'squid'</span>, <span class="string">'be'</span>, <span class="string">'jump'</span>, <span class="string">'out'</span>, <span class="string">'of'</span>, <span class="string">'suitcase'</span>, <span class="string">'these'</span>, <span class="string">'day'</span>, <span class="string">'that'</span>, <span class="string">'you'</span>, <span class="string">'can'</span>, <span class="string">'barely'</span>, <span class="string">'go'</span>, <span class="string">'anywhere'</span>, <span class="string">'without'</span>, <span class="string">'see'</span>, <span class="string">'one'</span>, <span class="string">'burst'</span>, <span class="string">'forth'</span>, <span class="string">'from'</span>, <span class="string">'a'</span>, <span class="string">'tightly'</span>, <span class="string">'pack'</span>, <span class="string">'valise'</span>, <span class="string">'I'</span>, <span class="string">'go'</span>, <span class="string">'to'</span>, <span class="string">'the'</span>, <span class="string">'dentist'</span>, <span class="string">'the'</span>, <span class="string">'other'</span>, <span class="string">'day'</span>, <span class="string">'and'</span>, <span class="string">'sure'</span>, <span class="string">'enough'</span>, <span class="string">'I'</span>, <span class="string">'saw'</span>, <span class="string">'an'</span>, <span class="string">'angry'</span>, <span class="string">'one'</span>, <span class="string">'jump'</span>, <span class="string">'out'</span>, <span class="string">'of'</span>, <span class="string">'my'</span>, <span class="string">'dentist'</span>, <span class="string">'s'</span>, <span class="string">'bag'</span>, <span class="string">'within'</span>, <span class="string">'minute'</span>, <span class="string">'of'</span>, <span class="string">'arrive'</span>, <span class="string">'She'</span>, <span class="string">'hardly'</span>, <span class="string">'even'</span>, <span class="string">'notice'</span>]</span><br></pre></td></tr></table></figure>



<h3 id="Parsing-Text"><a href="#Parsing-Text" class="headerlink" title="Parsing Text"></a>Parsing Text</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> spacy</span><br><span class="line"><span class="keyword">from</span> nltk <span class="keyword">import</span> Tree</span><br><span class="line"><span class="keyword">from</span> squids <span class="keyword">import</span> squids_text</span><br><span class="line"></span><br><span class="line">dependency_parser = spacy.load(<span class="string">'en'</span>)</span><br><span class="line"></span><br><span class="line">parsed_squids = dependency_parser(squids_text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Assign my_sentence a new value:</span></span><br><span class="line">my_sentence = <span class="string">"Your sentence goes here!"</span></span><br><span class="line">my_parsed_sentence = dependency_parser(my_sentence)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_nltk_tree</span><span class="params">(node)</span>:</span></span><br><span class="line">  <span class="keyword">if</span> node.n_lefts + node.n_rights &gt; <span class="number">0</span>:</span><br><span class="line">    parsed_child_nodes = [to_nltk_tree(child) <span class="keyword">for</span> child <span class="keyword">in</span> node.children]</span><br><span class="line">    <span class="keyword">return</span> Tree(node.orth_, parsed_child_nodes)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">return</span> node.orth_</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> sent <span class="keyword">in</span> parsed_squids.sents:</span><br><span class="line">  to_nltk_tree(sent.root).pretty_print()</span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> sent <span class="keyword">in</span> my_parsed_sentence.sents:</span><br><span class="line"> to_nltk_tree(sent.root).pretty_print()</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">        jumping                       </span><br><span class="line">  _________|_______________________    </span><br><span class="line"> |   |     |      |       out      |  </span><br><span class="line"> |   |     |      |        |       |   </span><br><span class="line"> |   |     |    squids     of     days</span><br><span class="line"> |   |     |      |        |       |   </span><br><span class="line"> So are    .     many  suitcases these</span><br><span class="line"></span><br><span class="line">          go                       </span><br><span class="line">  ________|____________________     </span><br><span class="line"> |   |    |       |      |  without</span><br><span class="line"> |   |    |       |      |     |    </span><br><span class="line"> |   |    |       |      |   seeing</span><br><span class="line"> |   |    |       |      |     |    </span><br><span class="line">You can barely anywhere  .    one  </span><br><span class="line"></span><br><span class="line">          went               </span><br><span class="line">  _________|_________         </span><br><span class="line"> |   |     to        |       </span><br><span class="line"> |   |     |         |        </span><br><span class="line"> |   |  dentist     day      </span><br><span class="line"> |   |     |      ___|____    </span><br><span class="line"> I   .    the   the     other</span><br><span class="line"></span><br><span class="line">             saw                                     </span><br><span class="line">  ____________|___________________                    </span><br><span class="line"> |   |   |    |                  jump                </span><br><span class="line"> |   |   |    |          _________|__________         </span><br><span class="line"> |   |   |    |         |                   out      </span><br><span class="line"> |   |   |    |         |                    |        </span><br><span class="line"> |   |   |    |         |                    of      </span><br><span class="line"> |   |   |    |         |                    |        </span><br><span class="line"> |   |   |    |         |                   bag      </span><br><span class="line"> |   |   |    |         |                    |        </span><br><span class="line"> |   |   |  enough     one                dentist    </span><br><span class="line"> |   |   |    |      ___|____           _____|_____   </span><br><span class="line"> ,   I   .   Sure   an     angry       my          <span class="string">'s</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    noticed         </span></span><br><span class="line"><span class="string">  _____|__________   </span></span><br><span class="line"><span class="string">She  hardly even  . </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">     goes         </span></span><br><span class="line"><span class="string">  ____|______      </span></span><br><span class="line"><span class="string"> |    |   sentence</span></span><br><span class="line"><span class="string"> |    |      |     </span></span><br><span class="line"><span class="string">here  !     Your</span></span><br></pre></td></tr></table></figure>



<h3 id="Language-Models-Bag-of-Words-Approach"><a href="#Language-Models-Bag-of-Words-Approach" class="headerlink" title="Language Models - Bag-of-Words Approach"></a>Language Models - Bag-of-Words Approach</h3><p>When grammar and word order are irrelevant, this is probably a good model to use.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># importing regex and nltk</span></span><br><span class="line"><span class="keyword">import</span> re, nltk</span><br><span class="line"><span class="keyword">from</span> nltk.corpus <span class="keyword">import</span> stopwords</span><br><span class="line"><span class="keyword">from</span> nltk.tokenize <span class="keyword">import</span> word_tokenize</span><br><span class="line"><span class="keyword">from</span> nltk.stem <span class="keyword">import</span> WordNetLemmatizer</span><br><span class="line"><span class="comment"># importing Counter to get word counts for bag of words</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="comment"># importing a passage from Through the Looking Glass</span></span><br><span class="line"><span class="keyword">from</span> looking_glass <span class="keyword">import</span> looking_glass_text</span><br><span class="line"><span class="comment"># importing part-of-speech function for lemmatization</span></span><br><span class="line"><span class="keyword">from</span> part_of_speech <span class="keyword">import</span> get_part_of_speech</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change text to another string:</span></span><br><span class="line"><span class="comment"># text = looking_glass_text</span></span><br><span class="line">text = <span class="string">"hello world i miss you"</span></span><br><span class="line"></span><br><span class="line">cleaned = re.sub(<span class="string">'\W+'</span>, <span class="string">' '</span>, text).lower()</span><br><span class="line">tokenized = word_tokenize(cleaned)</span><br><span class="line"></span><br><span class="line">stop_words = stopwords.words(<span class="string">'english'</span>)</span><br><span class="line">filtered = [word <span class="keyword">for</span> word <span class="keyword">in</span> tokenized <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> stop_words]</span><br><span class="line"></span><br><span class="line">normalizer = WordNetLemmatizer()</span><br><span class="line">normalized = [normalizer.lemmatize(token, get_part_of_speech(token)) <span class="keyword">for</span> token <span class="keyword">in</span> filtered]</span><br><span class="line"><span class="comment"># Comment out the print statement below</span></span><br><span class="line">print(normalized)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define bag_of_looking_glass_words &amp; print:</span></span><br><span class="line">bag_of_looking_glass_words = Counter(normalized)</span><br><span class="line">print(bag_of_looking_glass_words)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">'hello'</span>, <span class="string">'world'</span>, <span class="string">'miss'</span>]</span><br><span class="line">Counter(&#123;<span class="string">'hello'</span>: 1, <span class="string">'world'</span>: 1, <span class="string">'miss'</span>: 1&#125;)</span><br></pre></td></tr></table></figure>



<h3 id="Language-Models-N-Grams-and-NLM"><a href="#Language-Models-N-Grams-and-NLM" class="headerlink" title="Language Models - N-Grams and NLM"></a>Language Models - N-Grams and NLM</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nltk, re</span><br><span class="line"><span class="keyword">from</span> nltk.tokenize <span class="keyword">import</span> word_tokenize</span><br><span class="line"><span class="comment"># importing ngrams module from nltk</span></span><br><span class="line"><span class="keyword">from</span> nltk.util <span class="keyword">import</span> ngrams</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">from</span> looking_glass <span class="keyword">import</span> looking_glass_full_text</span><br><span class="line"></span><br><span class="line">cleaned = re.sub(<span class="string">'\W+'</span>, <span class="string">' '</span>, looking_glass_full_text).lower()</span><br><span class="line">tokenized = word_tokenize(cleaned)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change the n value to 2:</span></span><br><span class="line">looking_glass_bigrams = ngrams(tokenized, <span class="number">2</span>)</span><br><span class="line">looking_glass_bigrams_frequency = Counter(looking_glass_bigrams)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change the n value to 3:</span></span><br><span class="line">looking_glass_trigrams = ngrams(tokenized, <span class="number">3</span>)</span><br><span class="line">looking_glass_trigrams_frequency = Counter(looking_glass_trigrams)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Change the n value to a number greater than 3:</span></span><br><span class="line">looking_glass_ngrams = ngrams(tokenized, <span class="number">4</span>)</span><br><span class="line">looking_glass_ngrams_frequency = Counter(looking_glass_ngrams)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Looking Glass Bigrams:"</span>)</span><br><span class="line">print(looking_glass_bigrams_frequency.most_common(<span class="number">10</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"\nLooking Glass Trigrams:"</span>)</span><br><span class="line">print(looking_glass_trigrams_frequency.most_common(<span class="number">10</span>), <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">3</span></span><br><span class="line">print(<span class="string">"\nLooking Glass n-grams:"</span>)</span><br><span class="line">print(looking_glass_ngrams_frequency.most_common(<span class="number">10</span>), <span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Looking Glass Bigrams:</span><br><span class="line">[((<span class="string">'of'</span>, <span class="string">'the'</span>), 101), ((<span class="string">'said'</span>, <span class="string">'the'</span>), 98), ((<span class="string">'in'</span>, <span class="string">'a'</span>), 97), ((<span class="string">'in'</span>, <span class="string">'the'</span>), 90), ((<span class="string">'as'</span>, <span class="string">'she'</span>), 82), ((<span class="string">'you'</span>, <span class="string">'know'</span>), 72), ((<span class="string">'a'</span>, <span class="string">'little'</span>), 68), ((<span class="string">'the'</span>, <span class="string">'queen'</span>), 67), ((<span class="string">'said'</span>, <span class="string">'alice'</span>), 67), ((<span class="string">'to'</span>, <span class="string">'the'</span>), 66)] 2</span><br><span class="line"></span><br><span class="line">Looking Glass Trigrams:</span><br><span class="line">[((<span class="string">'the'</span>, <span class="string">'red'</span>, <span class="string">'queen'</span>), 54), ((<span class="string">'the'</span>, <span class="string">'white'</span>, <span class="string">'queen'</span>), 31), ((<span class="string">'said'</span>, <span class="string">'in'</span>, <span class="string">'a'</span>), 21), ((<span class="string">'she'</span>, <span class="string">'went'</span>, <span class="string">'on'</span>), 18), ((<span class="string">'said'</span>, <span class="string">'the'</span>, <span class="string">'red'</span>), 17), ((<span class="string">'thought'</span>, <span class="string">'to'</span>, <span class="string">'herself'</span>), 16), ((<span class="string">'the'</span>, <span class="string">'queen'</span>, <span class="string">'said'</span>), 16), ((<span class="string">'said'</span>, <span class="string">'to'</span>, <span class="string">'herself'</span>), 14), ((<span class="string">'said'</span>, <span class="string">'humpty'</span>, <span class="string">'dumpty'</span>), 14), ((<span class="string">'the'</span>, <span class="string">'knight'</span>, <span class="string">'said'</span>), 14)] 3</span><br><span class="line"></span><br><span class="line">Looking Glass n-grams:</span><br><span class="line">[((<span class="string">'said'</span>, <span class="string">'the'</span>, <span class="string">'red'</span>, <span class="string">'queen'</span>), 15), ((<span class="string">'she'</span>, <span class="string">'said'</span>, <span class="string">'to'</span>, <span class="string">'herself'</span>), 11), ((<span class="string">'alice'</span>, <span class="string">'thought'</span>, <span class="string">'to'</span>, <span class="string">'herself'</span>), 9), ((<span class="string">'to'</span>, <span class="string">'herself'</span>, <span class="string">'as'</span>, <span class="string">'she'</span>), 9), ((<span class="string">'one'</span>, <span class="string">'and'</span>, <span class="string">'one'</span>, <span class="string">'and'</span>), 8), ((<span class="string">'and'</span>, <span class="string">'one'</span>, <span class="string">'and'</span>, <span class="string">'one'</span>), 8), ((<span class="string">'alice'</span>, <span class="string">'said'</span>, <span class="string">'in'</span>, <span class="string">'a'</span>), 6), ((<span class="string">'for'</span>, <span class="string">'a'</span>, <span class="string">'minute'</span>, <span class="string">'or'</span>), 6), ((<span class="string">'a'</span>, <span class="string">'minute'</span>, <span class="string">'or'</span>, <span class="string">'two'</span>), 6), ((<span class="string">'in'</span>, <span class="string">'a'</span>, <span class="string">'tone'</span>, <span class="string">'of'</span>), 6)] 5</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nltk, re</span><br><span class="line"><span class="keyword">from</span> sherlock_holmes <span class="keyword">import</span> bohemia_ch1, bohemia_ch2, bohemia_ch3, boscombe_ch1, boscombe_ch2, boscombe_ch3</span><br><span class="line"><span class="keyword">from</span> preprocessing <span class="keyword">import</span> preprocess_text</span><br><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> CountVectorizer, TfidfVectorizer</span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> LatentDirichletAllocation</span><br><span class="line"></span><br><span class="line"><span class="comment"># preparing the text</span></span><br><span class="line">corpus = [bohemia_ch1, bohemia_ch2, bohemia_ch3, boscombe_ch1, boscombe_ch2, boscombe_ch3]</span><br><span class="line">preprocessed_corpus = [preprocess_text(chapter) <span class="keyword">for</span> chapter <span class="keyword">in</span> corpus]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Update stop_list:</span></span><br><span class="line">stop_list = []</span><br><span class="line"><span class="comment"># filtering topics for stop words</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">filter_out_stop_words</span><span class="params">(corpus)</span>:</span></span><br><span class="line">  no_stops_corpus = []</span><br><span class="line">  <span class="keyword">for</span> chapter <span class="keyword">in</span> corpus:</span><br><span class="line">    no_stops_chapter = <span class="string">" "</span>.join([word <span class="keyword">for</span> word <span class="keyword">in</span> chapter.split(<span class="string">" "</span>) <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> stop_list])</span><br><span class="line">    no_stops_corpus.append(no_stops_chapter)</span><br><span class="line">  <span class="keyword">return</span> no_stops_corpus</span><br><span class="line">filtered_for_stops = filter_out_stop_words(preprocessed_corpus)</span><br><span class="line"></span><br><span class="line"><span class="comment"># creating the bag of words model</span></span><br><span class="line">bag_of_words_creator = CountVectorizer()</span><br><span class="line">bag_of_words = bag_of_words_creator.fit_transform(filtered_for_stops)</span><br><span class="line"></span><br><span class="line"><span class="comment"># creating the tf-idf model</span></span><br><span class="line">tfidf_creator = TfidfVectorizer(min_df = <span class="number">0.2</span>)</span><br><span class="line">tfidf = tfidf_creator.fit_transform(preprocessed_corpus)</span><br><span class="line"></span><br><span class="line"><span class="comment"># creating the bag of words LDA model</span></span><br><span class="line">lda_bag_of_words_creator = LatentDirichletAllocation(learning_method=<span class="string">'online'</span>, n_components=<span class="number">10</span>)</span><br><span class="line">lda_bag_of_words = lda_bag_of_words_creator.fit_transform(bag_of_words)</span><br><span class="line"></span><br><span class="line"><span class="comment"># creating the tf-idf LDA model</span></span><br><span class="line">lda_tfidf_creator = LatentDirichletAllocation(learning_method=<span class="string">'online'</span>, n_components=<span class="number">10</span>)</span><br><span class="line">lda_tfidf = lda_tfidf_creator.fit_transform(tfidf)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"~~~ Topics found by bag of words LDA ~~~"</span>)</span><br><span class="line"><span class="keyword">for</span> topic_id, topic <span class="keyword">in</span> enumerate(lda_bag_of_words_creator.components_):</span><br><span class="line">  message = <span class="string">"Topic #&#123;&#125;: "</span>.format(topic_id + <span class="number">1</span>)</span><br><span class="line">  message += <span class="string">" "</span>.join([bag_of_words_creator.get_feature_names()[i] <span class="keyword">for</span> i <span class="keyword">in</span> topic.argsort()[:<span class="number">-5</span> :<span class="number">-1</span>]])</span><br><span class="line">  print(message)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"\n\n~~~ Topics found by tf-idf LDA ~~~"</span>)</span><br><span class="line"><span class="keyword">for</span> topic_id, topic <span class="keyword">in</span> enumerate(lda_tfidf_creator.components_):</span><br><span class="line">  message = <span class="string">"Topic #&#123;&#125;: "</span>.format(topic_id + <span class="number">1</span>)</span><br><span class="line">  message += <span class="string">" "</span>.join([tfidf_creator.get_feature_names()[i] <span class="keyword">for</span> i <span class="keyword">in</span> topic.argsort()[:<span class="number">-5</span> :<span class="number">-1</span>]])</span><br><span class="line">  print(message)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">~~~ Topics found by bag of words LDA ~~~</span><br><span class="line">Topic <span class="comment">#1: holmes say little upon</span></span><br><span class="line">Topic <span class="comment">#2: house come could man</span></span><br><span class="line">Topic <span class="comment">#3: holmes say know come</span></span><br><span class="line">Topic <span class="comment">#4: holmes would say know</span></span><br><span class="line">Topic <span class="comment">#5: say holmes know see</span></span><br><span class="line">Topic <span class="comment">#6: say holmes man could</span></span><br><span class="line">Topic <span class="comment">#7: say upon mccarthy man</span></span><br><span class="line">Topic <span class="comment">#8: make holmes cry majesty</span></span><br><span class="line">Topic <span class="comment">#9: holmes say man upon</span></span><br><span class="line">Topic <span class="comment">#10: upon holmes see say</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">~~~ Topics found by tf-idf LDA ~~~</span><br><span class="line">Topic <span class="comment">#1: merely upon boot catch</span></span><br><span class="line">Topic <span class="comment">#2: boot save holmes mccarthy</span></span><br><span class="line">Topic <span class="comment">#3: norton resolve help refer</span></span><br><span class="line">Topic <span class="comment">#4: leave remove three lodge</span></span><br><span class="line">Topic <span class="comment">#5: say neck resolute stone</span></span><br><span class="line">Topic <span class="comment">#6: holmes king majesty photograph</span></span><br><span class="line">Topic <span class="comment">#7: fear together heavy upon</span></span><br><span class="line">Topic <span class="comment">#8: holmes say know man</span></span><br><span class="line">Topic <span class="comment">#9: figure surround definite heel</span></span><br><span class="line">Topic <span class="comment">#10: know many swiftly scotland</span></span><br></pre></td></tr></table></figure>



<h3 id="Text-Similarity"><a href="#Text-Similarity" class="headerlink" title="Text Similarity"></a>Text Similarity</h3><p>Most of us have a good autocorrect story. Our phone’s messenger quietly swaps one letter for another as we type and suddenly the meaning of our message has changed (to our horror or pleasure). However, addressing <strong><em>text similarity\</em></strong> — including spelling correction — is a major challenge within natural language processing.</p>
<p>Addressing word similarity and misspelling for spellcheck or autocorrect often involves considering the <strong><em>Levenshtein distance\</em></strong> or minimal edit distance between two words. The distance is calculated through the minimum number of insertions, deletions, and substitutions that would need to occur for one word to become another. For example, turning “bees” into “beans” would require one substitution (“a” for “e”) and one insertion (“n”), so the Levenshtein distance would be two.</p>
<p>Phonetic similarity is also a major challenge within speech recognition. English-speaking humans can easily tell from context whether someone said “euthanasia” or “youth in Asia,” but it’s a far more challenging task for a machine! More advanced autocorrect and spelling correction technology additionally considers key distance on a keyboard and <strong><em>phonetic similarity\</em></strong> (how much two words or phrases sound the same).</p>
<p>It’s also helpful to find out if texts are the same to guard against plagiarism, which we can identify through <strong><em>lexical similarity\</em></strong> (the degree to which texts use the same vocabulary and phrases). Meanwhile, <strong><em>semantic similarity\</em></strong> (the degree to which documents contain similar meaning or topics) is useful when you want to find (or recommend) an article or book similar to one you recently finished.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nltk</span><br><span class="line"><span class="comment"># NLTK has a built-in function</span></span><br><span class="line"><span class="comment"># to check Levenshtein distance:</span></span><br><span class="line"><span class="keyword">from</span> nltk.metrics <span class="keyword">import</span> edit_distance</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_levenshtein</span><span class="params">(string1, string2)</span>:</span></span><br><span class="line">  print(<span class="string">"The Levenshtein distance from '&#123;0&#125;' to '&#123;1&#125;' is &#123;2&#125;!"</span>.format(string1, string2, edit_distance(string1, string2)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Check the distance between</span></span><br><span class="line"><span class="comment"># any two words here!</span></span><br><span class="line">print_levenshtein(<span class="string">"fart"</span>, <span class="string">"target"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Assign passing strings here:</span></span><br><span class="line">three_away_from_code = <span class="string">"cat"</span></span><br><span class="line"></span><br><span class="line">two_away_from_chunk = <span class="string">"cheek"</span></span><br><span class="line"></span><br><span class="line">print_levenshtein(<span class="string">"code"</span>, three_away_from_code)</span><br><span class="line">print_levenshtein(<span class="string">"chunk"</span>, two_away_from_chunk)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The Levenshtein distance from <span class="string">'fart'</span> to <span class="string">'target'</span> is 3!</span><br><span class="line">The Levenshtein distance from <span class="string">'code'</span> to <span class="string">'cat'</span> is 3!</span><br><span class="line">The Levenshtein distance from <span class="string">'chunk'</span> to <span class="string">'cheek'</span> is 2!</span><br></pre></td></tr></table></figure>



<h3 id="Language-Prediction-amp-Text-Generation"><a href="#Language-Prediction-amp-Text-Generation" class="headerlink" title="Language Prediction &amp; Text Generation"></a>Language Prediction &amp; Text Generation</h3><p>How does your favorite search engine complete your search queries? How does your phone’s keyboard know what you want to type next? <strong><em>Language prediction\</em></strong> is an application of NLP concerned with predicting text given preceding text. Autosuggest, autocomplete, and suggested replies are common forms of language prediction.</p>
<p>Your first step to language prediction is picking a language model. Bag of words alone is generally not a great model for language prediction; no matter what the preceding word was, you will just get one of the most commonly used words from your training corpus.</p>
<p>If you go the <em>n</em>-gram route, you will most likely rely on <strong><em>Markov chains\</em></strong> to predict the statistical likelihood of each following word (or character) based on the training corpus. Markov chains are memory-less and make statistical predictions based entirely on the current <em>n</em>-gram on hand.</p>
<p>For example, let’s take a sentence beginning, “I ate so many grilled cheese”. Using a trigram model (where <em>n</em> is 3), a Markov chain would predict the following word as “sandwiches” based on the number of times the sequence “grilled cheese sandwiches” has appeared in the training data out of all the times “grilled cheese” has appeared in the training data.</p>
<p>A more advanced approach, using a neural language model, is the <strong><em>Long Short Term Memory (LSTM)\</em></strong> model. LSTM uses deep learning with a network of artificial “cells” that manage memory, making them better suited for text prediction than traditional neural networks.</p>
<p><strong>1.</strong></p>
<p>Add three short stories by your favorite author or the lyrics to three songs by your favorite artist to <strong>document1.py</strong>, <strong>document2.py</strong>, and <strong>document3.py</strong>. Then run <strong>script.py</strong> to see a short example of text prediction.</p>
<p>Does it look like something by your favorite author or artist?</p>
<p>If you accidentally close one of the files, just click the file folder in the top left corner of the code editor to find the file and re-open it.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nltk, re, random</span><br><span class="line"><span class="keyword">from</span> nltk.tokenize <span class="keyword">import</span> word_tokenize</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict, deque</span><br><span class="line"><span class="keyword">from</span> document1 <span class="keyword">import</span> training_doc1</span><br><span class="line"><span class="keyword">from</span> document2 <span class="keyword">import</span> training_doc2</span><br><span class="line"><span class="keyword">from</span> document3 <span class="keyword">import</span> training_doc3</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MarkovChain</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">    self.lookup_dict = defaultdict(list)</span><br><span class="line">    self._seeded = <span class="literal">False</span></span><br><span class="line">    self.__seed_me()</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__seed_me</span><span class="params">(self, rand_seed=None)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> self._seeded <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">True</span>:</span><br><span class="line">      <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> rand_seed <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">          random.seed(rand_seed)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">          random.seed()</span><br><span class="line">        self._seeded = <span class="literal">True</span></span><br><span class="line">      <span class="keyword">except</span> NotImplementedError:</span><br><span class="line">        self._seeded = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">add_document</span><span class="params">(self, str)</span>:</span></span><br><span class="line">    preprocessed_list = self._preprocess(str)</span><br><span class="line">    pairs = self.__generate_tuple_keys(preprocessed_list)</span><br><span class="line">    <span class="keyword">for</span> pair <span class="keyword">in</span> pairs:</span><br><span class="line">      self.lookup_dict[pair[<span class="number">0</span>]].append(pair[<span class="number">1</span>])</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">_preprocess</span><span class="params">(self, str)</span>:</span></span><br><span class="line">    cleaned = re.sub(<span class="string">r'\W+'</span>, <span class="string">' '</span>, str).lower()</span><br><span class="line">    tokenized = word_tokenize(cleaned)</span><br><span class="line">    <span class="keyword">return</span> tokenized</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__generate_tuple_keys</span><span class="params">(self, data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> len(data) &lt; <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(data) - <span class="number">1</span>):</span><br><span class="line">      <span class="keyword">yield</span> [ data[i], data[i + <span class="number">1</span>] ]</span><br><span class="line">      </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">generate_text</span><span class="params">(self, max_length=<span class="number">50</span>)</span>:</span></span><br><span class="line">    context = deque()</span><br><span class="line">    output = []</span><br><span class="line">    <span class="keyword">if</span> len(self.lookup_dict) &gt; <span class="number">0</span>:</span><br><span class="line">      self.__seed_me(rand_seed=len(self.lookup_dict))</span><br><span class="line">      chain_head = [list(self.lookup_dict)[<span class="number">0</span>]]</span><br><span class="line">      context.extend(chain_head)</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">while</span> len(output) &lt; (max_length - <span class="number">1</span>):</span><br><span class="line">        next_choices = self.lookup_dict[context[<span class="number">-1</span>]]</span><br><span class="line">        <span class="keyword">if</span> len(next_choices) &gt; <span class="number">0</span>:</span><br><span class="line">          next_word = random.choice(next_choices)</span><br><span class="line">          context.append(next_word)</span><br><span class="line">          output.append(context.popleft())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">          <span class="keyword">break</span></span><br><span class="line">      output.extend(list(context))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">" "</span>.join(output)</span><br><span class="line"></span><br><span class="line">my_markov = MarkovChain()</span><br><span class="line">my_markov.add_document(training_doc1)</span><br><span class="line">my_markov.add_document(training_doc2)</span><br><span class="line">my_markov.add_document(training_doc3)</span><br><span class="line">generated_text = my_markov.generate_text()</span><br><span class="line">print(generated_text)</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/03/28/Web/2020-03-28-Full%20Stack%20review/">Web/2020-03-28-Full Stack review</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-03-28</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Web/">Web</a></span><div class="content"><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd8e8h8nvzj317g0g6n9s.jpg" alt="image-20200327125348804" style="zoom:67%;" /></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/03/23/System-Design/Abstraction/2020-03-15-System%20Design%20Abstraction%201/">System-Design/Abstraction/2020-03-15-System Design Abstraction 1</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-03-23</time><div class="content"><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p><a href="https://aojajena.wordpress.com/2012/04/19/abstraction-in-design/" target="_blank" rel="noopener">https://aojajena.wordpress.com/2012/04/19/abstraction-in-design/</a></p>
<p><a href="http://web.stanford.edu/~ouster/CS349W/lectures/abstraction.html" target="_blank" rel="noopener">http://web.stanford.edu/~ouster/CS349W/lectures/abstraction.html</a></p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd3y9agjg2j30sc0iu0w9.jpg" alt="image-20200323163855008"></p>
<h2 id="2-UI-amp-UX"><a href="#2-UI-amp-UX" class="headerlink" title="2 UI &amp; UX"></a>2 UI &amp; UX</h2><p><a href="https://99designs.com/blog/tips/7-unbreakable-laws-of-user-interface-design/" target="_blank" rel="noopener">https://99designs.com/blog/tips/7-unbreakable-laws-of-user-interface-design/</a></p>
<h3 id="User-Experience"><a href="#User-Experience" class="headerlink" title="User Experience"></a>User Experience</h3></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/03/18/Books/2020-03-23-Lifes%20in%20English/">Books/2020-03-23-Lifes in English</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-03-18</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/English-Life/">English &amp; Life</a></span><div class="content"><blockquote>
<p>Ross: Probably. But you know, I’ll tell you something. Passion is way overrated.</p>
<p>Rachel: Yeah right.</p>
<p>Ross: It is… eventually… kind of… <strong>burns out</strong>. But hopefully, what you’re left with is trust, and security, and… well, in the case of my ex-wife, lesbianism. So, you know, for all of those people who <strong>miss out</strong> on that passion… thing, there’s all that other good stuff.</p>
</blockquote>
<p>Ref: <a href="http://www.tingroom.com/print_35336.html" target="_blank" rel="noopener">http://www.tingroom.com/print_35336.html</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/03/18/Web/2020-03-27-Design%20User%20System%20DB%20&amp;%20Cache/">Web/2020-03-27-Design User System DB &amp; Cache</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-03-18</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SystemDesign/">SystemDesign</a></span><div class="content"><h1 id="Design-User-System"><a href="#Design-User-System" class="headerlink" title="Design User System"></a>Design User System</h1><p>註冊、登錄、查詢 (看別的好友之類)、修改info</p>
<blockquote>
<h5 id="单选题-以下四个操作哪个最频繁？"><a href="#单选题-以下四个操作哪个最频繁？" class="headerlink" title="[单选题]以下四个操作哪个最频繁？"></a>[单选题]以下四个操作哪个最频繁？</h5><p>A.注册3.36% 选择</p>
<p>B.登录44.02% 选择</p>
<p>C.用户信息查询50.67% 选择</p>
<p>D.用户信息修改1.94% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQxNzAwNjYyNTQzIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwODgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMiAwYTUxMiA1MTIgMCAxIDAgMCAxMDI0QTUxMiA1MTIgMCAwIDAgNTEyIDB6IG0xNjUuOTUyIDYzNy43NmwxNS4wNCAxNC45NzZhMjguNDE2IDI4LjQxNiAwIDEgMS00MC4yNTYgNDAuMjU2bC0xNC45NzYtMTUuMDRMNTA5LjUwNCA1NDkuNzYgMzcxLjIgNjg4YTI4LjQxNiAyOC40MTYgMCAxIDEtNDAuMjU2LTQwLjI1NmwxMzguMzA0LTEzOC4yNC0xMjMuMi0xMjMuMi0xNS4xMDQtMTUuMTA0YTI4LjU0NCAyOC41NDQgMCAwIDEgMC00MC4yNTYgMjguNTQ0IDI4LjU0NCAwIDAgMSA0MC4yNTYgMGwxNS4wNCAxNS4xMDRMNTA5LjQ0IDQ2OS4yNDhsMTQzLjIzMi0xNDMuMjk2YTI4LjQxNiAyOC40MTYgMCAxIDEgNDAuMjU2IDQwLjI1Nkw1NDkuNzYgNTA5LjUwNGwxMjguMTkyIDEyOC4yNTZ6IiBmaWxsPSIjRjY1RTVFIiBwLWlkPSIxMDg5Ij48L3BhdGg+PC9zdmc+" alt="img">答错了，您选择的答案是B</p>
<p><strong>正确答案:</strong>C</p>
</blockquote>
<h3 id="Scenario"><a href="#Scenario" class="headerlink" title="Scenario"></a>Scenario</h3><h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><ul>
<li>Authentication Service</li>
<li>UserService</li>
<li>FriendshipService</li>
</ul>
<h3 id="Storage"><a href="#Storage" class="headerlink" title="Storage"></a>Storage</h3><p>check SQL &amp; NoSQL &amp; Redis 對 QPS數的支持</p>
<blockquote>
<h5 id="多选题-注册，登录，信息修改使用哪种数据库可以满足？"><a href="#多选题-注册，登录，信息修改使用哪种数据库可以满足？" class="headerlink" title="[多选题]注册，登录，信息修改使用哪种数据库可以满足？"></a>[多选题]注册，登录，信息修改使用哪种数据库可以满足？</h5><p>A.MySQL60.32% 选择</p>
<p>B.Cassandra18.05% 选择</p>
<p>C.Redis13.46% 选择</p>
<p>D.Memcached8.18% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQxNzAwNjYyNTQzIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwODgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMiAwYTUxMiA1MTIgMCAxIDAgMCAxMDI0QTUxMiA1MTIgMCAwIDAgNTEyIDB6IG0xNjUuOTUyIDYzNy43NmwxNS4wNCAxNC45NzZhMjguNDE2IDI4LjQxNiAwIDEgMS00MC4yNTYgNDAuMjU2bC0xNC45NzYtMTUuMDRMNTA5LjUwNCA1NDkuNzYgMzcxLjIgNjg4YTI4LjQxNiAyOC40MTYgMCAxIDEtNDAuMjU2LTQwLjI1NmwxMzguMzA0LTEzOC4yNC0xMjMuMi0xMjMuMi0xNS4xMDQtMTUuMTA0YTI4LjU0NCAyOC41NDQgMCAwIDEgMC00MC4yNTYgMjguNTQ0IDI4LjU0NCAwIDAgMSA0MC4yNTYgMGwxNS4wNCAxNS4xMDRMNTA5LjQ0IDQ2OS4yNDhsMTQzLjIzMi0xNDMuMjk2YTI4LjQxNiAyOC40MTYgMCAxIDEgNDAuMjU2IDQwLjI1Nkw1NDkuNzYgNTA5LjUwNGwxMjguMTkyIDEyOC4yNTZ6IiBmaWxsPSIjRjY1RTVFIiBwLWlkPSIxMDg5Ij48L3BhdGg+PC9zdmc+" alt="img">答错了，您选择的答案是ACD</p>
<p><strong>正确答案:</strong>ABC</p>
<p><strong>解析:</strong></p>
<p>Memcached 不能持久化存储数据，不适合用来存储用户信息</p>
</blockquote>
<blockquote>
<ul>
<li><p>Q: 10k ~ 100k QPS?</p>
<ul>
<li>看需求。可以使用单台redis或者使用多台Cassandra的集群，又或者如果你的场景需要高可靠性的事务支持，但是读多写少，那就MySQL做持久化+memcached做cache优化。不同的数据库有不同的功能，这里列出的QPS只是为了告诉你各个数据库的承载能力，不是说xxxQPS就一定要用xxx数据库，QPS不是唯一决定因素，需要结合实际需求分析。</li>
</ul>
</li>
<li><p>为什么Mysql只支持1k 的QPS,但facebook 依然会选择。 facebook的QPS应该远高于1k吧</p>
<ul>
<li>单机1k左右，但是facebook的是mysql集群，QPS肯定不是这个量级的</li>
</ul>
</li>
<li><p>redis，memcached会比普通的存储贵吗</p>
<ul>
<li>redis memcached 用 memory 多，肯定比主要用 disk 的机器要贵的。</li>
</ul>
</li>
</ul>
</blockquote>
<p>讀多寫少，代表經常不會變！</p>
<blockquote>
<h5 id="多选题-文件系统可以用作缓存么？如果可以，可以做什么的缓存？"><a href="#多选题-文件系统可以用作缓存么？如果可以，可以做什么的缓存？" class="headerlink" title="[多选题]文件系统可以用作缓存么？如果可以，可以做什么的缓存？"></a>[多选题]文件系统可以用作缓存么？如果可以，可以做什么的缓存？</h5><p>A.不可以1.22% 选择</p>
<p>B.用来做网络请求的缓存。30.30% 选择</p>
<p>C.用来做计算结果的缓存34.45% 选择</p>
<p>D.用来做数据库的缓存34.04% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQxNzAwNjYyNTQzIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwODgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMiAwYTUxMiA1MTIgMCAxIDAgMCAxMDI0QTUxMiA1MTIgMCAwIDAgNTEyIDB6IG0xNjUuOTUyIDYzNy43NmwxNS4wNCAxNC45NzZhMjguNDE2IDI4LjQxNiAwIDEgMS00MC4yNTYgNDAuMjU2bC0xNC45NzYtMTUuMDRMNTA5LjUwNCA1NDkuNzYgMzcxLjIgNjg4YTI4LjQxNiAyOC40MTYgMCAxIDEtNDAuMjU2LTQwLjI1NmwxMzguMzA0LTEzOC4yNC0xMjMuMi0xMjMuMi0xNS4xMDQtMTUuMTA0YTI4LjU0NCAyOC41NDQgMCAwIDEgMC00MC4yNTYgMjguNTQ0IDI4LjU0NCAwIDAgMSA0MC4yNTYgMGwxNS4wNCAxNS4xMDRMNTA5LjQ0IDQ2OS4yNDhsMTQzLjIzMi0xNDMuMjk2YTI4LjQxNiAyOC40MTYgMCAxIDEgNDAuMjU2IDQwLjI1Nkw1NDkuNzYgNTA5LjUwNGwxMjguMTkyIDEyOC4yNTZ6IiBmaWxsPSIjRjY1RTVFIiBwLWlkPSIxMDg5Ij48L3BhdGg+PC9zdmc+" alt="img">答错了，您选择的答案是BD</p>
<p><strong>正确答案:</strong>BC</p>
<p><strong>解析:</strong></p>
<p>缓存的目的是让访问变得更快。文件系统的访问比网络访问快，一些耗时很长的计算得到的结果也可以缓存在文件中，但是文件系统的访问速度和数据库的访问速度基本上是差不多，所以一般不会用文件系统来做数据库的缓存，意义不大。</p>
</blockquote>
<blockquote>
<h5 id="多选题-下面哪些写法是“不对”的？"><a href="#多选题-下面哪些写法是“不对”的？" class="headerlink" title="[多选题]下面哪些写法是“不对”的？"></a>[多选题]下面哪些写法是“不对”的？</h5><p>哪些写法可能造成数据的不一致？也就是数据库和缓存中存储的数据不一样。</p>
<p>A.db.set; cache.set29.67% 选择</p>
<p>B.db.set; cache.delete29.48% 选择</p>
<p>C.cache.set; db.set29.83% 选择</p>
<p>D.cache.delete; db.set11.02% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是ABCD</p>
<p><strong>正确答案:</strong>ABCD</p>
</blockquote>
<blockquote>
<h5 id="单选题-有没有可能第一个执行失败，第二个执行成功？"><a href="#单选题-有没有可能第一个执行失败，第二个执行成功？" class="headerlink" title="[单选题]有没有可能第一个执行失败，第二个执行成功？"></a>[单选题]有没有可能第一个执行失败，第二个执行成功？</h5><p>A.可能，会造成数据不一致55.52% 选择</p>
<p>B.可能，不会造成数据不一致12.52% 选择</p>
<p>C.不可能，不会造成数据不一致31.96% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQxNzAwNjYyNTQzIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwODgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMiAwYTUxMiA1MTIgMCAxIDAgMCAxMDI0QTUxMiA1MTIgMCAwIDAgNTEyIDB6IG0xNjUuOTUyIDYzNy43NmwxNS4wNCAxNC45NzZhMjguNDE2IDI4LjQxNiAwIDEgMS00MC4yNTYgNDAuMjU2bC0xNC45NzYtMTUuMDRMNTA5LjUwNCA1NDkuNzYgMzcxLjIgNjg4YTI4LjQxNiAyOC40MTYgMCAxIDEtNDAuMjU2LTQwLjI1NmwxMzguMzA0LTEzOC4yNC0xMjMuMi0xMjMuMi0xNS4xMDQtMTUuMTA0YTI4LjU0NCAyOC41NDQgMCAwIDEgMC00MC4yNTYgMjguNTQ0IDI4LjU0NCAwIDAgMSA0MC4yNTYgMGwxNS4wNCAxNS4xMDRMNTA5LjQ0IDQ2OS4yNDhsMTQzLjIzMi0xNDMuMjk2YTI4LjQxNiAyOC40MTYgMCAxIDEgNDAuMjU2IDQwLjI1Nkw1NDkuNzYgNTA5LjUwNGwxMjguMTkyIDEyOC4yNTZ6IiBmaWxsPSIjRjY1RTVFIiBwLWlkPSIxMDg5Ij48L3BhdGg+PC9zdmc+" alt="img">答错了，您选择的答案是A</p>
<p><strong>正确答案:</strong>C</p>
<p><strong>解析:</strong></p>
<p>不可能。程序的执行是顺序执行的，第一个语句执行出错以后，第二个语句就不会执行了，用户会收到整个 setUser 操作失败的信息。</p>
</blockquote>
<blockquote>
<h5 id="多选题-cache-delete-db-set-什么情况下会造成数据不一致？"><a href="#多选题-cache-delete-db-set-什么情况下会造成数据不一致？" class="headerlink" title="[多选题]cache.delete + db.set 什么情况下会造成数据不一致？"></a>[多选题]cache.delete + db.set 什么情况下会造成数据不一致？</h5><p>A.多线程38.22% 选择</p>
<p>B.多进程28.27% 选择</p>
<p>C.多机器28.65% 选择</p>
<p>D.cache.delete 成功但 db.set 失败4.87% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQxNzAwNjYyNTQzIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwODgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMiAwYTUxMiA1MTIgMCAxIDAgMCAxMDI0QTUxMiA1MTIgMCAwIDAgNTEyIDB6IG0xNjUuOTUyIDYzNy43NmwxNS4wNCAxNC45NzZhMjguNDE2IDI4LjQxNiAwIDEgMS00MC4yNTYgNDAuMjU2bC0xNC45NzYtMTUuMDRMNTA5LjUwNCA1NDkuNzYgMzcxLjIgNjg4YTI4LjQxNiAyOC40MTYgMCAxIDEtNDAuMjU2LTQwLjI1NmwxMzguMzA0LTEzOC4yNC0xMjMuMi0xMjMuMi0xNS4xMDQtMTUuMTA0YTI4LjU0NCAyOC41NDQgMCAwIDEgMC00MC4yNTYgMjguNTQ0IDI4LjU0NCAwIDAgMSA0MC4yNTYgMGwxNS4wNCAxNS4xMDRMNTA5LjQ0IDQ2OS4yNDhsMTQzLjIzMi0xNDMuMjk2YTI4LjQxNiAyOC40MTYgMCAxIDEgNDAuMjU2IDQwLjI1Nkw1NDkuNzYgNTA5LjUwNGwxMjguMTkyIDEyOC4yNTZ6IiBmaWxsPSIjRjY1RTVFIiBwLWlkPSIxMDg5Ij48L3BhdGg+PC9zdmc+" alt="img">答错了，您选择的答案是D</p>
<p><strong>正确答案:</strong>ABC</p>
<p><strong>解析:</strong></p>
<p>多机器的话自然而然也是多进程的。</p>
</blockquote>
<blockquote>
<h5 id="单选题-能否给数据库和缓存的操作加锁来保证数据一致性？"><a href="#单选题-能否给数据库和缓存的操作加锁来保证数据一致性？" class="headerlink" title="[单选题]能否给数据库和缓存的操作加锁来保证数据一致性？"></a>[单选题]能否给数据库和缓存的操作加锁来保证数据一致性？</h5><p>A.可以加锁47.11% 选择</p>
<p>B.加不了锁52.89% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是B</p>
<p><strong>正确答案:</strong>B</p>
<p><strong>解析:</strong></p>
<p>加锁以后只能保证在同一个数据上的操作顺序执行，但是无法执行“回滚”，也就是说如果第一个操作成功，第二个操作失败了，也会导致数据的不一致。<br>另外互斥锁（mutex）是多线程内共享的，多进程内无法共享。如果要加锁，只能使用分布式锁，比如 Zookeeper，但是这会导致读取效率急剧降低。得不偿失。</p>
</blockquote>
<blockquote>
<h5 id="单选题-User-Table-的-Cache-Hit-Rate-一般有多少？"><a href="#单选题-User-Table-的-Cache-Hit-Rate-一般有多少？" class="headerlink" title="[单选题]User Table 的 Cache Hit Rate 一般有多少？"></a>[单选题]User Table 的 Cache Hit Rate 一般有多少？</h5><p>A.20%5.16% 选择</p>
<p>B.50%8.32% 选择</p>
<p>C.95%24.54% 选择</p>
<p>D.98%61.98% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是D</p>
<p><strong>正确答案:</strong>D</p>
<p><strong>解析:</strong></p>
<p>hit rate = cache hit / (cache hit + cache miss)</p>
</blockquote>
<ul>
<li>我们允许数据库和缓存有“短时间”内的不一致，但最终会一致。</li>
</ul>
<blockquote>
<ul>
<li>database.set(key, user);cache.set(key)我觉得没有脏数据啊。当第一个线程1执行到15-16行之间的时候。假如有另一个线程2进入setUser这个函数。线程2的cache.set也会覆盖线程1的cache.set结果的啊，所以旧数据就被覆盖了啊。没有脏数据啊，求解释？</li>
</ul>
<p>假设执行顺序如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">thread 1 line 15: database.set(user) &#x2F;&#x2F; old data</span><br><span class="line">thread 2 line 15: database.set(user) &#x2F;&#x2F; new data</span><br><span class="line">thread 2 line 16: cache.set(user) &#x2F;&#x2F; new data</span><br><span class="line">thread 1 line 15: cache.set(user) &#x2F;&#x2F; old data</span><br></pre></td></tr></table></figure>

<p>最后 cache 里是 old data, database 里是 new data</p>
<p>线程2的cache.set也会覆盖线程1的cache.set结果的啊<br>在上面列举的情况中，是 thread 1 覆盖了 thread 2。要注意 user 是一个局部变量。thread 2 里的 user 和 thread 1 里的 user 的内容是不同的。</p>
</blockquote>
<p>如果寫真的太多太多了，在Cache Aside下，就是加DB啊。</p>
<blockquote>
<ul>
<li>redis包含cache和一个db，是说redis里面包含了relational database management system , rdbms么？ 我记得redis只是缓存，没mysql的呢。<ul>
<li>redis可以跟mysql配合使用，redis会完全接管mysql，自己从mysql里面load数据，所以在外界<strong>看起来</strong>就像是redis里面包了一个mysql一样。并不是说redis里面有一个mysql。</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="Authentication-Service"><a href="#Authentication-Service" class="headerlink" title="Authentication Service"></a>Authentication Service</h2><h3 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h3><p>可以用uuid()算這個hash值</p>
<p>通常用UUID来作为Session Key(Session Token)，UUID(Universal Unique ID): UUID是由一组32位数的16进制数字所构成，所以UUID理论上的总数为16^32=2^128，约等于3.4 x 10^38。也就是说若每纳秒产生1兆个UUID，要花100亿年才会将所有UUID用完。所以通俗的称之为宇宙爆炸都不会出现重复的ID字段。</p>
<blockquote>
<ul>
<li>cookie 存在browser 的哪里？<ul>
<li>browser 就是一个 client 就是一个客户端软件，是一个 application 是一个 software，一个程序，一段代码。一个 software 要持久化的存储一个东西，最终都是存储在操作系统的文件系统上的。</li>
</ul>
</li>
<li>session key一般有效期多久？<ul>
<li>取决于网站的安全等级，比如银行类的一般浏览器关掉 session key就过期了。社交类的一般就三个月甚至更长。这个可以由网站开发人员自行定义。</li>
</ul>
</li>
<li>any security problems regarding to session key?<ul>
<li>如果你的 session key 被盗，比如你拿了你男朋友女朋友的电脑，悄悄的记录下了 session key，你就可以以你男朋友女朋友的身份登录了。所以通常一些安全性较高的网站，如银行，session key 几分钟就会失效。</li>
</ul>
</li>
<li>session table 是存在数据库里， 还是存在In memory db 里面?<ul>
<li>都是可以的。不过一般都是存在 数据库里，否则memory数据丢了所有用户都会被logout 这个体验并不好。</li>
</ul>
</li>
<li>what if i never log in again? my session will live forever?<ul>
<li>通常网站的逻辑都是最多3个月。session table 里有 expire_at 这个 field，记录了什么时候会过期。一般用户登陆以后，这一项设置为 3 个月。当然你可以根据你网站的安全性要求来设置不同的过期时间，安全性越高的网站过期时间越短。一般不会设置为永久不过期。</li>
</ul>
</li>
</ul>
</blockquote>
<h3 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h3><ul>
<li>用户 Login 以后，为他创建一个 session 对象</li>
<li>并把 session_key 返回给浏览器，让浏览器存储起来</li>
<li>浏览器将该值记录在浏览器的 cookie 中</li>
<li>用户每次向服务器发送的访问，都会自动带上该网站所有的 cookie</li>
<li>此时服务器拿到 cookie 中的 session_key，在 Session Table 中检测是否存在，是否过期</li>
<li>Cookie:HTTP协议中浏览器和服务器的沟通机制，服务器把一些用于标记用户身份的信息，传递给 浏览器，浏览器每次访问任何网页链接的时候，都会在 HTTP 请求中带上所有的该网站相关的 Cookie 信息。Cookie 可以理解为一个 Client 端的 hash table。</li>
</ul>
<blockquote>
<h5 id="单选题-Cookie-里存的东西是越多越好么？"><a href="#单选题-Cookie-里存的东西是越多越好么？" class="headerlink" title="[单选题]Cookie 里存的东西是越多越好么？"></a>[单选题]Cookie 里存的东西是越多越好么？</h5><p>A.是的3.13% 选择</p>
<p>B.不是96.87% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是B</p>
<p><strong>正确答案:</strong>B</p>
<p><strong>解析:</strong></p>
<p>首先 Cookie 的大小 HTTP 协议是有限制的。其次因为每次 Request 都要带上 Cookie 里的内容，因此 Cookie 里存的东西是越少越好而不是越多越好。</p>
</blockquote>
<p>一般就是放個session key表明用戶身份，如掛在胸前的牌，代表授權訪問的用戶。然後去session table查是不是過期了，查uuid(就是session key), 然後知道 user_id，就是client端的hash table。</p>
<blockquote>
<h5 id="单选题-服务器需要主动删除掉过期的-Session-么？"><a href="#单选题-服务器需要主动删除掉过期的-Session-么？" class="headerlink" title="[单选题]服务器需要主动删除掉过期的 Session 么？"></a>[单选题]服务器需要主动删除掉过期的 Session 么？</h5><p>A.需要34.19% 选择</p>
<p>B.不需要65.81% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQxNzAwNjYyNTQzIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwODgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMiAwYTUxMiA1MTIgMCAxIDAgMCAxMDI0QTUxMiA1MTIgMCAwIDAgNTEyIDB6IG0xNjUuOTUyIDYzNy43NmwxNS4wNCAxNC45NzZhMjguNDE2IDI4LjQxNiAwIDEgMS00MC4yNTYgNDAuMjU2bC0xNC45NzYtMTUuMDRMNTA5LjUwNCA1NDkuNzYgMzcxLjIgNjg4YTI4LjQxNiAyOC40MTYgMCAxIDEtNDAuMjU2LTQwLjI1NmwxMzguMzA0LTEzOC4yNC0xMjMuMi0xMjMuMi0xNS4xMDQtMTUuMTA0YTI4LjU0NCAyOC41NDQgMCAwIDEgMC00MC4yNTYgMjguNTQ0IDI4LjU0NCAwIDAgMSA0MC4yNTYgMGwxNS4wNCAxNS4xMDRMNTA5LjQ0IDQ2OS4yNDhsMTQzLjIzMi0xNDMuMjk2YTI4LjQxNiAyOC40MTYgMCAxIDEgNDAuMjU2IDQwLjI1Nkw1NDkuNzYgNTA5LjUwNGwxMjguMTkyIDEyOC4yNTZ6IiBmaWxsPSIjRjY1RTVFIiBwLWlkPSIxMDg5Ij48L3BhdGg+PC9zdmc+" alt="img">答错了，您选择的答案是A</p>
<p><strong>正确答案:</strong>B</p>
<p><strong>解析:</strong></p>
<p>做 lazy loading 就好了。因为有 expire_at，无需主动删除，被动删除即可，即在用户登陆的时候发现过期了再删。</p>
</blockquote>
<blockquote>
<ul>
<li>session table 是存在数据库里， 还是存在In memory db 里面?<ul>
<li>都是可以的。不过一般都是存在 数据库里，否则memory数据丢了所有用户都会被logout 这个体验并不好。</li>
</ul>
</li>
</ul>
</blockquote>
<p>device token 也可紀錄在 session table, </p>
<blockquote>
<h5 id="单选题-Session-Table-适合存储在什么数据库里？"><a href="#单选题-Session-Table-适合存储在什么数据库里？" class="headerlink" title="[单选题]Session Table 适合存储在什么数据库里？"></a>[单选题]Session Table 适合存储在什么数据库里？</h5><p>A.Memcached21.64% 选择</p>
<p>B.MySQL22.46% 选择</p>
<p>C.Memcached + MySQL55.90% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQxNzAwNjYyNTQzIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwODgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMiAwYTUxMiA1MTIgMCAxIDAgMCAxMDI0QTUxMiA1MTIgMCAwIDAgNTEyIDB6IG0xNjUuOTUyIDYzNy43NmwxNS4wNCAxNC45NzZhMjguNDE2IDI4LjQxNiAwIDEgMS00MC4yNTYgNDAuMjU2bC0xNC45NzYtMTUuMDRMNTA5LjUwNCA1NDkuNzYgMzcxLjIgNjg4YTI4LjQxNiAyOC40MTYgMCAxIDEtNDAuMjU2LTQwLjI1NmwxMzguMzA0LTEzOC4yNC0xMjMuMi0xMjMuMi0xNS4xMDQtMTUuMTA0YTI4LjU0NCAyOC41NDQgMCAwIDEgMC00MC4yNTYgMjguNTQ0IDI4LjU0NCAwIDAgMSA0MC4yNTYgMGwxNS4wNCAxNS4xMDRMNTA5LjQ0IDQ2OS4yNDhsMTQzLjIzMi0xNDMuMjk2YTI4LjQxNiAyOC40MTYgMCAxIDEgNDAuMjU2IDQwLjI1Nkw1NDkuNzYgNTA5LjUwNGwxMjguMTkyIDEyOC4yNTZ6IiBmaWxsPSIjRjY1RTVFIiBwLWlkPSIxMDg5Ij48L3BhdGg+PC9zdmc+" alt="img">答错了，您选择的答案是B</p>
<p><strong>正确答案:</strong>C</p>
</blockquote>
<p>如果自己建個網站，用戶不多，放在Memcache裡也Ok, 就算斷了，用戶就是再重登一次，不會怎樣，畢竟不是用戶信息的不能丟的。</p>
<p>大網站就最好撐久點，讓體驗好，訪問效率高</p>
<blockquote>
<ul>
<li>那个device id那一块，如何实现？有点模糊。<ul>
<li>就是在每个device第一次登录的时候给他分配一个id，然后把这个id放到该设备的cookie中，每次访问网站的时候都要带上这个id，这样根据id就能知道当前活动的是哪台设备了。</li>
</ul>
</li>
<li>db如何设计呢？如何判断这个session 是这个user，然后把之前的ipad的session logout，再让这个iphone的session建立？<ul>
<li>如果用NoSQL，那么表中的每一行可以是{user_id, session, expire_at，其中user_id是foreign key并且建立了index方便快速查找，session在生成的时候可以encode进去user_id的信息，方便直接从session中识别出当前用户。如果是key-value NoSQL，那就直接把上述结构改为user_id ==&gt; {session, expire_at}就行了。<br>当用户登录的时候直接生成一个新的session替换掉原来的。<br>当旧设备的session再次尝试请求数据的时候，先从session中decode出user_id，然后去查表，然后会发现表中的session跟当前的session不是同一个，那就强制logout。</li>
</ul>
</li>
<li>每个device 都会有一个 session key 吗？<ul>
<li>session key 和 device 不是绑定的关系。 session key 是记录某次登录后所形成的客户端与服务器端的保持通话的记录的 key。同一台机器上的不同的浏览器登录以后的 session key一般就是不同的。像 Google Chrome 这种支持多用户的浏览器，切换用户以后，就相当于切换浏览器一样，session 记录也是不同的。</li>
</ul>
</li>
<li>如果一个ipad来登陆来了，如何把iphone的session key给expire还是删除呢？如何判断，这2个device是一个user？如果问，如何回答。<ul>
<li>用同一个账号登录肯定就是同一个user。如果登录之后发现在session table中该账号有一个active的session，就可以把这个session 给expire了然后写一个新的进去。</li>
</ul>
</li>
<li>登陆之后，发现该账号已经有一个active user，就可以把这个session给expire了。这个“expire”操作具体是怎样进行的？<ul>
<li>这种情况可以直接删除该行记录。</li>
</ul>
</li>
<li>想问一下RESTful API里面比如POST一个新blog的请求会用session_key来验证user吗？<ul>
<li>也会的，只要是需要authorization的操作都需要验证当前用户的session.</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="Friendship-Storage-amp-Query"><a href="#Friendship-Storage-amp-Query" class="headerlink" title="Friendship Storage &amp; Query"></a>Friendship Storage &amp; Query</h2><p>單向：Twitter, Ins, Weibo</p>
<p>雙向：WeChat, FB, WhatsApp</p>
<blockquote>
<h5 id="单选题-为什么要区分-smaller-user-id-和-bigger-user-id？"><a href="#单选题-为什么要区分-smaller-user-id-和-bigger-user-id？" class="headerlink" title="[单选题]为什么要区分 smaller_user_id 和 bigger_user_id？"></a>[单选题]为什么要区分 smaller_user_id 和 bigger_user_id？</h5><p>A.否则查询 A 和 B 是否为好友的时候会变慢55.84% 选择</p>
<p>B.否则查询 A 的所有好友的时候会变慢32.22% 选择</p>
<p>C.猜不到11.94% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是A</p>
<p><strong>正确答案:</strong>A</p>
<p><strong>解析:</strong></p>
<p>查询 A 的所有好友不会变慢，因为依然是 select * from friendship where user_id1=A or user_id2=A。</p>
</blockquote>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/03/18/System-Design/9p/2020-03-18-System%20Design%20&amp;%20Design%20Twitter/">System-Design/9p/2020-03-18-System Design &amp; Design Twitter</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-03-18</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SystemDesign/">SystemDesign</a></span><div class="content"><ul>
<li><h3 id="Web-Server"><a href="#Web-Server" class="headerlink" title="Web Server"></a>Web Server</h3></li>
<li><h3 id="DB"><a href="#DB" class="headerlink" title="DB"></a>DB</h3></li>
<li><h3 id="File-System"><a href="#File-System" class="headerlink" title="File System"></a>File System</h3></li>
<li><h3 id="Cache"><a href="#Cache" class="headerlink" title="Cache"></a>Cache</h3></li>
</ul>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><h1 id="Design-Twitter"><a href="#Design-Twitter" class="headerlink" title="Design Twitter"></a>Design Twitter</h1><h2 id="General"><a href="#General" class="headerlink" title="General"></a>General</h2><ol>
<li>注意事項：<ul>
<li>這個問題要考慮的用戶規模有多大？</li>
<li>有哪些功能需要我設計的？</li>
</ul>
</li>
<li>Key words: <ul>
<li>Load Balancer, Memcache, NodeJS, MongoDB, MySQL, Sharding, Consistent Sharding, Master Slave, HDFS, Hadoop…<ul>
<li>How if only 2 users?…  No need all above… So, <strong>ASK</strong> for clarification first!</li>
</ul>
</li>
</ul>
</li>
<li>側重：<ul>
<li>Work solution</li>
<li>Special Case</li>
<li>Analysis</li>
<li>Tradeoff, PlanA vs PlanB</li>
<li>Knowledge Base, e.g. DB, FS, Memory, Info Queue</li>
</ul>
</li>
</ol>
<ol start="4">
<li>4S analyzation<ul>
<li>Scenario<br>需要設計哪些功能？功能要到多厲害？<br>Ask: Features, QPS, DAU, Interfaces</li>
<li>Service<br>將大系統拆分為小服務<br>Split Application, Module</li>
<li>Storage<br>數據如何存儲與訪問<br>Schema: Data, SQL, NoSQL, File System</li>
<li>Scale<br>怎麼解決缺陷，處理可能遇到的問題<br>Sharding, Optimize, Special Case</li>
</ul>
</li>
</ol>
<h2 id="Scenario-場景"><a href="#Scenario-場景" class="headerlink" title="Scenario 場景"></a>Scenario 場景</h2><ol>
<li>Ask; 2. Analysis</li>
</ol>
<ul>
<li>需要設計哪些功能？</li>
<li>需要承受多大的訪問量？<ul>
<li>DAU</li>
<li>Twitter: MAU 330M, DAU ~170+M</li>
</ul>
</li>
</ul>
<p>有些公司會用註冊用戶，但這不準。一般要看MAU。</p>
<blockquote>
<h5 id="单选题-下面说法中，”不”正确的是"><a href="#单选题-下面说法中，”不”正确的是" class="headerlink" title="[单选题]下面说法中，”不”正确的是"></a>[单选题]下面说法中，”不”正确的是</h5><p>A.MAU 会影响到 DAU，DAU 会影响到并发请求的用户数，从而影响到系统的承载力5.37% 选择</p>
<p>B.一个用户一个月登陆了3次，会累加 3次 MAU77.78% 选择</p>
<p>C.一个用户一天登陆了10次也只算一次 DAU9.55% 选择</p>
<p>D.MAU 和 DAU 的比例通常是 2:1 左右7.30% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是B</p>
<p><strong>正确答案:</strong>B</p>
<p><strong>解析:</strong></p>
<p>B是错的，一个用户一个月登陆 100 次也只算作 1 次 MAU</p>
</blockquote>
<h3 id="需要設計哪些功能"><a href="#需要設計哪些功能" class="headerlink" title="需要設計哪些功能"></a>需要設計哪些功能</h3><p>Step1. Enumerate - 把 Twitter 的功能一個個羅列出來</p>
<ul>
<li>Register/ Login</li>
<li>User Profile Display / Edit</li>
<li>Upload Image / Video * </li>
<li>Search *</li>
<li>Post /Share a tweet</li>
<li>Timeline News Feed</li>
<li>Follow Unfollow a User</li>
</ul>
<p>Step2. Sort - 選出核心功能</p>
<ul>
<li>Post a Tweet</li>
<li>Timeline</li>
<li>News Feed</li>
<li>Follow / Unfollow a user</li>
<li>Register / Login</li>
</ul>
<blockquote>
<ul>
<li><p>Read QPS: 是对数据库的操作频率</p>
</li>
<li><p>TPS = Transactions Per second<br>QPS = Queries Per second<br>一个 Transaction 里可能会有多个 Db Query。<br>一般来说我做这么细的区分，统一都用 QPS 就可以了。</p>
</li>
<li><p>mongodb, dynamodb 的QPS大概多少:</p>
<ul>
<li>根据机器配置不同，是不一样的。大概在 1w~10w 这个级别。</li>
</ul>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd6gby3ys1j30x40ewac9.jpg" alt="image-20200325203515823" style="zoom:50%;" />
</li>
<li><p>SQL vs NoSQL 大概有几个原则：</p>
<ol>
<li>大部分的情况，用SQL也好，用NoSQL也好，都是可以的</li>
<li>需要支持 Transaction 的话不能选 NoSQL</li>
<li>你想不想偷懒很大程度决定了选什么数据库，SQL更成熟帮你做了很多事儿，NoSQL很多事儿都要亲力亲为(Serialization, Secondary Index)</li>
<li>如果想省点服务器获得更高的性能，NoSQL就更好硬盘型的NoSQL比SQL一般都要快10倍以上</li>
</ol>
<p>这个NoSQ跟SQL的选择没有一套万能的方法去告诉你应该怎么选，需要了解各种数据库的优缺点，根据场景需求灵活选择。</p>
</li>
<li><p>NoSQL 的数据结构比较简单，支持的查询操作也比较简单。结构简单的话，处理效率就高。SQL 为了支持一些很复杂的查询，所以处理效率较低。</p>
</li>
<li><p>Database 里index query是啥呀</p>
<ul>
<li>就是说查询的时候，database 通过 index 进行查询，会比一个一个数据查过去的方式更快</li>
<li>select * from xxx table where yyy=1, 如果 yyy 有 index，就是一个 index query，否则就是一个 sequential query</li>
</ul>
</li>
<li><p>join应该是变慢，index query是加快，为什么都会让qps变小呢？</p>
<ul>
<li>index query 这里指的是相对于按照 primary key(id) 去 query。因为 index query 要先query index 的内部表，再去具体的表单里取数据，相比直接通过 id 去取数据要慢的。</li>
</ul>
</li>
<li><p>为啥NOSQL承受量这么多， 跟SQL比起来</p>
<ul>
<li>因为 NoSQL 的数据结构比较简单，支持的查询操作也比较简单。结构简单的话，处理效率就高。SQL 为了支持一些很复杂的查询，所以处理效率较低。</li>
</ul>
</li>
<li><p>join应该是变慢，index query是加快，为什么都会让qps变小呢？</p>
<p>index query多所以查询速度快，所以每秒可处理的query更多，所以qps的值不是应该更大么？课件上说join和index query多的话，qps会小。。 ?</p>
<ul>
<li>index query 这里指的是相对于按照 primary key(id) 去 query。因为 index query 要先query index 的内部表，再去具体的表单里取数据，相比直接通过 id 去取数据要慢的。</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h2><p>將大系統拆分為小服務, 如 SOA, Service Oriented Architecture</p>
<p>合併需要設計的功能，相似的功能整合為一個Service - 邏輯處理的整合</p>
<ol>
<li>Replay 重放需求</li>
<li>Merge 歸併需求</li>
</ol>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd6gnly99kj30oc0bead6.jpg" alt="image-20200325204630511" style="zoom:50%;" />







<h2 id="Storage"><a href="#Storage" class="headerlink" title="Storage"></a>Storage</h2><ul>
<li>现在 id 一般要用 Bigint （64位）才不会担心溢出。</li>
<li>細化數據表單</li>
<li>畫圖展示數據存、讀過程</li>
<li>為每個Service選合適的儲存</li>
</ul>
<blockquote>
<h5 id="单选题-关于文件系统和数据库系统之间的关系，下列说法“不正确”的是？"><a href="#单选题-关于文件系统和数据库系统之间的关系，下列说法“不正确”的是？" class="headerlink" title="[单选题]关于文件系统和数据库系统之间的关系，下列说法“不正确”的是？"></a>[单选题]关于文件系统和数据库系统之间的关系，下列说法“不正确”的是？</h5><p>A.数据库系统是建立在文件系统之上的，也就是说数据库系统中存储的数据最终都是要存在文件系统上的18.45% 选择</p>
<p>B.文件系统中可以支持丰富的数据查询接口，如在记录用户信息的文件中快速挑选出所有身高在 175 到 185 之间的男性68.39% 选择</p>
<p>C.我们一般将结构化的数据（Structured Data）放在数据库系统中，把非结构化的数据放在文件系统中9.42% 选择</p>
<p>D.文件系统和数据库系统都是可持久化的存储系统3.74% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQxNzAwNjYyNTQzIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwODgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMiAwYTUxMiA1MTIgMCAxIDAgMCAxMDI0QTUxMiA1MTIgMCAwIDAgNTEyIDB6IG0xNjUuOTUyIDYzNy43NmwxNS4wNCAxNC45NzZhMjguNDE2IDI4LjQxNiAwIDEgMS00MC4yNTYgNDAuMjU2bC0xNC45NzYtMTUuMDRMNTA5LjUwNCA1NDkuNzYgMzcxLjIgNjg4YTI4LjQxNiAyOC40MTYgMCAxIDEtNDAuMjU2LTQwLjI1NmwxMzguMzA0LTEzOC4yNC0xMjMuMi0xMjMuMi0xNS4xMDQtMTUuMTA0YTI4LjU0NCAyOC41NDQgMCAwIDEgMC00MC4yNTYgMjguNTQ0IDI4LjU0NCAwIDAgMSA0MC4yNTYgMGwxNS4wNCAxNS4xMDRMNTA5LjQ0IDQ2OS4yNDhsMTQzLjIzMi0xNDMuMjk2YTI4LjQxNiAyOC40MTYgMCAxIDEgNDAuMjU2IDQwLjI1Nkw1NDkuNzYgNTA5LjUwNGwxMjguMTkyIDEyOC4yNTZ6IiBmaWxsPSIjRjY1RTVFIiBwLWlkPSIxMDg5Ij48L3BhdGg+PC9zdmc+" alt="img">答错了，您选择的答案是C</p>
<p><strong>正确答案:</strong>B</p>
<p><strong>解析:</strong></p>
<p>数据库系统是文件系统的一层“包装”，将数据结构化的存储起来，从而可以支持更丰富的数据查询方法。如筛选某个属性在某个范围内的所有数据。而文件系统一般就是支持最简单的查询方法：取出某个文件从第x个字节开始的长度为y的所有数据。</p>
</blockquote>
<p>NoSQL 有index吗？</p>
<p>有的，MongoDB就支持索引<a href="http://www.runoob.com/mongodb/mongodb-indexing.html。" target="_blank" rel="noopener">http://www.runoob.com/mongodb/mongodb-indexing.html。</a><br>索引就是帮助快速定位数据的一组附加信息，可以用在NoSQL上。</p>
<blockquote>
<h5 id="单选题-为什么-User-Table-里不用-username-email-作为-Primary-key"><a href="#单选题-为什么-User-Table-里不用-username-email-作为-Primary-key" class="headerlink" title="[单选题]为什么 User Table 里不用 username / email 作为 Primary key"></a>[单选题]为什么 User Table 里不用 username / email 作为 Primary key</h5><p>A.因为两个用户可能使用同一个 Username23.95% 选择</p>
<p>B.因为数据库只支持整数作为 primary key6.02% 选择</p>
<p>C.因为 email 要区分大小写，查询相对较慢4.06% 选择</p>
<p>D.因为很多网站支持用户修改 email 和 username65.97% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQxNzAwNjYyNTQzIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwODgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMiAwYTUxMiA1MTIgMCAxIDAgMCAxMDI0QTUxMiA1MTIgMCAwIDAgNTEyIDB6IG0xNjUuOTUyIDYzNy43NmwxNS4wNCAxNC45NzZhMjguNDE2IDI4LjQxNiAwIDEgMS00MC4yNTYgNDAuMjU2bC0xNC45NzYtMTUuMDRMNTA5LjUwNCA1NDkuNzYgMzcxLjIgNjg4YTI4LjQxNiAyOC40MTYgMCAxIDEtNDAuMjU2LTQwLjI1NmwxMzguMzA0LTEzOC4yNC0xMjMuMi0xMjMuMi0xNS4xMDQtMTUuMTA0YTI4LjU0NCAyOC41NDQgMCAwIDEgMC00MC4yNTYgMjguNTQ0IDI4LjU0NCAwIDAgMSA0MC4yNTYgMGwxNS4wNCAxNS4xMDRMNTA5LjQ0IDQ2OS4yNDhsMTQzLjIzMi0xNDMuMjk2YTI4LjQxNiAyOC40MTYgMCAxIDEgNDAuMjU2IDQwLjI1Nkw1NDkuNzYgNTA5LjUwNGwxMjguMTkyIDEyOC4yNTZ6IiBmaWxsPSIjRjY1RTVFIiBwLWlkPSIxMDg5Ij48L3BhdGg+PC9zdmc+" alt="img">答错了，您选择的答案是A</p>
<p><strong>正确答案:</strong>D</p>
<p><strong>相关知识点:</strong>主键和外键 Primary Key &amp; Foreign Key</p>
<p><strong>解析:</strong></p>
<p>如果用 username / email 作为 primary key，会因被其他 table 引用而存储在其他的 table 中，如果被修改，会引起一连串的修改，效率很低。另外一个重要的原因是，通常 primary key 会作为 url 中的一个部分被分享出去，如果 primary key 被修改，则可能导致原本被分享出去的 url 失效。</p>
</blockquote>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd5ektr01cj30v60do430.jpg" alt="image-20200324224901600" style="zoom:50%;" />

<ul>
<li>varchar 是数据库里的 string。</li>
<li>用来作foreign key 的不希望它經常變化</li>
<li>Tweet可以放在SQL也可以放在NoSQL。这里的Schema只是为了确定每条Tweet需要有哪些字段，这些字段可以存在SQL数据库中也可以存在NoSQL中。如果用SQL存的话，那么就是一行是一个tweet，如果是key-value型的NoSQL，那可能就是id =&gt; {user_id, content, created_at}这样的结构。</li>
<li>media service 就不需要有任何結構啦</li>
</ul>
<h3 id="PULL"><a href="#PULL" class="headerlink" title="PULL"></a>PULL</h3><h4 id="News-Feed-如何存取？-gt-Tradeoff"><a href="#News-Feed-如何存取？-gt-Tradeoff" class="headerlink" title="News Feed 如何存取？==&gt; Tradeoff!"></a>News Feed 如何存取？==&gt; Tradeoff!</h4><ul>
<li>登入後看到的info的整合</li>
<li>典型例子<ul>
<li>FB, Twitter, 朋友圈，RSS Reader(關啦)</li>
</ul>
</li>
<li>新鮮事系統的核心因素？<ul>
<li>關注＆被關注</li>
<li>每個人看到的新鮮都是不同的</li>
</ul>
</li>
</ul>
<p>主動要，拉自己關注的10個好友的前100 tweets，再合成一個給自己看的前100條 ==&gt; </p>
<ul>
<li>Merge K Sorted Lists</li>
<li>複雜度：<ul>
<li>如果關注了N個人，那麼就N次DB REA時間 + N路merge時間(這個可忽略)</li>
<li>disk 慢 memory 1000倍。</li>
<li>Post a tweet =&gt; 1 次 DB Write 的時間</li>
</ul>
</li>
</ul>
<blockquote>
<h5 id="单选题-关于为什么多路归并的时间可以被忽略，下列说法不正确的是"><a href="#单选题-关于为什么多路归并的时间可以被忽略，下列说法不正确的是" class="headerlink" title="[单选题]关于为什么多路归并的时间可以被忽略，下列说法不正确的是"></a>[单选题]关于为什么多路归并的时间可以被忽略，下列说法不正确的是</h5><p>A.因为 DB Reads 的时间是瓶颈15.43% 选择</p>
<p>B.因为多路归并的操作都是在内存和CPU中进行的，相对于在DB中读取数据是很快的43.05% 选择</p>
<p>C.因为多路归并的时间复杂度相对磁盘读取更低41.53% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是C</p>
<p><strong>正确答案:</strong>C</p>
<p><strong>解析:</strong></p>
<p>假设一共 N 个关注的好友，每个好友100条信息。多路归并的时间复杂度是 O(100NlogN)，这里使用了一个大小为 N 的堆。初始化这个堆需要 O(N) 的时间，归并出 100N 条信息，每一条需要 O(logN) 的时间。值得注意的是，读 DB 的时间是获取了 O(100N) 条数据，这个从时间复杂度上来说要更低，但是因为 DB 的操作事实上是在对文件进行操作，而文件的访问比内存访问慢几百上千倍。</p>
</blockquote>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd5f4d7ckaj31ii0pawgp.jpg" alt="image-20200324230746737" style="zoom:67%;" />

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd6g3t4bkvj30v20c8teh.jpg" alt="image-20200325202727234" style="zoom:50%;" />

<ul>
<li><p>缺點：</p>
<ul>
<li>現算，就是慢，算好才能展示，卡住，用戶可感知的慢</li>
</ul>
</li>
</ul>
<h3 id="Push"><a href="#Push" class="headerlink" title="Push"></a>Push</h3><p>別人在發帖時，就把他的推到了我的News Feed List裡 – <strong><em>Fanout</em></strong></p>
<p>需要一個News Feed Table。</p>
<ul>
<li>用戶需要查看News Feed時，只要從該News Feed Lists中讀取最新的100條就可</li>
</ul>
<table>
<thead>
<tr>
<th>New Feed Table</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>id</td>
<td>integer</td>
</tr>
<tr>
<td>owner_id</td>
<td>Foreign Key</td>
</tr>
<tr>
<td>tweet_id</td>
<td>Foreign Key</td>
</tr>
<tr>
<td>created_at</td>
<td>timestamp</td>
</tr>
</tbody></table>
<blockquote>
<p>Denormalized 叫去标准化。通俗的解释是，通过在不同的 Table 中存储同一份数据的（也就是说至少一份是冗余数据）的形式，来加速数据的查询。因为当数据只存储在一个固定的 Table A 的时候，其他 Table B访问时如果需要同时取得关联的 Table A 的数据，则需要进行 join 操作之类的，会比较慢。一个例子就是在，统计有多少人点赞了一个帖子，可以通过 <code>select count(*) from like_table where post_id=</code> 的方式来获取，但是也可以在 post table 中新增一个 like_count，每次点赞就 +1。这里 like_count 就是一个 denormalized field，因为是可以通过 <code>select count(*)</code> 在 like table 中获得的。</p>
</blockquote>
<ul>
<li>複雜度分析<ul>
<li>News Feed =&gt; 1次 DB Read</li>
<li>Post a tweet =&gt; N 個粉絲，需要N次的DB Write, <ul>
<li>可以用異步在後台執行，不需要用戶等待</li>
</ul>
</li>
</ul>
</li>
</ul>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd6f979oduj30ya0foaos.jpg" alt="image-20200325195759690" style="zoom:50%;" />

<ul>
<li>如果想讓這次的query很快的話，數據庫的index 該怎麼建？</li>
</ul>
<blockquote>
<h5 id="单选题-NewsFeedTable的索引（index）该怎么建？"><a href="#单选题-NewsFeedTable的索引（index）该怎么建？" class="headerlink" title="[单选题]NewsFeedTable的索引（index）该怎么建？"></a>[单选题]NewsFeedTable的索引（index）该怎么建？</h5><p>A.为 owner_id 建索引即可17.32% 选择</p>
<p>B.为 created_at 建倒序索引即可4.96% 选择</p>
<p>C.为 owner_id + created_at 建立联合索引（Composite Index）62.15% 选择</p>
<p>D.为 owner_id 和 created_at 分别建索引15.57% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQxNzAwNjYyNTQzIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwODgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMiAwYTUxMiA1MTIgMCAxIDAgMCAxMDI0QTUxMiA1MTIgMCAwIDAgNTEyIDB6IG0xNjUuOTUyIDYzNy43NmwxNS4wNCAxNC45NzZhMjguNDE2IDI4LjQxNiAwIDEgMS00MC4yNTYgNDAuMjU2bC0xNC45NzYtMTUuMDRMNTA5LjUwNCA1NDkuNzYgMzcxLjIgNjg4YTI4LjQxNiAyOC40MTYgMCAxIDEtNDAuMjU2LTQwLjI1NmwxMzguMzA0LTEzOC4yNC0xMjMuMi0xMjMuMi0xNS4xMDQtMTUuMTA0YTI4LjU0NCAyOC41NDQgMCAwIDEgMC00MC4yNTYgMjguNTQ0IDI4LjU0NCAwIDAgMSA0MC4yNTYgMGwxNS4wNCAxNS4xMDRMNTA5LjQ0IDQ2OS4yNDhsMTQzLjIzMi0xNDMuMjk2YTI4LjQxNiAyOC40MTYgMCAxIDEgNDAuMjU2IDQwLjI1Nkw1NDkuNzYgNTA5LjUwNGwxMjguMTkyIDEyOC4yNTZ6IiBmaWxsPSIjRjY1RTVFIiBwLWlkPSIxMDg5Ij48L3BhdGg+PC9zdmc+" alt="img">答错了，您选择的答案是D</p>
<p><strong>正确答案:</strong>C</p>
<p><strong>相关知识点:</strong>数据库索引 Index</p>
<p><strong>解析:</strong></p>
<p>解析见视频</p>
</blockquote>
<ul>
<li><p>單獨給兩個feature作排序沒用，應該是要建一個複合索引 (composite index)，</p>
</li>
<li><p>新增好友，会创建一个异步任务，去把这个好友发的帖子查询到，然后插入到当前用户的 news feed 里。删除好友的时候也是类似的。看起来似乎很土，但是确实实际工程里就是这么做的。系统设计很多东西都不是大家想象的那种需要什么牛逼的技巧的，只要能用不费力就可以了。这个方法看着土，但是用异步任务可以很好的解决，也不是特别慢。十分行之有效。</p>
</li>
</ul>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd6fm9su6zj30xu0fa0ub.jpg" alt="image-20200325201034815" style="zoom:50%;" />

<ul>
<li><p>缺陷</p>
<blockquote>
<h5 id="多选题-Push-模型有什么主要的缺陷？"><a href="#多选题-Push-模型有什么主要的缺陷？" class="headerlink" title="[多选题]Push 模型有什么主要的缺陷？"></a>[多选题]Push 模型有什么主要的缺陷？</h5><p>A.数据库中创建太多记录，浪费磁盘20.49% 选择</p>
<p>B.粉丝数目可能很大，导致 Fanout 过程很长，从而导致用户刷到新鲜事有延迟26.92% 选择</p>
<p>C.浪费系统资源去为很多僵尸粉创建新鲜事记录25.38% 选择</p>
<p>D.明星发帖会在短时间内为系统带来很大的处理压力27.21% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTQxNzAwNjYyNTQzIiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwODgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNjQiIGhlaWdodD0iNjQiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMiAwYTUxMiA1MTIgMCAxIDAgMCAxMDI0QTUxMiA1MTIgMCAwIDAgNTEyIDB6IG0xNjUuOTUyIDYzNy43NmwxNS4wNCAxNC45NzZhMjguNDE2IDI4LjQxNiAwIDEgMS00MC4yNTYgNDAuMjU2bC0xNC45NzYtMTUuMDRMNTA5LjUwNCA1NDkuNzYgMzcxLjIgNjg4YTI4LjQxNiAyOC40MTYgMCAxIDEtNDAuMjU2LTQwLjI1NmwxMzguMzA0LTEzOC4yNC0xMjMuMi0xMjMuMi0xNS4xMDQtMTUuMTA0YTI4LjU0NCAyOC41NDQgMCAwIDEgMC00MC4yNTYgMjguNTQ0IDI4LjU0NCAwIDAgMSA0MC4yNTYgMGwxNS4wNCAxNS4xMDRMNTA5LjQ0IDQ2OS4yNDhsMTQzLjIzMi0xNDMuMjk2YTI4LjQxNiAyOC40MTYgMCAxIDEgNDAuMjU2IDQwLjI1Nkw1NDkuNzYgNTA5LjUwNGwxMjguMTkyIDEyOC4yNTZ6IiBmaWxsPSIjRjY1RTVFIiBwLWlkPSIxMDg5Ij48L3BhdGg+PC9zdmc+" alt="img">答错了，您选择的答案是ABCD</p>
<p><strong>正确答案:</strong>BCD</p>
<p><strong>解析:</strong></p>
<p>记住一句话 “Disk is cheap”，不要怕浪费数据库存储，为了加速查询，多存一些东西是没关系的。</p>
</blockquote>
<p>Pull - 自己關注的人不會很多一般來講，但明星的粉絲很多！一億之類，要為所有粉絲都建紀錄，超大。</p>
</li>
</ul>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd6fsjx9npj30qw0eogn0.jpg" alt="image-20200325201633121" style="zoom:50%;" />

<ul>
<li><p>FB - Pull; Ins - Push + Pull; Twitter - Pull; Friends Circle - 最多就是有廣告，沒排序或找你沒看過的，Pull</p>
<p>總是要作Tradeoff的。勇擇一個</p>
<blockquote>
<h5 id="单选题-广告的插入是-Push-还是-Pull-模型？"><a href="#单选题-广告的插入是-Push-还是-Pull-模型？" class="headerlink" title="[单选题]广告的插入是 Push 还是 Pull 模型？"></a>[单选题]广告的插入是 Push 还是 Pull 模型？</h5><p>A.Push54.32% 选择</p>
<p>B.Pull43.45% 选择</p>
<p>C.猜不出来2.23% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是B</p>
<p><strong>正确答案:</strong>B</p>
<p><strong>解析:</strong></p>
<p>广告的投放人群很多，Push 模式很费时间，无法实时生效。且广告主可以筛选和改变投放人群，因此 Push 模型并不能很好的支持这种动态的改动。</p>
</blockquote>
</li>
</ul>
<ul>
<li>可以在 push 的时候筛选没错，但是消息一旦push 出去以后，你再想要改动就很难了。广告主的需求很可能是 push 出去之后发现钱烧得太快要缩小投放访问，这个时候 push 模式就不太方便了。</li>
</ul>
<h3 id="數據庫的索引"><a href="#數據庫的索引" class="headerlink" title="數據庫的索引"></a>數據庫的索引</h3><p>查字典時，先找頭、找到全身、去翻頁碼，要有序啦</p>
<p>相當於一張專門存index的表</p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd6j1mdm73j30xy0ewgu3.jpg" alt="image-20200325212010964" style="zoom:67%;" />

<ul>
<li>這個暫存表告訴我們直接去原表的4、9 row找</li>
<li>可加速 where時、還有range時的查詢</li>
<li>原理就 B+ Tree, 關聯型主要都是它，通過多分叉減小樹的高度，以減小磁盤 seek 次數<ul>
<li>1000 =&gt;lg1000為10了，還是多會有磁頭移動的物理過程，不像內存裡動很快。所以仍希望二分-&gt;三分-&gt;四分，就是二叉的樹高還是太高，所以才有B+樹叉開</li>
</ul>
</li>
</ul>
<p>怎麼建index. &amp; 常用的幾類 index</p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd6ia4xbojj30sa0c0wfy.jpg" alt="image-20200325214230561" style="zoom:67%;" />

<ul>
<li>唯一索引：如在email, phone_number, user_name</li>
<li>聯合索引：涉及多個col需求，就是建聯合索引</li>
<li><strong><em>條件索引</em></strong>：如要去filter已經付費的用戶中，的聯合索引；我們不去care沒付錢的</li>
</ul>
<h2 id="Scale"><a href="#Scale" class="headerlink" title="Scale"></a>Scale</h2><p>擴展 - 如何優化？</p>
<blockquote>
<ul>
<li>Newsfeed 是朋友圈（你和你朋友发的帖子的汇总），timeline是你发的帖子的汇总。有的网站也把这两个概念反过来。我们课上用的是我刚才说的方式。</li>
<li>那这个cache什么时候更新呢？是在N个用户任意一个发了新推特时候既更新DB又更新cache吗 （异步任务）？<ul>
<li>用户发新的 post 的时候，只更新这个用户发过了哪些帖子的 cache，不会去更新关注他的人的 cache。关注他的人要获得这个新的帖子，需要 pull 一下然后拿到新的 post 然后再更新自己的 news feed cache。</li>
</ul>
</li>
<li>pull优化中每个人的cache如何更新呢？如果每发一个新的tweet都更新一次cache，本质上和push就一样了吧<ul>
<li>pull的时候才更新cache，但是只更新上一次pull之后发的tweet。比如说你一分钟前pull过，pull的结果放在了cache里面，然后你现在再pull，就只会去db或者每个人的timeline cache里面取最近一分钟的tweets，从而优化了pull的速度。</li>
</ul>
</li>
<li>刚才有个人问了这个问题：”请问pull优化中每个人的cache如何更新呢？如果每发一个新的tweet都更新一次cache，本质上和push就一样了吧“。 我想说就算是从某个时间戳之后去DB拉去 Follower的数据，从IO次数上讲没有本质的变化啊。<ul>
<li>是有区别的。如果我需要拿这个人所有的 posts 和我拿这个人最近5分钟的 posts，前者数据多，取出来慢，后者很多时候都是没有数据，速度很快。时间效率不仅仅跟 query 次数有关，跟数据的传输量也有关系。你想一下如果一个 hash map 里，key1 里存了 1个数，key2 里存了 1m 个数，你是取1个数快呢，还是取 1m 个数快呢？找到 1个数和 1m 个数的内存首地址是一样的。但是这里因为是访问 cache，cache和访问者未必在同一台机器，所以虽然 key1和 Key2都很快找到数据了，但是 key2 传输 1m 个数据到 cache 的使用者，这个过程是要比传输1个数据要慢的。</li>
</ul>
</li>
</ul>
</blockquote>
<ol>
<li><p>優化</p>
<ul>
<li><p>解決設計缺陷如 Pull vs Push</p>
<ul>
<li><p>PULL - 登入時才去組織內容，他要是關注了1000個用戶，就要有這麼多次的SQL query，效率就是還低。</p>
<ul>
<li>所以可以在DB訪問前加入 Cache</li>
<li>Cache每個用戶的 Timeline<ul>
<li>N次DB請求 =》 N次Cache請求</li>
<li>Tradeoff: Cache幾條？最近的1000條？其實也就100、200就差不多啦</li>
</ul>
</li>
<li>Cache 每個用戶的 News Feed – 可能30秒我就刷一下，刷跟刷之間我所關注的人沒有更新，每次都做merge太浪費計算時間啦。<ul>
<li>沒有 Cache News Feeds 的用戶: Merge N用戶的最近100條 Tweets，然後取出前100條，除非這個是第一次。</li>
<li>有Cache News Feeds的用戶：Merge N 用戶在某個<strong>時間戳</strong>之後的所有 Tweets</li>
</ul>
</li>
<li>對比 MySQL vs Memcached 的 QPS<ul>
<li>約 1000 ~100</li>
</ul>
</li>
</ul>
</li>
<li><p>PUSH - 浪費了更多的 Disk</p>
<ul>
<li><p>PULL 是存在Mem中</p>
</li>
<li><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd6iuzhttdj30ma0b4t9v.jpg" alt="image-20200325220243909" style="zoom:67%;" />
</li>
<li><p>Fanout的時過程要幾個小時啊！資源該多為大多數人服務</p>
<ul>
<li>嘗試在現有的模型作最小改動優化之，多加幾台用於作Push任務的機器, Problem solved! </li>
<li>對長期的增長進行估計，並評估是否值得轉換整個模型成PULL或混合的，PULL還可以方便插入廣告、內容排序、幹掉zombie粉不給他發帖了</li>
</ul>
</li>
</ul>
</li>
<li><p>PUSH + PULL </p>
<ul>
<li>普通用戶一樣是PUSH</li>
<li>明星就標上去，不PUSH到用戶的News Feed中</li>
<li>當用戶需要的時候，來明星用戶的Timeline拿，然後合併到News Feed裡</li>
</ul>
</li>
<li><p>怎麼定義明星？</p>
<ul>
<li><blockquote>
<h5 id="单选题-直接用粉丝数目判断是否是明星会不会有问题"><a href="#单选题-直接用粉丝数目判断是否是明星会不会有问题" class="headerlink" title="[单选题]直接用粉丝数目判断是否是明星会不会有问题"></a>[单选题]直接用粉丝数目判断是否是明星会不会有问题</h5><p>A.有问题80.95% 选择</p>
<p>B.没有问题12.72% 选择</p>
<p>C.猜不出6.33% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是A</p>
<p><strong>正确答案:</strong>A</p>
<p><strong>解析:</strong></p>
<p>明星可能会掉粉，会从 &gt;=1m 掉粉掉到 &lt;1m，导致一些用户丢失掉一些明星发的帖子</p>
</blockquote>
</li>
</ul>
<p>如果大明星掉了粉好幾10萬，</p>
<p>最初因為他是大明星，所以系統不push他的文章，當他掉了一堆粉，我刷新News Feed, 因為這時大明星不是明星了，所以系統就不去Pull他的文章，我就丟失了他的動態啦。。</p>
<ul>
<li>所以不要動態計算他是不是明星，要離線計算，可以在User Table加一個字段 : is_superstar。</li>
</ul>
</li>
<li><p>為什麼大家都用PULL, 幹嘛還要學PUSH?</p>
<ul>
<li><p>設計本就不是找唯一方案，而是最合適</p>
</li>
<li><p>流量小時，Push是最經濟跟省力方式</p>
<table>
<thead>
<tr>
<th>PUSH 使用時機</th>
<th>PULL 使用時機</th>
</tr>
</thead>
<tbody><tr>
<td>資源少</td>
<td>資源多</td>
</tr>
<tr>
<td>想少寫code</td>
<td></td>
</tr>
<tr>
<td><strong>實時性不高</strong></td>
<td>****</td>
</tr>
<tr>
<td>用戶帖少</td>
<td>用戶帖多</td>
</tr>
<tr>
<td>雙向好友關係，沒有明★問題，如朋友圈</td>
<td>單向好友關係，有明★問題</td>
</tr>
</tbody></table>
<p>twitter就發得多，隨便噴；ins就比較慢</p>
<p>FB PULL，又作群組又排序又插廣告就PULL</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>更多功能</p>
<ul>
<li>Like，Follow &amp; Unfollow, Ads</li>
</ul>
</li>
<li><p>特殊情況時，如僵屍粉、大新聞搞掛了服務</p>
<ul>
<li>掛了怎辦？</li>
<li>用戶逐漸</li>
<li>服務器頂不住壓力怎辦？</li>
<li>數據庫頂不住怎辦？</li>
</ul>
</li>
</ul>
</li>
<li><p>Maintenance</p>
<ul>
<li>魯棒性，要是掛了怎辦</li>
<li>擴展性，要是流量暴增怎辦</li>
</ul>
</li>
</ol>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><ul>
<li>Ask before Design – 先問清楚再設計</li>
</ul>
<ul>
<li>no more no less – 要設計剛剛好夠用的就好</li>
</ul>
<ul>
<li>Work solution first – 先設計一個基本能工作的，再逐本優化</li>
<li>Analysis is important than solution – 分析過程展示知識儲備；權衡各種設計方式的利弊</li>
</ul>
<h1 id="Extension"><a href="#Extension" class="headerlink" title="Extension"></a>Extension</h1><h2 id="數據持久化與常見的數據庫"><a href="#數據持久化與常見的數據庫" class="headerlink" title="數據持久化與常見的數據庫"></a>數據持久化與常見的數據庫</h2><ul>
<li>MySQL, PostgreSQL</li>
<li>Memcached<ul>
<li>k-v緩存系統</li>
<li>value 不支持 set / list</li>
<li>無法持久化</li>
</ul>
</li>
<li>Redis<ul>
<li>value 支持 set / list，O(1) add, append，</li>
<li>數據可持久化同步上disk，數據都load進memory，</li>
<li>後來可多台機器的內存</li>
<li>可用作 Cache/ Message Queu/ Database，重開機還在</li>
</ul>
</li>
<li>Cassandra, HBase<ul>
<li>Column Family Base NoSQL 數據庫</li>
<li>key分為 row-key, column-key</li>
<li>適合放查詢請求簡單不複雜的data</li>
</ul>
</li>
<li>MongoDB<ul>
<li>適合寫多讀少的數據，寫快讀慢</li>
</ul>
</li>
<li>Rocksdb<ul>
<li>kv, value 不支持 set / list</li>
<li>用於大公司的kv storage底層, 如FB、抖音</li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>选择memcached 和cache 的区别？<ul>
<li>cache单机的，单机的内存有限制，并且只能本机访问，memcache是一个cache db，可以由多台机器组成，并且可以多个server同时访问</li>
</ul>
</li>
</ul>
</blockquote>
<blockquote>
<p>异步任务中适合放那些不着急响应结果给用户或者执行起来比较慢的任务。所以 LintCode 评测和发邮件都适合放在异步任务中执行。C和D中的两个操作只是简单的在数据库中创建一条记录，是很快的，不需要通过异步任务执行，且 D 选项必须马上反馈给用户是否注册成功，更加不能放在异步任务中。</p>
</blockquote>
<h2 id="消息隊列"><a href="#消息隊列" class="headerlink" title="消息隊列"></a>消息隊列</h2><p>IPC</p>
<p>關注一個最主要是把好友關係存下來</p>
<p>RabbitMQ, Redis(Cache比不過Memcached, MQ比不上RabbitMQ, DB比不上SQL…)</p>
<p>Amazon Simple Queue Service</p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd7r1stfcrj30ta0g475i.jpg" alt="image-20200326233130851" style="zoom:67%;" />



<hr>
<h5 id="Tradeoff"><a href="#Tradeoff" class="headerlink" title="Tradeoff"></a>Tradeoff</h5><h5 id="SOA"><a href="#SOA" class="headerlink" title="SOA"></a>SOA</h5><h5 id="Pull-vs-Push-Model"><a href="#Pull-vs-Push-Model" class="headerlink" title="Pull vs Push Model"></a>Pull vs Push Model</h5><h5 id="DB-Systems"><a href="#DB-Systems" class="headerlink" title="DB Systems"></a>DB Systems</h5><h5 id="Async-amp-Message-Queue"><a href="#Async-amp-Message-Queue" class="headerlink" title="Async &amp; Message Queue"></a>Async &amp; Message Queue</h5><h5 id="Persistent"><a href="#Persistent" class="headerlink" title="Persistent"></a>Persistent</h5><h5 id="Denormalize"><a href="#Denormalize" class="headerlink" title="Denormalize"></a>Denormalize</h5><h5 id="Thundering-Herd"><a href="#Thundering-Herd" class="headerlink" title="Thundering Herd"></a>Thundering Herd</h5><h5 id="News-Feed-Design"><a href="#News-Feed-Design" class="headerlink" title="News Feed Design?!"></a>News Feed Design?!</h5></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/03/03/SQL/T/">SQL/T</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-03-03</time><div class="content"><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcg1afg4rdj30jg0hkdgt.jpg" alt="image-20200303001005931" style="zoom:50%;" />

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> tmp</span><br><span class="line"><span class="keyword">AS</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> *</span><br><span class="line">	<span class="keyword">FROM</span> Campaigns</span><br><span class="line">	<span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">		<span class="keyword">SELECT</span> Campaign_id</span><br><span class="line">			,<span class="keyword">min</span>(<span class="built_in">DATE</span>) <span class="keyword">AS</span> earliest_date</span><br><span class="line">			,Spend_amount_USD</span><br><span class="line">		<span class="keyword">FROM</span> Spend</span><br><span class="line">		<span class="keyword">GROUP</span> <span class="keyword">BY</span> Campaign_id</span><br><span class="line">		) ss <span class="keyword">ON</span> Campaigns.Campaign_id = ss.Campaign_id</span><br><span class="line">	)</span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> tmp</span><br></pre></td></tr></table></figure>





<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Campaigns</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> s1.Campaign_id</span><br><span class="line">		,s1.DATE</span><br><span class="line">		,Spend_amount_USD</span><br><span class="line">	<span class="keyword">FROM</span> Spend <span class="keyword">AS</span> s1</span><br><span class="line">	<span class="keyword">INNER</span> <span class="keyword">JOIN</span> (</span><br><span class="line">		<span class="keyword">SELECT</span> Campaign_id</span><br><span class="line">			,<span class="keyword">min</span>(<span class="built_in">DATE</span>) <span class="keyword">AS</span> earliest_date</span><br><span class="line">		<span class="keyword">FROM</span> Spend</span><br><span class="line">		<span class="keyword">GROUP</span> <span class="keyword">BY</span> Campaign_id</span><br><span class="line">		) tmp <span class="keyword">ON</span> s1.Campaign_id = tmp.Campaign_id</span><br><span class="line">		<span class="keyword">AND</span> s1.DATE = tmp.earliest_date</span><br><span class="line">	) ss <span class="keyword">ON</span> Campaigns.Campaign_id = ss.Campaign_id</span><br></pre></td></tr></table></figure>

<p>left join 因為，可能 Spend裡找不到235這活動，但是他的確是Account_id２辦過的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> cs</span><br><span class="line"><span class="keyword">AS</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> *</span><br><span class="line">	<span class="keyword">FROM</span> Campaigns</span><br><span class="line">	<span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">		<span class="keyword">SELECT</span> Campaign_id</span><br><span class="line">			,<span class="keyword">min</span>(<span class="built_in">DATE</span>) <span class="keyword">AS</span> earliest_date</span><br><span class="line">			,Spend_amount_USD</span><br><span class="line">		<span class="keyword">FROM</span> Spend</span><br><span class="line">		<span class="keyword">GROUP</span> <span class="keyword">BY</span> Campaign_id</span><br><span class="line">		) ss <span class="keyword">ON</span> Campaigns.Campaign_id = ss.Campaign_id</span><br><span class="line">	)</span><br><span class="line">	</span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> cs <span class="keyword">AS</span> c1</span><br><span class="line"><span class="keyword">WHERE</span> c1.earliest_date = (</span><br><span class="line">		<span class="keyword">SELECT</span> <span class="keyword">min</span>(c2.earliest_date)</span><br><span class="line">		<span class="keyword">FROM</span> cs <span class="keyword">AS</span> c2</span><br><span class="line">		<span class="keyword">WHERE</span> c2.Account_id = c2.Account_id</span><br><span class="line">		)</span><br><span class="line">	<span class="keyword">OR</span> c1.earliest_date <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> account_id</span><br></pre></td></tr></table></figure>





<table>
<thead>
<tr>
<th>ID</th>
<th>Account_id</th>
<th>Campaign_id</th>
<th>Campaign_type</th>
<th>Campaign_id:1</th>
<th>earliest_date</th>
<th>Spend_amount_USD</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
<td>123</td>
<td>Promoted Trend</td>
<td>123</td>
<td>2017-08-01</td>
<td>200.0</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>234</td>
<td>Promoted Account</td>
<td>234</td>
<td>2017-08-01</td>
<td>500.0</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
<td>235</td>
<td>Promoted Tweet</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>456</td>
<td>Promoted Trend</td>
<td>456</td>
<td>2017-08-01</td>
<td>200.0</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
<td>999</td>
<td>NONO</td>
<td>999</td>
<td>2017-08-11</td>
<td>1000.0</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>ID</th>
<th>Account_id</th>
<th>Campaign_id</th>
<th>Campaign_type</th>
<th>Campaign_id:1</th>
<th>earliest_date</th>
<th>Spend_amount_USD</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>1</td>
<td>123</td>
<td>Promoted Trend</td>
<td>123</td>
<td>2017-08-01</td>
<td>200.0</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>234</td>
<td>Promoted Account</td>
<td>234</td>
<td>2017-08-01</td>
<td>500.0</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>456</td>
<td>Promoted Trend</td>
<td>456</td>
<td>2017-08-01</td>
<td>200.0</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
<td>235</td>
<td>Promoted Tweet</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> cs</span><br><span class="line"><span class="keyword">AS</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> *</span><br><span class="line">	<span class="keyword">FROM</span> Campaigns</span><br><span class="line">	<span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (</span><br><span class="line">		<span class="keyword">SELECT</span> Campaign_id</span><br><span class="line">			,<span class="keyword">min</span>(<span class="built_in">DATE</span>) <span class="keyword">AS</span> earliest_date</span><br><span class="line">			,<span class="keyword">SUM</span>(Spend_amount_USD)</span><br><span class="line">		<span class="keyword">FROM</span> Spend</span><br><span class="line">		<span class="keyword">GROUP</span> <span class="keyword">BY</span> Campaign_id</span><br><span class="line">		) ss <span class="keyword">ON</span> Campaigns.Campaign_id = ss.Campaign_id</span><br><span class="line">	)</span><br><span class="line">	</span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> cs <span class="keyword">AS</span> c1</span><br><span class="line"><span class="keyword">WHERE</span> c1.earliest_date = (</span><br><span class="line">		<span class="keyword">SELECT</span> <span class="keyword">min</span>(c2.earliest_date)</span><br><span class="line">		<span class="keyword">FROM</span> cs <span class="keyword">AS</span> c2</span><br><span class="line">		<span class="keyword">WHERE</span> c1.Account_id = c2.Account_id</span><br><span class="line">		)</span><br><span class="line">	<span class="keyword">OR</span> c1.earliest_date <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> account_id</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/03/02/Books/2020-03-02%20%E9%9D%9E%E6%9A%B4%E5%8A%9B%E6%BA%9D%E9%80%9A-NonViolent%20Communication/">Books/2020-03-02 非暴力溝通-NonViolent Communication</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-03-02</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Books/">Books</a></span><div class="content"><h5 id=""><a href="#" class="headerlink" title=""></a></h5><h2 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h2><h3 id="暴力溝通四種模式："><a href="#暴力溝通四種模式：" class="headerlink" title="暴力溝通四種模式："></a>暴力溝通四種模式：</h3><p>Four modes of violent communication:</p>
<p>道德批判、進行比較、迴避責任、強人所難。</p>
<p>Ethical criticism, comparison, avoidance of responsibility, and tough people.</p>
<h3 id="非暴力溝通模式-–-觀察對方和自己的需要"><a href="#非暴力溝通模式-–-觀察對方和自己的需要" class="headerlink" title="非暴力溝通模式 – 觀察對方和自己的需要"></a>非暴力溝通模式 – 觀察對方和自己的需要</h3><p>Non-violent communication mode – Observe the needs of others and yourself</p>
<h4 id="e-g"><a href="#e-g" class="headerlink" title="e.g."></a>e.g.</h4><p>和幾個同事在一個小組，需要共同完成一項工作。可有一位同事被大家認為沒有團隊精神，喜”單打獨鬥”。如果我們們用非暴力的思維去思考他的行為，就會發現他喜歡單打獨鬥的背後，一定有他的需要，可能他搞長難度更高的工作、可能他特別渴望獲得尊重。這個時候，我們可以平和引導他說出，他喜歡單打獨鬥的原因，然後綜合大家的需求，找到滿足雙方需求的方法，而不是用道德判斷的暴力溝通方式，覺得他價值觀有問題而去疏遠他。</p>
<p>In a small group with several colleagues, you need to complete a job together. However, one colleague was considered to have no team spirit and liked “single fight alone.” If we use non-violent thinking to think about his behavior, we will find that he likes to fight alone and there must be his needs. Maybe he has a more difficult job. Maybe he is particularly eager to get respect. At this time, we can calmly guide him to explain why he likes to fight alone, and then integrate everyone’s needs to find a way to meet the needs of both parties, instead of using violent communication methods based on moral judgment, and feel alienated in his values he.</p>
<h4 id="觀察、感受、需要、請求"><a href="#觀察、感受、需要、請求" class="headerlink" title="觀察、感受、需要、請求,"></a>觀察、感受、需要、請求,</h4><h4 id="Observe-feel-need-request"><a href="#Observe-feel-need-request" class="headerlink" title="Observe, feel, need, request"></a>Observe, feel, need, request</h4><p>比如，一位下屬沒有按時提交報表，如果是非暴力溝通的上級，可能會這樣和他交流：</p>
<p>上次的報表應該上週就完成的，可是你在昨天才給到我，我感到有點擔心，因為整體的工作進度可能會被擔誤，我不確定是不是你手頭上的工作太多，還是說你家裡有事情。我希望能幫助你更有效率地工作，可以告訴我你最近有什麼困難嗎？</p>
<p>For example, a subordinate did not submit a report on time. If he is a superior who communicates nonviolently, he may communicate with him like this:</p>
<p>The last report should have been completed last week, but you only gave it to me yesterday. I am a bit worried because the overall work progress may be burdened. I am not sure if you have too much work on hand, or Say you have something at home. I hope to help you work more efficiently. Can you tell me about any recent difficulties?</p>
<h2 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h2><h3 id="區分觀察-vs-評論-Distinguish-observation-vs-comments"><a href="#區分觀察-vs-評論-Distinguish-observation-vs-comments" class="headerlink" title="區分觀察 vs 評論 Distinguish observation vs comments"></a>區分觀察 vs 評論 Distinguish observation vs comments</h3><p>評論為絕對化的；觀察式的不會有反感，要避免絕對化的評論。</p>
<p>觀察結果的表述 – 加上絕對的時間跟地點</p>
<p>Comments are absolute; observations are not objectionable. Avoid absolute comments. Representation of observations – together w/ absolute time and place</p>
<h3 id="體會表達感受-Express-feelings"><a href="#體會表達感受-Express-feelings" class="headerlink" title="體會表達感受  Express feelings"></a>體會表達感受  Express feelings</h3><p>Thnks about the roots behind feelings</p>
<h3 id="找到並表達需求-Find-and-express-needs"><a href="#找到並表達需求-Find-and-express-needs" class="headerlink" title="找到並表達需求 Find and express needs"></a>找到並表達需求 Find and express needs</h3><h3 id="學會表達請求-Learn-to-express-requests"><a href="#學會表達請求-Learn-to-express-requests" class="headerlink" title="學會表達請求 Learn to express requests"></a>學會表達請求 Learn to express requests</h3><p>Refine goals with requests when expressing</p>
<h5 id="例１-E-g-1"><a href="#例１-E-g-1" class="headerlink" title="例１ E.g.1"></a>例１ E.g.1</h5><p>”我覺得這項工作我做得不是很好” – 僅想法，未表達感受</p>
<p>”這項工作沒做好，我很愧疚” – 表達感受；且適當示弱有助於溝通，是一種有效緩解對立情緒、解決衝突的方法。</p>
<p>“I don’t think I did a good job with this job” – only thoughts, no feelings </p>
<p>“This job is not done well, I feel guilty” – expressing feelings; BTW, showing weakness appropriately helps communication, which is an effective way to alleviate conflicts and resolve conflicts.</p>
<h5 id="例２-E-g-2"><a href="#例２-E-g-2" class="headerlink" title="例２ E.g.2"></a>例２ E.g.2</h5><p>看到下屬將機密文件隨便放到了辦公桌上，於是對他說：「你將機密文件放到辦公桌上，沒有及時鎖起來，這讓我特別緊張。」</p>
<p>接著，要繼續說「因為我不想讓機密文件存在任何洩密隱患」，這句話，挑明了”需求”。</p>
<p>「那麼，請你下次注意將文件第一時間收到保險箱裡，好嗎？」，這句話，則提出了我們的”請求”。</p>
<p>When seeing my subordinates placing confidential documents on the desk, and said to him, “You placed the confidential documents on the desk and did not lock them in time, which made me particularly nervous.</p>
<p>Then, to continue to say “because I don’t want any hidden dangers of confidential documents”, this sentence clarifies the “need”.</p>
<p>“Then, please pay attention to the documents once after being received and put in the safe as soon as possible, okay?” In this sentence, we made our “request”.</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/28/ML/2019-03-27-Time%20Series%20Analysis/">ML/2019-03-27-Time Series Analysis</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-28</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/M/">M</a></span><div class="content"><h2 id="時間數據的特徵工程"><a href="#時間數據的特徵工程" class="headerlink" title="時間數據的特徵工程"></a>時間數據的特徵工程</h2><p>可展開成年、月、日、星期幾、週末、月的哪部分，一年當中第幾天、第幾個月、月初還是月末、節日</p>
<p>上中下旬用數字不OK, 所以可用one-hot encoding，用很多個bool表示其中那個用1, 2, 3表示的上中下旬。</p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd8c7zt08dj30w20bg75q.jpg" alt="image-20200327114411681" style="zoom:67%;" />



<p>pd.get_dummies 做 one-hot- encoding</p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd8cgz308wj314g0iq411.jpg" alt="image-20200327115247759" style="zoom:80%;" />

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd8ccnwq2gj310409k757.jpg" alt="image-20200327114837591" style="zoom:67%;" />

<p>用10個維度表示其中的10年</p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd8cbtiq38j310o096aam.jpg" alt="image-20200327114753055" style="zoom:67%;" />





<p>然後整理數據集</p>
<p>Linear regression, 多項式迴歸、嶺迴歸、Lasso regression 需要　X_dummy , with one-hot-encoding, 成72維度</p>
<p>DT、RF不需要 one-hot-encoding，用 X_before_dummy</p>
<h2 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h2><p>MSE, RMSE, MAbsoluteE, R Square</p>
<h4 id="線性迴歸"><a href="#線性迴歸" class="headerlink" title="線性迴歸"></a>線性迴歸</h4><p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd8cqzb6j7j312u0huh1c.jpg" alt="image-20200327120233707"></p>
<p>我們看到的是72維在2D平面的投影</p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd8ct2bdltj313m02mdgg.jpg" alt="image-20200327120425110" style="zoom:80%;" />



<h4 id="多項式迴歸"><a href="#多項式迴歸" class="headerlink" title="多項式迴歸"></a>多項式迴歸</h4><p>二次、三次</p>
<h4 id="嶺迴歸"><a href="#嶺迴歸" class="headerlink" title="嶺迴歸"></a>嶺迴歸</h4><ul>
<li>線性加了L1正則</li>
</ul>
<h4 id="Lasso迴歸"><a href="#Lasso迴歸" class="headerlink" title="Lasso迴歸"></a>Lasso迴歸</h4><ul>
<li>線性加了L2正則</li>
</ul>
<h4 id="RF"><a href="#RF" class="headerlink" title="RF"></a>RF</h4><ul>
<li>bagging 子集建各樹、考慮最大的特徵數，作Cross Validation</li>
</ul>
<h2 id="模型比較"><a href="#模型比較" class="headerlink" title="模型比較"></a>模型比較</h2><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd8df910hwj31eu0m8n1b.jpg" alt="image-20200327122545346" style="zoom:67%;" />

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd8dfjtqpej315o0gk4cq.jpg" alt="image-20200327122605413" style="zoom:67%;" /></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/28/Old_Records_for_Daily_Practice/2020-02-28-Daily%20Problem/">Old_Records_for_Daily_Practice/2020-02-28-Daily Problem</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-28</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Daily/">Daily</a></span><div class="content"><h3 id="Anagram-in-a-string"><a href="#Anagram-in-a-string" class="headerlink" title="Anagram in a string"></a>Anagram in a string</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_anagrams</span><span class="params">(s, t)</span>:</span></span><br><span class="line">  <span class="comment"># Fill this in.</span></span><br><span class="line"></span><br><span class="line">print(find_anagrams(<span class="string">'acdbacdacb'</span>, <span class="string">'abc'</span>))</span><br><span class="line"><span class="comment"># [3, 7]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findAnagrams_Counter</span><span class="params">(self, s: str, p: str)</span> -&gt; List[int]:</span>    <span class="comment"># Took 7300 ms</span></span><br><span class="line">        window = len(p)</span><br><span class="line">        c_p = Counter(p)</span><br><span class="line">        </span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(window<span class="number">-1</span>, len(s)):   <span class="comment"># 2</span></span><br><span class="line">            pat = s[i-window+<span class="number">1</span>:i+<span class="number">1</span>]</span><br><span class="line">            <span class="comment"># print(pat)</span></span><br><span class="line">            c_pat = Counter(pat)  </span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> c_p == c_pat:</span><br><span class="line">                res.append(i-window+<span class="number">1</span>) </span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findAnagrams</span><span class="params">(self, s: str, p: str)</span> -&gt; List[int]:</span>    <span class="comment"># 100 ms</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s <span class="keyword">or</span> <span class="keyword">not</span> p:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        </span><br><span class="line">        enc_p = self.encoder(p)</span><br><span class="line">        win = len(p)</span><br><span class="line">        <span class="comment"># enc_s = self.encoder(s[:win])</span></span><br><span class="line">        </span><br><span class="line">        offset = win<span class="number">-1</span></span><br><span class="line">        res = []</span><br><span class="line">        <span class="string">'''Dynamically update pattern in s'''</span></span><br><span class="line">        <span class="comment"># for i in range(offset, len(s)):</span></span><br><span class="line">        enc_c = [<span class="number">0</span>] * <span class="number">26</span></span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">            enc_c[ord(s[i]) - ord(<span class="string">'a'</span>)] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> i - j &gt;= win:</span><br><span class="line">                enc_c[ord(s[j]) - ord(<span class="string">'a'</span>)] -= <span class="number">1</span></span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> enc_c == enc_p:</span><br><span class="line">                res.append(j)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findAnagrams_TLE</span><span class="params">(self, s: str, p: str)</span> -&gt; List[int]:</span>    <span class="comment"># TLE</span></span><br><span class="line">        <span class="string">''' TLE, SHOULD Dynamically  Update enc_tmp'''</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s <span class="keyword">or</span> <span class="keyword">not</span> p:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        </span><br><span class="line">        enc_p = self.encoder(p)</span><br><span class="line">        win = len(p)</span><br><span class="line">        </span><br><span class="line">        offset = win<span class="number">-1</span></span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(offset, len(s)):</span><br><span class="line">            start = i - win + <span class="number">1</span></span><br><span class="line">            sub_s = s[start:i+<span class="number">1</span>]</span><br><span class="line">            <span class="comment"># print(sub_s)</span></span><br><span class="line">            enc_tmp = self.encoder(sub_s)  <span class="comment"># 2 - (3-1) : 3  # No OOR</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> enc_tmp == enc_p:</span><br><span class="line">                res.append(start)</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="Reverse-Words"><a href="#Reverse-Words" class="headerlink" title="Reverse Words"></a><del>Reverse Words</del></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_words</span><span class="params">(words)</span>:</span></span><br><span class="line">  <span class="comment"># Fill this in.</span></span><br><span class="line"></span><br><span class="line">s = list(<span class="string">"can you read this"</span>)</span><br><span class="line">reverse_words(s)</span><br><span class="line">print(<span class="string">''</span>.join(s))</span><br><span class="line"><span class="comment"># this read you can</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverseWords</span><span class="params">(self, s: str)</span> -&gt; str:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s:</span><br><span class="line">            <span class="keyword">return</span> s</span><br><span class="line">        l = s.split()[::<span class="number">-1</span>]</span><br><span class="line">        res = <span class="string">' '</span>.join(l)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>

<h3 id="Reverse-Words-Ⅱ"><a href="#Reverse-Words-Ⅱ" class="headerlink" title="Reverse Words Ⅱ"></a><del>Reverse Words Ⅱ</del></h3><p>Given an input string , reverse the string word by word. </p>
<p><strong>Example:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input:  [&quot;t&quot;,&quot;h&quot;,&quot;e&quot;,&quot; &quot;,&quot;s&quot;,&quot;k&quot;,&quot;y&quot;,&quot; &quot;,&quot;i&quot;,&quot;s&quot;,&quot; &quot;,&quot;b&quot;,&quot;l&quot;,&quot;u&quot;,&quot;e&quot;]</span><br><span class="line">Output: [&quot;b&quot;,&quot;l&quot;,&quot;u&quot;,&quot;e&quot;,&quot; &quot;,&quot;i&quot;,&quot;s&quot;,&quot; &quot;,&quot;s&quot;,&quot;k&quot;,&quot;y&quot;,&quot; &quot;,&quot;t&quot;,&quot;h&quot;,&quot;e&quot;]</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverseWords</span><span class="params">(self, s: List[str])</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Do not return anything, modify s in-place instead.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        t = <span class="string">' '</span>.join(<span class="string">''</span>.join(s).split()[::<span class="number">-1</span>])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">            s[i] = t[i]</span><br></pre></td></tr></table></figure>

<h3 id="Reverse-Words-Ⅲ"><a href="#Reverse-Words-Ⅲ" class="headerlink" title="Reverse Words Ⅲ"></a><del>Reverse Words Ⅲ</del></h3><p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: &quot;Let&#39;s take LeetCode contest&quot;</span><br><span class="line">Output: &quot;s&#39;teL ekat edoCteeL tsetnoc&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverseWords</span><span class="params">(self, s: str)</span> -&gt; str:</span></span><br><span class="line">        t  = s.split()</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> t:</span><br><span class="line">            w = w[::<span class="number">-1</span>]</span><br><span class="line">            res.append(w)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">' '</span>.join(res)</span><br></pre></td></tr></table></figure>



<h3 id="Find-Subtree"><a href="#Find-Subtree" class="headerlink" title="Find Subtree"></a><del>Find Subtree</del></h3><p>Given 2 binary trees t and s, find if s has an equal subtree in t, where the structure and the values are the same. Return True if it exists, otherwise return False.</p>
<p>Here’s some starter code and an example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, value, left=None, right=None)</span>:</span></span><br><span class="line">    self.value = value</span><br><span class="line">    self.left = left</span><br><span class="line">    self.right = right</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f"(Value: <span class="subst">&#123;self.value&#125;</span> Left: <span class="subst">&#123;self.left&#125;</span> Right: <span class="subst">&#123;self.right&#125;</span>)"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_subtree</span><span class="params">(s, t)</span>:</span></span><br><span class="line">  <span class="comment"># Fill this in.</span></span><br><span class="line"></span><br><span class="line">t3 = Node(<span class="number">4</span>, Node(<span class="number">3</span>), Node(<span class="number">2</span>))</span><br><span class="line">t2 = Node(<span class="number">5</span>, Node(<span class="number">4</span>), Node(<span class="number">-1</span>))</span><br><span class="line">t = Node(<span class="number">1</span>, t2, t3)</span><br><span class="line"></span><br><span class="line">s = Node(<span class="number">4</span>, Node(<span class="number">3</span>), Node(<span class="number">2</span>))</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">Tree t:</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">   / \</span></span><br><span class="line"><span class="string">  4   5 </span></span><br><span class="line"><span class="string"> / \ / \</span></span><br><span class="line"><span class="string">3  2 4 -1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Tree s:</span></span><br><span class="line"><span class="string">  4 </span></span><br><span class="line"><span class="string"> / \</span></span><br><span class="line"><span class="string">3  2 </span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">print(find_subtree(s, t))</span><br><span class="line"><span class="comment"># True</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isSubtree</span><span class="params">(self, s: TreeNode, t: TreeNode)</span> -&gt; bool:</span></span><br><span class="line">        </span><br><span class="line">            <span class="comment"># self.isSubtree()</span></span><br><span class="line">        <span class="comment"># self.t = t</span></span><br><span class="line">        <span class="keyword">return</span> self.preorder(s, t) <span class="keyword">or</span> self.preorder(t, s)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preorder</span><span class="params">(self, root, ref)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        ans =  self.is_sametree(root, ref)</span><br><span class="line">        </span><br><span class="line">        L_has_same = self.preorder(root.left, ref)</span><br><span class="line">        R_has_same = self.preorder(root.right, ref)</span><br><span class="line">        <span class="keyword">return</span> ans <span class="keyword">or</span> L_has_same <span class="keyword">or</span> R_has_same</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_sametree</span><span class="params">(self, s, t)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s <span class="keyword">and</span> <span class="keyword">not</span> t:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s <span class="keyword">or</span> <span class="keyword">not</span> t:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> s.val == t.val <span class="keyword">and</span> self.is_sametree(s.left, t.left) <span class="keyword">and</span> self.is_sametree(s.right, t.right)</span><br></pre></td></tr></table></figure>



<h3 id="Sorted-Square-Numbers"><a href="#Sorted-Square-Numbers" class="headerlink" title="Sorted Square Numbers"></a><del>Sorted Square Numbers</del></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def square_numbers(nums):</span><br><span class="line"> # Fill this in.</span><br><span class="line"></span><br><span class="line">print(square_numbers([-5, -3, -1, 0, 1, 4, 5]))</span><br><span class="line"># [0, 1, 1, 9, 16, 25, 25]Solve this problem in O(n) time.</span><br></pre></td></tr></table></figure>



<h3 id="Picking-up-Change"><a href="#Picking-up-Change" class="headerlink" title="Picking up Change?!"></a><del>Picking up Change?!</del></h3><h3 id="Determine-if-numbe-–-Hard-if-not-able-to-use-built-in…"><a href="#Determine-if-numbe-–-Hard-if-not-able-to-use-built-in…" class="headerlink" title="Determine if numbe – Hard if not able to use built-in…"></a>Determine if numbe – Hard if not able to use built-in…</h3><p>Given a string that may represent a number, determine if it is a number. Here’s some of examples of how the number may be presented:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;123&quot; # Integer</span><br><span class="line">&quot;12.3&quot; # Floating point</span><br><span class="line">&quot;-123&quot; # Negative numbers</span><br><span class="line">&quot;-.3&quot; # Negative floating point</span><br><span class="line">&quot;1.5e5&quot; # Scientific notation</span><br></pre></td></tr></table></figure>

<p>Here’s some examples of what isn’t a proper number:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;12a&quot; # No letters</span><br><span class="line">&quot;1 2&quot; # No space between numbers</span><br><span class="line">&quot;1e1.2&quot; # Exponent can only be an integer (positive or negative or 0)</span><br></pre></td></tr></table></figure>

<p>Scientific notation requires the first number to be less than 10, however to simplify the solution assume the first number can be greater than 10. Do not parse the string with int() or any other python functions.</p>
<h2 id="Swap-bits-–-A-Neat-Bitwise-Trick-For-Swapping-Even-and-Odd-Bits"><a href="#Swap-bits-–-A-Neat-Bitwise-Trick-For-Swapping-Even-and-Odd-Bits" class="headerlink" title="Swap bits – A Neat Bitwise Trick For Swapping Even and Odd Bits"></a>Swap bits – A Neat Bitwise Trick For Swapping Even and Odd Bits</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def swap_bits(x):</span><br><span class="line">    EVEN &#x3D; 0b10101010</span><br><span class="line">    ODD &#x3D; 0b01010101</span><br><span class="line">    return (x &amp; EVEN) &gt;&gt; 1 | (x &amp; ODD) &lt;&lt; 1</span><br></pre></td></tr></table></figure>



<h3 id="String-to-Integer-atoi"><a href="#String-to-Integer-atoi" class="headerlink" title="String to Integer(atoi)"></a>String to Integer(atoi)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">myAtoi</span><span class="params">(self, str: str)</span> -&gt; int:</span></span><br><span class="line">        t = str.strip()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> t:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> t[<span class="number">0</span>] <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">'+-1234567890'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        flag = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> t[<span class="number">0</span>] == <span class="string">'-'</span>:</span><br><span class="line">            <span class="keyword">if</span> len(t) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            flag = <span class="number">-1</span></span><br><span class="line">            t = t[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">elif</span> t[<span class="number">0</span>] == <span class="string">'+'</span>:</span><br><span class="line">            <span class="keyword">if</span> len(t) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            t = t[<span class="number">1</span>:]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> t[<span class="number">0</span>] <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">"1234567890"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># chech 0s and " "</span></span><br><span class="line">        q = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> q &lt; len(t):</span><br><span class="line">            <span class="keyword">if</span> t[q] <span class="keyword">in</span> <span class="string">"1234567890"</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            q += <span class="number">1</span></span><br><span class="line">                </span><br><span class="line">        <span class="keyword">if</span> q == len(t):<span class="comment"># or q == 0:</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            </span><br><span class="line">        t = t[q:]</span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        tmp = <span class="number">10</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> range(len(t)):</span><br><span class="line">            <span class="keyword">if</span> t[idx] <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">"1234567890"</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            digit = (ord(t[idx]) - ord(<span class="string">'0'</span>))</span><br><span class="line">            <span class="comment"># print(digit)</span></span><br><span class="line">            <span class="comment"># res *= tmp</span></span><br><span class="line">            res = tmp*res + digit</span><br><span class="line">            <span class="comment"># tmp *= 10</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">        ans = res*flag</span><br><span class="line">        <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> min(ans, <span class="number">2</span>**<span class="number">31</span> - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> max(ans, <span class="number">-2</span>**<span class="number">31</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Rotate-Matrix"><a href="#Rotate-Matrix" class="headerlink" title="Rotate Matrix"></a><del>Rotate Matrix</del></h3><h3 id="Pow"><a href="#Pow" class="headerlink" title="Pow"></a>Pow</h3><h5 id="Wrong-This-doesn’t-solve-overflow-issue-for-2-31-2-31-1"><a href="#Wrong-This-doesn’t-solve-overflow-issue-for-2-31-2-31-1" class="headerlink" title="Wrong, This doesn’t solve overflow issue for [-2^(31), 2^31-1]"></a>Wrong, This doesn’t solve overflow issue for [-2^(31), 2^31-1]</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import math</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">myPow</span><span class="params">(self, x: float, n: int)</span> -&gt; float:</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">or</span> x  == <span class="number">1</span>: </span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">0</span>:       <span class="comment">#2**(-3) ==  1/2**3 == 2* 2**(-4)</span></span><br><span class="line">            <span class="comment"># n = -(n+1)</span></span><br><span class="line">            n = abs(n) + <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> x * (<span class="number">1</span>/self.pos_pow(x, n))</span><br><span class="line">        <span class="keyword">return</span> self.pos_pow(x, n)</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pos_pow</span><span class="params">(self, x, n)</span>:</span></span><br><span class="line">        <span class="comment"># print(x, n)</span></span><br><span class="line">        res = <span class="number">1</span>    </span><br><span class="line">        <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> n % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">                res *= x</span><br><span class="line">            <span class="comment"># x = x ** 2      # <span class="doctag">TODO:</span> CAUTIOUS, Numerical result out of range for (2, -2**31)</span></span><br><span class="line">            x = x * x         <span class="comment"># SHOULD USE THIS!</span></span><br><span class="line">            n = n//<span class="number">2</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    for neg number: </span></span><br><span class="line"><span class="string">    [-2**31, 2**31 -1]</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">res   base index</span></span><br><span class="line"><span class="string">1     2    9      ** --&gt; ans!</span></span><br><span class="line"><span class="string">2     4    4</span></span><br><span class="line"><span class="string">2     16   2</span></span><br><span class="line"><span class="string">2     256  1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1     2    10</span></span><br><span class="line"><span class="string">1     4    5</span></span><br><span class="line"><span class="string">4     16   2</span></span><br><span class="line"><span class="string">4     256  1</span></span><br><span class="line"><span class="string">    '''</span></span><br></pre></td></tr></table></figure>



<h5 id="Correct"><a href="#Correct" class="headerlink" title="Correct"></a>Correct</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">myPow</span><span class="params">(self, x: float, n: int)</span> -&gt; float:</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">or</span> x == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># return XXXX # TODO</span></span><br><span class="line">            n1 = abs(n) - <span class="number">1</span>                         <span class="comment"># n == -2**31</span></span><br><span class="line">            <span class="keyword">return</span> (<span class="number">1</span>/x) * (<span class="number">1</span>/self.pos_pow(x, n1))  <span class="comment"># 2^(-4) == 1/2^4 ==  1/2 * 1/2^3</span></span><br><span class="line">        <span class="keyword">return</span> self.pos_pow(x, n)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pos_pow</span><span class="params">(self, base, idx)</span>:</span></span><br><span class="line">        res = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> idx &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># print(base, idx)</span></span><br><span class="line">            <span class="keyword">if</span> idx % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                res *= base</span><br><span class="line">            base *= base</span><br><span class="line">            idx //= <span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">        </span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    res base    idx</span></span><br><span class="line"><span class="string">    1   2       10</span></span><br><span class="line"><span class="string">    1   4       5</span></span><br><span class="line"><span class="string">    4   16      2    </span></span><br><span class="line"><span class="string">    4   256     1</span></span><br><span class="line"><span class="string">    ans </span></span><br><span class="line"><span class="string">    '''</span></span><br></pre></td></tr></table></figure>



<h3 id="Sqrt"><a href="#Sqrt" class="headerlink" title="Sqrt"></a><del>Sqrt</del></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mySqrt</span><span class="params">(self, x: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="comment"># if x &lt;= 1:</span></span><br><span class="line">        <span class="comment">#     return x</span></span><br><span class="line">        l, r = <span class="number">0</span>, x</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> l &lt;= r:</span><br><span class="line">            mid = l + (r-l)//<span class="number">2</span></span><br><span class="line">            print(l, r, mid)</span><br><span class="line">            <span class="keyword">if</span>  mid*mid &lt;= x &lt; (mid+<span class="number">1</span>)*(mid+<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">return</span> mid</span><br><span class="line">            <span class="keyword">elif</span> mid*mid &gt; x:</span><br><span class="line">                r = mid - <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                l = mid + <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h3 id="Missing-Ranges"><a href="#Missing-Ranges" class="headerlink" title="Missing Ranges"></a>Missing Ranges</h3><p>Given a sorted integer array <strong><em>nums\</em></strong>, where the range of elements are in the <strong>inclusive range</strong> <strong>[*lower*, *upper*]</strong>, return its missing ranges.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">0 1 3         50</span></span><br><span class="line"><span class="string">start       1+1 = 2   4</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findMissingRanges</span><span class="params">(self, nums: List[int], lower: int, upper: int)</span> -&gt; List[str]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> [str(lower) + <span class="string">"-&gt;"</span> + str(upper)] <span class="keyword">if</span> lower != upper <span class="keyword">else</span> [str(lower)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        res = []</span><br><span class="line">        <span class="comment"># item = ""</span></span><br><span class="line">        <span class="keyword">if</span> nums[<span class="number">0</span>] != lower:</span><br><span class="line">            <span class="comment"># print('aaaaaaa')</span></span><br><span class="line">            item = <span class="string">"&#123;&#125;-&gt;&#123;&#125;"</span>.format(lower, nums[<span class="number">0</span>]<span class="number">-1</span>) <span class="keyword">if</span> lower != nums[<span class="number">0</span>] - <span class="number">1</span> <span class="keyword">else</span> <span class="string">"&#123;&#125;"</span>.format(str(lower))</span><br><span class="line">            res.append(item)</span><br><span class="line">            </span><br><span class="line">        start, end = float(<span class="string">'-inf'</span>), float(<span class="string">'inf'</span>)</span><br><span class="line">        prev = nums[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(nums)):</span><br><span class="line">            <span class="keyword">if</span> nums[i] - prev &gt; <span class="number">1</span>:</span><br><span class="line">                start, end = prev + <span class="number">1</span>, nums[i] - <span class="number">1</span></span><br><span class="line">                item = <span class="string">"&#123;&#125;-&gt;&#123;&#125;"</span>.format(start, end) <span class="keyword">if</span> start != end <span class="keyword">else</span> str(end)</span><br><span class="line">                res.append(item)</span><br><span class="line">            prev = nums[i]</span><br><span class="line">        <span class="keyword">if</span> nums[<span class="number">-1</span>] != upper:</span><br><span class="line">            item = <span class="string">"&#123;&#125;-&gt;&#123;&#125;"</span>.format(nums[<span class="number">-1</span>]+<span class="number">1</span>, upper) <span class="keyword">if</span> nums[<span class="number">-1</span>] + <span class="number">1</span> != upper <span class="keyword">else</span> <span class="string">"&#123;&#125;"</span>.format(str(upper))</span><br><span class="line">            res.append(item)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="Sudoku-Check"><a href="#Sudoku-Check" class="headerlink" title="Sudoku Check"></a>Sudoku Check</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValidSudoku</span><span class="params">(self, board: List[List[str]])</span> -&gt; bool:</span></span><br><span class="line">        </span><br><span class="line">        dict_cols = defaultdict(defaultdict)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(board)):</span><br><span class="line">            dict_row = defaultdict(str)</span><br><span class="line">            <span class="keyword">if</span> i % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">                dict_boxes = defaultdict(defaultdict)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>])):</span><br><span class="line">                <span class="keyword">if</span> board[i][j] != <span class="string">'.'</span>:</span><br><span class="line">                    <span class="keyword">if</span> board[i][j] <span class="keyword">in</span> dict_row:</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        dict_row[board[i][j]] = <span class="literal">True</span></span><br><span class="line">                        </span><br><span class="line">                    <span class="keyword">if</span> board[i][j] <span class="keyword">in</span> dict_cols[j]:</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        dict_cols[j][board[i][j]] = <span class="literal">True</span></span><br><span class="line">                        </span><br><span class="line">                    <span class="comment"># if board[i][j] in dict_boxes</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="number">0</span> &lt;= j % <span class="number">9</span> &lt;= <span class="number">2</span>:</span><br><span class="line">                        <span class="keyword">if</span> board[i][j] <span class="keyword">in</span> dict_boxes[<span class="number">0</span>]:</span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                        dict_boxes[<span class="number">0</span>][board[i][j]] = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">elif</span> <span class="number">3</span> &lt;= j % <span class="number">9</span> &lt;= <span class="number">5</span>:</span><br><span class="line">                        <span class="keyword">if</span> board[i][j] <span class="keyword">in</span> dict_boxes[<span class="number">1</span>]:</span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">False</span>                        </span><br><span class="line">                        dict_boxes[<span class="number">1</span>][board[i][j]] = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">elif</span> <span class="number">6</span> &lt;= j % <span class="number">9</span> &lt;= <span class="number">8</span>:</span><br><span class="line">                        <span class="keyword">if</span> board[i][j] <span class="keyword">in</span> dict_boxes[<span class="number">2</span>]:</span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">False</span>                        </span><br><span class="line">                        dict_boxes[<span class="number">2</span>][board[i][j]] = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>



<h3 id="Sum-of-Squares"><a href="#Sum-of-Squares" class="headerlink" title="Sum of Squares"></a><del>Sum of Squares</del></h3><h3 id="RM-Duplicate-from-Sorted-Linked-List"><a href="#RM-Duplicate-from-Sorted-Linked-List" class="headerlink" title="RM Duplicate from Sorted Linked List"></a>RM Duplicate from Sorted Linked List</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">deleteDuplicates</span><span class="params">(self, head: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head :</span><br><span class="line">            <span class="keyword">return</span> head</span><br><span class="line"></span><br><span class="line">        cur = head</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> cur.next:</span><br><span class="line">            <span class="keyword">if</span> cur.next.val == cur.val: <span class="comment"># TODO check cur.next</span></span><br><span class="line">                cur.next = cur.next.next</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur = cur.next</span><br><span class="line">        <span class="keyword">return</span> head</span><br></pre></td></tr></table></figure>



<h3 id="N-Queens"><a href="#N-Queens" class="headerlink" title="N-Queens"></a><del>N-Queens</del></h3><h3 id="Remove-One-Layer-of-Parentheses"><a href="#Remove-One-Layer-of-Parentheses" class="headerlink" title="Remove One Layer of Parentheses"></a><del>Remove One Layer of Parentheses</del></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">algo.</span></span><br><span class="line"><span class="string">( score+1</span></span><br><span class="line"><span class="string">) -1</span></span><br><span class="line"><span class="string">res = []</span></span><br><span class="line"><span class="string">if score == 0:</span></span><br><span class="line"><span class="string">    item.pop()</span></span><br><span class="line"><span class="string">    res.append(item[1:-1])</span></span><br><span class="line"><span class="string">return ''.join(res)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">removeOuterParentheses</span><span class="params">(self, S: str)</span> -&gt; str:</span></span><br><span class="line">        score = <span class="number">0</span></span><br><span class="line">        item = <span class="string">''</span></span><br><span class="line">        res = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(S)):</span><br><span class="line">            <span class="comment"># if S[j] == 0:</span></span><br><span class="line">            <span class="keyword">if</span> S[i] == <span class="string">'('</span>:</span><br><span class="line">                score += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> S[i] == <span class="string">')'</span>:</span><br><span class="line">                score -= <span class="number">1</span></span><br><span class="line">            item += S[i]    <span class="comment"># '(() ...'</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> score == <span class="number">0</span>:</span><br><span class="line">                res.append(item[<span class="number">1</span>:<span class="number">-1</span>])  <span class="comment"># NO OOR since slicing helps handle it</span></span><br><span class="line">                item = <span class="string">''</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join(res)</span><br></pre></td></tr></table></figure>



<h3 id="Count-Primes"><a href="#Count-Primes" class="headerlink" title="Count Primes"></a>Count Primes</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">0 1 2 3 4 5 6 7 8 9 10 11 </span></span><br><span class="line"><span class="string">x x v v   v   v         v</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">countPrimes</span><span class="params">(self, m: int)</span> -&gt; int:</span></span><br><span class="line">        n = m - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            </span><br><span class="line">        isPrime = [<span class="literal">None</span>] + [<span class="literal">None</span>] * n</span><br><span class="line">        isPrime[<span class="number">0</span>] = isPrime[<span class="number">1</span>] = <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, n+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> isPrime[i] == <span class="literal">None</span>:</span><br><span class="line">                isPrime[i] = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> range(i*<span class="number">2</span>, n+<span class="number">1</span>, i):</span><br><span class="line">                    isPrime[j] = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> sum(isPrime)</span><br></pre></td></tr></table></figure>



<h3 id="Inorder-Successor"><a href="#Inorder-Successor" class="headerlink" title="Inorder Successor"></a>Inorder Successor</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">      5</span></span><br><span class="line"><span class="string">    3     6</span></span><br><span class="line"><span class="string">   2  4 </span></span><br><span class="line"><span class="string">'''</span>    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># def __init__(self):</span></span><br><span class="line">        <span class="comment"># self.flag = False</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inorderSuccessor</span><span class="params">(self, root: <span class="string">'TreeNode'</span>, p: <span class="string">'TreeNode'</span>)</span> -&gt; 'TreeNode':</span> </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># self.result = []</span></span><br><span class="line"><span class="comment">#         self.helper(root, p, [])</span></span><br><span class="line">        <span class="keyword">return</span> self.helper(root, p.val)</span><br><span class="line"><span class="comment">#         if not self.result:</span></span><br><span class="line"><span class="comment">#             return None</span></span><br><span class="line"><span class="comment">#         else:</span></span><br><span class="line"><span class="comment">#             return self.result[0].val</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">          5</span></span><br><span class="line"><span class="string">        3     33</span></span><br><span class="line"><span class="string">       2  4     40</span></span><br><span class="line"><span class="string">               34</span></span><br><span class="line"><span class="string">                 36 v</span></span><br><span class="line"><span class="string">    '''</span>  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root, target)</span>:</span></span><br><span class="line">        cur = root</span><br><span class="line">        suc = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">while</span> cur:</span><br><span class="line">            <span class="comment"># suc = cur</span></span><br><span class="line">            <span class="keyword">if</span> target &gt; cur.val:</span><br><span class="line">                cur = cur.right</span><br><span class="line">            <span class="keyword">elif</span> target == cur.val:</span><br><span class="line">                cur = cur.right</span><br><span class="line">                <span class="comment"># if target == cur.val:</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                suc = cur</span><br><span class="line">                cur = cur.left</span><br><span class="line">        <span class="keyword">return</span> suc</span><br></pre></td></tr></table></figure>



<h3 id="Number-of-Connected-Components-in-an-Undirected-Graph"><a href="#Number-of-Connected-Components-in-an-Undirected-Graph" class="headerlink" title="Number of Connected Components in an Undirected Graph"></a>Number of Connected Components in an Undirected Graph</h3><h3 id="Split-BST"><a href="#Split-BST" class="headerlink" title="Split BST"></a>Split BST</h3><p>Ref: </p>
<ul>
<li><a href="https://www.coursera.org/lecture/data-structures/split-and-merge-22BgE" target="_blank" rel="noopener">https://www.coursera.org/lecture/data-structures/split-and-merge-22BgE</a></li>
<li><a href="https://leetcode.com/problems/split-bst/discuss/159985/Python-DFS-tm" target="_blank" rel="noopener">https://leetcode.com/problems/split-bst/discuss/159985/Python-DFS-tm</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">          4                 V == 2</span></span><br><span class="line"><span class="string">        /   \</span></span><br><span class="line"><span class="string">      2      6</span></span><br><span class="line"><span class="string">     / \    / \</span></span><br><span class="line"><span class="string">    1   3  5   7</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">splitBST</span><span class="params">(self, root: TreeNode, V: int)</span> -&gt; List[TreeNode]:</span></span><br><span class="line">        <span class="keyword">return</span> self.helper(root, V)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root, V)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root: </span><br><span class="line">            <span class="keyword">return</span> [<span class="literal">None</span>, <span class="literal">None</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> V &lt; root.val:</span><br><span class="line">            R1, R2 = self.helper(root.left, V)    <span class="comment"># keep splitting LHS, </span></span><br><span class="line">                                             <span class="comment"># R1 means LEFT, R2 means RIGHT</span></span><br><span class="line">                                             <span class="comment"># [2-&gt;1, 3]</span></span><br><span class="line">            <span class="comment"># Merge R1 and root.right with root </span></span><br><span class="line">            self.merge(R2, root.right, root)      <span class="comment"># [3 subtree, 657, 4]</span></span><br><span class="line">            <span class="keyword">return</span> [R1, root]                       <span class="comment"># [2, 4]</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">else</span>: <span class="comment"># V &gt;= root.val</span></span><br><span class="line">            R1, R2 = self.helper(root.right, V) <span class="comment"># if V==5 or 5.5 </span></span><br><span class="line">                                                <span class="comment"># [5, 6-&gt;7]</span></span><br><span class="line">            self.merge(root.left, R1, root)          <span class="comment"># [2 subtree, 5, 4]</span></span><br><span class="line">            <span class="keyword">return</span> [root, R2]                   <span class="comment"># [4, 6]</span></span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">merge</span><span class="params">(self, l, r, T)</span>:</span></span><br><span class="line">        T.left = l</span><br><span class="line">        T.right = r</span><br></pre></td></tr></table></figure>



<h3 id="Find-the-Closest-Points"><a href="#Find-the-Closest-Points" class="headerlink" title="Find the Closest Points"></a>Find the Closest Points</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kClosest</span><span class="params">(self, points: List[List[int]], K: int)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="comment"># return self.helper_heap_KlgK(points, K)</span></span><br><span class="line">        <span class="keyword">return</span> self.helper_Q_select(points, K)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper_Q_select</span><span class="params">(self, points, K)</span>:</span></span><br><span class="line">        dis = []</span><br><span class="line">        <span class="keyword">for</span> pt <span class="keyword">in</span> points:</span><br><span class="line">            dis.append(self.distance(pt, [<span class="number">0</span>,<span class="number">0</span>]))</span><br><span class="line">        </span><br><span class="line">        self.Q_select(dis, K, points) <span class="comment"># 0, len(dis)-1, K)</span></span><br><span class="line">        <span class="keyword">return</span> points[:K]</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Q_select</span><span class="params">(self, dis, K, points)</span>:</span></span><br><span class="line">        </span><br><span class="line">        l, r = <span class="number">0</span>, len(dis)<span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            meetup = self.partition(dis, l, r, points)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> meetup == K:</span><br><span class="line">                <span class="keyword">return</span> </span><br><span class="line">            <span class="keyword">elif</span> meetup &lt; K:</span><br><span class="line">                l = meetup + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r = meetup - <span class="number">1</span>        </span><br><span class="line">                </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partition</span><span class="params">(self, arr, low, high, points)</span>:</span></span><br><span class="line">        <span class="comment"># def swap(x, y):</span></span><br><span class="line">        <span class="comment">#     x, y = y, x</span></span><br><span class="line">            </span><br><span class="line">        i = low - <span class="number">1</span></span><br><span class="line">        pvt = arr[high]      </span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">              3    0 5 4 1 8 2 2</span></span><br><span class="line"><span class="string">        low              high </span></span><br><span class="line"><span class="string">        X    X X 2 Y Y Y Y </span></span><br><span class="line"><span class="string">               i         4   </span></span><br><span class="line"><span class="string">        # 0 1 2 2</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(low, high):</span><br><span class="line">            <span class="keyword">if</span> arr[j] &lt;= pvt:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">                arr[i], arr[j] = arr[j], arr[i]</span><br><span class="line">                points[i], points[j] = points[j], points[i]</span><br><span class="line">                <span class="comment"># swap(arr[j], arr[i])      # NO USE</span></span><br><span class="line">                <span class="comment"># swap(points[j], points[i])</span></span><br><span class="line">            </span><br><span class="line">        <span class="comment"># swap(arr[i+1], arr[high])</span></span><br><span class="line">        <span class="comment"># swap(points[i+1], points[high])</span></span><br><span class="line">        arr[i+<span class="number">1</span>], arr[high] = arr[high], arr[i+<span class="number">1</span>]</span><br><span class="line">        points[i+<span class="number">1</span>], points[high] = points[high], points[i+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> i+<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partitionX</span><span class="params">(self, arr, l, r, points)</span>:</span> <span class="comment"># 18, 26, 20</span></span><br><span class="line">        pvt = arr[l]</span><br><span class="line">        pvt_point = points[l]</span><br><span class="line">        i = l+<span class="number">1</span></span><br><span class="line">        j = r</span><br><span class="line">                    </span><br><span class="line">        <span class="keyword">while</span> i &lt; j:</span><br><span class="line">            <span class="string">'''</span></span><br><span class="line"><span class="string">               3 2 1 5 0 8 7 4   </span></span><br><span class="line"><span class="string">             pvt i i i</span></span><br><span class="line"><span class="string">                       j, </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">               3 2 1 0</span></span><br><span class="line"><span class="string">             pvt  </span></span><br><span class="line"><span class="string">                     i</span></span><br><span class="line"><span class="string">            '''</span>            </span><br><span class="line">            <span class="keyword">while</span> arr[i] &lt; pvt <span class="keyword">and</span> i &lt; j:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> arr[j] &gt; pvt <span class="keyword">and</span> i &lt; j:</span><br><span class="line">                j -= <span class="number">1</span></span><br><span class="line">            <span class="comment"># if i &lt; j:</span></span><br><span class="line">            <span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">                arr[i], arr[j] = arr[j], arr[i]</span><br><span class="line">                points[i], points[j] = points[j], points[i]</span><br><span class="line">                <span class="comment"># i += 1</span></span><br><span class="line">                <span class="comment"># j -= 1</span></span><br><span class="line">        <span class="comment"># arr[l], arr[i] = arr[i], pvt   # arr[l] WRONG!</span></span><br><span class="line">        <span class="comment"># points[l], points[i] = points[i], pvt_point   # arr[l] WRONG!</span></span><br><span class="line">        <span class="keyword">return</span> j</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper_heap_KlgK</span><span class="params">(self, points, K)</span>:</span>  <span class="comment"># should use max-heap since we pop out unwanted ones   </span></span><br><span class="line">        l = []</span><br><span class="line">        <span class="keyword">for</span> pt <span class="keyword">in</span> points:   <span class="comment"># O(N*lg(K))</span></span><br><span class="line">            <span class="comment"># heapq._heappush_max(l, (self.distance(pt, [0,0]), pt))</span></span><br><span class="line">            heapq.heappush(l, (<span class="number">-1</span>*self.distance(pt, [<span class="number">0</span>,<span class="number">0</span>]), pt))</span><br><span class="line">            <span class="keyword">if</span> len(l) == K+<span class="number">1</span>:</span><br><span class="line">                heapq.heappop(l)</span><br><span class="line">        </span><br><span class="line">        Q = deque()</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(l)):</span><br><span class="line">            _, pt = heapq.heappop(l)</span><br><span class="line">            Q.appendleft(pt)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> Q</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper_heap_NlgN</span><span class="params">(self, points, K)</span>:</span></span><br><span class="line">        </span><br><span class="line">        l = []</span><br><span class="line">        <span class="keyword">for</span> pt <span class="keyword">in</span> points:   <span class="comment"># O(N*lg(N))</span></span><br><span class="line">            <span class="comment"># l.append(self.distance(pt, [0,0]), pt)</span></span><br><span class="line">            heapq.heappush(l, (self.distance(pt, [<span class="number">0</span>,<span class="number">0</span>]), pt))</span><br><span class="line">            </span><br><span class="line">        ans = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(K):</span><br><span class="line">            _, pt = heapq.heappop(l)</span><br><span class="line">            ans.append(pt)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kClosest_old</span><span class="params">(self, points: List[List[int]], K: int)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="string">''' N*log(N)</span></span><br><span class="line"><span class="string">        # Q-sort tech</span></span><br><span class="line"><span class="string">        # [dis1, dis2, dis3]</span></span><br><span class="line"><span class="string">        if not points or not K:</span></span><br><span class="line"><span class="string">            return 0</span></span><br><span class="line"><span class="string">        l = []</span></span><br><span class="line"><span class="string">        for xy in points:</span></span><br><span class="line"><span class="string">            heapq.heappush(l, (self.distance(xy), xy[0], xy[1]))  # n*log(n)</span></span><br><span class="line"><span class="string">            # if len(l) &gt; K:</span></span><br><span class="line"><span class="string">            #     heapq._heappop_max(l)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        # map(points, self.distance)</span></span><br><span class="line"><span class="string">        # for point in points:</span></span><br><span class="line"><span class="string">        #     self.distance(point)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        res = []</span></span><br><span class="line"><span class="string">        for i in range(K):</span></span><br><span class="line"><span class="string">            dis, x, y = heapq.heappop(l)</span></span><br><span class="line"><span class="string">            res.append([x,y])</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">        return res</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        l = []</span><br><span class="line">        <span class="keyword">for</span> xy <span class="keyword">in</span> points:</span><br><span class="line">            dist = self.distance(xy)</span><br><span class="line">            dist = <span class="number">-1</span>*dist</span><br><span class="line">            <span class="keyword">if</span> len(l) &lt;= K<span class="number">-1</span>:</span><br><span class="line">                heapq.heappush(l, (dist, xy))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># print('---', dist)</span></span><br><span class="line">                <span class="keyword">if</span> dist &gt; l[<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    heapq.heappop(l)</span><br><span class="line">                    heapq.heappush(l, (dist, xy))</span><br><span class="line">                    </span><br><span class="line">        res = []</span><br><span class="line">        <span class="comment"># for i in range(len(l)):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(K):</span><br><span class="line">            res.append(heapq.heappop(l)[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">distance</span><span class="params">(self, xy, xy2=[<span class="number">0</span>,<span class="number">0</span>])</span>:</span></span><br><span class="line">        <span class="keyword">return</span> math.sqrt((xy[<span class="number">0</span>]-xy2[<span class="number">0</span>])**<span class="number">2</span> + (xy[<span class="number">1</span>]-xy2[<span class="number">1</span>])**<span class="number">2</span>)<span class="comment">#, xy[0], xy[1]</span></span><br></pre></td></tr></table></figure>

<p><strong>For Quick-Select Complexity Analysis</strong></p>
<ul>
<li>Time Complexity: <em>O</em>(<em>N</em>) in <em>average case</em> complexity, where <em>N</em> is the length of <code>points</code>., worst when O(N^2)</li>
<li>Space Complexity: <em>O</em>(<em>N</em>).</li>
</ul>
<h3 id="Duplicate-Subtrees"><a href="#Duplicate-Subtrees" class="headerlink" title="Duplicate Subtrees"></a>Duplicate Subtrees</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findDuplicateSubtrees</span><span class="params">(self, root: TreeNode)</span> -&gt; List[TreeNode]:</span></span><br><span class="line">        </span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        serialize each node in post order</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.mapping = defaultdict(int)</span><br><span class="line">        self.res = []</span><br><span class="line">        self.helper(root)</span><br><span class="line">        <span class="keyword">return</span> self.res</span><br><span class="line">        </span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">                1</span></span><br><span class="line"><span class="string">       /                    \</span></span><br><span class="line"><span class="string">      2 (2 (4 # #) #)         3</span></span><br><span class="line"><span class="string">     /          / \</span></span><br><span class="line"><span class="string">    4 (4 # #)      2   4</span></span><br><span class="line"><span class="string">                   /</span></span><br><span class="line"><span class="string">                  4 (4 # #)</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        <span class="comment"># post order </span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"#"</span></span><br><span class="line">        <span class="comment"># if not root.left and not root.right:</span></span><br><span class="line">            </span><br><span class="line">        </span><br><span class="line">        L = self.helper(root.left)</span><br><span class="line">        R = self.helper(root.right)</span><br><span class="line">        </span><br><span class="line">        pattern = <span class="string">"(&#123;&#125; &#123;&#125; &#123;&#125;)"</span>.format(root.val, L, R)</span><br><span class="line">        <span class="comment"># 4 # #</span></span><br><span class="line">        self.mapping[pattern] += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.mapping[pattern] == <span class="number">2</span>:</span><br><span class="line">            self.res += [root]    </span><br><span class="line">        <span class="keyword">return</span> pattern</span><br></pre></td></tr></table></figure>



<h3 id="K-Closest-Elements"><a href="#K-Closest-Elements" class="headerlink" title="K Closest Elements"></a>K Closest Elements</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findClosestElements</span><span class="params">(self, arr: List[int], k: int, x: int)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="comment"># use a max-heap to maintain </span></span><br><span class="line">        <span class="comment"># return self.helper_random_when_tie(arr, k, x)</span></span><br><span class="line">        <span class="keyword">return</span> self.helper(arr, k, x)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, arr, k, x)</span>:</span></span><br><span class="line">        num_rm = len(arr) - k</span><br><span class="line">        l, r = <span class="number">0</span>, len(arr)<span class="number">-1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(num_rm):</span><br><span class="line">            <span class="keyword">if</span> abs(arr[l]-x) &lt;= abs(arr[r]-x):</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> arr[l:r+<span class="number">1</span>]</span><br><span class="line">  ref: https://www.bilibili.com/video/av92867152?from=search&amp;seid=10589543388785979484</span><br></pre></td></tr></table></figure>



<h3 id="Index-of-Larger-Next-Number"><a href="#Index-of-Larger-Next-Number" class="headerlink" title="Index of Larger Next Number"></a>Index of Larger Next Number</h3><p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd2z6g4039j318i0r4h4c.jpg" alt="image-20200322202508690"></p>
<h3 id="Number-of-Meeting-Rooms"><a href="#Number-of-Meeting-Rooms" class="headerlink" title="Number of Meeting Rooms"></a>Number of Meeting Rooms</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">minMeetingRooms</span><span class="params">(self, intervals: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> intervals:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    arr = sorted(intervals, key=<span class="keyword">lambda</span> x: x[<span class="number">0</span>])</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    0   5   10.  15   20.  25.  30     </span></span><br><span class="line"><span class="string">    s.                           e </span></span><br><span class="line"><span class="string">        s    e</span></span><br><span class="line"><span class="string">                 s     e </span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    ends = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(arr)):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ends:</span><br><span class="line">            ends.append(arr[i][<span class="number">1</span>])</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">        <span class="comment"># can use while, to compare arr[i][0] with all ends, but we dont' have to store so manu </span></span><br><span class="line">        <span class="comment"># but if it's ends is sorted ACS, we can compare only once , so , use min-heap</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># if ends[0] &lt; arr[i][1]:</span></span><br><span class="line">            <span class="keyword">if</span> ends[<span class="number">0</span>] &lt;= arr[i][<span class="number">0</span>]:    </span><br><span class="line">                <span class="string">"""結束的那瞬間跟別人開始時一樣是OK的，第二組人馬還是可以用"""</span></span><br><span class="line">                <span class="comment"># count += 1</span></span><br><span class="line">                heapq.heapreplace(ends, arr[i][<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">                heapq.heappush(ends, arr[i][<span class="number">1</span>])</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> count</span><br></pre></td></tr></table></figure>

<h3 id="Primes"><a href="#Primes" class="headerlink" title="Primes"></a><del>Primes</del></h3><h3 id="Multiply-Strings"><a href="#Multiply-Strings" class="headerlink" title="Multiply Strings"></a>Multiply Strings</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">multiply</span><span class="params">(self, num1: str, num2: str)</span> -&gt; str:</span></span><br><span class="line">        a = self.string2num(num1)</span><br><span class="line">        b = self.string2num(num2)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> str(a*b)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">string2num</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        ret = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(n)):</span><br><span class="line">            digit = ord(n[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">            ret = <span class="number">10</span>*ret + digit</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure>



<h3 id="Remove-Adjacent-Duplicate-Characters"><a href="#Remove-Adjacent-Duplicate-Characters" class="headerlink" title="Remove Adjacent Duplicate Characters"></a>Remove Adjacent Duplicate Characters</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">removeDuplicates</span><span class="params">(self, S: str)</span> -&gt; str:</span></span><br><span class="line">        <span class="keyword">return</span> self.helper2(S)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper2</span><span class="params">(self, S)</span>:</span></span><br><span class="line">        <span class="comment"># if len(S)</span></span><br><span class="line">        tmp = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(S)):</span><br><span class="line">            <span class="keyword">if</span> tmp <span class="keyword">and</span> tmp[<span class="number">-1</span>] == S[i]:</span><br><span class="line">                tmp.pop()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tmp.append(S[i])</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span>.join(tmp)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">removeDuplicates</span><span class="params">(self, s: str, k: int)</span> -&gt; str:</span>  </span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>.join(self.helper(s, k))</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, s, k)</span>:</span></span><br><span class="line">        stack = [[<span class="string">'#'</span>, <span class="number">0</span>]]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">            <span class="keyword">if</span> stack[<span class="number">-1</span>][<span class="number">0</span>] != s[i]:</span><br><span class="line">                stack.append([s[i], <span class="number">1</span>])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># stack[-1] = [stack[-1][0], stack[-1][1]+1]</span></span><br><span class="line">                stack[<span class="number">-1</span>][<span class="number">1</span>] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> stack[<span class="number">-1</span>][<span class="number">1</span>] == k:</span><br><span class="line">                stack.pop()</span><br><span class="line">        res = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(stack)):</span><br><span class="line">            res += stack[j][<span class="number">0</span>] * stack[j][<span class="number">1</span>]</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="Common-Characters"><a href="#Common-Characters" class="headerlink" title="Common Characters"></a>Common Characters</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter, defaultdict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">commonChars</span><span class="params">(self, A: List[str])</span> -&gt; List[str]:</span></span><br><span class="line">        </span><br><span class="line">        c_maps = Counter(A[<span class="number">0</span>])</span><br><span class="line">        <span class="comment"># keys, values = c_maps.keys(), c_maps.values()</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(A)):</span><br><span class="line">            ret = defaultdict(int)</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(A[i])):</span><br><span class="line">                <span class="keyword">if</span> A[i][j] <span class="keyword">in</span> c_maps <span class="keyword">and</span> c_maps[A[i][j]] &gt; <span class="number">0</span>:</span><br><span class="line">                    ret[A[i][j]] += <span class="number">1</span></span><br><span class="line">                    c_maps[A[i][j]] -= <span class="number">1</span></span><br><span class="line">            c_maps = ret</span><br><span class="line">        </span><br><span class="line">        res = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> ret:</span><br><span class="line">            res += k * ret[k]</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> list(res)</span><br></pre></td></tr></table></figure>



<h3 id="Matrix-Transpose"><a href="#Matrix-Transpose" class="headerlink" title="Matrix Transpose"></a><del>Matrix Transpose</del></h3><h3 id="Convert-to-Hexadecimal"><a href="#Convert-to-Hexadecimal" class="headerlink" title="Convert to Hexadecimal"></a>Convert to Hexadecimal</h3><h3 id="Remove-Character-to-Create-Palindrome"><a href="#Remove-Character-to-Create-Palindrome" class="headerlink" title="Remove Character to Create Palindrome"></a>Remove Character to Create Palindrome</h3><p>==&gt; Turn into LCS if num of deletion is not limited</p>
<h3 id="Convert-Fraction-to-Decimal"><a href="#Convert-Fraction-to-Decimal" class="headerlink" title="Convert Fraction to Decimal"></a>Convert Fraction to Decimal</h3><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/27/Web/2020-02-27-Web%20GIS%20Go/">Web/2020-02-27-Web GIS Go</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-27</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/WebGIS/">WebGIS</a></span><div class="content"><p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcc9u69spxj31iw0u0e81.jpg" alt="image-20200228180339584"></p>
<h3 id="3rd-Party-Vendors-APIs"><a href="#3rd-Party-Vendors-APIs" class="headerlink" title="3rd Party Vendors APIs"></a>3rd Party Vendors APIs</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> geopy</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[s <span class="keyword">for</span> s <span class="keyword">in</span> dir(geopy.geocoders) <span class="keyword">if</span> s[<span class="number">0</span>].isupper()]</span><br><span class="line">[<span class="string">'ArcGIS'</span>, <span class="string">'AzureMaps'</span>, <span class="string">'BANFrance'</span>, <span class="string">'Baidu'</span>, <span class="string">'Bing'</span>, <span class="string">'DataBC'</span>, <span class="string">'GeoNames'</span>, <span class="string">'GeocodeEarth'</span>, <span class="string">'GeocodeFarm'</span>, <span class="string">'GeocoderNotFound'</span>, <span class="string">'Geolake'</span>, <span class="string">'GoogleV3'</span>, <span class="string">'Here'</span>, <span class="string">'IGNFrance'</span>, <span class="string">'LiveAddress'</span>, <span class="string">'MapBox'</span>, <span class="string">'Nominatim'</span>, <span class="string">'OpenCage'</span>, <span class="string">'OpenMapQuest'</span>, <span class="string">'Pelias'</span>, <span class="string">'Photon'</span>, <span class="string">'PickPoint'</span>, <span class="string">'SERVICE_TO_GEOCODER'</span>, <span class="string">'TomTom'</span>, <span class="string">'What3Words'</span>, <span class="string">'Yandex'</span>]</span><br><span class="line"><span class="comment"># ref: https://gnss.help/2019/10/20/geopy-introduce/index.html</span></span><br></pre></td></tr></table></figure>



<h3 id="Geocode-for-Location"><a href="#Geocode-for-Location" class="headerlink" title="Geocode for Location"></a>Geocode for Location</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> geopy.geocoders <span class="keyword">import</span> Nominatim</span><br><span class="line">geolocator = Nominatim(user_agent=<span class="string">"my-application"</span>)</span><br><span class="line"><span class="comment"># Nominatim 類為對 OpenStreetMap 服務的實現與封裝。</span></span><br><span class="line">location = geolocator.geocode(<span class="string">"台北101"</span>)</span><br><span class="line">print(location.address)</span><br><span class="line">print(location.latitude, location.longitude)</span><br><span class="line">print(location.raw)</span><br></pre></td></tr></table></figure>

<pre><code>台北101, 7, 信義路五段, 西村里, 臺北市, 信義區, 臺北市, 11049, Taiwan
25.03368625 121.56481033101315
{&apos;place_id&apos;: 131652329, &apos;licence&apos;: &apos;Data © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright&apos;, &apos;osm_type&apos;: &apos;way&apos;, &apos;osm_id&apos;: 198637969, &apos;boundingbox&apos;: [&apos;25.0333741&apos;, &apos;25.0339529&apos;, &apos;121.5644934&apos;, &apos;121.5651265&apos;], &apos;lat&apos;: &apos;25.03368625&apos;, &apos;lon&apos;: &apos;121.56481033101315&apos;, &apos;display_name&apos;: &apos;台北101, 7, 信義路五段, 西村里, 臺北市, 信義區, 臺北市, 11049, Taiwan&apos;, &apos;class&apos;: &apos;building&apos;, &apos;type&apos;: &apos;commercial&apos;, &apos;importance&apos;: 0.6234659627195251}</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location = geolocator.geocode(<span class="string">"麗山高中"</span>)</span><br><span class="line">print(location.address)</span><br><span class="line">print(location.latitude, location.longitude)</span><br><span class="line">print(location.raw)</span><br></pre></td></tr></table></figure>

<pre><code>麗山高中, 100, 環山路二段, 港富里, 內湖科技園區, 內湖區, 臺北市, 114, Taiwan
25.0852582 121.57789295239849
{&apos;place_id&apos;: 235790759, &apos;licence&apos;: &apos;Data © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright&apos;, &apos;osm_type&apos;: &apos;relation&apos;, &apos;osm_id&apos;: 4790964, &apos;boundingbox&apos;: [&apos;25.0839322&apos;, &apos;25.0865509&apos;, &apos;121.5765468&apos;, &apos;121.5789789&apos;], &apos;lat&apos;: &apos;25.0852582&apos;, &apos;lon&apos;: &apos;121.57789295239849&apos;, &apos;display_name&apos;: &apos;麗山高中, 100, 環山路二段, 港富里, 內湖科技園區, 內湖區, 臺北市, 114, Taiwan&apos;, &apos;class&apos;: &apos;amenity&apos;, &apos;type&apos;: &apos;school&apos;, &apos;importance&apos;: 0.41093879814957734, &apos;icon&apos;: &apos;https://nominatim.openstreetmap.org/images/mapicons/education_school.p.20.png&apos;}</code></pre><h3 id="Distance"><a href="#Distance" class="headerlink" title="Distance"></a>Distance</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from geopy.distance import vincenty</span></span><br><span class="line"><span class="keyword">from</span> geopy.distance <span class="keyword">import</span> distance, geodesic, great_circle</span><br><span class="line">oneOone = (<span class="number">25.03368625</span>, <span class="number">121.56481033101315</span>)</span><br><span class="line">home = (<span class="number">25.0852582</span>, <span class="number">121.57789295239849</span>)</span><br><span class="line">print(distance(oneOone, home))</span><br><span class="line">print(geodesic(oneOone, home))</span><br><span class="line">a = geodesic(oneOone, home)</span><br><span class="line">print(a.kilometers)</span><br><span class="line">print(great_circle(oneOone, home))    <span class="comment"># 0.5% Error, Quick, 1/20 of geodesic time</span></span><br></pre></td></tr></table></figure>

<pre><code>5.863348200787801 km
5.863348200787801 km
5.863348200787801
5.884012063917416 km</code></pre><h3 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">location = geolocator.reverse(<span class="string">"39.90733345,116.391244079988"</span>)</span><br><span class="line">print(location.address)</span><br></pre></td></tr></table></figure>

<p>天安门, 1, 西长安街, 北京市, 东城区, 北京市, 100010, China 中国</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line">print(json.dumps(location.raw, indent=<span class="number">4</span>, ensure_ascii=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"place_id"</span>: <span class="number">235962976</span>,</span><br><span class="line">    <span class="attr">"licence"</span>: <span class="string">"Data © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright"</span>,</span><br><span class="line">    <span class="attr">"osm_type"</span>: <span class="string">"relation"</span>,</span><br><span class="line">    <span class="attr">"osm_id"</span>: <span class="number">8847697</span>,</span><br><span class="line">    <span class="attr">"lat"</span>: <span class="string">"39.907359"</span>,</span><br><span class="line">    <span class="attr">"lon"</span>: <span class="string">"116.39126301779459"</span>,</span><br><span class="line">    <span class="attr">"display_name"</span>: <span class="string">"天安门, 1, 西长安街, 北京市, 东城区, 北京市, 100010, China 中国"</span>,</span><br><span class="line">    <span class="attr">"address"</span>: &#123;</span><br><span class="line">        <span class="attr">"address29"</span>: <span class="string">"天安门"</span>,</span><br><span class="line">        <span class="attr">"house_number"</span>: <span class="string">"1"</span>,</span><br><span class="line">        <span class="attr">"road"</span>: <span class="string">"西长安街"</span>,</span><br><span class="line">        <span class="attr">"city"</span>: <span class="string">"东城区"</span>,</span><br><span class="line">        <span class="attr">"state"</span>: <span class="string">"北京市"</span>,</span><br><span class="line">        <span class="attr">"postcode"</span>: <span class="string">"100010"</span>,</span><br><span class="line">        <span class="attr">"country"</span>: <span class="string">"China 中国"</span>,</span><br><span class="line">        <span class="attr">"country_code"</span>: <span class="string">"cn"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"boundingbox"</span>: [</span><br><span class="line">        <span class="string">"39.9071482"</span>,</span><br><span class="line">        <span class="string">"39.9075289"</span>,</span><br><span class="line">        <span class="string">"116.3905678"</span>,</span><br><span class="line">        <span class="string">"116.3919619"</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/27/jupyter-demo/2020-02-28-POI/">jupyter-demo/2020-02-28-POI</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-27</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Jupy-Demo/">Jupy-Demo</a></span><div class="content"><iframe src="https://nbviewer.jupyter.org/github/Joecth/Joecth.github.io/blob/hexo-melody/source/_posts/jupyter-demo/poi.ipynb" width="100%" height="1000"></iframe>



<h3 id="Binder"><a href="#Binder" class="headerlink" title="Binder:"></a>Binder:</h3><p><a href="https://hub.gke.mybinder.org/user/joecth-joecth.github.io-48awaq7m/notebooks/source/_posts/jupyter-demo/poi.ipynb" target="_blank" rel="noopener">https://hub.gke.mybinder.org/user/joecth-joecth.github.io-48awaq7m/notebooks/source/_posts/jupyter-demo/poi.ipynb</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/27/jupyter-demo/2020-02-28-GeoPy_testing/">jupyter-demo/2020-02-28-GeoPy_testing</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-27</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Jupy-Demo/">Jupy-Demo</a></span><div class="content"><h3 id="with-https-nbviewer-jupyter-org"><a href="#with-https-nbviewer-jupyter-org" class="headerlink" title="with https://nbviewer.jupyter.org/"></a>with <a href="https://nbviewer.jupyter.org/" target="_blank" rel="noopener">https://nbviewer.jupyter.org/</a></h3><iframe src="https://nbviewer.jupyter.org/github/Joecth/Joecth.github.io/blob/hexo-melody/source/_posts/jupyter-demo/geopy_testing.ipynb" width="100%" height="1000"></iframe>

<h3 id="Binder"><a href="#Binder" class="headerlink" title="Binder:"></a>Binder:</h3><p><a href="https://hub.gke.mybinder.org/user/joecth-joecth.github.io-ua8tv4g1/notebooks/source/_posts/jupyter-demo/geopy_testing.ipynb" target="_blank" rel="noopener">https://hub.gke.mybinder.org/user/joecth-joecth.github.io-ua8tv4g1/notebooks/source/_posts/jupyter-demo/geopy_testing.ipynb</a></p>
<hr>
<p>ref: <a href="https://www.dazhuanlan.com/2020/01/06/5e12cba50f56b/" target="_blank" rel="noopener">https://www.dazhuanlan.com/2020/01/06/5e12cba50f56b/</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/25/LC/2020-02-25-Codility%20demo%20record/">LC/2020-02-25-Codility demo record</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-25</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/LC/">LC</a></span><div class="content"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Counter  X</span></span><br><span class="line"><span class="string">if not ass: return </span></span><br><span class="line"><span class="string">if arr[-1] &lt; 1:</span></span><br><span class="line"><span class="string">    return 1</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">if diff &gt; 1:</span></span><br><span class="line"><span class="string">    return arr[perv] + 1</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">if i end loops :</span></span><br><span class="line"><span class="string">    return arr[-1] + 1   or</span></span><br><span class="line"><span class="string">    return arr[prev] + 1</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">sort</span></span><br><span class="line"><span class="string">    -2 -1 0 1 2 3 4     5</span></span><br><span class="line"><span class="string">                      prev    i</span></span><br><span class="line"><span class="string">                 diff &gt; 1!  </span></span><br><span class="line"><span class="string">                bk</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solution</span><span class="params">(A)</span>:</span></span><br><span class="line">    <span class="comment"># write your code in Python 3.6</span></span><br><span class="line">    <span class="comment"># pass</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> A:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> len(A) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> <span class="keyword">if</span> A[<span class="number">0</span>] &lt;= <span class="number">0</span> <span class="keyword">else</span> A[<span class="number">0</span>]+<span class="number">1</span></span><br><span class="line">        </span><br><span class="line">    arr = sorted(A, key=<span class="keyword">lambda</span> x: x)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> arr[<span class="number">-1</span>] &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    prev = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(arr)):    <span class="comment"># at least 2 elems here</span></span><br><span class="line">        <span class="keyword">if</span> arr[i] &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        diff = arr[i] - arr[prev]</span><br><span class="line">        <span class="keyword">if</span> diff &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> arr[prev] + <span class="number">1</span></span><br><span class="line">        prev = i</span><br><span class="line">    <span class="keyword">return</span> arr[prev] + <span class="number">1</span></span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/24/Musics/2020-02-24-N_Beats_Examples_and_ByteDance/">Musics/2020-02-24-N_Beats_Examples_and_ByteDance</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-24</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Music/">Music</a></span><div class="content"><h2 id="N-Beats-amp-Examples"><a href="#N-Beats-amp-Examples" class="headerlink" title="N Beats &amp; Examples"></a>N Beats &amp; Examples</h2><table>
<thead>
<tr>
<th>Beats</th>
<th>♩= Speed</th>
<th>Player</th>
<th>Music</th>
<th>Style</th>
</tr>
</thead>
<tbody><tr>
<td><strong><a href="#8Beats">8 Beats</a></strong></td>
<td>♩＝87</td>
<td>Cold Play</td>
<td>Yellow</td>
<td>另类摇滚</td>
</tr>
<tr>
<td></td>
<td>♩＝106</td>
<td>Green Day</td>
<td>Wake Me Up When September Ends</td>
<td><a name="rock"><strong>摇滚</strong></a></td>
</tr>
<tr>
<td></td>
<td>♩=128</td>
<td>Muse</td>
<td>Can’t Take My Eyes off You</td>
<td>前卫摇滚 (此外，这首被不同 Player 改成过很多种不同曲风及不同Beats, 经典)</td>
</tr>
<tr>
<td></td>
<td>♩＝125</td>
<td>Cranberry</td>
<td>Dreams</td>
<td>另类摇滚</td>
</tr>
<tr>
<td></td>
<td>♩＝82</td>
<td>Cranberry</td>
<td>Zombie</td>
<td>摇滚 + 民谣</td>
</tr>
<tr>
<td></td>
<td>♩＝74</td>
<td>MayDay</td>
<td>温柔</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩＝97</td>
<td>RHCP</td>
<td>Dani California</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩=126</td>
<td>Kylie Minoque</td>
<td>Can’t Get You Out of My Head</td>
<td>流行舞曲, Techno</td>
</tr>
<tr>
<td>(8 Beats, 但16也OK)</td>
<td>♩=100</td>
<td>Sixpence None the Richer</td>
<td>Kiss Me</td>
<td></td>
</tr>
<tr>
<td><strong><a href="#16Beats">16 Beats</a></strong></td>
<td>♩=95</td>
<td>Venessa Carlton</td>
<td>A Thousand Miles</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩=96</td>
<td>Natalie Imbruglia</td>
<td>Torn</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩=94</td>
<td>D’Sound</td>
<td>Play Me The Song</td>
<td>Fusion</td>
</tr>
<tr>
<td></td>
<td>♩=90</td>
<td>The Black Eyed Peas</td>
<td>Don’t Lie</td>
<td>舞曲, Pop, Rap</td>
</tr>
<tr>
<td></td>
<td>♩=94</td>
<td>Joss Stone</td>
<td>Super Duper Love</td>
<td></td>
</tr>
<tr>
<td>12 Beats</td>
<td>♩=120</td>
<td></td>
<td>小叮噹</td>
<td>Swing</td>
</tr>
<tr>
<td></td>
<td>♩＝147</td>
<td>西洋老歌</td>
<td>You Are My Sunshine</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩=66</td>
<td>Whitney Houston</td>
<td>Saving All My Love For You</td>
<td>Slow Rock; Jazz + Pop</td>
</tr>
<tr>
<td></td>
<td>♩=53</td>
<td>Gary Moore</td>
<td>Still Got The Blues</td>
<td>抒情蓝调</td>
</tr>
<tr>
<td>24 Beat</td>
<td>♩=89</td>
<td>Maroon5</td>
<td>Sunday Morning</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩=70</td>
<td>Westlife</td>
<td>Easy</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩=77</td>
<td>Macy Gary</td>
<td>I Try</td>
<td></td>
</tr>
</tbody></table>
<h3 id="4-4-拍："><a href="#4-4-拍：" class="headerlink" title="4/4 拍："></a><strong>4/4 拍：</strong></h3><ul>
<li><p><strong>4 Beats</strong> - 猪头,  1,     2,     3,     4</p>
</li>
<li><p><strong><a name="8Beats">8 Beats</a></strong> - 舞者，1n,     2n,     3n,     4n</p>
</li>
<li><p><strong><a name="16Beats">16 Beats</a></strong> - 鼓手, <strong><u>1</u></strong>234,     <u><strong>2</strong></u>234,     <strong><u>3</u></strong>234,     <u><strong>4</strong></u>234</p>
</li>
<li><p><strong><a name="24Beats">24 Beats</a></strong> </p>
</li>
</ul>
<h3 id="12-8-拍"><a href="#12-8-拍" class="headerlink" title="12/8 拍:"></a><strong>12/8 拍:</strong></h3><ul>
<li><strong>12 Beats</strong> - 像是 12/8 的音乐</li>
</ul>
<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><strong>Speed 60</strong></td>
<td>♩＝ 64</td>
<td>LeAnn Rimes</td>
<td>How Do I Live</td>
</tr>
<tr>
<td><strong>Speed 140</strong></td>
<td>♩＝ 135</td>
<td>Roxette</td>
<td>Sleeping In My Car</td>
</tr>
<tr>
<td><strong>Speed 160</strong></td>
<td>♩＝160</td>
<td>Lindsay</td>
<td>Ultimate</td>
</tr>
<tr>
<td></td>
<td>♩＝159</td>
<td>金亚中</td>
<td>Maria</td>
</tr>
<tr>
<td></td>
<td>♩＝154</td>
<td>中岛美嘉</td>
<td>Glamorous Sky</td>
</tr>
<tr>
<td><a href="#rock"><strong>摇滚补充</strong></a></td>
<td></td>
<td>Avril Lavigne</td>
<td>Complicated<br/>My happy ending, 8 beats, ♩= 85<br/>Take Me Away<br/>Together<br/>Nobodys home</td>
</tr>
</tbody></table>
<h2 id="抖音"><a href="#抖音" class="headerlink" title="抖音"></a>抖音</h2><table>
<thead>
<tr>
<th>Beats</th>
<th>程式算出的Beats数</th>
<th>♩= Speed</th>
<th>Player</th>
<th>Song</th>
<th></th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>8 Beats</td>
<td>4</td>
<td>♩＝89</td>
<td>阿冗</td>
<td><strong>你的答案</strong></td>
<td></td>
<td>向着风，拥抱彩虹，勇敢的向前走</td>
</tr>
<tr>
<td>8 Beats</td>
<td>8</td>
<td>♩＝66</td>
<td>程响</td>
<td>世界这么大还是遇见你</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats or Single 16 Beats</td>
<td>8</td>
<td>♩＝66</td>
<td>司南</td>
<td>冬眠</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>4</td>
<td>♩＝128</td>
<td>R3hab</td>
<td>All Comes Back to You</td>
<td>电子舞曲</td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>4</td>
<td>♩＝110</td>
<td>Zico</td>
<td>Any Song (아무노래)</td>
<td>舞曲吧… 这首很特别</td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>4</td>
<td>♩＝100</td>
<td>阿悠悠</td>
<td>你若三冬</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>4</td>
<td>♩＝80</td>
<td>要不要买菜</td>
<td>下山</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>8</td>
<td>♩＝81</td>
<td>锦零</td>
<td>桃花笑</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>这个我重听</td>
<td>♩＝120</td>
<td>罗隽永</td>
<td>处处吻</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>8</td>
<td>♩＝66</td>
<td>八三夭</td>
<td><strong>想见你想见你想见你</strong></td>
<td>抒情</td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>4</td>
<td>♩＝90</td>
<td>孫子涵</td>
<td>是你啊</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>8</td>
<td>♩＝72</td>
<td>棉子</td>
<td>勇气</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>未跑</td>
<td>♩＝79</td>
<td>张韶涵</td>
<td>红红的太阳</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>8</td>
<td>♩＝66</td>
<td>王二浪</td>
<td><strong>往后余生</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td></td>
<td>♩＝120</td>
<td>卢鑫玉浩</td>
<td>今天我要戴口罩</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td></td>
<td>♩＝108</td>
<td>Mesto</td>
<td>Leyla (Official Music Video)</td>
<td>舞曲/电子</td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td></td>
<td>♩＝83</td>
<td>李昕融</td>
<td>听我说谢谢你</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td></td>
<td>♩＝81</td>
<td>李超</td>
<td>不放弃</td>
<td></td>
<td></td>
</tr>
<tr>
<td>More</td>
<td></td>
<td>More</td>
<td>More</td>
<td>More</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>我猜程式会跑出8Beats</td>
<td>♩＝70</td>
<td>柏松</td>
<td>世界美好与你环环相扣</td>
<td>抒情</td>
<td></td>
</tr>
<tr>
<td></td>
<td>我猜程式会跑出8Beats</td>
<td>♩＝80</td>
<td>林俊杰</td>
<td>可惜没如果</td>
<td>流行</td>
<td></td>
</tr>
<tr>
<td></td>
<td>我猜程式会跑出4Beats</td>
<td>♩＝123</td>
<td></td>
<td>无中生有</td>
<td>舞曲</td>
<td></td>
</tr>
<tr>
<td></td>
<td>我猜程式会跑出8Beats</td>
<td>♩＝53</td>
<td>张宇</td>
<td>囚鸟</td>
<td>流行</td>
<td></td>
</tr>
<tr>
<td></td>
<td>我猜程式会跑出4Beats</td>
<td>♩＝68</td>
<td>柏松</td>
<td>器张</td>
<td>抒情</td>
<td></td>
</tr>
</tbody></table>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/21/LC/Pandas/2015-02-21-Pandas%20review/">LC/Pandas/2015-02-21-Pandas review</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-21</time><div class="content"><h4 id="layout-post"><a href="#layout-post" class="headerlink" title="layout: post"></a>layout: post</h4><p>categories: Pandas<br>tag: []<br>date: 2015-02-21</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;</span><br><span class="line">  <span class="string">'Product ID'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">  <span class="comment"># add Product Name and Color here</span></span><br><span class="line">  <span class="string">'Product Name'</span>:[<span class="string">'t-shirt'</span>, <span class="string">'t-shirt'</span>, <span class="string">'skirt'</span>, <span class="string">'skirt'</span>], </span><br><span class="line">  <span class="string">'Color'</span>:[<span class="string">'blue'</span>, <span class="string">'green'</span>, <span class="string">'red'</span>, <span class="string">'black'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4f7b94uej30py09qdg6.jpg" alt="image-20200221230441471" style="zoom:50%;" />

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df2 = pd.DataFrame([</span><br><span class="line">  [<span class="number">1</span>, <span class="string">'San Diego'</span>, <span class="number">100</span>],</span><br><span class="line">  [<span class="number">2</span>, <span class="string">'Los Angeles'</span>, <span class="number">120</span>],</span><br><span class="line">  <span class="comment"># Fill in rows 3 and 4</span></span><br><span class="line">  [<span class="number">3</span>, <span class="string">'San Francisco'</span>, <span class="number">90</span>],</span><br><span class="line">  [<span class="number">4</span>, <span class="string">'Sacramento'</span>, <span class="number">115</span>],</span><br><span class="line">],</span><br><span class="line">  columns=[</span><br><span class="line">    <span class="comment">#add column names here</span></span><br><span class="line">    <span class="string">'Store ID'</span>, <span class="string">'Location'</span>, <span class="string">'Number of Employees'</span></span><br><span class="line">  ])</span><br><span class="line"></span><br><span class="line">print(df2)</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4f7o819gj30pw0a8q3d.jpg" alt="image-20200221230502087" style="zoom: 50%;" />





<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4fgr9zz2j30xj0u0n2t.jpg" alt="image-20200221231348325" style="zoom:67%;" />



<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4flj5cvgj319q0ru44j.jpg" alt="image-20200221231823180" style="zoom:67%;" />

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">march = df.iloc[<span class="number">2</span>]	<span class="comment"># single row</span></span><br><span class="line">april_may_june = df.iloc[<span class="number">3</span>:<span class="number">6</span>]	<span class="comment"># multi row</span></span><br><span class="line">january = df[df.month == <span class="string">'January'</span>] <span class="comment"># condition, single row</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">month</th>
<th align="left">clinic_east</th>
<th align="left">clinic_north</th>
<th align="left">clinic_south</th>
<th>clinic_west</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">January</td>
<td align="left">100</td>
<td align="left">100</td>
<td align="left">23</td>
<td>100</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame([</span><br><span class="line">  [<span class="string">'January'</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">23</span>, <span class="number">100</span>],</span><br><span class="line">  [<span class="string">'February'</span>, <span class="number">51</span>, <span class="number">45</span>, <span class="number">145</span>, <span class="number">45</span>],</span><br><span class="line">  [<span class="string">'March'</span>, <span class="number">81</span>, <span class="number">96</span>, <span class="number">65</span>, <span class="number">96</span>],</span><br><span class="line">  [<span class="string">'April'</span>, <span class="number">80</span>, <span class="number">80</span>, <span class="number">54</span>, <span class="number">180</span>],</span><br><span class="line">  [<span class="string">'May'</span>, <span class="number">51</span>, <span class="number">54</span>, <span class="number">54</span>, <span class="number">154</span>],</span><br><span class="line">  [<span class="string">'June'</span>, <span class="number">112</span>, <span class="number">109</span>, <span class="number">79</span>, <span class="number">129</span>]],</span><br><span class="line">  columns=[<span class="string">'month'</span>, <span class="string">'clinic_east'</span>,</span><br><span class="line">           <span class="string">'clinic_north'</span>, <span class="string">'clinic_south'</span>,</span><br><span class="line">           <span class="string">'clinic_west'</span>])</span><br><span class="line"></span><br><span class="line">march_april = df[(df.month == <span class="string">'March'</span>) | (df.month == <span class="string">'April'</span>)]</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">month</th>
<th align="left">clinic_east</th>
<th align="left">clinic_north</th>
<th align="left">clinic_south</th>
<th align="left">clinic_west</th>
</tr>
</thead>
<tbody><tr>
<td align="left">2</td>
<td align="left">March</td>
<td align="left">81</td>
<td align="left">96</td>
<td align="left">65</td>
<td align="left">96</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">April</td>
<td align="left">80</td>
<td align="left">80</td>
<td align="left">54</td>
<td align="left">180</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">january_february_march = df[df.month.isin([<span class="string">'January'</span>, <span class="string">'February'</span>, <span class="string">'March'</span>])]</span><br><span class="line">print(january_february_march)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">month</th>
<th align="left">clinic_east</th>
<th align="left">clinic_north</th>
<th align="left">clinic_south</th>
<th>clinic_west</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">January</td>
<td align="left">100</td>
<td align="left">100</td>
<td align="left">23</td>
<td>100</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">February</td>
<td align="left">51</td>
<td align="left">45</td>
<td align="left">145</td>
<td>45</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">March</td>
<td align="left">81</td>
<td align="left">96</td>
<td align="left">65</td>
<td>96</td>
</tr>
</tbody></table>
<h3 id="setting-indices"><a href="#setting-indices" class="headerlink" title="setting indices"></a>setting indices</h3><table>
<thead>
<tr>
<th align="left"></th>
<th align="left">month</th>
<th align="left">clinic_east</th>
<th align="left">clinic_north</th>
<th align="left">clinic_south</th>
<th>clinic_west</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">February</td>
<td align="left">51</td>
<td align="left">45</td>
<td align="left">145</td>
<td>45</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">April</td>
<td align="left">80</td>
<td align="left">80</td>
<td align="left">54</td>
<td>180</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">June</td>
<td align="left">112</td>
<td align="left">109</td>
<td align="left">79</td>
<td>129</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df2 = df.loc[[<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(df2)</span></span><br><span class="line"></span><br><span class="line">df3 = df2.reset_index()</span><br><span class="line"></span><br><span class="line">print(df3)</span><br><span class="line"></span><br><span class="line">df2.reset_index(inplace = <span class="literal">True</span>, drop = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">print(df2)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">index</th>
<th align="left">month</th>
<th align="left">clinic_east</th>
<th align="left">clinic_north</th>
<th align="left">clinic_south</th>
<th align="left">clinic_west</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">February</td>
<td align="left">51</td>
<td align="left">45</td>
<td align="left">145</td>
<td align="left">45</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">3</td>
<td align="left">April</td>
<td align="left">80</td>
<td align="left">80</td>
<td align="left">54</td>
<td align="left">180</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">5</td>
<td align="left">June</td>
<td align="left">112</td>
<td align="left">109</td>
<td align="left">79</td>
<td align="left">129</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">month</th>
<th align="left">clinic_east</th>
<th align="left">clinic_north</th>
<th align="left">clinic_south</th>
<th align="left">clinic_west</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">February</td>
<td align="left">51</td>
<td align="left">45</td>
<td align="left">145</td>
<td align="left">45</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">April</td>
<td align="left">80</td>
<td align="left">80</td>
<td align="left">54</td>
<td align="left">180</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">June</td>
<td align="left">112</td>
<td align="left">109</td>
<td align="left">79</td>
<td align="left">129</td>
</tr>
</tbody></table>
<h2 id="Case-ShoeFly-com"><a href="#Case-ShoeFly-com" class="headerlink" title="Case : ShoeFly.com"></a>Case : ShoeFly.com</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">orders = pd.read_csv(<span class="string">'shoefly.csv'</span>)</span><br><span class="line">print(orders.iloc([:<span class="number">5</span>]))  <span class="comment"># check first 5 lines</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">id</th>
<th align="left">first_name</th>
<th align="left">last_name</th>
<th align="left">email</th>
<th align="left">shoe_type</th>
<th align="left">shoe_material</th>
<th align="left">shoe_color</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">54791</td>
<td align="left">Rebecca</td>
<td align="left">Lindsay</td>
<td align="left"><a href="mailto:RebeccaLindsay57@hotmail.com">RebeccaLindsay57@hotmail.com</a></td>
<td align="left">clogs</td>
<td align="left">faux-leather</td>
<td>black</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">53450</td>
<td align="left">Emily</td>
<td align="left">Joyce</td>
<td align="left"><a href="mailto:EmilyJoyce25@gmail.com">EmilyJoyce25@gmail.com</a></td>
<td align="left">ballet flats</td>
<td align="left">faux-leather</td>
<td>navy</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">91987</td>
<td align="left">Joyce</td>
<td align="left">Waller</td>
<td align="left"><a href="mailto:Joyce.Waller@gmail.com">Joyce.Waller@gmail.com</a></td>
<td align="left">sandals</td>
<td align="left">fabric</td>
<td>black</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">14437</td>
<td align="left">Justin</td>
<td align="left">Erickson</td>
<td align="left"><a href="mailto:Justin.Erickson@outlook.com">Justin.Erickson@outlook.com</a></td>
<td align="left">clogs</td>
<td align="left">faux-leather</td>
<td>red</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">79357</td>
<td align="left">Andrew</td>
<td align="left">Banks</td>
<td align="left"><a href="mailto:AB4318@gmail.com">AB4318@gmail.com</a></td>
<td align="left">boots</td>
<td align="left">leather</td>
<td>brown</td>
</tr>
</tbody></table>
<h3 id="Review"><a href="#Review" class="headerlink" title="Review"></a>Review</h3><p>You’ve completed the lesson! You’ve just learned the basics of working with a single table in Pandas, including:</p>
<ul>
<li>Create a table from scratch</li>
<li>Loading data from another file</li>
<li>Selecting certain rows or columns of a table</li>
</ul>
<p>Let’s practice what you’ve learned.</p>
<p>Instructions</p>
<p><strong>1.</strong></p>
<p>In this example, you’ll be the data analyst for ShoeFly.com, a fictional online shoe store. You’ve seen this data; now it’s your turn to work with it!</p>
<p>Load the data from <code>shoefly.csv</code> into the variable <code>orders</code>.</p>
<p>Hint</p>
<p>You’ll need to use <code>pd.read_csv</code>.</p>
<p><strong>2.</strong></p>
<p>Inspect the first 5 lines of the data.</p>
<p>Stuck? Get a hint</p>
<p><strong>3.</strong></p>
<p>Your marketing department wants to send out an email blast to everyone who ordered shoes!</p>
<p>Select all of the email addresses from the column <code>email</code> and save them to a variable called <code>emails</code>.</p>
<p>Stuck? Get a hint</p>
<p><strong>4.</strong></p>
<p>Frances Palmer claims that her order was wrong. What did Frances Palmer order?</p>
<p>Use logic to select that row of <code>orders</code> and save it to the variable <code>frances_palmer</code>.</p>
<p>Stuck? Get a hint</p>
<p><strong>5.</strong></p>
<p>We need some customer reviews for our comfortable shoes. Select all orders for <code>shoe_type</code>: <code>clogs</code>, <code>boots</code>, and <code>ballet flats</code> and save them to the variable <code>comfy_shoes</code>.</p>
<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4gjxbp5vj32380sin7i.jpg" alt="image-20200221235121135"></p>
<h2 id="Case-2"><a href="#Case-2" class="headerlink" title="Case 2:"></a>Case 2:</h2><p>Use the lambda function <code>get_last_name</code> to create a new column <code>last_name</code> with only the employees’ last name.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add columns here</span></span><br><span class="line">get_last_name = <span class="keyword">lambda</span> s: s.split()[<span class="number">-1</span>]</span><br><span class="line">df[<span class="string">'last_name'</span>] = df.name.apply(get_last_name)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">id</th>
<th align="left">name</th>
<th align="left">hourly_wage</th>
<th align="left">hours_worked</th>
<th>last_name</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">10310</td>
<td align="left">Lauren Durham</td>
<td align="left">19</td>
<td align="left">43</td>
<td>Durham</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">18656</td>
<td align="left">Grace Sellers</td>
<td align="left">17</td>
<td align="left">40</td>
<td>Sellers</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">61254</td>
<td align="left">Shirley Rasmussen</td>
<td align="left">16</td>
<td align="left">30</td>
<td>Rasmussen</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">16886</td>
<td align="left">Brian Rojas</td>
<td align="left">18</td>
<td align="left">47</td>
<td>Rojas</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">89010</td>
<td align="left">Samantha Mosley</td>
<td align="left">11</td>
<td align="left">38</td>
<td>Mosley</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">87246</td>
<td align="left">Louis Guzman</td>
<td align="left">14</td>
<td align="left">39</td>
<td>Guzman</td>
</tr>
</tbody></table>
<p>花俏。。，但就熟悉下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">total_earned = <span class="keyword">lambda</span> row: (row.hourly_wage * <span class="number">40</span>) + ((row.hourly_wage * <span class="number">1.5</span>) * (row.hours_worked - <span class="number">40</span>)) \</span><br><span class="line">	<span class="keyword">if</span> row.hours_worked &gt; <span class="number">40</span> \</span><br><span class="line">  <span class="keyword">else</span> row.hourly_wage * row.hours_worked</span><br><span class="line">  </span><br><span class="line">df[<span class="string">'total_earned'</span>] = df.apply(total_earned, axis = <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">id</th>
<th align="left">name</th>
<th align="left">hourly_wage</th>
<th align="left">hours_worked</th>
<th align="left">total_earned</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">10310</td>
<td align="left">Lauren Durham</td>
<td align="left">19</td>
<td align="left">43</td>
<td align="left">845.5</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">18656</td>
<td align="left">Grace Sellers</td>
<td align="left">17</td>
<td align="left">40</td>
<td align="left">680.0</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">61254</td>
<td align="left">Shirley Rasmussen</td>
<td align="left">16</td>
<td align="left">30</td>
<td align="left">480.0</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">16886</td>
<td align="left">Brian Rojas</td>
<td align="left">18</td>
<td align="left">47</td>
<td align="left">909.0</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">89010</td>
<td align="left">Samantha Mosley</td>
<td align="left">11</td>
<td align="left">38</td>
<td align="left">418.0</td>
</tr>
</tbody></table>
<h3 id="rename-column"><a href="#rename-column" class="headerlink" title="rename column"></a>rename column</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df.rename(columns=&#123;</span><br><span class="line">  <span class="string">'name'</span>: <span class="string">'movie_title'</span></span><br><span class="line">  &#125;, </span><br><span class="line">  inplace=<span class="literal">True</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>



<h2 id="Case-ShoeFly-com-1"><a href="#Case-ShoeFly-com-1" class="headerlink" title="Case ShoeFly.com"></a>Case ShoeFly.com</h2><h4 id="Add-Columns"><a href="#Add-Columns" class="headerlink" title="Add Columns"></a>Add Columns</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">orders[<span class="string">'shoe_source'</span>] = orders.shoe_material.apply(<span class="keyword">lambda</span> x: \</span><br><span class="line">                        	<span class="string">'animal'</span> <span class="keyword">if</span> x == <span class="string">'leather'</span><span class="keyword">else</span> <span class="string">'vegan'</span>)</span><br><span class="line"></span><br><span class="line">orders[<span class="string">'salutation'</span>] = orders.apply(<span class="keyword">lambda</span> row: \</span><br><span class="line">                                    <span class="string">'Dear Mr. '</span> + row[<span class="string">'last_name'</span>]</span><br><span class="line">                                    <span class="keyword">if</span> row[<span class="string">'gender'</span>] == <span class="string">'male'</span></span><br><span class="line">                                    <span class="keyword">else</span> <span class="string">'Dear Ms. '</span> + row[<span class="string">'last_name'</span>],</span><br><span class="line">                                    axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>



<h4 id="Pedal-Inventory"><a href="#Pedal-Inventory" class="headerlink" title="Pedal Inventory"></a>Pedal Inventory</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> codecademylib</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">inventory = pd.read_csv(<span class="string">'inventory.csv'</span>)</span><br><span class="line">print(inventory.head(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">staten_island = inventory[inventory[<span class="string">'location'</span>] == <span class="string">'Staten Island'</span>]</span><br><span class="line">print(staten_island.head(<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">product_request = staten_island[<span class="string">'product_description'</span>]</span><br><span class="line">print(product_request.head(<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">seed_request = inventory[(inventory.location == <span class="string">'Brooklyn'</span>) &amp; (inventory.product_type == <span class="string">'seeds'</span>)]</span><br><span class="line">print(seed_request.head(<span class="number">4</span>))</span><br><span class="line"><span class="comment"># print(inventory[inventory['location'] == 'Brooklyn' and inventory.product_type == 'seeds'])</span></span><br><span class="line"></span><br><span class="line">inventory[<span class="string">'in_stock'</span>] = inventory.quantity.apply(<span class="keyword">lambda</span> val: <span class="literal">True</span> <span class="keyword">if</span> val &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">False</span>)</span><br><span class="line">print(inventory.head(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">inventory[<span class="string">'total_value'</span>] = inventory.apply(<span class="keyword">lambda</span> row: row.price * row.quantity, axis=<span class="number">1</span>)</span><br><span class="line">print(inventory.head(<span class="number">7</span>))</span><br><span class="line"></span><br><span class="line">combine_lambda = <span class="keyword">lambda</span> row: \</span><br><span class="line">    <span class="string">'&#123;&#125; - &#123;&#125;'</span>.format(row.product_type,</span><br><span class="line">                     row.product_description)</span><br><span class="line"></span><br><span class="line">inventory[<span class="string">'full_description'</span>] = inventory.apply(combine_lambda,</span><br><span class="line">                                               axis=<span class="number">1</span>)</span><br><span class="line">print(inventory.head(<span class="number">9</span>))</span><br></pre></td></tr></table></figure>



</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/21/LC/2020-02-22-LC%20SQL%20Easy/">LC/2020-02-22-LC SQL Easy</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/LC/">LC</a></span><div class="content"><h4 id="175-Combine-Two-Tables"><a href="#175-Combine-Two-Tables" class="headerlink" title="175. Combine Two Tables"></a>175. Combine Two Tables</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| PersonId    | int     |</span><br><span class="line">| FirstName   | varchar |</span><br><span class="line">| LastName    | varchar |</span><br><span class="line">+-------------+---------+</span><br><span class="line">PersonId is the primary key column for this table.</span><br></pre></td></tr></table></figure>

<p>Table: <code>Address</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| AddressId   | int     |</span><br><span class="line">| PersonId    | int     |</span><br><span class="line">| City        | varchar |</span><br><span class="line">| State       | varchar |</span><br><span class="line">+-------------+---------+</span><br><span class="line">AddressId is the primary key column for this table.</span><br></pre></td></tr></table></figure>

<p>Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for each of those people:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> FirstName, LastName, City, State</span><br><span class="line"><span class="keyword">FROM</span> Person </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Address</span><br><span class="line"><span class="keyword">ON</span> Person.PersonId = Address.PersonId</span><br></pre></td></tr></table></figure>



<h4 id="176-Second-Highest-Salary"><a href="#176-Second-Highest-Salary" class="headerlink" title="176. Second Highest Salary"></a>176. Second Highest Salary</h4><p>For example, given the above Employee table, the query should return <code>200</code> as the second highest salary. If there is no second highest salary, then the query should return <code>null</code>.</p>
<p>Write a SQL query to get the second highest salary from the <code>Employee</code> table.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+----+--------+</span><br><span class="line">| Id | Salary |</span><br><span class="line">+----+--------+</span><br><span class="line">| 1  | 100    |</span><br><span class="line">| 2  | 200    |</span><br><span class="line">| 3  | 300    |</span><br><span class="line">+----+--------+</span><br></pre></td></tr></table></figure>

<p>For example, given the above Employee table, the query should return <code>200</code> as the second highest salary. If there is no second highest salary, then the query should return <code>null</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+---------------------+</span><br><span class="line">| SecondHighestSalary |</span><br><span class="line">+---------------------+</span><br><span class="line">| 200                 |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(a.Salary) <span class="keyword">AS</span> SecondHighestSalary</span><br><span class="line"><span class="keyword">FROM</span> Employee <span class="keyword">AS</span> a</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> Employee <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">ON</span> a.Salary &lt; b.Salary</span><br></pre></td></tr></table></figure>



<h4 id="181-Employees-Earning-More-Than-Their-Managers"><a href="#181-Employees-Earning-More-Than-Their-Managers" class="headerlink" title="181. Employees Earning More Than Their Managers"></a>181. Employees Earning More Than Their Managers</h4><p>The <code>Employee</code> table holds all employees including their managers. Every employee has an Id, and there is also a column for the manager Id.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+--------+-----------+</span><br><span class="line">| Id | Name  | Salary | ManagerId |</span><br><span class="line">+----+-------+--------+-----------+</span><br><span class="line">| 1  | Joe   | 70000  | 3         |</span><br><span class="line">| 2  | Henry | 80000  | 4         |</span><br><span class="line">| 3  | Sam   | 60000  | NULL      |</span><br><span class="line">| 4  | Max   | 90000  | NULL      |</span><br><span class="line">+----+-------+--------+-----------+</span><br></pre></td></tr></table></figure>

<p>Given the <code>Employee</code> table, write a SQL query that finds out employees who earn more than their managers. For the above table, Joe is the only employee who earns more than his manager.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+----------+</span><br><span class="line">| Employee |</span><br><span class="line">+----------+</span><br><span class="line">| Joe      |</span><br><span class="line">+----------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> tb1.Name <span class="keyword">AS</span> Employee</span><br><span class="line"><span class="keyword">FROM</span> Employee <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> Employee <span class="keyword">as</span> tb2</span><br><span class="line"><span class="keyword">on</span> tb1.ManagerId = tb2.Id</span><br><span class="line"><span class="keyword">where</span> tb1.Salary &gt; tb2.Salary</span><br></pre></td></tr></table></figure>



<h4 id="182-Duplicate-Emails"><a href="#182-Duplicate-Emails" class="headerlink" title="182. Duplicate Emails"></a>182. Duplicate Emails</h4><p>Write a SQL query to find all duplicate emails in a table named <code>Person</code>.</p>
<p>For example, your query should return the following for the above table:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+---------+</span><br><span class="line">| Email   |</span><br><span class="line">+---------+</span><br><span class="line">| a@b.com |</span><br><span class="line">+---------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Email <span class="comment">#, COUNT(Email)</span></span><br><span class="line"><span class="keyword">FROM</span> Person</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Email</span><br><span class="line"><span class="comment"># ORDER BY COUNT(Email)</span></span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(Email) &gt; <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h4 id="183-Customers-Who-Never-Order"><a href="#183-Customers-Who-Never-Order" class="headerlink" title="183. Customers Who Never Order"></a>183. Customers Who Never Order</h4><p>Suppose that a website contains two tables, the <code>Customers</code> table and the <code>Orders</code> table. Write a SQL query to find all customers who never order anything.</p>
<p>Table: <code>Customers</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+</span><br><span class="line">| Id | Name  |</span><br><span class="line">+----+-------+</span><br><span class="line">| 1  | Joe   |</span><br><span class="line">| 2  | Henry |</span><br><span class="line">| 3  | Sam   |</span><br><span class="line">| 4  | Max   |</span><br><span class="line">+----+-------+</span><br></pre></td></tr></table></figure>

<p>Table: <code>Orders</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+----+------------+</span><br><span class="line">| Id | CustomerId |</span><br><span class="line">+----+------------+</span><br><span class="line">| 1  | 3          |</span><br><span class="line">| 2  | 1          |</span><br><span class="line">+----+------------+</span><br></pre></td></tr></table></figure>

<p>Using the above tables as example, return the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+-----------+</span><br><span class="line">| Customers |</span><br><span class="line">+-----------+</span><br><span class="line">| Henry     |</span><br><span class="line">| Max       |</span><br><span class="line">+-----------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> tb1.Name <span class="keyword">AS</span> Customers</span><br><span class="line"><span class="keyword">from</span> Customers <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Orders </span><br><span class="line"><span class="keyword">ON</span> tb1.Id = Orders.CustomerId</span><br><span class="line"><span class="keyword">WHERE</span> Orders.CustomerId <span class="keyword">is</span> <span class="literal">NULL</span></span><br></pre></td></tr></table></figure>



<h4 id="196-Delete-Duplicate-Emails"><a href="#196-Delete-Duplicate-Emails" class="headerlink" title="196. Delete Duplicate Emails"></a>196. Delete Duplicate Emails</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> p1</span><br><span class="line"><span class="keyword">FROM</span> Person p1</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> Person p2</span><br><span class="line"><span class="keyword">WHERE</span> p1.Email = p2.Email</span><br><span class="line">	<span class="keyword">AND</span> p1.Id &gt; p2.Id;</span><br></pre></td></tr></table></figure>



<h4 id="197"><a href="#197" class="headerlink" title="197."></a>197.</h4><h4 id="511"><a href="#511" class="headerlink" title="511."></a>511.</h4><h4 id="512"><a href="#512" class="headerlink" title="512."></a>512.</h4></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/21/SQL/2020-02-21-SQL-Churn%20Rate%20with%20Case/">SQL/2020-02-21-SQL-Churn Rate with Case</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><blockquote>
<p>Codeflix, a streaming video startup, is interested in measuring their user churn rate. In this project, you’ll be helping them answer these questions about their churn:</p>
<p>\1. Get familiar with the company.</p>
<ul>
<li>How many months has the company been operating? Which months do you have enough information to calculate a churn rate?</li>
<li>What segments of users exist?</li>
</ul>
<p>\2. What is the overall churn trend since the company started?</p>
<p>\3. Compare the churn rates between user segments.</p>
<ul>
<li>Which segment of users should the company focus on expanding?</li>
</ul>
<hr>
<p>Start the following project, which will guide you through the queries you need to answer the above questions. Make sure to save your queries and results — you’ll be using them as well.</p>
<p>Then, create a set of slides using <a href="https://www.google.com/slides/about/" target="_blank" rel="noopener">Google Slides</a>, Microsoft Powerpoint, or some other presentation software. Your presentation should answer all of the questions listed above. Each answer should include a text explanation and data to support your claim. The queries used to find that data should be included in a separate <strong>.sql</strong> file.</p>
<ul>
<li><strong><a href="https://s3.amazonaws.com/codecademy-content/programs/learn-sql-from-scratch/SQL+Templates+ADwSQL.pptx" target="_blank" rel="noopener">Template:</a></strong> We recommend that you use the template linked here. This template contains examples of the types of slides you’ll want to use.</li>
<li><strong><a href="https://s3.amazonaws.com/codecademy-content/programs/learn-sql-from-scratch/calc-churn-proj/churn-rubric-for-learners-ADwSQL.pdf" target="_blank" rel="noopener">Rubric:</a></strong> You can share your work with your peers on Codecademy, who can give you feedback based on this rubric. Make sure to check your work before submitting!</li>
</ul>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- select * from subscriptions limit 20;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select min(subscription_start), max(subscription_start)</span></span><br><span class="line"><span class="comment">-- from subscriptions;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">months</span> <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span></span><br><span class="line">   <span class="string">'2017-01-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">   <span class="string">'2017-01-31'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line"> <span class="keyword">UNION</span></span><br><span class="line"> <span class="keyword">SELECT</span></span><br><span class="line">   <span class="string">'2017-02-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">   <span class="string">'2017-02-28'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line"> <span class="keyword">UNION</span></span><br><span class="line"> <span class="keyword">SELECT</span></span><br><span class="line">   <span class="string">'2017-03-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">   <span class="string">'2017-03-31'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line">),</span><br><span class="line">cross_join <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> subscriptions <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> <span class="keyword">months</span></span><br><span class="line">),</span><br><span class="line"><span class="keyword">status</span> <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span> <span class="keyword">id</span>, first_day <span class="keyword">as</span> <span class="keyword">month</span>, </span><br><span class="line">  <span class="keyword">CASE</span></span><br><span class="line">   <span class="keyword">WHEN</span> <span class="keyword">segment</span> = <span class="number">87</span> <span class="keyword">AND</span> </span><br><span class="line">     (subscription_start &lt; first_day</span><br><span class="line">        <span class="keyword">AND</span></span><br><span class="line">        (</span><br><span class="line">          subscription_end &gt; first_day</span><br><span class="line">          <span class="keyword">OR</span></span><br><span class="line">          subscription_end <span class="keyword">is</span> <span class="literal">null</span></span><br><span class="line">        )</span><br><span class="line">     ) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">   <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line"> <span class="keyword">END</span> <span class="keyword">AS</span> is_active_87</span><br><span class="line"> ,</span><br><span class="line"> <span class="keyword">CASE</span></span><br><span class="line">   <span class="keyword">WHEN</span> <span class="keyword">segment</span> = <span class="number">30</span> <span class="keyword">AND</span> </span><br><span class="line">     (subscription_start &lt; first_day</span><br><span class="line">        <span class="keyword">AND</span></span><br><span class="line">        (</span><br><span class="line">          subscription_end &gt; first_day</span><br><span class="line">          <span class="keyword">OR</span></span><br><span class="line">          subscription_end <span class="keyword">is</span> <span class="literal">null</span></span><br><span class="line">        )</span><br><span class="line">     ) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">   <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line"> <span class="keyword">END</span> <span class="keyword">AS</span> is_active_30</span><br><span class="line"> ,</span><br><span class="line"> <span class="keyword">CASE</span> </span><br><span class="line">   <span class="keyword">WHEN</span> <span class="keyword">segment</span> = <span class="number">87</span> <span class="keyword">AND</span></span><br><span class="line">     (</span><br><span class="line">       subscription_end <span class="keyword">BETWEEN</span> first_day <span class="keyword">AND</span> <span class="keyword">last_day</span></span><br><span class="line">     ) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">   <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line"> <span class="keyword">END</span> <span class="keyword">AS</span> is_canceled_87</span><br><span class="line"> ,</span><br><span class="line"> <span class="keyword">CASE</span> </span><br><span class="line">   <span class="keyword">WHEN</span> <span class="keyword">segment</span> = <span class="number">30</span> <span class="keyword">AND</span></span><br><span class="line">     (</span><br><span class="line">       subscription_end <span class="keyword">BETWEEN</span> first_day <span class="keyword">AND</span> <span class="keyword">last_day</span></span><br><span class="line">     ) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">   <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line"> <span class="keyword">END</span> <span class="keyword">AS</span> is_canceled_30</span><br><span class="line"> <span class="keyword">FROM</span> cross_join </span><br><span class="line">),</span><br><span class="line">status_aggregate <span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line">  <span class="keyword">SELECT</span>  <span class="keyword">month</span>, </span><br><span class="line">          <span class="keyword">SUM</span>(is_active_87) <span class="keyword">AS</span> sum_active_87,</span><br><span class="line">          <span class="keyword">SUM</span>(is_active_30) <span class="keyword">AS</span> sum_active_30,       </span><br><span class="line">          <span class="keyword">SUM</span>(is_canceled_87) <span class="keyword">AS</span> sum_canceled_87, </span><br><span class="line">          <span class="keyword">SUM</span>(is_canceled_30) <span class="keyword">AS</span> sum_canceled_30</span><br><span class="line">  <span class="keyword">FROM</span> <span class="keyword">status</span></span><br><span class="line">  <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">month</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> status_aggregate <span class="keyword">limit</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Query-Results-status-aggregate"><a href="#Query-Results-status-aggregate" class="headerlink" title="Query Results - status_aggregate"></a>Query Results - status_aggregate</h3><table>
<thead>
<tr>
<th align="center">month</th>
<th align="center">sum_active_87</th>
<th align="center">sum_active_30</th>
<th align="center">sum_canceled_87</th>
<th align="center">sum_canceled_30</th>
</tr>
</thead>
<tbody><tr>
<td align="center">2017-01-01</td>
<td align="center">278</td>
<td align="center">291</td>
<td align="center">70</td>
<td align="center">22</td>
</tr>
<tr>
<td align="center">2017-02-01</td>
<td align="center">462</td>
<td align="center">518</td>
<td align="center">148</td>
<td align="center">38</td>
</tr>
<tr>
<td align="center">2017-03-01</td>
<td align="center">531</td>
<td align="center">716</td>
<td align="center">258</td>
<td align="center">84</td>
</tr>
</tbody></table>
<p><strong>8.</strong></p>
<p>Calculate the churn rates for the two segments over the three month period. Which segment has a lower churn rate?</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- select * from status_aggregate limit 10;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span>  a.month, </span><br><span class="line">        <span class="number">1.0</span> * a.sum_canceled_87 / a.sum_active_87 <span class="keyword">AS</span> churn_87, </span><br><span class="line">        <span class="number">1.0</span> * a.sum_canceled_30 / a.sum_active_30 <span class="keyword">AS</span> churn_30</span><br><span class="line"><span class="keyword">FROM</span> status_aggregate <span class="keyword">as</span> a;</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/21/SQL/2020-02-21-SQL-UTM%20with%20Case/">SQL/2020-02-21-SQL-UTM with Case</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><h2 id="The-Attribution-Query-II"><a href="#The-Attribution-Query-II" class="headerlink" title="The Attribution Query II"></a>The Attribution Query II</h2><p>To get the UTM parameters, we’ll need to <code>JOIN</code> these results back with the original table.</p>
<p>We’ll join tables <code>first_touch</code>, aka<code>ft</code>, and <code>page_visits</code>, aka <code>pv</code>, on <code>user_id</code> and <code>timestamp</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ft.user_id &#x3D; pv.user_id</span><br><span class="line">AND ft.first_touch_at &#x3D; pv.timestamp</span><br></pre></td></tr></table></figure>

<p>Remember that <code>first_touch_at</code> is the earliest timestamp for each user. Here’s the simplified query:</p>
<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4dkxtc5wj31640tgdjo.jpg" alt="image-20200221220840486" style="zoom:67%;" />

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> first_touch <span class="keyword">AS</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> user_id,</span><br><span class="line">      <span class="keyword">MIN</span>(<span class="built_in">timestamp</span>) <span class="keyword">AS</span> <span class="string">'first_touch_at'</span></span><br><span class="line">   <span class="keyword">FROM</span> page_visits</span><br><span class="line">   <span class="keyword">GROUP</span> <span class="keyword">BY</span> user_id)</span><br><span class="line"><span class="keyword">SELECT</span> ft.user_id,</span><br><span class="line">  ft.first_touch_at,</span><br><span class="line">  pv.utm_source</span><br><span class="line"><span class="keyword">FROM</span> first_touch <span class="keyword">AS</span> <span class="string">'ft'</span></span><br><span class="line"><span class="keyword">JOIN</span> page_visits <span class="keyword">AS</span> <span class="string">'pv'</span></span><br><span class="line">  <span class="keyword">ON</span> ft.user_id = pv.user_id</span><br><span class="line">  <span class="keyword">AND</span> ft.first_touch_at = pv.timestamp;</span><br></pre></td></tr></table></figure>



<h2 id="The-Attribution-Query-III"><a href="#The-Attribution-Query-III" class="headerlink" title="The Attribution Query III"></a>The Attribution Query III</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">WITH</span> last_touch <span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line">  <span class="keyword">SELECT</span> user_id,</span><br><span class="line">     <span class="keyword">MAX</span>(<span class="built_in">timestamp</span>) <span class="keyword">AS</span> <span class="string">'last_touch_at'</span></span><br><span class="line">  <span class="keyword">FROM</span> page_visits</span><br><span class="line">  <span class="comment">-- WHERE user_id = 10069</span></span><br><span class="line">  <span class="keyword">GROUP</span> <span class="keyword">BY</span> user_id</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- select * from last_touch limit 10;</span></span><br><span class="line"><span class="keyword">SELECT</span> lt.user_id, lt.last_touch_at, pv.utm_source</span><br><span class="line"><span class="keyword">FROM</span> last_touch <span class="keyword">as</span> <span class="string">'lt'</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> page_visits <span class="keyword">as</span> <span class="string">'pv'</span></span><br><span class="line">  <span class="keyword">ON</span> lt.user_id = pv.user_id </span><br><span class="line">  <span class="keyword">AND</span> lt.last_touch_at = pv.timestamp</span><br><span class="line"><span class="keyword">WHERE</span> lt.user_id = <span class="number">10069</span>;</span><br></pre></td></tr></table></figure>





<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4dypt1xnj30ps03aaa8.jpg" alt="image-20200221222149765" style="zoom:67%;" />

<h1 id="Review"><a href="#Review" class="headerlink" title="Review"></a>Review</h1><p>You can now wield SQL to find where, when, and how users are visiting a website. Well done! Here’s a summary of what you learned:</p>
<ul>
<li><em>UTM parameters</em> are a way of tracking visits to a website. Developers, marketers, and analysts use them to capture information like the time, attribution source, and attribution medium for each user visit.</li>
<li><em>First-touch attribution</em> only considers the first source for each customer. This is a good way of knowing how visitors initially discover a website.</li>
<li><em>Last-touch attribution</em> only considers the last source for each customer. This is a good way of knowing how visitors are drawn back to a website, especially for making a final purchase.</li>
<li>Find first and last touches by grouping <code>page_visits</code> by <code>user_id</code> and finding the <code>MIN</code> and <code>MAX</code> of <code>timestamp</code>.</li>
<li>To find first- and last-touch attribution, join that table back with the original <code>page_visits</code> table on <code>user_id</code> and <code>timestamp</code>.</li>
</ul>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/20/Codecademies/2020-02-22-SQL-Advanced_Aggregate_&amp;_Count_Metrics/">Codecademies/2020-02-22-SQL-Advanced_Aggregate_&amp;_Count_Metrics</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-20</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><h1 id="Advanced-Aggregate"><a href="#Advanced-Aggregate" class="headerlink" title="Advanced Aggregate"></a>Advanced Aggregate</h1><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcv26l5ilkj31bm0jcn1v.jpg" alt="image-20200316000428263" style="zoom:67%;" />



<h2 id="Database-Schema"><a href="#Database-Schema" class="headerlink" title="Database Schema"></a>Database Schema</h2><table>
<thead>
<tr>
<th align="center">orders4999 rows</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td>int</td>
</tr>
<tr>
<td align="center">ordered_at</td>
<td>text</td>
</tr>
<tr>
<td align="center">delivered_at</td>
<td>text</td>
</tr>
<tr>
<td align="center">delivered_to</td>
<td>int</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">order_items20000 rows</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td>int</td>
</tr>
<tr>
<td align="center">order_id</td>
<td>int</td>
</tr>
<tr>
<td align="center">name</td>
<td>text</td>
</tr>
<tr>
<td align="center">amount_paid</td>
<td>real</td>
</tr>
</tbody></table>
<h2 id="Percentage"><a href="#Percentage" class="headerlink" title="Percentage"></a>Percentage</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>, <span class="keyword">round</span>(<span class="keyword">sum</span>(amount_paid)/</span><br><span class="line">(</span><br><span class="line">  <span class="keyword">select</span> <span class="keyword">sum</span>(amount_paid) <span class="keyword">from</span> order_items</span><br><span class="line">) *<span class="number">100.0</span>, <span class="number">2</span>) <span class="keyword">as</span> pct</span><br><span class="line"><span class="keyword">from</span> order_items</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span> <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Query-Results"><a href="#Query-Results" class="headerlink" title="Query Results"></a>Query Results</h3><table>
<thead>
<tr>
<th align="center">name</th>
<th align="center">%</th>
</tr>
</thead>
<tbody><tr>
<td align="center">tikka-masala</td>
<td align="center">31.7</td>
</tr>
<tr>
<td align="center">grilled-cheese</td>
<td align="center">21.6</td>
</tr>
<tr>
<td align="center">chicken-parm</td>
<td align="center">19.95</td>
</tr>
<tr>
<td align="center">blt</td>
<td align="center">14.75</td>
</tr>
<tr>
<td align="center">soda</td>
<td align="center">5.48</td>
</tr>
<tr>
<td align="center">orange-juice</td>
<td align="center">2.94</td>
</tr>
<tr>
<td align="center">cake</td>
<td align="center">2.71</td>
</tr>
<tr>
<td align="center">banana-smoothie</td>
<td align="center">0.53</td>
</tr>
<tr>
<td align="center">kale-smoothie</td>
<td align="center">0.35</td>
</tr>
</tbody></table>
<h2 id="Grouping-with-Case-Statements"><a href="#Grouping-with-Case-Statements" class="headerlink" title="Grouping with Case Statements"></a>Grouping with Case Statements</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="comment">/**/</span></span><br><span class="line">  <span class="keyword">case</span> <span class="keyword">name</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'kale-smoothie'</span>    <span class="keyword">then</span> <span class="string">'smoothie'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'banana-smoothie'</span>  <span class="keyword">then</span> <span class="string">'smoothie'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'orange-juice'</span>     <span class="keyword">then</span> <span class="string">'drink'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'soda'</span>             <span class="keyword">then</span> <span class="string">'drink'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'blt'</span>              <span class="keyword">then</span> <span class="string">'sandwich'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'grilled-cheese'</span>   <span class="keyword">then</span> <span class="string">'sandwich'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'tikka-masala'</span>     <span class="keyword">then</span> <span class="string">'dinner'</span></span><br><span class="line">    <span class="keyword">when</span> <span class="string">'chicken-parm'</span>     <span class="keyword">then</span> <span class="string">'dinner'</span></span><br><span class="line">     <span class="keyword">else</span> <span class="string">'other'</span></span><br><span class="line">  <span class="keyword">end</span> <span class="keyword">as</span> <span class="keyword">category</span>, </span><br><span class="line">  <span class="keyword">round</span>(<span class="number">1.0</span> * <span class="keyword">sum</span>(amount_paid) / </span><br><span class="line">          (</span><br><span class="line">            <span class="keyword">select</span> <span class="keyword">sum</span>(amount_paid) <span class="keyword">from</span> order_items</span><br><span class="line">          ) * <span class="number">100</span>, <span class="number">2</span></span><br><span class="line">       ) <span class="keyword">as</span> <span class="string">'%'</span></span><br><span class="line"><span class="keyword">from</span> order_items</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span> <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Query-Results-1"><a href="#Query-Results-1" class="headerlink" title="Query Results"></a>Query Results</h3><table>
<thead>
<tr>
<th align="center">category</th>
<th align="center">round(1.0 * sum(amount_paid) / ( select sum(amount_paid) from order_items ) * 100, 2 )</th>
</tr>
</thead>
<tbody><tr>
<td align="center">dinner</td>
<td align="center">51.64</td>
</tr>
<tr>
<td align="center">sandwich</td>
<td align="center">36.34</td>
</tr>
<tr>
<td align="center">drink</td>
<td align="center">8.42</td>
</tr>
<tr>
<td align="center">other</td>
<td align="center">2.71</td>
</tr>
<tr>
<td align="center">smoothie</td>
<td align="center">0.88</td>
</tr>
</tbody></table>
<h2 id="Reorder-Rates"><a href="#Reorder-Rates" class="headerlink" title="Reorder Rates"></a>Reorder Rates</h2><p>“While we do know that kale smoothies (and drinks overall) are not driving a lot of revenue, we don’t know why. A big part of data analysis is implementing your own metrics to get information out of the piles of data in your database.</p>
<p>In our case, the reason could be that no one likes kale, but it could be something else entirely. To find out, we’ll create a metric called <em>reorder rate</em> and see how that compares to the other products at SpeedySpoon.</p>
<p>We’ll define <em>reorder rate</em> as the ratio of the total number of orders to the number of people making those orders. A higher ratio means most of the orders are reorders. A lower ratio means more of the orders are first purchases.”</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcvlv4b5ldj327o0s4wkh.jpg" alt="image-20200316112531249"></p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcvm0mdyqsj324j0u0k30.jpg" alt="image-20200316113051990"></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><h2 id="Conclusion-1"><a href="#Conclusion-1" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Wow! That’s unexpected. While smoothies aren’t making a lot of money for SpeedySpoon, they have a very high reorder rate. That means these smoothie customers are strong repeat customers.</p>
<p>Instead of recommending smoothies be taken off the menu, we should talk to the smoothie customers and see what they like so much about these smoothies. There could be an opportunity here to expand the product line, or get other customers as excited as these kale fanatics. Nice work!</p>
<p>Let’s generalize what we’ve learned so far:</p>
<ul>
<li><em>Data aggregation</em> is the grouping of data in summary form.</li>
<li><em>Daily Count</em> is the count of orders in a day.</li>
<li><em>Daily Revenue Count</em> is the revenue on orders per day.</li>
<li><em>Product Sum</em> is the total revenue of a product.</li>
<li><em>Subqueries</em> can be used to perform complicated calculations and create filtered or aggregate tables on the fly.</li>
<li><em>Reorder Rate</em> is the ratio of the total number of orders to the number of people making orders.</li>
</ul>
<h1 id="Count-Metrics"><a href="#Count-Metrics" class="headerlink" title="Count Metrics"></a>Count Metrics</h1><h3 id="Query-Results-2"><a href="#Query-Results-2" class="headerlink" title="Query Results"></a>Query Results</h3><table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">user_id</th>
<th align="center">price</th>
<th align="center">refunded_at</th>
<th align="center">created_at</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0</td>
<td align="center">255</td>
<td align="center">1.5</td>
<td align="center"></td>
<td align="center">2015-10-04 14:39:46</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">448</td>
<td align="center">0.5</td>
<td align="center"></td>
<td align="center">2015-09-11 17:33:06</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">237</td>
<td align="center">4.5</td>
<td align="center"></td>
<td align="center">2015-08-17 23:13:32</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">468</td>
<td align="center">3.5</td>
<td align="center"></td>
<td align="center">2015-08-08 16:25:59</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">50</td>
<td align="center">4.5</td>
<td align="center"></td>
<td align="center">2015-08-18 02:36:17</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">86</td>
<td align="center">1.5</td>
<td align="center">2015-11-19 10:02:31</td>
<td align="center">2015-11-19 05:16:54</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">384</td>
<td align="center">4.5</td>
<td align="center"></td>
<td align="center">2015-08-21 14:35:02</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">490</td>
<td align="center">1.5</td>
<td align="center"></td>
<td align="center">2015-10-08 01:09:32</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">454</td>
<td align="center">1.5</td>
<td align="center"></td>
<td align="center">2015-10-24 12:26:39</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">280</td>
<td align="center">1.5</td>
<td align="center"></td>
<td align="center">2015-08-24 15:19:00</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">user_id</th>
<th align="center">created_at</th>
<th align="center">platform</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0</td>
<td align="center">225</td>
<td align="center">2015-11-25 20:06:36</td>
<td align="center">Web</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">175</td>
<td align="center">2015-08-08 12:39:30</td>
<td align="center">iOS</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">453</td>
<td align="center">2015-11-11 05:44:58</td>
<td align="center">Web</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">438</td>
<td align="center">2015-10-27 07:26:07</td>
<td align="center">Android</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">413</td>
<td align="center">2015-11-12 19:47:57</td>
<td align="center">iOS</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">424</td>
<td align="center">2015-11-10 23:23:49</td>
<td align="center">Android</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">55</td>
<td align="center">2015-09-13 14:49:09</td>
<td align="center">iOS</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">285</td>
<td align="center">2015-08-31 18:32:49</td>
<td align="center">Web</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">28</td>
<td align="center">2015-08-16 00:34:09</td>
<td align="center">iOS</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">22</td>
<td align="center">2015-08-11 23:53:11</td>
<td align="center">iOS</td>
</tr>
</tbody></table>
<h3 id="Database-Schema-1"><a href="#Database-Schema-1" class="headerlink" title="Database Schema"></a>Database Schema</h3><table>
<thead>
<tr>
<th align="center">purchases2000 rows</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td>int</td>
</tr>
<tr>
<td align="center">user_id</td>
<td>int</td>
</tr>
<tr>
<td align="center">price</td>
<td>real</td>
</tr>
<tr>
<td align="center">refunded_at</td>
<td>text</td>
</tr>
<tr>
<td align="center">created_at</td>
<td>text</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">gameplays14000 rows</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="center">id</td>
<td>int</td>
</tr>
<tr>
<td align="center">user_id</td>
<td>int</td>
</tr>
<tr>
<td align="center">created_at</td>
<td>text</td>
</tr>
<tr>
<td align="center">platform</td>
<td>text</td>
</tr>
</tbody></table>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcvmo5pnolj32660lugq8.jpg" alt="image-20200316115322516"></p>
<h2 id="Daily-Active-Users"><a href="#Daily-Active-Users" class="headerlink" title="Daily Active Users"></a>Daily Active Users</h2><p>Mineblocks is a game, and one of the core metrics to any game is the number of people who play each day. That KPI is called <em>Daily Active Users</em>, or <em>DAU</em>.</p>
<p><em>DAU</em> is defined as the number of unique players seen in-game each day. It’s important not to double count users who played multiple times, so we’ll use <code>distinct</code> in our <code>count</code> function.</p>
<p>Likewise, Weekly Active Users (WAU) and Monthly Active Users (MAU) are in the same family.</p>
<ol>
<li><p>For Mineblocks, we’ll use the <code>gameplays</code> table to calculate DAU. Each time a user plays the game, their session is recorded in <code>gameplays</code>. Thus, a distinct count of users per day from gameplays will give us DAU.</p>
<p>Calculate Daily Active Users for Mineblocks. Complete the query’s <code>count</code> function by passing in the <code>distinct</code> keyword and the <code>user_id</code> column name.</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(created_at), </span><br><span class="line">  <span class="keyword">count</span>(<span class="keyword">distinct</span> user_id<span class="comment">/**/</span>) <span class="keyword">as</span> dau</span><br><span class="line"><span class="keyword">from</span> gameplays</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<h2 id="Daily-Active-Users-2"><a href="#Daily-Active-Users-2" class="headerlink" title="Daily Active Users 2"></a>Daily Active Users 2</h2><p><strong>1.</strong></p>
<p>Previously we calculated DAU only per day, so the output we wanted was <code>[date, dau_count]</code>. Now we want DAU per platform, making the desired output <code>[date, platform, dau_count]</code>.</p>
<p>Calculate DAU for Mineblocks per-platform. Complete the query below. You will need to select the <code>platform</code> column and add a <code>count</code> function by passing in the <code>distinct</code> keyword and the <code>user_id</code> column name.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(created_at), </span><br><span class="line">  platform,</span><br><span class="line">  <span class="keyword">count</span>(<span class="keyword">distinct</span> user_id<span class="comment">/**/</span>) <span class="keyword">as</span> dau</span><br><span class="line"><span class="keyword">from</span> gameplays</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span>, <span class="number">2</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>, <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">P.S. IF NO 2nd group by , diff platforms collapse into the same day</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>date(created_at)</th>
<th>platform</th>
<th>dau</th>
</tr>
</thead>
<tbody><tr>
<td>2015-08-08</td>
<td>Android</td>
<td>39</td>
</tr>
<tr>
<td>2015-08-08</td>
<td>Web</td>
<td>43</td>
</tr>
<tr>
<td>2015-08-08</td>
<td>iOS</td>
<td>25</td>
</tr>
<tr>
<td>2015-08-09</td>
<td>Android</td>
<td>55</td>
</tr>
<tr>
<td>2015-08-09</td>
<td>Web</td>
<td>44</td>
</tr>
<tr>
<td>2015-08-09</td>
<td>iOS</td>
<td>37</td>
</tr>
<tr>
<td>2015-08-10</td>
<td>Android</td>
<td>38</td>
</tr>
</tbody></table>
<h2 id="Daily-Average-Revenue-Per-Purchasing-User"><a href="#Daily-Average-Revenue-Per-Purchasing-User" class="headerlink" title="Daily Average Revenue Per Purchasing User"></a>Daily Average Revenue Per Purchasing User</h2><p>We’ve looked at DAU and Daily Revenue in Mineblocks. Now we must understand the purchasing habits of our users.</p>
<p>Mineblocks, like every freemium game, has two types of users:</p>
<ul>
<li>purchasers: users who have bought things in the game</li>
<li>players: users who play the game but have not yet purchased</li>
</ul>
<p>The next KPI we’ll look at <em>Daily ARPPU</em> - Average Revenue Per Purchasing User. This metric shows if the average amount of money spent by purchasers is going up over time.</p>
<p><em>Daily ARPPU</em> is defined as the sum of revenue divided by the number of purchasers per day.</p>
<p><strong>1.</strong></p>
<p>To get Daily ARPPU, modify the daily revenue query from earlier to divide by the number of purchasers.</p>
<p>Complete the query by adding a numerator and a denominator. The numerator will display daily revenue, or <code>sum</code> the <code>price</code> columns. The denominator will display the number of purchasers by passing the <code>distinct</code> keyword and the <code>user_id</code> column name into the <code>count</code> function.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(created_at),</span><br><span class="line">  <span class="keyword">round</span>(<span class="comment">/**/</span><span class="keyword">sum</span>(price) / <span class="keyword">count</span>(<span class="keyword">distinct</span> user_id<span class="comment">/**/</span>), <span class="number">2</span>) <span class="keyword">as</span> arppu</span><br><span class="line"><span class="keyword">from</span> purchases</span><br><span class="line"><span class="keyword">where</span> refunded_at <span class="keyword">is</span> <span class="literal">null</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">date(created_at)</th>
<th align="center">arppu</th>
</tr>
</thead>
<tbody><tr>
<td align="center">2015-08-04</td>
<td align="center">3.46</td>
</tr>
<tr>
<td align="center">2015-08-05</td>
<td align="center">2.65</td>
</tr>
<tr>
<td align="center">2015-08-06</td>
<td align="center">1.44</td>
</tr>
<tr>
<td align="center">2015-08-07</td>
<td align="center">2.32</td>
</tr>
<tr>
<td align="center">2015-08-08</td>
<td align="center">2.53</td>
</tr>
<tr>
<td align="center">2015-08-09</td>
<td align="center">1.75</td>
</tr>
<tr>
<td align="center">2015-08-10</td>
<td align="center">3.0</td>
</tr>
<tr>
<td align="center">2015-08-11</td>
<td align="center">2.25</td>
</tr>
<tr>
<td align="center">2015-08-12</td>
<td align="center">2.78</td>
</tr>
<tr>
<td align="center">2015-08-13</td>
<td align="center">2.83</td>
</tr>
<tr>
<td align="center">2015-08-14</td>
<td align="center">2.7</td>
</tr>
</tbody></table>
<h2 id="Daily-Average-Revenue-Per-User"><a href="#Daily-Average-Revenue-Per-User" class="headerlink" title="Daily Average Revenue Per User"></a>Daily Average Revenue Per User</h2><p>The more popular (and difficult) cousin to Daily ARPPU is <em>Daily ARPU</em>, Average Revenue Per User. ARPU measures the average amount of money we’re getting across all players, <strong><em>whether or not they’ve purchased.</em></strong></p>
<p>ARPPU increases if purchasers are spending more money. ARPU increases if more players are choosing to purchase, even if the purchase size stays consistent.</p>
<p><strong><em>No one metric can tell the whole story.</em></strong> That’s why it’s so helpful to have many KPIs on the same dashboard.</p>
<h2 id="ARPU-2"><a href="#ARPU-2" class="headerlink" title="ARPU 2"></a>ARPU 2</h2><p>Daily ARPU is defined as revenue divided by the number of players, per-day. To get that, we’ll need to calculate the daily revenue and daily active users separately, and then join them on their dates.</p>
<p>One way to easily create and organize temporary results in a query is with <em>CTEs</em>, <em>Common Table Expressions</em>, also known as <code>with</code> clauses. The <code>with</code> clauses make it easy to define and use results in a more organized way than subqueries.</p>
<p>These clauses usually look like this:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**/</span><span class="keyword">with</span>  daily_revenue <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span></span><br><span class="line">    <span class="built_in">date</span>(created_at) <span class="keyword">as</span> dt,</span><br><span class="line">    <span class="keyword">round</span>(<span class="keyword">sum</span>(price), <span class="number">2</span>) <span class="keyword">as</span> rev</span><br><span class="line">  <span class="keyword">from</span> purchases</span><br><span class="line">  <span class="keyword">where</span> refunded_at <span class="keyword">is</span> <span class="literal">null</span></span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> daily_revenue <span class="keyword">order</span> <span class="keyword">by</span> dt;</span><br></pre></td></tr></table></figure>

<p><strong>2.</strong></p>
<p>Now that we have the revenue and DAU, join them on their dates and calculate daily ARPU. Complete the query by adding the keyword <code>using</code> in the <code>join</code> clause.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**/</span> <span class="keyword">with</span>  daily_revenue <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span></span><br><span class="line">    <span class="built_in">date</span>(created_at) <span class="keyword">as</span> dt,</span><br><span class="line">    <span class="keyword">round</span>(<span class="keyword">sum</span>(price), <span class="number">2</span>) <span class="keyword">as</span> rev</span><br><span class="line">  <span class="keyword">from</span> purchases</span><br><span class="line">  <span class="keyword">where</span> refunded_at <span class="keyword">is</span> <span class="literal">null</span></span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">),</span><br><span class="line">daily_players <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span></span><br><span class="line">    <span class="comment">/**/</span><span class="built_in">date</span>(created_at) <span class="keyword">as</span> dt,</span><br><span class="line">    <span class="comment">/**/</span><span class="keyword">count</span>(<span class="keyword">distinct</span> user_id) <span class="keyword">as</span> players</span><br><span class="line">  <span class="keyword">from</span> gameplays</span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span></span><br><span class="line">  daily_revenue.dt, </span><br><span class="line">  daily_revenue.rev / daily_players.players</span><br><span class="line"><span class="keyword">from</span> daily_revenue</span><br><span class="line">  <span class="keyword">join</span> daily_players <span class="keyword">using</span> (dt);</span><br></pre></td></tr></table></figure>

<p>In the final <code>select</code> statement, <code>daily_revenue.dt</code> represents the date, while <code>daily_revenue.rev / daily_players.players</code> is the daily revenue divided by the number of players that day. In full, it represents how much the company is making per player, per day.</p>
<p>When the columns to join have the same name in both tables you can use <code>using</code> instead of <code>on</code>. Our use of the <code>using</code> keyword is in this case equivalent to this clause:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from daily_revenue</span><br><span class="line">  join daily_players on</span><br><span class="line">    daily_revenue.dt = daily_players.dt;</span><br></pre></td></tr></table></figure>



<h2 id="1Day-Retention"><a href="#1Day-Retention" class="headerlink" title="1Day Retention"></a>1Day Retention</h2><h1 id="1-Day-Retention"><a href="#1-Day-Retention" class="headerlink" title="1 Day Retention"></a>1 Day Retention</h1><p>Now let’s find out what percent of Mineblock players are returning to play the next day. This KPI is called <em>1 Day Retention</em>.</p>
<p><em>Retention</em> can be defined many different ways, but we’ll stick to the most basic definition. For all players on Day N, we’ll consider them retained if they came back to play again on Day N+1.</p>
<p>This will let us track whether or not Mineblocks is getting “stickier” over time. The stickier our game, the more days players will spend in-game.</p>
<p>And more time in-game means more opportunities to monetize and grow our business.</p>
<h4 id="Cont"><a href="#Cont" class="headerlink" title="Cont."></a>Cont.</h4><p>Before we can calculate retention we need to get our data formatted in a way where we can determine if a user returned.</p>
<p>Currently the <code>gameplays</code> table is a list of when the user played, and it’s not easy to see if any user came back.</p>
<p>By using a <code>self-join</code>, we can make multiple gameplays available on the same row of results. This will enable us to calculate retention.</p>
<p>The power of <code>self-join</code> comes from joining every row to every other row. This makes it possible to compare values from two different rows in the new result set. In our case, we’ll compare rows that are one date apart from each user.</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcw6v3ohoqj30dj0a3q3j.jpg" alt="SQL join types"></p>
<p>Now that we have our <code>gameplays</code> table joined to itself, we can start to calculate retention.</p>
<p>1 Day Retention is defined as the number of players who returned the next day divided by the number of original players, per day. Suppose 10 players played Mineblocks on Dec 10th. If 4 of them play on Dec 11th, the 1 day retention for Dec 10th is 40%.</p>
<p>Instructions</p>
<p><strong>1.</strong></p>
<p>The previous query joined all rows in gameplays against all other rows for each user, making a massive result set that we don’t need.</p>
<p>We’ll need to modify this query.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(g1.created_at) <span class="keyword">as</span> dt,</span><br><span class="line">  g1.user_id, </span><br><span class="line">  g2.user_id</span><br><span class="line"><span class="keyword">from</span> gameplays <span class="keyword">as</span> g1</span><br><span class="line">  <span class="comment">/**/</span> <span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">    gameplays <span class="keyword">as</span> g2 <span class="keyword">on</span></span><br><span class="line">    g1.user_id = g2.user_id</span><br><span class="line">    <span class="keyword">and</span> <span class="built_in">date</span>(g1.created_at) = <span class="built_in">date</span>(datetime(g2.created_at, <span class="string">'-1 day'</span>))</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">limit</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>



<p><strong>2.</strong></p>
<p>The query above won’t return meaningful results because we’re using an <code>inner join</code>. This type of join requires that the condition be met for all rows, effectively limiting our selection to only the users that have returned.</p>
<p>Instead, we want to use a <code>left join</code>, this way all rows in <code>g1</code> are preserved, leaving nulls in the rows from <code>g2</code> where users did not return to play the next day.</p>
<p>Change the <code>join</code> clause to use <code>left join</code> and count the distinct number of users from <code>g1</code> and <code>g2</code> per date.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(g1.created_at) <span class="keyword">as</span> dt,</span><br><span class="line">  <span class="comment">-- g1.user_id, </span></span><br><span class="line">  <span class="comment">-- g2.user_id</span></span><br><span class="line">  <span class="keyword">count</span>(<span class="keyword">distinct</span> g1.user_id) <span class="keyword">as</span> total_users,</span><br><span class="line">  <span class="keyword">count</span>(<span class="keyword">distinct</span> g2.user_id) <span class="keyword">as</span> retained_users </span><br><span class="line"><span class="keyword">from</span> gameplays <span class="keyword">as</span> g1</span><br><span class="line">  <span class="comment">/**/</span> <span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">    gameplays <span class="keyword">as</span> g2 <span class="keyword">on</span></span><br><span class="line">    g1.user_id = g2.user_id</span><br><span class="line">    <span class="keyword">and</span> <span class="built_in">date</span>(g1.created_at) = <span class="built_in">date</span>(datetime(g2.created_at, <span class="string">'-1 day'</span>))</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">limit</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>dt</th>
<th>total_users</th>
<th>retained_users</th>
</tr>
</thead>
<tbody><tr>
<td>2015-08-19</td>
<td>111</td>
<td>26</td>
</tr>
<tr>
<td>2015-08-20</td>
<td>117</td>
<td>31</td>
</tr>
<tr>
<td>2015-08-21</td>
<td>112</td>
<td>27</td>
</tr>
<tr>
<td>2015-08-22</td>
<td>117</td>
<td>24</td>
</tr>
<tr>
<td>2015-08-23</td>
<td>94</td>
<td>23</td>
</tr>
<tr>
<td>2015-08-24</td>
<td>108</td>
<td>23</td>
</tr>
<tr>
<td>2015-08-25</td>
<td>120</td>
<td>23</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(g1.created_at) <span class="keyword">as</span> dt,</span><br><span class="line">  <span class="comment">-- g1.user_id, </span></span><br><span class="line">  <span class="comment">-- g2.user_id</span></span><br><span class="line">  <span class="keyword">round</span>(<span class="number">100</span> * <span class="keyword">count</span>(<span class="keyword">distinct</span> g1.user_id) <span class="keyword">as</span> total_users /</span><br><span class="line">  <span class="keyword">count</span>(<span class="keyword">distinct</span> g2.user_id)) <span class="keyword">as</span> <span class="keyword">retention</span></span><br><span class="line"><span class="keyword">from</span> gameplays <span class="keyword">as</span> g1</span><br><span class="line">  <span class="comment">/**/</span> <span class="keyword">left</span> <span class="keyword">join</span> </span><br><span class="line">    gameplays <span class="keyword">as</span> g2 <span class="keyword">on</span></span><br><span class="line">    g1.user_id = g2.user_id</span><br><span class="line">    <span class="keyword">and</span> <span class="built_in">date</span>(g1.created_at) = <span class="built_in">date</span>(datetime(g2.created_at, <span class="string">'-1 day'</span>))</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">limit</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">  <span class="built_in">date</span>(g1.created_at) <span class="keyword">as</span> dt,</span><br><span class="line">  <span class="keyword">round</span>(<span class="number">100</span> * <span class="keyword">count</span>(<span class="keyword">distinct</span> g2.user_id) /</span><br><span class="line">    <span class="keyword">count</span>(<span class="keyword">distinct</span> g1.user_id)) <span class="keyword">as</span> <span class="keyword">retention</span></span><br><span class="line"><span class="keyword">from</span> gameplays <span class="keyword">as</span> g1</span><br><span class="line">  <span class="keyword">left</span> <span class="keyword">join</span> gameplays <span class="keyword">as</span> g2 <span class="keyword">on</span></span><br><span class="line">    g1.user_id = g2.user_id</span><br><span class="line">    <span class="keyword">and</span> <span class="built_in">date</span>(g1.created_at) = <span class="built_in">date</span>(datetime(g2.created_at, <span class="string">'-1 day'</span>))</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">limit</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>



<h2 id="Common-Metrics-Conclusion"><a href="#Common-Metrics-Conclusion" class="headerlink" title="Common Metrics Conclusion"></a>Common Metrics Conclusion</h2><p>While every business has different metrics to track their success, most are based on revenue and usage.</p>
<p>The metrics in this lesson are merely a starting point, and from here you’ll be able to create and customize metrics to track whatever is most important to your company.</p>
<p>And remember, data science is exploratory! The current set of metrics can always be improved and there’s usually more to any spike or dip than what immediately meets the eye.</p>
<p>Let’s generalize what we’ve learned so far:</p>
<ul>
<li><em>Key Performance Indicators</em> are high level health metrics for a business.</li>
<li><em>Daily Revenue</em> is the sum of money made per day.</li>
<li><em>Daily Active Users</em> are the number of unique users seen each day</li>
<li><em>Daily Average Revenue Per Purchasing User (ARPPU)</em> is the average amount of money spent by purchasers each day.</li>
<li><em>Daily Average Revenue Per User (ARPU)</em> is the average amount of money across all users.</li>
<li><em>1 Day Retention</em> is defined as the number of players from Day N who came back to play again on Day N+1.</li>
</ul>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/20/SQL/2020-02-20-SQL-Create%20Table/">SQL/2020-02-20-SQL-Create Table</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-20</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><p><a href="https://www.codecademy.com/courses/learn-sql/projects/learn_sql_create_table" target="_blank" rel="noopener">https://www.codecademy.com/courses/learn-sql/projects/learn_sql_create_table</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> friends(</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">INTEGER</span>,</span><br><span class="line">  <span class="keyword">name</span> <span class="built_in">TEXT</span>,</span><br><span class="line">  birthday <span class="built_in">DATE</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- alter table friends</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> friends (<span class="keyword">id</span>, <span class="keyword">name</span>, birthday)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">'Jane Doe'</span>, <span class="string">'1990-05-30'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> friends;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> friends (<span class="keyword">id</span>, <span class="keyword">name</span>, birthday)</span><br><span class="line"><span class="keyword">values</span> (<span class="number">2</span>, <span class="string">'Alex'</span>, <span class="string">'1986-06-06'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> friends (<span class="keyword">id</span>, <span class="keyword">name</span>, birthday)</span><br><span class="line"><span class="keyword">values</span> (<span class="number">3</span>, <span class="string">'Tina'</span>, <span class="string">'1984-12-12'</span>);</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> friends;</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> friends</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">name</span> = <span class="string">'Jane Smith'</span></span><br><span class="line"><span class="keyword">where</span> <span class="keyword">id</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> friends;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLe</span> friends</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> email <span class="built_in">TEXT</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> friends</span><br><span class="line"><span class="keyword">set</span> email = <span class="string">'jane@codecademy.com'</span></span><br><span class="line"><span class="keyword">where</span> <span class="keyword">id</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> friends;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> friends</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">id</span>  = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> friends;</span><br><span class="line"><span class="comment">-- alter table friends (name)</span></span><br><span class="line"><span class="comment">-- values (1, )</span></span><br></pre></td></tr></table></figure>



<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc2ud71ragj30oe0vwtbb.jpg" alt="image-20200220141807884" style="zoom:50%;" /></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/20/SQL/2020-02-21-SQL-analyzation,%20Funnel%20&amp;%20Churn%20Rate/">SQL/2020-02-21-SQL-analyzation, Funnel &amp; Churn Rate</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-20</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><p><a href="https://s3.amazonaws.com/codecademy-content/courses/sql-intensive/SQL_diagram_v6.pdf" target="_blank" rel="noopener">https://s3.amazonaws.com/codecademy-content/courses/sql-intensive/SQL_diagram_v6.pdf</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> premium_users.user_id,</span><br><span class="line">  months.months,</span><br><span class="line">  <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> (</span><br><span class="line">      premium_users.purchase_date &lt;= months.months</span><br><span class="line">      )</span><br><span class="line">      <span class="keyword">AND</span></span><br><span class="line">      (</span><br><span class="line">        premium_users.cancel_date &gt;= months.months</span><br><span class="line">        <span class="keyword">OR</span></span><br><span class="line">        premium_users.cancel_date <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line">      )</span><br><span class="line">    <span class="keyword">THEN</span> <span class="string">'active'</span></span><br><span class="line">    <span class="keyword">ELSE</span> <span class="string">'not_active'</span></span><br><span class="line">  <span class="keyword">END</span> <span class="keyword">AS</span> <span class="string">'status'</span></span><br><span class="line"><span class="keyword">FROM</span> premium_users</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> <span class="keyword">months</span>;</span><br></pre></td></tr></table></figure>



<h2 id="Build-a-Funnel-From-a-Single-Table"><a href="#Build-a-Funnel-From-a-Single-Table" class="headerlink" title="Build a Funnel From a Single Table"></a>Build a Funnel From a Single Table</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> survey_responses <span class="keyword">limit</span> <span class="number">15</span>;</span><br><span class="line"><span class="comment">-- with count_of_users as(</span></span><br><span class="line"><span class="comment">--   select user_id, count(*) as nums</span></span><br><span class="line"><span class="comment">--   from survey_responses</span></span><br><span class="line"><span class="comment">--   group by user_id</span></span><br><span class="line"><span class="comment">--   order by count(*) desc</span></span><br><span class="line"><span class="comment">-- )  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select user_id, count(*)</span></span><br><span class="line"><span class="comment">-- from count_of_users</span></span><br><span class="line"><span class="comment">-- where nums = 5;  # SINCE 5 Questions</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> question_text, </span><br><span class="line">   <span class="keyword">count</span>(<span class="keyword">distinct</span> user_id)</span><br><span class="line"><span class="keyword">from</span> survey_responses</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> question_text;</span><br></pre></td></tr></table></figure>



<hr>
<p><em>If we divide the number of people completing each step by the number of people completing the previous step:</em></p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Percent Completed this Question</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>100%</td>
</tr>
<tr>
<td>2</td>
<td>95%</td>
</tr>
<tr>
<td>3</td>
<td>82%</td>
</tr>
<tr>
<td>4</td>
<td>95%</td>
</tr>
<tr>
<td>5</td>
<td>74%</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>We see that Questio<em>ns 2 and 4 have high completion rates, but Questions 3 and 5 have lower rates.</em></p>
<p><em>This suggests that age and household income are more sensitive questions that people might be reluctant to answer!</em></p>
<hr>
<h2 id="Compare-Funnels-for-A-B-Tests"><a href="#Compare-Funnels-for-A-B-Tests" class="headerlink" title="Compare Funnels for A/B Tests"></a>Compare Funnels for A/B Tests</h2><p>They’ve set up an A/B test where:</p>
<ul>
<li>50% of users view the original <code>control</code> version of the pop-ups</li>
<li>50% of users view the new <code>variant</code> version of the pop-ups</li>
</ul>
<p>Eventually, we’ll want to answer the question:</p>
<p><em>How is the funnel different between the two groups?</em></p>
<p>We will be using a table called <code>onboarding_modals</code> with the following columns:</p>
<ul>
<li><code>user_id</code> - the user identifier</li>
<li><code>modal_text</code> - the modal step</li>
<li><code>user_action</code> - the user response (Close Modal or Continue)</li>
<li><code>ab_group</code> - the version (control or variant)</li>
</ul>
<p><strong>2.</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 2</span></span><br><span class="line"><span class="comment">-- select modal_text, </span></span><br><span class="line"><span class="comment">--   count(distinct user_id)</span></span><br><span class="line"><span class="comment">-- from onboarding_modals </span></span><br><span class="line"><span class="comment">-- group by modal_text</span></span><br><span class="line"><span class="comment">-- order by modal_text asc;</span></span><br></pre></td></tr></table></figure>



<p><strong>3.</strong></p>
<p>Delete your previous code.</p>
<p>The previous query combined both the control and variant groups.</p>
<p>We can use a <code>CASE</code> statement within our <code>COUNT()</code> aggregate so that we only count <code>user_id</code>s whose <code>ab_group</code> is equal to ‘control’:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> modal_text,</span><br><span class="line">  <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> ab_group = <span class="string">'control'</span> <span class="keyword">THEN</span> user_id</span><br><span class="line">    <span class="keyword">END</span>) <span class="keyword">AS</span> <span class="string">'control_clicks'</span></span><br><span class="line"><span class="keyword">FROM</span> onboarding_modals</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>Paste this code into the code editor and see what happens.</p>
<p><strong>4.</strong></p>
<p>Add an additional column to your previous query that counts the number of clicks from the variant group and alias it as ‘variant_clicks’.</p>
<p>Hint</p>
<p>Your third column should be:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">COUNT(DISTINCT CASE</span><br><span class="line">  WHEN ab_group = 'variant' THEN user_id</span><br><span class="line">  <span class="keyword">END</span>) <span class="keyword">AS</span> <span class="string">'variant_clicks'</span></span><br></pre></td></tr></table></figure>

<p>Don’t forget that columns need to be separated by a comma!</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> modal_text,</span><br><span class="line">  <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> ab_group = <span class="string">'control'</span> <span class="keyword">THEN</span> user_id</span><br><span class="line">    <span class="keyword">END</span>) <span class="keyword">AS</span> <span class="string">'control_clicks'</span>,</span><br><span class="line">  <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> ab_group = <span class="string">'variant'</span> <span class="keyword">THEN</span> user_id</span><br><span class="line">    <span class="keyword">END</span>) <span class="keyword">AS</span> <span class="string">'variant_clicks'</span></span><br><span class="line"><span class="keyword">FROM</span> onboarding_modals</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>The result should have three columns:</p>
<ul>
<li><code>modal_text</code></li>
<li><code>control_clicks</code></li>
<li><code>variant_clicks</code></li>
</ul>
<p>Now you can see the differences between the control and variant side by side!</p>
<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc3vrr5bsrj30pk07ijsa.jpg" alt="image-20200221115221429" style="zoom:50%;" />



<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc3vvqh9g9j30fs0nkaba.jpg" alt="image-20200221115615095"></p>
<h2 id="Build-a-Funnel-from-Multiple-Tables"><a href="#Build-a-Funnel-from-Multiple-Tables" class="headerlink" title="Build a Funnel from Multiple Tables"></a>Build a Funnel from Multiple Tables</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- with bc as (</span></span><br><span class="line"><span class="comment">--   select *</span></span><br><span class="line"><span class="comment">--   from browse as b</span></span><br><span class="line"><span class="comment">--   left join checkout as c</span></span><br><span class="line"><span class="comment">--   on b.user_id = c.user_id</span></span><br><span class="line"><span class="comment">--   where c.user_id is not null</span></span><br><span class="line"><span class="comment">--   -- limit 50</span></span><br><span class="line"><span class="comment">-- )</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- -- select * from bc limit 15;</span></span><br><span class="line"><span class="comment">-- select * </span></span><br><span class="line"><span class="comment">-- from bc</span></span><br><span class="line"><span class="comment">-- left join purchase as p</span></span><br><span class="line"><span class="comment">-- on bc.user_id = p.user_id</span></span><br><span class="line"><span class="comment">-- limit 50;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- BETTER SOLUTION ●○●○●</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> b.browse_date, b.user_id, </span><br><span class="line">  c.user_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> <span class="string">'is_checkout'</span>,</span><br><span class="line">  p.user_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> <span class="string">'is_purchase'</span></span><br><span class="line"><span class="keyword">from</span> browse <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> checkout <span class="keyword">as</span> c</span><br><span class="line">  <span class="keyword">on</span> b.user_id = c.user_id</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> purchase <span class="keyword">as</span> p</span><br><span class="line">  <span class="keyword">on</span> p.user_id = b.user_id</span><br><span class="line"><span class="keyword">limit</span> <span class="number">50</span>;</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> funnels <span class="keyword">AS</span> (</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> b.browse_date,</span><br><span class="line">     b.user_id,</span><br><span class="line">     c.user_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> <span class="string">'is_checkout'</span>,</span><br><span class="line">     p.user_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> <span class="string">'is_purchase'</span></span><br><span class="line">  <span class="keyword">FROM</span> browse <span class="keyword">AS</span> <span class="string">'b'</span></span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> checkout <span class="keyword">AS</span> <span class="string">'c'</span></span><br><span class="line">    <span class="keyword">ON</span> c.user_id = b.user_id</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> purchase <span class="keyword">AS</span> <span class="string">'p'</span></span><br><span class="line">    <span class="keyword">ON</span> p.user_id = c.user_id)</span><br><span class="line"><span class="comment">-- SELECT ______</span></span><br><span class="line"><span class="comment">-- _____________;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select * from funnels limit 15;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">as</span> <span class="string">'num_browse'</span>, <span class="keyword">sum</span>(is_checkout) <span class="keyword">as</span> <span class="string">'num_checkout'</span>, <span class="keyword">sum</span>(is_purchase) <span class="keyword">as</span> <span class="string">'num_purchase'</span>,</span><br><span class="line"><span class="number">1.0</span> * <span class="keyword">SUM</span>(is_checkout) / <span class="keyword">COUNT</span>(user_id) <span class="keyword">as</span> <span class="string">'checkout %'</span>, </span><br><span class="line"><span class="number">1.0</span> * <span class="keyword">SUM</span>(is_purchase) / <span class="keyword">SUM</span>(is_checkout) <span class="keyword">as</span> <span class="string">'purchase %'</span></span><br><span class="line"><span class="keyword">from</span> funnels;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc41t7u4ngj30ug038dg7.jpg" alt="image-20200221152122704" style="zoom:50%;" />





<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> funnels <span class="keyword">AS</span> (</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> b.browse_date,</span><br><span class="line">     b.user_id,</span><br><span class="line">     c.user_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> <span class="string">'is_checkout'</span>,</span><br><span class="line">     p.user_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> <span class="string">'is_purchase'</span></span><br><span class="line">  <span class="keyword">FROM</span> browse <span class="keyword">AS</span> <span class="string">'b'</span></span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> checkout <span class="keyword">AS</span> <span class="string">'c'</span></span><br><span class="line">    <span class="keyword">ON</span> c.user_id = b.user_id</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> purchase <span class="keyword">AS</span> <span class="string">'p'</span></span><br><span class="line">    <span class="keyword">ON</span> p.user_id = c.user_id)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">SELECT</span> browse_date, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> <span class="string">'num_browse'</span>,</span><br><span class="line">   <span class="keyword">SUM</span>(is_checkout) <span class="keyword">AS</span> <span class="string">'num_checkout'</span>,</span><br><span class="line">   <span class="keyword">SUM</span>(is_purchase) <span class="keyword">AS</span> <span class="string">'num_purchase'</span>,</span><br><span class="line">   <span class="number">1.0</span> * <span class="keyword">SUM</span>(is_checkout) / <span class="keyword">COUNT</span>(user_id) <span class="keyword">AS</span> <span class="string">'browse_to_checkout'</span>,</span><br><span class="line">   <span class="number">1.0</span> * <span class="keyword">SUM</span>(is_purchase) / <span class="keyword">SUM</span>(is_checkout) <span class="keyword">AS</span> <span class="string">'checkout_to_purchase'</span></span><br><span class="line"><span class="keyword">FROM</span> funnels</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> browse_date;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc45hn77ibj312006i3zs.jpg" alt="image-20200221172848148" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc45jto9t8j30gq0p0gml.jpg" alt="image-20200221173038606" style="zoom: 50%;" />





<h2 id="Usage-Funnels-with-Warby-Parker"><a href="#Usage-Funnels-with-Warby-Parker" class="headerlink" title="Usage Funnels with Warby Parker"></a>Usage Funnels with Warby Parker</h2><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4715qtfhj31qw0caq6d.jpg" alt="image-20200221182158177" style="zoom:67%;" />

<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4724wgkoj31rc09c0uz.jpg" alt="image-20200221182256478" style="zoom:67%;" /><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc473tav67j31qq0ayaeb.jpg" alt="image-20200221182442175"></p>
<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc473xoshtj31rc09c0uz.jpg" alt="image-20200221182256478" style="zoom:67%;" /><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc473tav67j31qq0ayaeb.jpg" alt="image-20200221182442175"></p>
<h2 id="Churn-Rate"><a href="#Churn-Rate" class="headerlink" title="Churn Rate"></a>Churn Rate</h2><h3 id="Single-Month-I"><a href="#Single-Month-I" class="headerlink" title="Single Month I"></a>Single Month I</h3><p>Remember from the previous exercise that churn rate is:</p>
<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc48q5lr2bj307d03ajra.jpg" alt="Churn" style="zoom: 67%;" />

<p>For the numerator, we only want the portion of the customers who cancelled during December:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="number">1.0</span> * </span><br><span class="line">(</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*)</span><br><span class="line">  <span class="keyword">FROM</span> subscriptions</span><br><span class="line">  <span class="keyword">WHERE</span> subscription_start &lt; <span class="string">'2017-01-01'</span></span><br><span class="line">  <span class="keyword">AND</span> (</span><br><span class="line">    subscription_end</span><br><span class="line">    <span class="keyword">BETWEEN</span> <span class="string">'2017-01-01'</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="string">'2017-01-31'</span></span><br><span class="line">  )</span><br><span class="line">) / (</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) </span><br><span class="line">  <span class="keyword">FROM</span> subscriptions </span><br><span class="line">  <span class="keyword">WHERE</span> subscription_start &lt; <span class="string">'2017-01-01'</span></span><br><span class="line">  <span class="keyword">AND</span> (</span><br><span class="line">    (subscription_end &gt;= <span class="string">'2017-01-01'</span>)</span><br><span class="line">    <span class="keyword">OR</span> (subscription_end <span class="keyword">IS</span> <span class="literal">NULL</span>)</span><br><span class="line">  )</span><br><span class="line">) </span><br><span class="line"><span class="keyword">AS</span> <span class="keyword">result</span>;</span><br></pre></td></tr></table></figure>





<h3 id="Single-Month-II"><a href="#Single-Month-II" class="headerlink" title="Single Month II"></a>Single Month II</h3><p>The previous method worked, but you may have noticed we selected the same group of customers twice for the same month and repeated a number of conditional statements.</p>
<p>Companies typically look at churn data over a period of many months. We need to modify the calculation a bit to make it easier to mold into a multi-month result. This is done by making use of <code>WITH</code> and <code>CASE</code>.</p>
<p>To start, use <code>WITH</code> to create the group of customers that are active going into December:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">WITH</span> enrollments <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> subscriptions</span><br><span class="line"><span class="keyword">WHERE</span> subscription_start &lt; <span class="string">'2017-01-01'</span></span><br><span class="line"><span class="keyword">AND</span> (</span><br><span class="line">  (subscription_end &gt;= <span class="string">'2017-01-01'</span>)</span><br><span class="line">  <span class="keyword">OR</span> (subscription_end <span class="keyword">IS</span> <span class="literal">NULL</span>)</span><br><span class="line">)),</span><br><span class="line"><span class="keyword">status</span> <span class="keyword">AS</span> </span><br><span class="line">(<span class="keyword">SELECT</span></span><br><span class="line">  <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> (subscription_end &gt; <span class="string">'2017-01-31'</span>)</span><br><span class="line">      <span class="keyword">OR</span> (subscription_end <span class="keyword">IS</span> <span class="literal">NULL</span>) <span class="keyword">THEN</span> <span class="number">0</span></span><br><span class="line">      <span class="keyword">ELSE</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">as</span> is_canceled,</span><br><span class="line">   <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> subscription_start &lt; <span class="string">'2017-01-01'</span></span><br><span class="line">      <span class="keyword">AND</span> (</span><br><span class="line">        (subscription_end &gt;= <span class="string">'2017-01-01'</span>)</span><br><span class="line">        <span class="keyword">OR</span> (subscription_end <span class="keyword">IS</span> <span class="literal">NULL</span>)</span><br><span class="line">      ) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">  <span class="keyword">END</span> <span class="keyword">as</span> is_active</span><br><span class="line">  <span class="keyword">FROM</span> enrollments</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1.0</span> * <span class="keyword">SUM</span>(is_canceled) / <span class="keyword">SUM</span>(is_active)</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">status</span>;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc49fnhr1dj30py0kkjt3.jpg" alt="image-20200221194509437" style="zoom:50%;" />



<h3 id="Multiple-Month-Create-Months-Temporary-Table"><a href="#Multiple-Month-Create-Months-Temporary-Table" class="headerlink" title="Multiple Month: Create Months Temporary Table"></a>Multiple Month: Create Months Temporary Table</h3><p>Our single month calculation is now in a form that we can extend to a multiple month result. But first, we need months!</p>
<p>Some SQL table schemes will contain a prebuilt table of months. Ours doesn’t, so we’ll need to build it using <code>UNION</code>. We’ll need the first and last day of each month.</p>
<p>Our churn calculation uses the first day as a cutoff for subscribers and the last day as a cutoff for cancellations.</p>
<p>This table can be created like:</p>
<p><strong>1.</strong></p>
<p>We will be using the months as a temporary table (using <code>WITH</code>) in the churn calculation.</p>
<p>Create the <code>months</code> temporary table using <code>WITH</code> and <code>SELECT</code> everything from it so that you can see the structure.</p>
<p>We need a table for January, February, and March of 2017.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> <span class="keyword">months</span> <span class="keyword">AS</span></span><br><span class="line">  (</span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">    <span class="string">'2017-01-01'</span> <span class="keyword">AS</span> first_day,</span><br><span class="line">    <span class="string">'2017-01-31'</span> <span class="keyword">AS</span> <span class="keyword">last_day</span></span><br><span class="line">    <span class="keyword">UNION</span></span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">    <span class="string">'2017-02-01'</span> <span class="keyword">AS</span> first_day,</span><br><span class="line">    <span class="string">'2017-02-28'</span> <span class="keyword">AS</span> <span class="keyword">last_day</span></span><br><span class="line">    <span class="keyword">UNION</span></span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">    <span class="string">'2017-03-01'</span> <span class="keyword">AS</span> first_day,</span><br><span class="line">    <span class="string">'2017-03-31'</span> <span class="keyword">AS</span> <span class="keyword">last_day</span></span><br><span class="line">  )</span><br><span class="line">  </span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> <span class="keyword">months</span>;</span><br></pre></td></tr></table></figure>



<h3 id="Multiple-Month-Cross-Join-Months-and-Users"><a href="#Multiple-Month-Cross-Join-Months-and-Users" class="headerlink" title="Multiple Month: Cross Join Months and Users"></a>Multiple Month: Cross Join Months and Users</h3><p>Now that we have a table of months, we will join it to the subscriptions table. This will result in a table containing every combination of month and subscription.</p>
<p>Ultimately, this table will be used to determine the status of each subscription in each month.</p>
<p>Instructions</p>
<p><strong>1.</strong></p>
<p>The workspace contains the <code>months</code> temporary table from the previous exercise.</p>
<p>Create a <code>cross_join</code> temporary table that is a <code>CROSS JOIN</code> of <code>subscriptions</code> and <code>months</code>.</p>
<p>We’ve added:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> cross_join</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>

<p>at the bottom of this exercise so you can visualize the temporary table you create.</p>
<p>It should <code>SELECT</code> all the columns from the temporary table.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> <span class="keyword">months</span> <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span></span><br><span class="line">  <span class="string">'2017-01-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">  <span class="string">'2017-01-31'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="string">'2017-02-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">  <span class="string">'2017-02-28'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="string">'2017-03-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">  <span class="string">'2017-03-31'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line">),</span><br><span class="line"><span class="comment">-- Add temporary cross_join definition here</span></span><br><span class="line">cross_join <span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line">  <span class="keyword">select</span> *</span><br><span class="line">  <span class="keyword">from</span> subscriptions </span><br><span class="line">  <span class="keyword">cross</span> <span class="keyword">join</span> <span class="keyword">months</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> cross_join</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>



<h4 id="Query-Results-cross-join"><a href="#Query-Results-cross-join" class="headerlink" title="Query Results - cross_join"></a>Query Results - cross_join</h4><table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">subscription_start</th>
<th align="center">subscription_end</th>
<th align="center">first_day</th>
<th align="center">last_day</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">2017-03-18</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">2017-03-18</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">2017-03-18</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2017-03-05</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2017-03-05</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2017-03-05</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">2016-12-21</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">2016-12-21</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">2016-12-21</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2017-03-26</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2017-03-26</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2017-03-26</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">2017-03-14</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">2017-03-14</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">2017-03-14</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2016-12-02</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2016-12-02</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2016-12-02</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2017-03-22</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2017-03-22</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2017-03-22</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2017-03-06</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2017-03-06</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2017-03-06</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">2016-12-22</td>
<td align="center">2017-03-31</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">2016-12-22</td>
<td align="center">2017-03-31</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">2016-12-22</td>
<td align="center">2017-03-31</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2017-02-22</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2017-02-22</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2017-02-22</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">2017-03-02</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">2017-03-02</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">2017-03-02</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">12</td>
<td align="center">2016-12-14</td>
<td align="center">2017-03-29</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">12</td>
<td align="center">2016-12-14</td>
<td align="center">2017-03-29</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">12</td>
<td align="center">2016-12-14</td>
<td align="center">2017-03-29</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">13</td>
<td align="center">2016-12-16</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">13</td>
<td align="center">2016-12-16</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">13</td>
<td align="center">2016-12-16</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">14</td>
<td align="center">2017-03-03</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">14</td>
<td align="center">2017-03-03</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">14</td>
<td align="center">2017-03-03</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">15</td>
<td align="center">2016-12-10</td>
<td align="center">2017-01-16</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">15</td>
<td align="center">2016-12-10</td>
<td align="center">2017-01-16</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">15</td>
<td align="center">2016-12-10</td>
<td align="center">2017-01-16</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">16</td>
<td align="center">2016-12-12</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">16</td>
<td align="center">2016-12-12</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">16</td>
<td align="center">2016-12-12</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">17</td>
<td align="center">2017-01-05</td>
<td align="center">2017-02-07</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">17</td>
<td align="center">2017-01-05</td>
<td align="center">2017-02-07</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">17</td>
<td align="center">2017-01-05</td>
<td align="center">2017-02-07</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">18</td>
<td align="center">2017-02-14</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">18</td>
<td align="center">2017-02-14</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">18</td>
<td align="center">2017-02-14</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">19</td>
<td align="center">2016-12-17</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">19</td>
<td align="center">2016-12-17</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">19</td>
<td align="center">2016-12-17</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">20</td>
<td align="center">2017-01-20</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">20</td>
<td align="center">2017-01-20</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">20</td>
<td align="center">2017-01-20</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">21</td>
<td align="center">2017-03-01</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">21</td>
<td align="center">2017-03-01</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">21</td>
<td align="center">2017-03-01</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">22</td>
<td align="center">2017-01-26</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">22</td>
<td align="center">2017-01-26</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">22</td>
<td align="center">2017-01-26</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">23</td>
<td align="center">2016-12-19</td>
<td align="center">2017-01-25</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">23</td>
<td align="center">2016-12-19</td>
<td align="center">2017-01-25</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">23</td>
<td align="center">2016-12-19</td>
<td align="center">2017-01-25</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">24</td>
<td align="center">2017-01-31</td>
<td align="center">2017-03-26</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">24</td>
<td align="center">2017-01-31</td>
<td align="center">2017-03-26</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">24</td>
<td align="center">2017-01-31</td>
<td align="center">2017-03-26</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">25</td>
<td align="center">2016-12-18</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">25</td>
<td align="center">2016-12-18</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">25</td>
<td align="center">2016-12-18</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">26</td>
<td align="center">2017-02-25</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">26</td>
<td align="center">2017-02-25</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">26</td>
<td align="center">2017-02-25</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">27</td>
<td align="center">2017-01-15</td>
<td align="center">2017-03-31</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">27</td>
<td align="center">2017-01-15</td>
<td align="center">2017-03-31</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">27</td>
<td align="center">2017-01-15</td>
<td align="center">2017-03-31</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">28</td>
<td align="center">2016-12-20</td>
<td align="center">2017-01-28</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">28</td>
<td align="center">2016-12-20</td>
<td align="center">2017-01-28</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">28</td>
<td align="center">2016-12-20</td>
<td align="center">2017-01-28</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">29</td>
<td align="center">2017-01-25</td>
<td align="center">2017-02-25</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">29</td>
<td align="center">2017-01-25</td>
<td align="center">2017-02-25</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">29</td>
<td align="center">2017-01-25</td>
<td align="center">2017-02-25</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">30</td>
<td align="center">2017-01-11</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">30</td>
<td align="center">2017-01-11</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">30</td>
<td align="center">2017-01-11</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">31</td>
<td align="center">2016-12-13</td>
<td align="center">2017-01-16</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">31</td>
<td align="center">2016-12-13</td>
<td align="center">2017-01-16</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">31</td>
<td align="center">2016-12-13</td>
<td align="center">2017-01-16</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">32</td>
<td align="center">2016-12-11</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">32</td>
<td align="center">2016-12-11</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">32</td>
<td align="center">2016-12-11</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">33</td>
<td align="center">2016-12-21</td>
<td align="center">2017-02-12</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">33</td>
<td align="center">2016-12-21</td>
<td align="center">2017-02-12</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">33</td>
<td align="center">2016-12-21</td>
<td align="center">2017-02-12</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">34</td>
<td align="center">2017-03-19</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
</tbody></table>
<h3 id="Multiple-Month-Determine-Active-Cancellation-Status"><a href="#Multiple-Month-Determine-Active-Cancellation-Status" class="headerlink" title="Multiple Month: Determine Active/Cancellation Status"></a>Multiple Month: Determine Active/Cancellation Status</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> <span class="keyword">months</span> <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span></span><br><span class="line">  <span class="string">'2017-01-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">  <span class="string">'2017-01-31'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="string">'2017-02-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">  <span class="string">'2017-02-28'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="string">'2017-03-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">  <span class="string">'2017-03-31'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line">),</span><br><span class="line">cross_join <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> subscriptions</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> <span class="keyword">months</span>),</span><br><span class="line"><span class="keyword">status</span> <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span> <span class="keyword">id</span>, first_day <span class="keyword">as</span> <span class="keyword">month</span>,</span><br><span class="line"><span class="keyword">CASE</span></span><br><span class="line">  <span class="keyword">WHEN</span> (subscription_start &lt; first_day)</span><br><span class="line">    <span class="keyword">AND</span> (</span><br><span class="line">      subscription_end &gt; first_day</span><br><span class="line">      <span class="keyword">OR</span> subscription_end <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line">    ) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">END</span> <span class="keyword">as</span> is_active,</span><br><span class="line"><span class="comment">-- add is_canceled here</span></span><br><span class="line"><span class="keyword">CASE</span> </span><br><span class="line">  <span class="keyword">WHEN</span> (subscription_end <span class="keyword">BETWEEN</span> first_day <span class="keyword">AND</span> <span class="keyword">last_day</span>) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line"> <span class="keyword">END</span> <span class="keyword">AS</span> is_canceled</span><br><span class="line"><span class="keyword">FROM</span> cross_join)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">status</span></span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>

<h4 id=""><a href="#" class="headerlink" title=""></a></h4><h4 id="Query-Results-status"><a href="#Query-Results-status" class="headerlink" title="Query Results - status"></a>Query Results - status</h4><table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">month</th>
<th align="center">is_active</th>
<th align="center">is_canceled</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">2017-03-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2017-03-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">2017-01-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">2017-02-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">2017-03-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2017-03-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">2017-03-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2017-01-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2017-02-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2017-03-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2017-03-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2017-03-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">2017-01-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">2017-02-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">2017-03-01</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2017-03-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody></table>
<h3 id="Multiple-Month-Sum-Active-and-Canceled-Users"><a href="#Multiple-Month-Sum-Active-and-Canceled-Users" class="headerlink" title="Multiple Month: Sum Active and Canceled Users"></a>Multiple Month: Sum Active and Canceled Users</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- add status_aggregate here</span></span><br><span class="line">status_aggregate AS</span><br><span class="line">(</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">month</span>, <span class="keyword">sum</span>(is_active), <span class="keyword">sum</span>(is_canceled)</span><br><span class="line">  <span class="keyword">FROM</span> <span class="keyword">status</span></span><br><span class="line">  <span class="keyword">Group</span> <span class="keyword">by</span> <span class="keyword">month</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> status_aggregate;</span><br></pre></td></tr></table></figure>

<h4 id="Query-Results-status-aggregate"><a href="#Query-Results-status-aggregate" class="headerlink" title="Query Results - status_aggregate"></a>Query Results - status_aggregate</h4><table>
<thead>
<tr>
<th align="center">month</th>
<th align="center">sum(is_active)</th>
<th align="center">sum(is_canceled)</th>
</tr>
</thead>
<tbody><tr>
<td align="center">2017-01-01</td>
<td align="center">276</td>
<td align="center">35</td>
</tr>
<tr>
<td align="center">2017-02-01</td>
<td align="center">506</td>
<td align="center">63</td>
</tr>
<tr>
<td align="center">2017-03-01</td>
<td align="center">667</td>
<td align="center">158</td>
</tr>
</tbody></table>
<h3 id="Multiple-Month-Churn-Rate-Calculation"><a href="#Multiple-Month-Churn-Rate-Calculation" class="headerlink" title="Multiple Month: Churn Rate Calculation"></a>Multiple Month: Churn Rate Calculation</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">month</span>, <span class="number">1.0</span> * a.canceled / a.active <span class="keyword">as</span> churn_rate</span><br><span class="line"><span class="keyword">from</span> status_aggregate <span class="keyword">as</span> a;</span><br></pre></td></tr></table></figure>

<h4 id="Query-Results-churn-rate"><a href="#Query-Results-churn-rate" class="headerlink" title="Query Results - churn_rate"></a>Query Results - churn_rate</h4><table>
<thead>
<tr>
<th align="center">month</th>
<th align="center">churn_rate</th>
</tr>
</thead>
<tbody><tr>
<td align="center">2017-01-01</td>
<td align="center">0.126811594202899</td>
</tr>
<tr>
<td align="center">2017-02-01</td>
<td align="center">0.124505928853755</td>
</tr>
<tr>
<td align="center">2017-03-01</td>
<td align="center">0.23688155922039</td>
</tr>
</tbody></table>
<p><em>In this lesson you learned:</em></p>
<ul>
<li><em>The churn rate is a percent of subscribers at the beginning of a period that cancel within that period. “Monthly churn” is a typical metric and what was used in the examples.</em></li>
<li><em>How to calculate this metric using SQL for a single month. This used <code>COUNT()</code> and conditions to determine the number of subscribers that were active and how many canceled.</em></li>
<li><em>A more complex method to track the subscriber churn rate over many months.</em></li>
</ul>
<p><em>Instructions</em></p>
<p><em>The complete churn calculation is provided here for you to experiment with.</em></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/20/SQL/2020-02-21-SQL-analyzation/">SQL/2020-02-21-SQL-analyzation</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-20</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><h1 id="Analyze-Data-with-SQL"><a href="#Analyze-Data-with-SQL" class="headerlink" title="Analyze Data with SQL"></a>Analyze Data with SQL</h1><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><p>The UX Research team wants to see a distribution of watch durations. They want the result to contain:</p>
<ul>
<li><code>duration</code>, which is the watch event duration, rounded to the closest minute</li>
<li><code>count</code>, the number of watch events falling into this “bucket”</li>
</ul>
<p>Your result should look like:</p>
<table>
<thead>
<tr>
<th>duration</th>
<th>count</th>
</tr>
</thead>
<tbody><tr>
<td>1.0</td>
<td>9</td>
</tr>
<tr>
<td>2.0</td>
<td>21</td>
</tr>
<tr>
<td>3.0</td>
<td>19</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>Use <code>COUNT()</code>, <code>GROUP BY</code>, and <code>ORDER BY</code> to create this result and order this data by increasing <code>duration</code>.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">round</span>(watch_duration_in_minutes, <span class="number">0</span>) </span><br><span class="line"><span class="keyword">from</span> watch_history </span><br><span class="line"><span class="keyword">limit</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="keyword">ROUND</span>(watch_duration_in_minutes, <span class="number">0</span>) <span class="keyword">as</span> <span class="keyword">duration</span>,</span><br><span class="line">  <span class="keyword">COUNT</span>(*) <span class="keyword">as</span> <span class="keyword">count</span></span><br><span class="line"><span class="keyword">FROM</span> watch_history</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">duration</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">duration</span> <span class="keyword">ASC</span> <span class="keyword">limit</span> <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">round</span>(watch_duration_in_minutes, <span class="number">0</span>) <span class="keyword">as</span> <span class="keyword">duration</span>, </span><br><span class="line"><span class="keyword">count</span>(*) <span class="keyword">as</span> <span class="keyword">count</span></span><br><span class="line"><span class="keyword">from</span> watch_history</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">duration</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">duration</span> <span class="keyword">asc</span> <span class="keyword">limit</span> <span class="number">20</span>;</span><br><span class="line"><span class="comment">-- order by count(*) asc limit 20;</span></span><br></pre></td></tr></table></figure>



<h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><p>Find all the users that have successfully made a payment to Codeflix and find their total amount paid.</p>
<p>Sort them by their total payments (from high to low).</p>
<p>Use <code>SUM()</code>, <code>WHERE</code>, <code>GROUP BY</code>, and <code>ORDER BY</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> user_id, <span class="keyword">SUM</span>(amount)</span><br><span class="line"><span class="keyword">FROM</span> payments</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">status</span> = <span class="string">'paid'</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> user_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">SUM</span>(amount) <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> user_id, <span class="keyword">SUM</span>(amount) <span class="keyword">AS</span> <span class="string">'total'</span></span><br><span class="line"><span class="keyword">FROM</span> payments</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">status</span> = <span class="string">'paid'</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span> <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>



<p>The <code>watch_history</code> table has the following columns:</p>
<ul>
<li><code>id</code></li>
<li><code>user_id</code></li>
<li><code>watch_date</code></li>
<li><code>watch_duration_in_minutes</code></li>
</ul>
<p>Click <a href="https://s3.amazonaws.com/codecademy-content/courses/learn-sql-aggregates-code-challenge/user-payments-history.png" target="_blank" rel="noopener">here</a> for the table diagram.</p>
<p>Instructions</p>
<p>Generate a table of user ids and total watch duration for users who watched more than 400 minutes of content.</p>
<p>Use <code>SUM()</code>, <code>GROUP BY</code>, and <code>HAVING</code> to achieve this.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> user_id, <span class="keyword">SUM</span>(watch_duration_in_minutes) </span><br><span class="line"><span class="keyword">from</span> watch_history </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> user_id</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">SUM</span>(watch_duration_in_minutes) &gt; <span class="number">400</span>;</span><br></pre></td></tr></table></figure>



<h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><p>Which days in this period did Codeflix collect the most money?</p>
<p>Your result should have two columns, <code>pay_date</code> and total <code>amount</code>, sorted by the latter descending.</p>
<p>This should only include successful payments (<code>status = &#39;paid&#39;</code>).</p>
<p>Use <code>SUM()</code>, <code>GROUP BY</code>, and <code>ORDER BY</code>.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> pay_date, <span class="keyword">sum</span>(amount)</span><br><span class="line"><span class="keyword">from</span> payments</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">status</span> = <span class="string">'paid'</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> pay_date</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">sum</span>(amount) <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>





<h1 id="The-Metropolitan-Museum-of-Art"><a href="#The-Metropolitan-Museum-of-Art" class="headerlink" title="The Metropolitan Museum of Art"></a>The Metropolitan Museum of Art</h1><p>First, let’s find the “lowest” year:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT MIN(date)</span><br><span class="line">FROM met;</span><br></pre></td></tr></table></figure>

<p>The result is 1600-1700.</p>
<p>Now, let’s try this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT date, title, medium</span><br><span class="line">FROM met</span><br><span class="line">WHERE date LIKE &#39;%1600%&#39;;</span><br></pre></td></tr></table></figure>

<p>Woah! <a href="https://www.metmuseum.org/art/collection/search/507" target="_blank" rel="noopener">Betty Lamp</a>, <a href="https://www.metmuseum.org/art/collection/search/1194" target="_blank" rel="noopener">Candlestick</a>, and <a href="https://www.metmuseum.org/art/collection/search/1458" target="_blank" rel="noopener">Casement Window</a> are among the oldest pieces in the collection.</p>
<p><strong>7.</strong></p>
<p>Lastly, let’s look at some bling!</p>
<p>Count the number of pieces where the <code>medium</code> contains ‘gold’ or ‘silver’.</p>
<p>And sort in descending order.</p>
<p>Hint</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ★★★ 7 </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">medium</span>, <span class="keyword">count</span>(*)</span><br><span class="line"><span class="keyword">from</span> met</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">medium</span> <span class="keyword">like</span> <span class="string">'%gold%'</span> <span class="keyword">or</span> <span class="string">'%silver%'</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">medium</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">count</span>(*) <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">-- 可以做得再更往大分類去，要用到 CASE!如這裡</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> <span class="keyword">medium</span> <span class="keyword">like</span> <span class="string">'%gold%'</span> <span class="keyword">THEN</span> <span class="string">'GOLD'</span></span><br><span class="line">    <span class="keyword">WHEN</span> <span class="keyword">medium</span> <span class="keyword">like</span> <span class="string">'%silver%'</span> <span class="keyword">THEN</span> <span class="string">'SILVER'</span></span><br><span class="line">    <span class="keyword">ELSE</span> <span class="literal">NULL</span></span><br><span class="line">  <span class="keyword">END</span> <span class="keyword">AS</span> <span class="string">'Bling'</span>, </span><br><span class="line">  <span class="keyword">count</span>(*)</span><br><span class="line"><span class="keyword">from</span> met</span><br><span class="line"><span class="comment">-- where medium like '%gold%' or '%silver%'</span></span><br><span class="line"><span class="comment">-- group by medium</span></span><br><span class="line"><span class="keyword">where</span> Bling <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> Bling</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">count</span>(*) <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>



<h1 id="Hacker-News"><a href="#Hacker-News" class="headerlink" title="Hacker News"></a>Hacker News</h1><h3 id="Which-sites-feed-Hacker-News"><a href="#Which-sites-feed-Hacker-News" class="headerlink" title="Which sites feed Hacker News?"></a>Which sites feed Hacker News?</h3><p><strong>6.</strong></p>
<p>Hacker News stories are essentially links that take users to other websites.</p>
<p><em>Which of these sites feed Hacker News the most</em>:</p>
<p><em><a href="https://www.github.com/" target="_blank" rel="noopener">GitHub</a>, <a href="https://www.medium.com/" target="_blank" rel="noopener">Medium</a>, or <a href="https://www.nytimes.com/" target="_blank" rel="noopener">New York Times</a>?</em></p>
<p>First, we want to categorize each story based on their source.</p>
<p>We can do this using a <code>CASE</code> statement:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT CASE</span><br><span class="line">   WHEN url LIKE &#39;%github.com%&#39; THEN &#39;GitHub&#39;</span><br><span class="line">   -- WHEN statement here</span><br><span class="line">   -- WHEN statement here</span><br><span class="line">   -- ELSE statement here</span><br><span class="line">  END AS &#39;Source&#39;</span><br><span class="line">FROM hacker_news;</span><br></pre></td></tr></table></figure>

<p>Fill in the other <code>WHEN</code> statements and the <code>ELSE</code> statement.</p>
<p>Stuck? Get a hint</p>
<p><strong>7.</strong></p>
<p>Next, build on the previous query:</p>
<p>Add a column for the number of stories from each URL using <code>COUNT()</code>.</p>
<p>Also, <code>GROUP BY</code> the <code>CASE</code> statement.</p>
<p>Remember that you can refer to a column in <code>GROUP BY</code> using a number.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 6, 7</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CASE</span></span><br><span class="line">  <span class="keyword">WHEN</span> <span class="keyword">url</span> <span class="keyword">LIKE</span> <span class="string">'%github%'</span> <span class="keyword">THEN</span> <span class="string">'GitHub'</span></span><br><span class="line">  <span class="keyword">WHEN</span> <span class="keyword">url</span> <span class="keyword">LIKE</span> <span class="string">'%medium.com%'</span> <span class="keyword">THEN</span> <span class="string">'Medium'</span></span><br><span class="line">  <span class="keyword">WHEN</span> <span class="keyword">url</span> <span class="keyword">LIKE</span> <span class="string">'%nytimes.com%'</span> <span class="keyword">THEN</span> <span class="string">'New York Times'</span></span><br><span class="line">  <span class="keyword">ELSE</span> <span class="string">'Other'</span></span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span> three_urls, <span class="keyword">count</span>(*)</span><br><span class="line"><span class="keyword">from</span> hacker_news </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> three_urls</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">count</span>(*);</span><br></pre></td></tr></table></figure>



<h3 id="What’s-the-best-time-to-post-a-story"><a href="#What’s-the-best-time-to-post-a-story" class="headerlink" title="What’s the best time to post a story?"></a>What’s the best time to post a story?</h3><p><strong>8.</strong></p>
<p>Every submitter wants their story to get a high score so that the story makes it to the front page, but…</p>
<p><em>What’s the best time of the day to post a story on Hacker News?</em></p>
<p>Before we get started, let’s run this query and take a look at the <code>timestamp</code> column:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT timestamp</span><br><span class="line">FROM hacker_news</span><br><span class="line">LIMIT 10;</span><br></pre></td></tr></table></figure>

<p>Notice that the values are formatted like:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2018-05-08T12:30:00Z</span><br></pre></td></tr></table></figure>

<p>If you ignore the <code>T</code> and <code>Z</code>, the format is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YYYY-MM-DD HH:MM:SS</span><br></pre></td></tr></table></figure>

<p>Stuck? Get a hint</p>
<p><strong>9.</strong></p>
<p>SQLite comes with a <code>strftime()</code> function - a very powerful function that allows you to return a formatted date.</p>
<p>It takes two arguments:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strftime(format, column)</span><br></pre></td></tr></table></figure>

<p>Let’s test this function out:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT timestamp,</span><br><span class="line">   strftime(&#39;%H&#39;, timestamp)</span><br><span class="line">FROM hacker_news</span><br><span class="line">GROUP BY 1</span><br><span class="line">LIMIT 20;</span><br></pre></td></tr></table></figure>

<p>What do you think this does? Open the hint if you’d like to learn more.</p>
<p>Stuck? Get a hint</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 8, 9</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">timestamp</span></span><br><span class="line"><span class="keyword">from</span> hacker_news</span><br><span class="line"><span class="keyword">limit</span> <span class="number">15</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">timestamp</span>,</span><br><span class="line">  strftime(<span class="string">'%H'</span>, <span class="built_in">timestamp</span>)</span><br><span class="line"><span class="keyword">from</span> hacker_news</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="comment">-- order by </span></span><br><span class="line"><span class="keyword">limit</span> <span class="number">15</span>;</span><br><span class="line"><span class="comment">-- This returns the hour, HH, of the timestamp column!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- For strftime(__, timestamp):</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- %Y returns the year (YYYY)</span></span><br><span class="line"><span class="comment">-- %m returns the month (01-12)</span></span><br><span class="line"><span class="comment">-- %d returns the day of the month (1-31)</span></span><br><span class="line"><span class="comment">-- %H returns 24-hour clock (00-23)</span></span><br><span class="line"><span class="comment">-- %M returns the minute (00-59)</span></span><br><span class="line"><span class="comment">-- %S returns the seconds (00-59)</span></span><br><span class="line"><span class="comment">-- if timestamp format is YYYY-MM-DD HH:MM:SS.</span></span><br></pre></td></tr></table></figure>



<p><strong>10.</strong></p>
<p>Okay, now we understand how <code>strftime()</code> works. Let’s write a query that returns three columns:</p>
<ol>
<li>The hours of the <code>timestamp</code></li>
<li>The <em>average</em> <code>score</code> for each hour</li>
<li>The <em>count</em> of stories for each hour</li>
</ol>
<p>Stuck? Get a hint</p>
<p><strong>11.</strong></p>
<p>Let’s edit a few things in the previous query:</p>
<ul>
<li>Round the average <code>score</code>s (<code>ROUND()</code>).</li>
<li>Rename the columns to make it more readable (<code>AS</code>).</li>
<li>Add a <code>WHERE</code> clause to filter out the <code>NULL</code> values in <code>timestamp</code>.</li>
</ul>
<p>Take a look at the result again:</p>
<p>What are the best hours to post a story on Hacker News?</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 10 ●○●○● </span></span><br><span class="line"><span class="keyword">select</span> strftime(<span class="string">'%H'</span>, <span class="built_in">timestamp</span>), <span class="keyword">avg</span>(score) ,<span class="keyword">count</span>(*)</span><br><span class="line"><span class="keyword">from</span> hacker_news</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- limit 15;</span></span><br><span class="line"><span class="comment">-- having sum(score)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 11</span></span><br><span class="line"><span class="keyword">select</span> strftime(<span class="string">'%H'</span>, <span class="built_in">timestamp</span>) <span class="keyword">AS</span> <span class="keyword">Hour</span>, <span class="keyword">round</span>(<span class="keyword">avg</span>(score), <span class="number">2</span>) <span class="keyword">AS</span> <span class="string">'Average Score'</span>,<span class="keyword">count</span>(*) <span class="keyword">AS</span> <span class="string">'# of Stories'</span></span><br><span class="line"><span class="keyword">from</span> hacker_news</span><br><span class="line"><span class="keyword">where</span> <span class="built_in">timestamp</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>  <span class="comment">-- 注意！！　這裡不能寫１，而要用本來的column名</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc5jrvpb7ij30fi0bq3yv.jpg" alt="image-20200222222825218" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc5k2mxbs4j31520hitmq.jpg" alt="image-20200222223832094" style="zoom:67%;" />



<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc5ka80insj31b00caqf3.jpg" alt="image-20200222224606164" style="zoom:67%;" /></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/18/SQL/2020-02-18-SQL-Cases/">SQL/2020-02-18-SQL-Cases</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-18</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><p><a href="https://www.codecademy.com/practice/projects/world-populations-sql-practice-ii" target="_blank" rel="noopener">https://www.codecademy.com/practice/projects/world-populations-sql-practice-ii</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- How many entries in the database are from Africa?</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">count</span>(*) </span><br><span class="line"><span class="keyword">FROM</span> countries <span class="keyword">where</span> continent = <span class="string">'Africa'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- What was the total population of Oceania in 2005?</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sum</span>(population)</span><br><span class="line"><span class="keyword">from</span> population_years <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> countries</span><br><span class="line"><span class="keyword">on</span> tb1.country_id = countries.id</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">year</span> = <span class="number">2005</span> <span class="keyword">and</span> continent = <span class="string">'Oceania'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- What is the average population of countries in South America in 2003?</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(population)</span><br><span class="line"><span class="keyword">from</span> population_years <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> countries</span><br><span class="line"><span class="keyword">on</span> tb1.country_id = countries.id</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">year</span> = <span class="number">2003</span> <span class="keyword">and</span> continent = <span class="string">'South America'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- What country had the smallest population in 2007?</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">min</span>(population)</span><br><span class="line"><span class="keyword">from</span> population_years <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> countries</span><br><span class="line"><span class="keyword">on</span> tb1.country_id = countries.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- What is the average population of Poland during the time period covered by this dataset?</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(population)</span><br><span class="line"><span class="keyword">from</span> population_years <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> countries </span><br><span class="line"><span class="keyword">on</span> tb1.country_id = countries.id</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">name</span> = <span class="string">'Poland'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- How many countries have the word "The" in their name?</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*)</span><br><span class="line"><span class="keyword">from</span> countries</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%The%'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- What was the total population of each continent in 2010?</span></span><br><span class="line"><span class="keyword">select</span> continent, <span class="keyword">sum</span>(tb1.population)</span><br><span class="line"><span class="keyword">from</span> population_years <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> countries</span><br><span class="line"><span class="keyword">on</span> tb1.country_id = countries.id</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">year</span> = <span class="number">2010</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">by</span> continent;</span><br></pre></td></tr></table></figure>











<h1 id="Trends-in-Startups"><a href="#Trends-in-Startups" class="headerlink" title="Trends in Startups"></a>Trends in Startups</h1><p>Howdy! It’s your first day as a <a href="https://techcrunch.com/" target="_blank" rel="noopener">TechCrunch</a> reporter. Your first task is to write an article on the rising trends in the startup world.</p>
<p>To get you started with your research, your boss emailed you a <strong>project.sqlite</strong> file that contains a table called <code>startups</code>. It is a portfolio of some of the biggest names in the industry.</p>
<p>Write queries with aggregate functions to retrieve some interesting insights about these companies.</p>
<p>What are you waiting for? Let’s get started!</p>
<p>If you get stuck during this project or would like to see an experienced developer work through it, click “<strong>Get Help</strong>“ to see a <strong>project walkthrough video</strong>.</p>
<p>Tasks</p>
<p>14/14Complete</p>
<p>Mark the tasks as complete by checking them off</p>
<h3 id="Write-the-following-queries"><a href="#Write-the-following-queries" class="headerlink" title="Write the following queries:"></a>Write the following queries:</h3><p><strong>1.</strong></p>
<p>Getting started, take a look at the <code>startups</code> table:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM startups;</span><br></pre></td></tr></table></figure>

<p>How many columns are there?</p>
<p>Stuck? Get a hint</p>
<p><strong>2.</strong></p>
<p>Calculate the total number of companies in the table.</p>
<p>Stuck? Get a hint</p>
<p><strong>3.</strong></p>
<p>We want to know the total value of all companies in this table.</p>
<p>Calculate this by getting the <code>SUM()</code> of the <code>valuation</code> column.</p>
<p>Stuck? Get a hint</p>
<p><strong>4.</strong></p>
<p>What is the highest amount raised by a startup?</p>
<p>Return the maximum amount of money <code>raised</code>.</p>
<p>Stuck? Get a hint</p>
<p><strong>5.</strong></p>
<p>Edit the query so that it returns the maximum amount of money <code>raised</code>, during ‘Seed’ stage.</p>
<p>Stuck? Get a hint</p>
<p><strong>6.</strong></p>
<p>In what year was the oldest company on the list founded?</p>
<p>Stuck? Get a hint</p>
<h3 id="Let’s-find-out-the-valuations-among-different-sectors"><a href="#Let’s-find-out-the-valuations-among-different-sectors" class="headerlink" title="Let’s find out the valuations among different sectors:"></a>Let’s find out the valuations among different sectors:</h3><p><strong>7.</strong></p>
<p>Return the average <code>valuation</code>.</p>
<p>Stuck? Get a hint</p>
<p><strong>8.</strong></p>
<p>Return the average <code>valuation</code>, in each <code>category</code>.</p>
<p>Stuck? Get a hint</p>
<p><strong>9.</strong></p>
<p>Return the average <code>valuation</code>, in each <code>category</code>.</p>
<p>Round the averages to two decimal places.</p>
<p>Stuck? Get a hint</p>
<p><strong>10.</strong></p>
<p>Return the average <code>valuation</code>, in each <code>category</code>.</p>
<p>Round the averages to two decimal places.</p>
<p>Lastly, order the list from highest averages to lowest.</p>
<p>Stuck? Get a hint</p>
<h3 id="What-are-the-most-competitive-markets"><a href="#What-are-the-most-competitive-markets" class="headerlink" title="What are the most competitive markets?"></a>What are the most competitive markets?</h3><p><strong>11.</strong></p>
<p>First, return the name of each <code>category</code> with the total number of companies that belong to it.</p>
<p>Stuck? Get a hint</p>
<p><strong>12.</strong></p>
<p>Next, filter the result to only include categories that have more than three companies in them.</p>
<p>What are the most competitive markets?</p>
<p>Stuck? Get a hint</p>
<h3 id="Let’s-see-if-there’s-a-difference-in-startups-sizes-among-different-locations"><a href="#Let’s-see-if-there’s-a-difference-in-startups-sizes-among-different-locations" class="headerlink" title="Let’s see if there’s a difference in startups sizes among different locations:"></a>Let’s see if there’s a difference in startups sizes among different locations:</h3><p><strong>13.</strong></p>
<p>What is the average size of a startup in each <code>location</code>?</p>
<p>Stuck? Get a hint</p>
<p><strong>14.</strong></p>
<p>What is the average size of a startup in each <code>location</code>, with average sizes above 500?</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- name	location	category	employees	raised	valuation	founded	stage	ceo	info</span></span><br><span class="line"><span class="comment">-- Pied Piper	Silicon Valley	Cloud Computing	6	5000000	50000000	2014	A	Richard Hendricks	A Middle-Out Compression Solution</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select * from startups;</span></span><br><span class="line"><span class="comment">-- select count(*)  from startups;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select sum(valuation)  from startups;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select max(raised)  from startups;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- -- 5</span></span><br><span class="line"><span class="comment">-- select max(raised)  </span></span><br><span class="line"><span class="comment">-- from startups</span></span><br><span class="line"><span class="comment">-- where stage = 'Seed';</span></span><br><span class="line"><span class="comment">-- -- 6</span></span><br><span class="line"><span class="comment">-- select min(founded) </span></span><br><span class="line"><span class="comment">-- from startups;</span></span><br><span class="line"><span class="comment">-- -- 7</span></span><br><span class="line"><span class="comment">-- select avg(valuation) </span></span><br><span class="line"><span class="comment">-- from startups;</span></span><br><span class="line"><span class="comment">-- -- 8</span></span><br><span class="line"><span class="comment">-- select category, avg(valuation) </span></span><br><span class="line"><span class="comment">-- from startups</span></span><br><span class="line"><span class="comment">-- group by category;</span></span><br><span class="line"><span class="comment">-- -- 9</span></span><br><span class="line"><span class="comment">-- select category, round(avg(valuation), 2)</span></span><br><span class="line"><span class="comment">-- from startups</span></span><br><span class="line"><span class="comment">-- group by category;</span></span><br><span class="line"><span class="comment">-- -- 10</span></span><br><span class="line"><span class="comment">-- select category, round(avg(valuation), 2)</span></span><br><span class="line"><span class="comment">-- from startups</span></span><br><span class="line"><span class="comment">-- group by category</span></span><br><span class="line"><span class="comment">-- order by 2 desc;</span></span><br><span class="line"><span class="comment">-- -- 11</span></span><br><span class="line"><span class="comment">-- -- select category, count(company)</span></span><br><span class="line"><span class="comment">-- select category, count(*)</span></span><br><span class="line"><span class="comment">-- from startups</span></span><br><span class="line"><span class="comment">-- group by category;</span></span><br><span class="line"><span class="comment">-- -- 12</span></span><br><span class="line"><span class="comment">-- -- -- select category, count(company)</span></span><br><span class="line"><span class="comment">-- select category, count(*)</span></span><br><span class="line"><span class="comment">-- from startups</span></span><br><span class="line"><span class="comment">-- group by category</span></span><br><span class="line"><span class="comment">-- having count(*) &gt; 3</span></span><br><span class="line"><span class="comment">-- order by 2 desc;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select * from startups;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 13</span></span><br><span class="line"><span class="comment">-- select location, avg(valuation)</span></span><br><span class="line"><span class="keyword">select</span> location, <span class="keyword">avg</span>(employees)</span><br><span class="line"><span class="keyword">from</span> startups</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> location</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">avg</span>(employees) &gt; <span class="number">500</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- having avg(*)</span></span><br></pre></td></tr></table></figure>



</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/11/LC/2020-02-10-LC%20High-G/">LC/2020-02-10-LC High-G</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/LC/">LC</a></span><div class="content"><h2 id="Recursion-Ⅱ"><a href="#Recursion-Ⅱ" class="headerlink" title="Recursion Ⅱ"></a>Recursion Ⅱ</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#904">904 Fruit Into Basket</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#51">51 N-Queens</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#52">52 N-Queens Ⅱ</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Process"><a href="#Process" class="headerlink" title="Process"></a>Process</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#929">929 Unique Email Address</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td>[Odd Even Jump]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Licese Key Formatting]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#904">904 Fruit Into Baskets</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="Arrays-and-Strings"><a href="#Arrays-and-Strings" class="headerlink" title="Arrays and Strings"></a>Arrays and Strings</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#3">3 Longest Substring Without Repeating Characters</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#11">11 Container with Most Water</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#15">15 3Sum</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#31">31 Next Permutation</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>待review</td>
</tr>
<tr>
<td><a href="#43">43 Multiply Strings</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#48">48 Rotate Image</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td>[Jump Game]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#66">66 Plus One</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td>[Minumum Window Substring]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Read N Characters Given]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Longest Substring with At ]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Missing Ranges]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Nezxt Closet Time]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Expressive Wods]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Find And Replace in String]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Maximize Distance to ]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#20">20 Valid Parentheses</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#23">23 Merge K Sorted Lists</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#42">42 Trapping Rain Water</a></td>
<td></td>
<td>當時感覺來了DP一次就對</td>
<td>2 ptrs</td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#215">215 Kth Largest Element in an Array</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Linked-List"><a href="#Linked-List" class="headerlink" title="Linked List"></a>Linked List</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>Coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#2">2 Add Two Numbers</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#19">19 Remove Nth Node From End of List</a></td>
<td></td>
<td>讓快的先走，開始rm時候要小心就是</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#21">21 Merge Two Sorted Lists</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#138">138 Copy List with Random Pointer</a></td>
<td></td>
<td>bottom up recursive 解時記得要先把做出來的node 加到visited, 不然random會一直叫下去不停</td>
<td>待試iterative</td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Trees-amp-Graphs"><a href="#Trees-amp-Graphs" class="headerlink" title="Trees &amp; Graphs"></a>Trees &amp; Graphs</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>Coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>[Binary Tree Maximum Path Sum]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong><a href="#127">127 Word Ladder</a></strong></td>
<td></td>
<td>用了双向BFS， 目前仍是TLE</td>
<td>待嘗試動態建圖</td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#200">200 Number of Islands</a></td>
<td></td>
<td>BFS 是最好的解，就熟它吧</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td>[Course Schedule Ⅱ]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#222">222 Count Complete Tree Nodes</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#543">543 Diameter of Binary Tree</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#951">951 Flip Equivalent Binary Trees</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Recursion"><a href="#Recursion" class="headerlink" title="Recursion"></a>Recursion</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#17">17 Letter Combination of a Phone Number</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#79">79 Word Search</a></td>
<td></td>
<td>TLE…</td>
<td>Solve by not deepcopying board</td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#212">212 Word Search</a></td>
<td></td>
<td>TLE with Also. from <a name="79">79</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="Sorting-and-Searching"><a href="#Sorting-and-Searching" class="headerlink" title="Sorting and Searching"></a>Sorting and Searching</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#34">34 Find First and Last Position of Element in Sorted Array</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#56">56 Merge Intervals</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#242">242 Valid Anagram</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#852">852 Peak Index in a Mountain Array</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="DP"><a href="#DP" class="headerlink" title="DP"></a>DP</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Longest Palindromic Subse</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#53">53 Maximum Subarray</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="Design"><a href="#Design" class="headerlink" title="Design"></a>Design</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>Coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#146">146 LRU Cache</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#155">155 Min Stack</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="2"><a href="#2" class="headerlink" title="2"></a><a name="2">2</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">2 4  3 </span></span><br><span class="line"><span class="string">5 6  4 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">7 10 </span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addTwoNumbers</span><span class="params">(self, l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        carry = <span class="number">0</span></span><br><span class="line">        dummy = cur = ListNode(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># loop = 0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> l1 <span class="keyword">or</span> l2:</span><br><span class="line">            <span class="comment"># total = l1.val + l2.val + carry</span></span><br><span class="line">            m, n = l1.val <span class="keyword">if</span> l1 <span class="keyword">else</span> <span class="number">0</span>, l2.val <span class="keyword">if</span> l2 <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">            total = m + n + carry</span><br><span class="line">            carry, digit = total//<span class="number">10</span>, total%<span class="number">10</span></span><br><span class="line">            cur.next = ListNode(digit)</span><br><span class="line">            cur = cur.next</span><br><span class="line">            l1, l2 = l1.next <span class="keyword">if</span> l1 <span class="keyword">else</span> <span class="literal">None</span>, l2.next <span class="keyword">if</span> l2 <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">            </span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        while l1 and l2:</span></span><br><span class="line"><span class="string">            total = l1.val + l2.val + carry</span></span><br><span class="line"><span class="string">            carry, digit = total//10, total%10  # 2 5 -&gt; 0 7, 4 6 =&gt; 1 0</span></span><br><span class="line"><span class="string">            # result = total * (10**loop) + result    # 10**1, 700    700   7*100 + 107</span></span><br><span class="line"><span class="string">            cur.next = ListNode(digit)</span></span><br><span class="line"><span class="string">            cur = cur.next</span></span><br><span class="line"><span class="string">            l1, l2 = l1.next, l2.next</span></span><br><span class="line"><span class="string">            # loop += 1</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        rem = l1 if l1 else l2</span></span><br><span class="line"><span class="string">        while rem:</span></span><br><span class="line"><span class="string">            total = rem.val + carry</span></span><br><span class="line"><span class="string">            carry, digit = total//10, total%10</span></span><br><span class="line"><span class="string">            cur.next = ListNode(digit)</span></span><br><span class="line"><span class="string">            cur = cur.next</span></span><br><span class="line"><span class="string">            # result = total * (10**loop) + result</span></span><br><span class="line"><span class="string">            rem = rem.next</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="keyword">if</span> carry:</span><br><span class="line">            cur.next = ListNode(carry)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br></pre></td></tr></table></figure>



<h3 id="3"><a href="#3" class="headerlink" title="3"></a><a name="3">3</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">　 a　b　c　a　b　c　b　b　</span></span><br><span class="line"><span class="string">             i     j</span></span><br><span class="line"><span class="string">-1 0 </span></span><br><span class="line"><span class="string">&#123;a:0, b:1, c:2&#125;  --&gt; &#123;a:3, b:1, c:2&#125; max_len = max(j - i, max_len)</span></span><br><span class="line"><span class="string">                 --&gt; &#123;a:3, b:4, c:5&#125; max_len = max(j - i, max_len)</span></span><br><span class="line"><span class="string">                 --&gt; &#123;a:3, b:4, c:5&#125; max_len = max(j - i, max_len)</span></span><br><span class="line"><span class="string">                 </span></span><br><span class="line"><span class="string">　 a　b　c　a　b　c　b　b　c a d</span></span><br><span class="line"><span class="string">                   i j  --&gt; &#123;a:3, b:7, c:5&#125; max_len = max(j - i, max_len)</span></span><br><span class="line"><span class="string">                   we can del d[a]  del[c] </span></span><br><span class="line"><span class="string">                   BUT,</span></span><br><span class="line"><span class="string">                 --&gt; i = max(i, d[a])</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">     a b c a b c b b  a </span></span><br><span class="line"><span class="string">             j   i </span></span><br><span class="line"><span class="string">i   0    2  </span></span><br><span class="line"><span class="string">j   0</span></span><br><span class="line"><span class="string">od  &#123;a&#125;  &#123;a b c&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    j       i       od                                                  dis</span></span><br><span class="line"><span class="string">    0       0       &#123;a:0&#125;                                                   1  </span></span><br><span class="line"><span class="string">    0       1       &#123;a:0 b:1&#125;                                                  2</span></span><br><span class="line"><span class="string">    0       2       &#123;a:0 b:1 c:2&#125;                                                     3</span></span><br><span class="line"><span class="string">    0       3       &#123;a:0 b:1 c:2&#125;    ==&gt;      while j 1   i 3   &#123;b:1 c:2 a:3&#125;          3</span></span><br><span class="line"><span class="string">    1       4       &#123;b:1 c:2 a:3&#125;     =&gt;      while j 2   i 4   &#123;c a b&#125;           3</span></span><br><span class="line"><span class="string">    2       5       &#123;&#125;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(self, s: str)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        od = OrderedDict()  <span class="comment"># position od</span></span><br><span class="line">        j = <span class="number">-1</span></span><br><span class="line">        g_max = cur_max = <span class="number">0</span></span><br><span class="line">        rec = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">            sym = s[i]</span><br><span class="line">            <span class="keyword">if</span> sym <span class="keyword">not</span> <span class="keyword">in</span> od:</span><br><span class="line">                od[sym] = i</span><br><span class="line">            <span class="keyword">else</span>:                           <span class="comment"># a b c b </span></span><br><span class="line">                <span class="comment"># while sym in od_pos:</span></span><br><span class="line">                    <span class="comment"># del od_pos[sym]</span></span><br><span class="line">                j = max(od[sym], j)</span><br><span class="line">                od[sym] = i     <span class="comment"># a 0</span></span><br><span class="line">                <span class="comment"># sym = od[j]</span></span><br><span class="line">                </span><br><span class="line">            cur_max = i - j</span><br><span class="line">            <span class="keyword">if</span> cur_max &gt; g_max:</span><br><span class="line">                g_max = cur_max</span><br><span class="line">                rec.append((i, j))</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> g_max</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># i = -1</span></span><br><span class="line">        <span class="comment"># max_len = 0</span></span><br><span class="line">        <span class="comment"># lkup = &#123;&#125;</span></span><br><span class="line">        <span class="comment"># for j in range(len(s)):</span></span><br><span class="line">        <span class="comment">#     if s[j] not in lkup:</span></span><br><span class="line">        <span class="comment">#         lkup[s[j]] = j</span></span><br><span class="line">        <span class="comment">#     else:</span></span><br><span class="line">        <span class="comment">#         i = max(lkup[s[j]], i)   # e.g. i at 7, doesn't go back to (6, c)</span></span><br><span class="line">        <span class="comment">#                                 # move i before update lkup[s[i]]</span></span><br><span class="line">        <span class="comment">#         lkup[s[j]] = j  # &#123;a:3, b:1, c:2&#125;</span></span><br><span class="line">        <span class="comment">#     max_len = max(max_len, j - i)   # 2 - (-1) = 3</span></span><br><span class="line">        <span class="comment"># return max_len</span></span><br><span class="line">                </span><br><span class="line">            <span class="comment"># if s[j] in lkup:</span></span><br><span class="line">            <span class="comment">#     max_len = max(max_len, j - i)</span></span><br><span class="line">            <span class="comment"># lkup[s[j]] = i</span></span><br></pre></td></tr></table></figure>



<h3 id="11"><a href="#11" class="headerlink" title="11"></a><a name="11">11</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">=== Mis-Understanding ===</span></span><br><span class="line"><span class="string">            [1,8,6,2,5,4,8,3,7]</span></span><br><span class="line"><span class="string">l_larger =  [0 0 1 1 2 1 5 1 2]</span></span><br><span class="line"><span class="string">r_larger =  [1 5 4 1 2 1 0 1 0]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">width[i] = l_larger[i] + r_larger[i]</span></span><br><span class="line"><span class="string">water = height[i] * width[i]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">=== Again-Understanding ==&gt; Still Wrong ! ===</span></span><br><span class="line"><span class="string">            [1,8,6,2, 5, 4, 8, 3, 7]</span></span><br><span class="line"><span class="string">l_dis =     [0 0 1 2  3  4  5  6  7]</span></span><br><span class="line"><span class="string">r_dis =     [8 5 6 5  4  3  0  1  0]</span></span><br><span class="line"><span class="string">ans      =. [8 0 6 10 12 12 40 21 49]</span></span><br><span class="line"><span class="string">width[i] = l_larger[i] + r_larger[i]</span></span><br><span class="line"><span class="string">water = height[i] * width[i]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxArea</span><span class="params">(self, height: List[int])</span> -&gt; int:</span></span><br><span class="line">        l, r = <span class="number">0</span>, len(height)<span class="number">-1</span></span><br><span class="line">        </span><br><span class="line">        g_area = area = <span class="number">0</span></span><br><span class="line">        rec = []</span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            h = min(height[l], height[r])    </span><br><span class="line">            area = h * (r-l)</span><br><span class="line">            <span class="keyword">if</span> height[l] &lt;= height[r]:</span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">            <span class="keyword">if</span> area &gt; g_area:</span><br><span class="line">                g_area = area</span><br><span class="line">                rec.append((l, r))</span><br><span class="line">                print(l, r)</span><br><span class="line">        <span class="keyword">return</span> g_area</span><br><span class="line">        </span><br><span class="line">        n = len(height)</span><br><span class="line">        l, r  = <span class="number">0</span>, len(height)<span class="number">-1</span></span><br><span class="line">        g_max = cur_area = <span class="number">0</span> </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            cur_area = (r - l) * min(height[l], height[r])</span><br><span class="line">            g_max = max(g_max, cur_area)</span><br><span class="line">            <span class="keyword">if</span> height[l] &lt;= height[r]:</span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> g_max</span><br></pre></td></tr></table></figure>



<h3 id="15"><a href="#15" class="headerlink" title="15"></a><a name="15">15</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># i, l, r</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">threeSum</span><span class="params">(self, nums: List[int])</span> -&gt; List[List[int]]:</span></span><br><span class="line">        nums.sort()</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)<span class="number">-2</span>):</span><br><span class="line">            l, r = i+<span class="number">1</span>, len(nums)<span class="number">-1</span></span><br><span class="line">            <span class="keyword">if</span> nums[i] <span class="keyword">and</span> nums[i] + nums[r<span class="number">-1</span>] + nums[r] &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> nums[r] &lt; <span class="number">0</span> <span class="keyword">and</span> nums[i] + nums[i+<span class="number">1</span>] + nums[r] &lt; <span class="number">0</span>:      <span class="comment"># nums[i] still has chance to overbeat l &amp; r</span></span><br><span class="line">                <span class="keyword">continue</span>    </span><br><span class="line">            <span class="keyword">if</span> i &gt; <span class="number">0</span> <span class="keyword">and</span> nums[i] == nums[i<span class="number">-1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            total = nums[i] + nums[l] + nums[r]</span><br><span class="line">            <span class="keyword">if</span> total == <span class="number">0</span>:</span><br><span class="line">                res.append([i, l, r])</span><br><span class="line">                <span class="comment"># while l&lt;r and nums[l] == nums[l+1]:</span></span><br><span class="line">                <span class="keyword">while</span> l+<span class="number">1</span>&lt;r <span class="keyword">and</span> nums[l] == nums[l+<span class="number">1</span>]:    </span><br><span class="line">                    l += <span class="number">1</span></span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">                <span class="comment"># while l&lt;rnums[r] == nums[r-1]:</span></span><br><span class="line">                <span class="keyword">while</span> r<span class="number">-1</span>&gt;l <span class="keyword">and</span> l&lt;rnums[r] == nums[r<span class="number">-1</span>]:</span><br><span class="line">                    r -= <span class="number">1</span></span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> total &lt; <span class="number">0</span>:</span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        nums.sort()</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)<span class="number">-2</span>):  <span class="comment"># i, l, r</span></span><br><span class="line">            l, r = i + <span class="number">1</span>, len(nums) - <span class="number">1</span></span><br><span class="line">            total = nums[i] + nums[l] + nums[r] <span class="comment"># prune here</span></span><br><span class="line">            <span class="comment"># if nums[i] &gt; 0:     # left most</span></span><br><span class="line">            <span class="comment">#     return res      </span></span><br><span class="line">            <span class="comment"># if nums[r] &lt; 0:     # right most</span></span><br><span class="line">            <span class="comment">#     return res</span></span><br><span class="line">            <span class="keyword">if</span> nums[i] &gt; <span class="number">0</span> <span class="keyword">and</span> nums[i] + nums[l] + nums[r] &gt; <span class="number">0</span>: <span class="comment"># r can be small</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> nums[r] &lt; <span class="number">0</span> <span class="keyword">and</span> nums[i] + nums[r<span class="number">-1</span>] + nums[r] &lt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> i &gt; <span class="number">0</span> <span class="keyword">and</span> nums[i] == nums[i<span class="number">-1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">while</span> l &lt; r:            <span class="comment"># -99 8 10 99</span></span><br><span class="line">                total = nums[i] + nums[l] + nums[r]</span><br><span class="line">                <span class="keyword">if</span> total == <span class="number">0</span>: </span><br><span class="line">                    res.append([nums[i], nums[l], nums[r]])</span><br><span class="line">                    <span class="string">''' The following "whiles" are CRUCIAL...'''</span></span><br><span class="line">                    <span class="comment"># -4 -1 -1 0 1 2 </span></span><br><span class="line">                    <span class="comment">#        idx</span></span><br><span class="line">                    <span class="comment">#     i   1  </span></span><br><span class="line">                    <span class="comment">#     l   2</span></span><br><span class="line">                    <span class="comment">#     r   5</span></span><br><span class="line">                    <span class="string">''' #[-2 -1 0 1 2 3] failed for [-1 0 1] 'cause l &amp; r overlapped '''</span></span><br><span class="line">                    <span class="keyword">while</span> l &lt; r <span class="keyword">and</span> nums[l+<span class="number">1</span>] == nums[l]:  </span><br><span class="line">                        l += <span class="number">1</span></span><br><span class="line">                    <span class="comment"># l += 1</span></span><br><span class="line">                    <span class="keyword">while</span> r &gt; l <span class="keyword">and</span> nums[r<span class="number">-1</span>] == nums[r]:</span><br><span class="line">                        r -= <span class="number">1</span></span><br><span class="line">                    <span class="comment"># r -= 1</span></span><br><span class="line">                    <span class="comment">#'''                    </span></span><br><span class="line">                    l, r = l + <span class="number">1</span>, r - <span class="number">1</span>   <span class="comment">#''' l+1 should before while of r '''</span></span><br><span class="line">                <span class="keyword">elif</span> total &lt; <span class="number">0</span>:</span><br><span class="line">                    l += <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    r -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="17"><a href="#17" class="headerlink" title="17"></a><a name="17">17</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2 3 4</span></span><br><span class="line"><span class="comment"># a d g</span></span><br><span class="line"><span class="comment"># b e h</span></span><br><span class="line"><span class="comment"># c f i</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">letterCombinations</span><span class="params">(self, digits: str)</span> -&gt; List[str]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> digits:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        self.d = &#123;<span class="string">'1'</span>:<span class="string">''</span>, <span class="string">'2'</span>:<span class="string">'abc'</span>, <span class="string">'3'</span>:<span class="string">'def'</span>, <span class="string">'4'</span>:<span class="string">'ghi'</span>, <span class="string">'5'</span>:<span class="string">'jkl'</span>, <span class="string">'6'</span>:<span class="string">'mno'</span>, <span class="string">'7'</span>:<span class="string">'pqrs'</span>, <span class="string">'8'</span>:<span class="string">'tuv'</span>, <span class="string">'9'</span>:<span class="string">'wxyz'</span>&#125;</span><br><span class="line">        self.result = []</span><br><span class="line">        self.helper(digits, <span class="string">''</span>, <span class="number">0</span>)        <span class="comment"># THIS IS ALREADY OK!</span></span><br><span class="line">        <span class="comment"># print(self.result)    </span></span><br><span class="line">        <span class="keyword">return</span> self.result</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, digits, item, level)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> level == len(digits):</span><br><span class="line">            <span class="comment"># self.result.append(item.copy())   # String has no attribute copy</span></span><br><span class="line">            self.result.append(item)    <span class="comment"># just call permutation here! Another backtracking for PERMUTATION</span></span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">        cur_digit = digits[level]   <span class="comment"># 2         3        </span></span><br><span class="line">        cur_candidates = self.d[cur_digit]          <span class="comment"># abc,      def</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(cur_candidates)):</span><br><span class="line">            item += cur_candidates[i]     <span class="comment"># def   </span></span><br><span class="line">            self.helper(digits, item, level+<span class="number">1</span>)</span><br><span class="line">            item = item[:<span class="number">-1</span>]    <span class="comment"># pop()</span></span><br></pre></td></tr></table></figure>



<h3 id="19"><a href="#19" class="headerlink" title="19"></a><a name="19">19</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> &gt; <span class="number">2</span> &gt; <span class="number">3</span> &gt; <span class="number">4</span> &gt; <span class="number">5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">removeNthFromEnd</span><span class="params">(self, head: ListNode, n: int)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        dummy = cur = later = ListNode(<span class="number">0</span>)</span><br><span class="line">        dummy.next = head</span><br><span class="line">        </span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> count &lt; n <span class="keyword">and</span> cur:</span><br><span class="line">            cur = cur.next</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">if</span> n &lt; count:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        0 1 2 3 4 5 </span></span><br><span class="line"><span class="string">              l   c</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        0  1</span></span><br><span class="line"><span class="string">        l  c</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="keyword">while</span> cur.next:</span><br><span class="line">            cur = cur.next</span><br><span class="line">            later = later.next</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> later.next:</span><br><span class="line">            <span class="string">''' remove later.next '''</span></span><br><span class="line">            <span class="comment"># later.next.next = None</span></span><br><span class="line">            later.next = later.next.next</span><br><span class="line">            <span class="comment"># later.next = None</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br></pre></td></tr></table></figure>



<h3 id="20"><a href="#20" class="headerlink" title="20"></a><a name="20">20</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValid</span><span class="params">(self, s: str)</span> -&gt; bool:</span></span><br><span class="line">        d = &#123;<span class="string">'('</span>: <span class="string">')'</span>, <span class="string">'['</span>:<span class="string">']'</span>, <span class="string">'&#123;'</span>:<span class="string">'&#125;'</span>&#125;</span><br><span class="line">        </span><br><span class="line">        S = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">            <span class="keyword">if</span> c == <span class="string">'('</span> <span class="keyword">or</span> c == <span class="string">'['</span> <span class="keyword">or</span> c ==<span class="string">'&#123;'</span>:</span><br><span class="line">                S.append(c)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> S:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    elem = S.pop()</span><br><span class="line">                    <span class="keyword">if</span> d[elem] != c:</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> S</span><br></pre></td></tr></table></figure>





<h3 id="21"><a href="#21" class="headerlink" title="21"></a><a name="21">21</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">    1 2 4 </span></span><br><span class="line"><span class="string">    i</span></span><br><span class="line"><span class="string">    1 3 4 </span></span><br><span class="line"><span class="string">cur -&gt; smaller one</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mergeTwoLists</span><span class="params">(self, l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="comment"># return l2 if not l1</span></span><br><span class="line">        <span class="comment"># return l1 if not l2</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1: <span class="keyword">return</span> l2</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l2: <span class="keyword">return</span> l1</span><br><span class="line">        dummy = cur = ListNode(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># dummy.next = </span></span><br><span class="line">        self.helper2(cur, l1, l2)</span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper2</span><span class="params">(self, root, l1, l2)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1:</span><br><span class="line">            root.next = l2</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l2:</span><br><span class="line">            root.next = l1</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> l1.val &lt;= l2.val:</span><br><span class="line">            root.next = l1</span><br><span class="line">            l1 = l1.next        </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            root.next = l2</span><br><span class="line">            l2 = l2.next</span><br><span class="line">            </span><br><span class="line">        root = root.next</span><br><span class="line">        self.helper2(root, l1, l2)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mergeTwoLists_alsoOK</span><span class="params">(self, l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1:</span><br><span class="line">            <span class="keyword">return</span> l2</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l2:</span><br><span class="line">            <span class="keyword">return</span> l1</span><br><span class="line">        dummy = ListNode(<span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># self.helper(l1, l2)   # Iterative</span></span><br><span class="line">        self.recursive(dummy, l1, l2)</span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    Input: 1-&gt;2-&gt;4, 1-&gt;3-&gt;4</span></span><br><span class="line"><span class="string">    Output: 1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="string">''' recursive '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recursive</span><span class="params">(self, root, l1, l2)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l2:</span><br><span class="line">            root.next = l1</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1:</span><br><span class="line">            root.next = l2</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> l1.val &lt;= l2.val:</span><br><span class="line">            root.next = l1</span><br><span class="line">            l1 = l1.next</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            root.next = l2</span><br><span class="line">            l2 = l2.next</span><br><span class="line">        <span class="comment"># root = root.next</span></span><br><span class="line">        </span><br><span class="line">        self.recursive(root.next, l1, l2)</span><br><span class="line">    </span><br><span class="line">    <span class="string">''' Iterative '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, l1, l2)</span>:</span></span><br><span class="line">        </span><br><span class="line">        head = cur = ListNode(<span class="number">0</span>) <span class="comment">#l1 if l1.val &lt;= l2.val else l2</span></span><br><span class="line">        prev = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">while</span> l1 <span class="keyword">and</span> l2:</span><br><span class="line">            <span class="keyword">if</span> l1.val &lt;= l2.val:</span><br><span class="line">                cur.next = l1</span><br><span class="line">                l1 = l1.next</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur.next = l2</span><br><span class="line">                l2 = l2.next</span><br><span class="line">            cur = cur.next</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l2 <span class="keyword">and</span> <span class="keyword">not</span> l1:</span><br><span class="line">            cur.next = <span class="literal">None</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l2:</span><br><span class="line">            cur.next = l1</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cur.next = l2</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> head.next</span><br></pre></td></tr></table></figure>



<h3 id="23"><a href="#23" class="headerlink" title="23"></a><a name="23">23</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mergeKLists</span><span class="params">(self, lists: List[ListNode])</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="comment"># val, index </span></span><br><span class="line">        <span class="comment"># 1, 0</span></span><br><span class="line">        <span class="comment"># 1, 1</span></span><br><span class="line">        <span class="comment"># 2, 2</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> lists:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># if not lists[0]:</span></span><br><span class="line">        <span class="comment">#     return None</span></span><br><span class="line">        </span><br><span class="line">        l = []  <span class="comment"># for heapq</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(lists)):</span><br><span class="line">            <span class="keyword">if</span> lists[i]:                <span class="comment"># CAUTION! for [[],[1]]</span></span><br><span class="line">                val, idx = lists[i].val, i</span><br><span class="line">                heapq.heappush(l, (val, idx))</span><br><span class="line">            <span class="comment"># lists[idx] = lists[idx].next  # CAUTION! 別跟31行重覆了</span></span><br><span class="line">        </span><br><span class="line">        root = curr = ListNode(<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> l:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            val, idx = heapq.heappop(l)</span><br><span class="line">            <span class="comment"># print(val, idx)</span></span><br><span class="line">            <span class="comment"># for update heapq</span></span><br><span class="line">            lists[idx] = lists[idx].next</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> lists[idx] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                heapq.heappush(l, (lists[idx].val, idx))</span><br><span class="line">                </span><br><span class="line">            <span class="comment"># for Result</span></span><br><span class="line">            curr.next = ListNode(val)</span><br><span class="line">            curr = curr.next</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> root.next</span><br></pre></td></tr></table></figure>



<h3 id="31"><a href="#31" class="headerlink" title="31"></a><a name="31">31</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">1 2 4  8  3  7 6  5   ==&gt;   </span></span><br><span class="line"><span class="string">          pvt r</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3 5 7 4  6 9 8 7 6 5</span></span><br><span class="line"><span class="keyword">from</span> bisect <span class="keyword">import</span> bisect_right</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">nextPermutation</span><span class="params">(self, nums: List[int])</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> len(nums) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        r = len(nums)<span class="number">-1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> r &gt; <span class="number">0</span> <span class="keyword">and</span> nums[r] &lt;= nums[r<span class="number">-1</span>]:</span><br><span class="line">            r -= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">0</span>:   <span class="comment"># 5 4 3 2 1</span></span><br><span class="line">            <span class="comment"># nums = nums[::-1]     # not in-place</span></span><br><span class="line">            nums.reverse()</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">#              # 1 2 3 4 5</span></span><br><span class="line">        <span class="keyword">if</span> r == len(nums) - <span class="number">1</span>:</span><br><span class="line">            <span class="comment"># nums[1:].reverse()  # DOESN'T WORK!!!</span></span><br><span class="line">            nums[<span class="number">-1</span>], nums[<span class="number">-2</span>] = nums[<span class="number">-2</span>], nums[<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># if r == nums[]</span></span><br><span class="line">        pvt = r</span><br><span class="line">        <span class="comment"># idx = bisect_right(nums[pvt:], nums[ref]) + r # WRONG!!!   # at 5</span></span><br><span class="line">        r2 = len(nums)<span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> r2 &gt; r <span class="keyword">and</span> nums[r2] &lt;= nums[r<span class="number">-1</span>]:</span><br><span class="line">            r2 -= <span class="number">1</span></span><br><span class="line">        nums[r<span class="number">-1</span>], nums[r2] = nums[r2], nums[r<span class="number">-1</span>]</span><br><span class="line">        nums[pvt:] = nums[pvt:][::<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>



<h3 id="34"><a href="#34" class="headerlink" title="34"></a><a name="34">34</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bisect <span class="keyword">import</span> * <span class="comment"># bisect_left() bisect_right()</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">searchRange</span><span class="params">(self, nums: List[int], target: int)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> [<span class="number">-1</span>, <span class="number">-1</span>]</span><br><span class="line">        </span><br><span class="line">        l = bisect_left(nums, target)</span><br><span class="line">        r = bisect_right(nums, target)</span><br><span class="line">        <span class="keyword">if</span> l == r:</span><br><span class="line">            <span class="keyword">return</span> [<span class="number">-1</span>, <span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">return</span> [l, r<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>



<h3 id="42"><a href="#42" class="headerlink" title="42"></a><a name="42">42</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">trap</span><span class="params">(self, height: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> self.two_ptr(height)</span><br><span class="line">        <span class="comment"># height = [0,1,0,2,1,0,1,3,2,1,2,1]</span></span><br><span class="line">        <span class="comment"># l_max =  [0 0 1 1 2 2 2 2 3 3 3 3]</span></span><br><span class="line">        <span class="comment"># r_max =  [3 3 3 3 3 3 3 2 2 2 1 0]</span></span><br><span class="line">        <span class="comment"># min_nbr = min(l_max[i], r_max[i])</span></span><br><span class="line">        <span class="comment"># water[i] = height[i] &lt; min_nbr ? (min_nbr-height[i]) * 1:0</span></span><br><span class="line">        <span class="comment"># return sum(water)</span></span><br><span class="line">        <span class="keyword">return</span> self.two_ptr(height)</span><br><span class="line">        <span class="keyword">return</span> self.dp_sol(height)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">two_ptr</span><span class="params">(self, height)</span>:</span></span><br><span class="line">        l, r = <span class="number">0</span>, len(height)<span class="number">-1</span></span><br><span class="line">        l_max, r_max = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            <span class="comment"># if height[l] &lt; height[r]:     # This should behind updates of l and r, or FAILED in VALLEY as [2 0 2]</span></span><br><span class="line">            <span class="comment">#     l += 1</span></span><br><span class="line">            <span class="comment"># else:</span></span><br><span class="line">            <span class="comment">#     r -= 1</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">if</span> height[l] &gt;= l_max:</span><br><span class="line">                l_max = height[l]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur = max(min(l_max, r_max) * <span class="number">1</span> - height[l], <span class="number">0</span>)</span><br><span class="line">                count += cur</span><br><span class="line">                <span class="comment"># l += 1</span></span><br><span class="line">            <span class="keyword">if</span> height[r] &gt;= r_max:</span><br><span class="line">                r_max = height[r]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur = max(min(l_max, r_max) * <span class="number">1</span> - height[r], <span class="number">0</span>)</span><br><span class="line">                count += cur</span><br><span class="line">                <span class="comment"># r -= 1</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">if</span> height[l] &lt; height[r]:</span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dp_sol</span><span class="params">(self, height)</span>:</span></span><br><span class="line">        n = len(height)</span><br><span class="line">        l_max = [<span class="number">0</span>] * n</span><br><span class="line">        cur_max = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            l_max[i] = cur_max</span><br><span class="line">            cur_max = max(height[i], cur_max)</span><br><span class="line">            </span><br><span class="line">        r_max = [<span class="number">0</span>] * n</span><br><span class="line">        cur_max = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> reversed(range(n)):</span><br><span class="line">            r_max[j] = cur_max</span><br><span class="line">            cur_max = max(height[j], cur_max)</span><br><span class="line">            </span><br><span class="line">        </span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(n):</span><br><span class="line">            min_nbr = min(l_max[k], r_max[k])</span><br><span class="line">            res += (min_nbr-height[k])*<span class="number">1</span> <span class="keyword">if</span> height[k] &lt; min_nbr <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="43"><a href="#43" class="headerlink" title="43"></a><a name="43">43</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">multiply</span><span class="params">(self, num1: str, num2: str)</span> -&gt; str:</span></span><br><span class="line">        a = self.string2num(num1)</span><br><span class="line">        b = self.string2num(num2)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> str(a*b)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">string2num</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        ret = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(n)):</span><br><span class="line">            digit = ord(n[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">            ret = <span class="number">10</span>*ret + digit</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure>



<h3 id="48"><a href="#48" class="headerlink" title="48"></a><a name="48">48</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">1 2 4  8  3  7 6  5   ==&gt;   </span></span><br><span class="line"><span class="string">          pvt r</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3 5 7 4  6 9 8 7 6 5</span></span><br><span class="line"><span class="keyword">from</span> bisect <span class="keyword">import</span> bisect_right</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">nextPermutation</span><span class="params">(self, nums: List[int])</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> len(nums) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        r = len(nums)<span class="number">-1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> r &gt; <span class="number">0</span> <span class="keyword">and</span> nums[r] &lt;= nums[r<span class="number">-1</span>]:</span><br><span class="line">            r -= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">0</span>:   <span class="comment"># 5 4 3 2 1</span></span><br><span class="line">            <span class="comment"># nums = nums[::-1]     # not in-place</span></span><br><span class="line">            nums.reverse()</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">#              # 1 2 3 4 5</span></span><br><span class="line">        <span class="keyword">if</span> r == len(nums) - <span class="number">1</span>:</span><br><span class="line">            <span class="comment"># nums[1:].reverse()  # DOESN'T WORK!!!</span></span><br><span class="line">            nums[<span class="number">-1</span>], nums[<span class="number">-2</span>] = nums[<span class="number">-2</span>], nums[<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># if r == nums[]</span></span><br><span class="line">        pvt = r</span><br><span class="line">        <span class="comment"># idx = bisect_right(nums[pvt:], nums[ref]) + r # WRONG!!!   # at 5</span></span><br><span class="line">        r2 = len(nums)<span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> r2 &gt; r <span class="keyword">and</span> nums[r2] &lt;= nums[r<span class="number">-1</span>]:</span><br><span class="line">            r2 -= <span class="number">1</span></span><br><span class="line">        nums[r<span class="number">-1</span>], nums[r2] = nums[r2], nums[r<span class="number">-1</span>]</span><br><span class="line">        nums[pvt:] = nums[pvt:][::<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>



<h3 id="51"><a href="#51" class="headerlink" title="51"></a><a name="51">51</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">solveNQueens</span><span class="params">(self, n: int)</span> -&gt; List[List[str]]:</span></span><br><span class="line">        self.result = []</span><br><span class="line">        mark = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(n)] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        location = [[<span class="string">'.'</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(n)] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        self.gen(n, <span class="number">0</span>, mark, location)</span><br><span class="line">        <span class="keyword">return</span> self.result</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen</span><span class="params">(self, n, k, mark, location)</span>:</span>  <span class="comment"># k == level</span></span><br><span class="line">        <span class="keyword">if</span> k == n:</span><br><span class="line">            self.result.append([<span class="string">''</span>.join(row) <span class="keyword">for</span> row <span class="keyword">in</span> location])</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(n):  <span class="comment"># row</span></span><br><span class="line">            <span class="comment"># print(k, j)</span></span><br><span class="line">            <span class="keyword">if</span> mark[k][j] == <span class="number">0</span>:</span><br><span class="line">                <span class="comment"># row_data += </span></span><br><span class="line">                tmp_mark = deepcopy(mark)</span><br><span class="line">                location[k][j] = <span class="string">'Q'</span></span><br><span class="line">                mark = self.put_down_the_queen(n, k, j, mark)</span><br><span class="line">                self.gen(n, k+<span class="number">1</span>, mark, location)</span><br><span class="line">                mark = deepcopy(tmp_mark)</span><br><span class="line">                location[k][j] = <span class="string">'.'</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put_down_the_queen</span><span class="params">(self, n, r, c, mark)</span>:</span></span><br><span class="line">        dr = [ <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>,  <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>]</span><br><span class="line">        dc = [<span class="number">-1</span>, <span class="number">1</span>,  <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">-1</span>,  <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(dc)):</span><br><span class="line">                new_r = r + i * dr[j]</span><br><span class="line">                new_c = c + i * dc[j]</span><br><span class="line">                <span class="keyword">if</span> new_c &gt;=<span class="number">0</span> <span class="keyword">and</span> new_r &gt;=<span class="number">0</span> <span class="keyword">and</span> new_c &lt; n <span class="keyword">and</span> new_r &lt; n:</span><br><span class="line">                    mark[new_r][new_c] = <span class="number">1</span>    </span><br><span class="line">        <span class="keyword">return</span> mark</span><br></pre></td></tr></table></figure>



<h3 id="52"><a href="#52" class="headerlink" title="52"></a><a name="52">52</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">totalNQueens</span><span class="params">(self, n: int)</span> -&gt; int:</span></span><br><span class="line">        attack_range = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(n)] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        board = [[<span class="string">'.'</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(n)] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        self.result = []</span><br><span class="line">        self.helper(<span class="number">0</span>, n, attack_range, board)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> len(self.result)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, row, n, attack_range, board)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> row == n:</span><br><span class="line">            self.result.append(deepcopy(board))</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">if</span> attack_range[row][col] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">                </span><br><span class="line">            tmp_attack = deepcopy(attack_range)</span><br><span class="line">            attack_range = self.put_down_queen(n, row, col, attack_range)</span><br><span class="line">            board[row][col] = <span class="string">'Q'</span></span><br><span class="line">            </span><br><span class="line">            self.helper(row+<span class="number">1</span>, n, attack_range, board)</span><br><span class="line">            attack_range = deepcopy(tmp_attack)</span><br><span class="line">            board[row][col] = <span class="string">'.'</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put_down_queen</span><span class="params">(self, n, row, col, attack_range)</span>:</span></span><br><span class="line">        <span class="comment"># update attack_range</span></span><br><span class="line">        drow = [<span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>,  <span class="number">0</span>, <span class="number">1</span>,  <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>]</span><br><span class="line">        dcol = [<span class="number">0</span>,  <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>,  <span class="number">1</span>, <span class="number">-1</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(len(drow)):</span><br><span class="line">            <span class="keyword">for</span> dis <span class="keyword">in</span> range(n):</span><br><span class="line">                new_row = row + dis*drow[k]</span><br><span class="line">                new_col = col + dis*dcol[k]</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> new_row &gt;= <span class="number">0</span> <span class="keyword">and</span> new_row &lt; n <span class="keyword">and</span> new_col &gt;= <span class="number">0</span> <span class="keyword">and</span> new_col &lt; n:</span><br><span class="line">                    attack_range[new_row][new_col] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> attack_range</span><br></pre></td></tr></table></figure>



<h3 id="53"><a href="#53" class="headerlink" title="53"></a><a name="53">53</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxSubArray</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> len(nums) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> nums[<span class="number">0</span>]</span><br><span class="line">        </span><br><span class="line">        dp = [<span class="number">0</span>] + [<span class="number">0</span>] * len(nums)</span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">            -2              1       -3 4 -1 2</span></span><br><span class="line"><span class="string"> uptome      0              0    </span></span><br><span class="line"><span class="string">       max(0, 0+-2)     max(0, 1)</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        dp[<span class="number">1</span>] = max(dp[<span class="number">0</span>]+nums[<span class="number">0</span>], nums[<span class="number">0</span>]) </span><br><span class="line">        dp[<span class="number">2</span>] = max(dp[<span class="number">1</span>]+nums[<span class="number">1</span>], nums[<span class="number">1</span>])</span><br><span class="line">        g = float(<span class="string">'-inf'</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, len(dp)):</span><br><span class="line">            dp[j] = max(dp[j<span class="number">-1</span>] + nums[j<span class="number">-1</span>], nums[j<span class="number">-1</span>]) </span><br><span class="line">            g = max(g, dp[j])</span><br><span class="line">        <span class="comment"># return dp[-1]</span></span><br><span class="line">        <span class="keyword">return</span> g</span><br></pre></td></tr></table></figure>



<h3 id="56"><a href="#56" class="headerlink" title="56"></a><a name="56">56</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">merge</span><span class="params">(self, intervals: List[List[int]])</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="keyword">return</span> self.helper(intervals)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, intervals)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> intervals:</span><br><span class="line">            <span class="keyword">return</span> intervals</span><br><span class="line">        result = []</span><br><span class="line">        intervals_s = sorted(intervals, key=<span class="keyword">lambda</span> x: x[<span class="number">0</span>])</span><br><span class="line">        prev_start, prev_end = intervals_s[<span class="number">0</span>][<span class="number">0</span>], intervals_s[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(intervals)):</span><br><span class="line">            <span class="comment"># cur_end_time </span></span><br><span class="line">            <span class="keyword">if</span> intervals_s[i][<span class="number">0</span>] &lt;= prev_end:</span><br><span class="line">                prev_end = max(prev_end, intervals_s[i][<span class="number">1</span>])</span><br><span class="line">                <span class="comment"># result.append([prev_start, intervals_s[i][1]])</span></span><br><span class="line">            <span class="keyword">else</span>:   <span class="comment"># not able to merge</span></span><br><span class="line">                result.append([prev_start, prev_end])</span><br><span class="line">                prev_start = intervals_s[i][<span class="number">0</span>]</span><br><span class="line">                prev_end = intervals_s[i][<span class="number">1</span>]</span><br><span class="line">        result.append([prev_start, prev_end])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>



<h3 id="66"><a href="#66" class="headerlink" title="66"></a><a name="66">66</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">plusOne</span><span class="params">(self, digits: List[int])</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="comment"># l = digits[:len(digits)-1] + [digits[-1]+1]</span></span><br><span class="line">        <span class="comment"># s = ''.join([str(num) for num in l])</span></span><br><span class="line">        <span class="comment"># res = []</span></span><br><span class="line">        <span class="comment"># res += [c for c in s]</span></span><br><span class="line">        <span class="comment"># return res</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> digits:</span><br><span class="line">            <span class="keyword">return</span> digits</span><br><span class="line">        </span><br><span class="line">        s, t = <span class="string">''</span>.join([str(dg) <span class="keyword">for</span> dg <span class="keyword">in</span> digits]), <span class="string">'1'</span></span><br><span class="line">        s = s[::<span class="number">-1</span>]</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        carry = <span class="number">0</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">while</span> i &lt; len(s):</span><br><span class="line">            num = ord(s[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">            m = <span class="number">0</span></span><br><span class="line">            <span class="keyword">if</span> i &lt; len(t):</span><br><span class="line">                m = ord(t[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">            total = carry + num + m</span><br><span class="line">            carry, digit = total//<span class="number">10</span>, total%<span class="number">10</span></span><br><span class="line">            result.append(digit)</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> carry:</span><br><span class="line">            result.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> result[::<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>



<h3 id="79"><a href="#79" class="headerlink" title="79"></a><a name="79">79</a></h3><h5 id="TLE…"><a href="#TLE…" class="headerlink" title="TLE…"></a>TLE…</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="comment"># from collections import deque</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">exist</span><span class="params">(self, board: List[List[str]], word: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> board <span class="keyword">or</span> <span class="keyword">not</span> board[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        </span><br><span class="line">        ans = <span class="literal">False</span></span><br><span class="line">        visited = [[<span class="literal">False</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>]))]<span class="keyword">for</span> i <span class="keyword">in</span> range(len(board))]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(board)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>])):</span><br><span class="line">                <span class="keyword">if</span> board[i][j] == word[<span class="number">0</span>]:</span><br><span class="line">                    ans = self.helper(board, i, j, word, <span class="literal">False</span>, deepcopy(visited)) <span class="keyword">or</span> ans  </span><br><span class="line">                    <span class="keyword">if</span> ans:</span><br><span class="line">                        <span class="keyword">return</span> ans</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">    </span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    First version failed AT:</span></span><br><span class="line"><span class="string">    [["C","A","A"],</span></span><br><span class="line"><span class="string">     ["A","A","A"],</span></span><br><span class="line"><span class="string">     ["B","C","D"]]</span></span><br><span class="line"><span class="string">    "AAB"</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, board, row, col, item, ans, visited)</span>:</span></span><br><span class="line">        <span class="comment"># if not item:</span></span><br><span class="line">        <span class="comment">#     return True</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> board[row][col] == item[<span class="number">0</span>]:</span><br><span class="line">            visited[row][col] = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> len(item) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                item = item[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> row &lt; len(board)<span class="number">-1</span>:</span><br><span class="line">            <span class="comment"># print(row, col)</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row+<span class="number">1</span>][col]:</span><br><span class="line">                ans = self.helper(board, row+<span class="number">1</span>, col, item, ans, deepcopy(visited)) <span class="keyword">or</span> ans</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> row &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row<span class="number">-1</span>][col]:</span><br><span class="line">                ans = self.helper(board, row<span class="number">-1</span>, col, item, ans, deepcopy(visited)) <span class="keyword">or</span> ans</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> col &lt; len(board[<span class="number">0</span>])<span class="number">-1</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row][col+<span class="number">1</span>]:</span><br><span class="line">                ans = self.helper(board, row, col+<span class="number">1</span>, item, ans, deepcopy(visited)) <span class="keyword">or</span> ans</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> col &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row][col<span class="number">-1</span>]:</span><br><span class="line">                ans = self.helper(board, row, col<span class="number">-1</span>, item, ans, deepcopy(visited)) <span class="keyword">or</span> ans</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>



<h5 id="Solved-TLE-by-not-deepcopy-board-but-merely-modifying-element-at-row-col"><a href="#Solved-TLE-by-not-deepcopy-board-but-merely-modifying-element-at-row-col" class="headerlink" title="Solved TLE: by not deepcopy board but merely modifying element at (row, col)"></a>Solved TLE: by not deepcopy board but merely modifying element at (row, col)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="comment"># from collections import deque</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">exist</span><span class="params">(self, board: List[List[str]], word: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> board <span class="keyword">or</span> <span class="keyword">not</span> board[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        </span><br><span class="line">        ans = <span class="literal">False</span></span><br><span class="line">        <span class="comment"># visited = [[False for j in range(len(board[0]))]for i in range(len(board))]</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(board)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>])):</span><br><span class="line">                <span class="keyword">if</span> board[i][j] == word[<span class="number">0</span>]:</span><br><span class="line">                    visited = [[<span class="literal">False</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>]))]<span class="keyword">for</span> i <span class="keyword">in</span> range(len(board))]</span><br><span class="line">                    ans = self.helper(board, i, j, word, <span class="literal">False</span>, visited) <span class="keyword">or</span> ans  </span><br><span class="line">                    <span class="keyword">if</span> ans:</span><br><span class="line">                        <span class="keyword">return</span> ans</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">    </span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    First version failed AT:</span></span><br><span class="line"><span class="string">    [["C","A","A"],</span></span><br><span class="line"><span class="string">     ["A","A","A"],</span></span><br><span class="line"><span class="string">     ["B","C","D"]]</span></span><br><span class="line"><span class="string">    "AAB"</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, board, row, col, item, ans, visited)</span>:</span></span><br><span class="line">        <span class="comment"># if not item:</span></span><br><span class="line">        <span class="comment">#     return True</span></span><br><span class="line">        <span class="keyword">if</span> visited[row][col] == <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> board[row][col] == item[<span class="number">0</span>]:</span><br><span class="line">            visited[row][col] = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> len(item) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                item = item[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> row &lt; len(board)<span class="number">-1</span>:</span><br><span class="line">            <span class="comment"># print(row, col)</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row+<span class="number">1</span>][col]:</span><br><span class="line">                tmp = visited[row+<span class="number">1</span>][col]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row+1, col, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row+<span class="number">1</span>, col, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row+<span class="number">1</span>][col] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> row &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row<span class="number">-1</span>][col]:</span><br><span class="line">                tmp = visited[row<span class="number">-1</span>][col]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row-1, col, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row<span class="number">-1</span>, col, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row<span class="number">-1</span>][col] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> col &lt; len(board[<span class="number">0</span>])<span class="number">-1</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row][col+<span class="number">1</span>]:</span><br><span class="line">                tmp = visited[row][col+<span class="number">1</span>]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row, col+1, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row, col+<span class="number">1</span>, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row][col+<span class="number">1</span>] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> col &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row][col<span class="number">-1</span>]:</span><br><span class="line">                tmp = visited[row][col<span class="number">-1</span>]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row, col-1, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row, col<span class="number">-1</span>, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row][col<span class="number">-1</span>] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>





<h3 id="138"><a href="#138" class="headerlink" title="138"></a><a name="138">138</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string"># Definition for a Node.</span></span><br><span class="line"><span class="string">class Node:</span></span><br><span class="line"><span class="string">    def __init__(self, x: int, next: 'Node' = None, random: 'Node' = None):</span></span><br><span class="line"><span class="string">        self.val = int(x)</span></span><br><span class="line"><span class="string">        self.next = next</span></span><br><span class="line"><span class="string">        self.random = random</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">copyRandomList</span><span class="params">(self, head: <span class="string">'Node'</span>)</span> -&gt; 'Node':</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span> head</span><br><span class="line">        visited = dict()</span><br><span class="line">        <span class="keyword">return</span> self.helper2(head, visited)</span><br><span class="line">        </span><br><span class="line">    <span class="string">''' Build from Bottom Up '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper2</span><span class="params">(self, root, visited)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> root <span class="keyword">in</span> visited:</span><br><span class="line">            <span class="keyword">return</span> visited[root]</span><br><span class="line">        </span><br><span class="line">        copy = Node(root.val)</span><br><span class="line">        visited[root] = copy            <span class="comment"># This Line EARLIER than recursive call is CRUCIAL </span></span><br><span class="line">        N_ptr = self.helper2(root.next, visited)</span><br><span class="line">        R_ptr = self.helper2(root.random, visited)</span><br><span class="line">        </span><br><span class="line">        copy.next = N_ptr</span><br><span class="line">        copy.random = R_ptr</span><br><span class="line">        <span class="comment"># visited[root] = copy</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> copy</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="comment">#     def helper(self, root, visited):</span></span><br><span class="line"><span class="comment">#         if not root:</span></span><br><span class="line"><span class="comment">#             return None</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#         # for 1st node</span></span><br><span class="line"><span class="comment">#         # if root not in visited:</span></span><br><span class="line"><span class="comment">#         copy = Node(root.val)</span></span><br><span class="line"><span class="comment">#         visited[root] = copy</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#         # if root.next:</span></span><br><span class="line"><span class="comment">#         copy_next = Node(root.next.val)</span></span><br><span class="line"><span class="comment">#         node.next = copy_next</span></span><br><span class="line"><span class="comment">#         visited[root.next] = copy_next</span></span><br><span class="line"><span class="comment">#         # if root.random:</span></span><br><span class="line"><span class="comment">#         copy_random = Node(root.random.val)</span></span><br><span class="line"><span class="comment">#         node.random = copy_random</span></span><br><span class="line"><span class="comment">#         visited[root.random] = copy_random</span></span><br><span class="line">          </span><br><span class="line">            </span><br><span class="line"><span class="comment">#         N_ptr = self.helper(root.next)#, visited)</span></span><br><span class="line"><span class="comment">#         R_ptr = self.helper(root.random)#, visited)</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">copyRandomList_copy</span><span class="params">(self, head: <span class="string">'Node'</span>)</span> -&gt; 'Node':</span></span><br><span class="line">        queue = []</span><br><span class="line">        copy = &#123;&#125;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        queue.append(head)</span><br><span class="line">        copy[head] = Node(head.val,<span class="literal">None</span>,<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">while</span> queue:</span><br><span class="line">            cur = queue.pop(<span class="number">0</span>)</span><br><span class="line">            n,r = cur.next,cur.random</span><br><span class="line">            <span class="keyword">if</span> n:</span><br><span class="line">                <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> copy:</span><br><span class="line">                    copy[n] = Node(n.val,<span class="literal">None</span>,<span class="literal">None</span>)</span><br><span class="line">                queue.append(n)</span><br><span class="line">                copy[cur].next = copy[n]</span><br><span class="line">            <span class="keyword">if</span> r:</span><br><span class="line">                <span class="keyword">if</span> r <span class="keyword">not</span> <span class="keyword">in</span> copy:</span><br><span class="line">                    copy[r] = Node(r.val,<span class="literal">None</span>,<span class="literal">None</span>)</span><br><span class="line">                copy[cur].random = copy[r]</span><br><span class="line">        <span class="keyword">return</span> copy[head]</span><br></pre></td></tr></table></figure>



<h3 id="146"><a href="#146" class="headerlink" title="146"></a><a name="146">146</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LRUCache</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, capacity)</span>:</span></span><br><span class="line">        <span class="comment"># self.od = collections.OrderedDict()</span></span><br><span class="line">        <span class="comment"># self.hash = &#123;&#125;</span></span><br><span class="line">        <span class="comment"># self.que = deque()</span></span><br><span class="line">        self.od = OrderedDict()</span><br><span class="line">        self.capacity = capacity</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, key)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">not</span> <span class="keyword">in</span> self.od:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res = self.od[key]</span><br><span class="line">            <span class="keyword">del</span> self.od[key]</span><br><span class="line">            self.od[key] = res</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">        1 1 </span></span><br><span class="line"><span class="string">        2 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    cms 3 3  ==&gt; del 1 1    del odr_dict[next(iter(odr_dict))]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        2 2</span></span><br><span class="line"><span class="string">        3 3</span></span><br><span class="line"><span class="string">    cms 2 2  ==&gt; del d[2]</span></span><br><span class="line"><span class="string">                 self.d[2] = value</span></span><br><span class="line"><span class="string">    '''</span>    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put</span><span class="params">(self, key, value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">not</span> <span class="keyword">in</span> self.od:</span><br><span class="line">            <span class="keyword">if</span> self.capacity == len(self.od):</span><br><span class="line">                <span class="keyword">del</span> self.od[next(iter(self.od))]</span><br><span class="line">            self.od[key] = value</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">del</span> self.od[key]</span><br><span class="line">            self.od[key] = value</span><br></pre></td></tr></table></figure>



<h3 id="155"><a href="#155" class="headerlink" title="155"></a><a name="155">155</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinStack</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        initialize your data structure here.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.stack = []</span><br><span class="line">        self.cur_min = float(<span class="string">"inf"</span>)</span><br><span class="line">        <span class="comment"># self.min_idx = -1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, x: int)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="keyword">if</span> x &lt; self.cur_min:</span><br><span class="line">            self.cur_min = x</span><br><span class="line">        self.stack += [(x, self.cur_min)]</span><br><span class="line">        <span class="comment"># self.min_idx = </span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span><span class="params">(self)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="comment"># self.stack.pop(-1)[0] if self.stack else None</span></span><br><span class="line">        v = self.stack.pop(<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">if</span> self.stack:</span><br><span class="line">            <span class="comment"># if self.stack[-1][1] &lt; self.cur_min:</span></span><br><span class="line">            self.cur_min = self.stack[<span class="number">-1</span>][<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.cur_min = float(<span class="string">"inf"</span>)    </span><br><span class="line">        <span class="keyword">return</span> v[<span class="number">0</span>]</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">top</span><span class="params">(self)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> self.stack[<span class="number">-1</span>][<span class="number">0</span>] <span class="keyword">if</span> self.stack <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getMin</span><span class="params">(self)</span> -&gt; int:</span></span><br><span class="line">        <span class="comment"># return min(self.stack)</span></span><br><span class="line">        <span class="comment"># return self.stack[-1][1] if self.stack else self.cur_min</span></span><br><span class="line">        <span class="keyword">return</span> self.cur_min</span><br></pre></td></tr></table></figure>



<h3 id="200"><a href="#200" class="headerlink" title="200"></a><a name="200">200</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">1 1 1 1 0</span></span><br><span class="line"><span class="string">1 1 0 1 0</span></span><br><span class="line"><span class="string">1 1 0 1 0</span></span><br><span class="line"><span class="string">0 0 0 0 0</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># for </span></span><br><span class="line"><span class="comment">#     for </span></span><br><span class="line"><span class="comment">#         bfs_graph</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numIslands</span><span class="params">(self, grid: List[List[str]])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> grid <span class="keyword">or</span> <span class="keyword">not</span> grid[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># arr = [[0 for j in range(len(grid[0])+1)] for i in range(len(grid)+1)]</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        arr = np.pad(grid, ((<span class="number">1</span>,<span class="number">1</span>), (<span class="number">1</span>,<span class="number">1</span>)))</span><br><span class="line">        print(arr)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># for i in range(1, len(arr)):</span></span><br><span class="line">        <span class="comment">#     for j in range(1, len(arr[0])):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(arr)<span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, len(arr[<span class="number">0</span>])<span class="number">-1</span>):</span><br><span class="line">                <span class="keyword">if</span> arr[i][j] == <span class="string">'1'</span>:</span><br><span class="line">                    self.bfs((arr[i][j], i, j), arr)</span><br><span class="line">                    count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bfs</span><span class="params">(self, item, arr)</span>:</span></span><br><span class="line">        Q = deque()</span><br><span class="line">        Q.append(item)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            val, i, j = Q.popleft()</span><br><span class="line">            <span class="keyword">if</span> val == <span class="string">'1'</span>:</span><br><span class="line">                arr[i][j] = <span class="string">'0'</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">if</span> arr[i][j<span class="number">-1</span>] == <span class="string">'1'</span>:         <span class="comment"># '0' is True...</span></span><br><span class="line">                Q.append((arr[i][j<span class="number">-1</span>], i, j<span class="number">-1</span>))</span><br><span class="line">                arr[i][j<span class="number">-1</span>] = <span class="string">'x'</span></span><br><span class="line">            <span class="keyword">if</span> arr[i<span class="number">-1</span>][j] == <span class="string">'1'</span>:</span><br><span class="line">                Q.append((arr[i<span class="number">-1</span>][j], i<span class="number">-1</span>, j))</span><br><span class="line">                arr[i<span class="number">-1</span>][j] = <span class="string">'x'</span></span><br><span class="line">            <span class="keyword">if</span> arr[i][j+<span class="number">1</span>] == <span class="string">'1'</span>:</span><br><span class="line">                Q.append((arr[i][j+<span class="number">1</span>], i, j+<span class="number">1</span>))</span><br><span class="line">                arr[i][j+<span class="number">1</span>] = <span class="string">'x'</span></span><br><span class="line">            <span class="keyword">if</span> arr[i+<span class="number">1</span>][j] == <span class="string">'1'</span>:</span><br><span class="line">                Q.append((arr[i+<span class="number">1</span>][j], i+<span class="number">1</span>, j))</span><br><span class="line">                arr[i+<span class="number">1</span>][j] = <span class="string">'x'</span></span><br></pre></td></tr></table></figure>



<h3 id="215"><a href="#215" class="headerlink" title="215"></a><a name="215">215</a></h3><p><strong>Complexity Analysis</strong></p>
<ul>
<li>Heap<ul>
<li>Time complexity : \mathcal{O}(N \log k)O(<em>N</em>log<em>k</em>).</li>
<li>Space complexity : \mathcal{O}(k)O(<em>k</em>) to store the heap elements.</li>
</ul>
</li>
<li>QuickSelect<ul>
<li>Time complexity : \mathcal{O}(N)O(<em>N</em>) in the average case, \mathcal{O}(N^2)O(<em>N</em>2) in the worst case.</li>
<li>Space complexity : \mathcal{O}(1)O(1).</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">def partition(l, r, arr)</span></span><br><span class="line"><span class="string">    3 5 2 1 5 6 4   k=2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    pvt 3 l 2 r 4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    fn to set 3 at idx2</span></span><br><span class="line"><span class="string">    while l&lt;r:</span></span><br><span class="line"><span class="string">        while arr[i] 5 &lt; 3: wrong</span></span><br><span class="line"><span class="string">            l ++</span></span><br><span class="line"><span class="string">        l 2</span></span><br><span class="line"><span class="string">        while arr[j]  &gt; 3: till 1 idx -4 == idx 3</span></span><br><span class="line"><span class="string">            r -- </span></span><br><span class="line"><span class="string">        r 3</span></span><br><span class="line"><span class="string">        swap(arr[l], arr[r])</span></span><br><span class="line"><span class="string">      3 1 2 5 5 6 4 </span></span><br><span class="line"><span class="string">          l</span></span><br><span class="line"><span class="string">          r</span></span><br><span class="line"><span class="string">      2 1 3 5 5 6 4   </span></span><br><span class="line"><span class="string">        return l</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">2 1 3 5 5 6 4   </span></span><br><span class="line"><span class="string">1 2 3 4 5 6  2nd large means idx 4 == 6 - 2 </span></span><br><span class="line"><span class="string">K largest means K_idx = len(arr) - K small</span></span><br><span class="line"><span class="string">while l &lt; r</span></span><br><span class="line"><span class="string">    idx = partition()    </span></span><br><span class="line"><span class="string">    K_idx = len(arr) - K</span></span><br><span class="line"><span class="string">    if K_idx &lt; idx:</span></span><br><span class="line"><span class="string">        r = idx - 1</span></span><br><span class="line"><span class="string">    elif k_idx &gt; idx:</span></span><br><span class="line"><span class="string">        l = idx +1</span></span><br><span class="line"><span class="string">    else:</span></span><br><span class="line"><span class="string">        break</span></span><br><span class="line"><span class="string">return arr[K_idx]</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span><span class="params">(self, nums: List[int], k: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.helper(nums, <span class="number">0</span>, len(nums)<span class="number">-1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, nums, i, j)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= j:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        i, j = <span class="number">0</span>, len(nums)<span class="number">-1</span></span><br><span class="line">        <span class="comment"># 1 2 3 4 5 6</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># k = 2 ==&gt; idx 4.  6-2</span></span><br><span class="line">        k_idx = len(nums) - k</span><br><span class="line">        <span class="keyword">while</span> i &lt; j:</span><br><span class="line">            pvt_idx = self.partition(i, j, nums)</span><br><span class="line">            <span class="keyword">if</span> k_idx &lt; pvt_idx:</span><br><span class="line">                j = pvt_idx - <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> k_idx &gt; pvt_idx:</span><br><span class="line">                i = pvt_idx + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> nums[k_idx]</span><br><span class="line">            </span><br><span class="line">    <span class="comment"># 3 2 5 4 1 6</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partition</span><span class="params">(self, l, r, arr)</span>:</span></span><br><span class="line">        pvt = arr[l]</span><br><span class="line">        ll = l+<span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> ll &lt; r:    </span><br><span class="line">            <span class="keyword">while</span> arr[ll] &lt; pvt <span class="keyword">and</span> ll &lt; r:</span><br><span class="line">                ll += <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> arr[r] &gt; pvt <span class="keyword">and</span> ll &lt; r:</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">            arr[ll], arr[r] = arr[r], arr[ll]</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> ll</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## <span class="doctag">TODO:</span> k largest ==&gt; len(nums) - k + 1 small</span></span><br><span class="line"><span class="comment"># 1 2 3 4 5 6</span></span><br><span class="line"><span class="comment"># k  = 2 ==&gt; 5</span></span><br><span class="line"><span class="comment"># ks = 5 ==&gt; 6-2+1</span></span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span><span class="params">(self, nums: List[int], k: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="comment"># l = nums</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        heapq.heapify(nums) <span class="comment">#O(N)</span></span><br><span class="line">        ks = len(nums) - k + <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(ks<span class="number">-1</span>):</span><br><span class="line">            heapq.heappop(nums) <span class="comment"># ks * O(lgN)</span></span><br><span class="line">        <span class="keyword">return</span> heapq.heappop(nums)</span><br></pre></td></tr></table></figure>



<h3 id="222"><a href="#222" class="headerlink" title="222"></a><a name="222">222</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">    1               i0</span></span><br><span class="line"><span class="string">   / \</span></span><br><span class="line"><span class="string">  2   3    h 1      2^i children</span></span><br><span class="line"><span class="string"> / \  /</span></span><br><span class="line"><span class="string">4  5 6     h 2</span></span><br><span class="line"><span class="string">1 count level by dfs, at each level, we should get </span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">countNodes</span><span class="params">(self, root: TreeNode)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.helper_recur(root)</span><br><span class="line">        <span class="keyword">return</span> self.helper_iter(root)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper_recur</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            count = <span class="number">0</span></span><br><span class="line">            <span class="keyword">return</span> count</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            count = <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        L = self.helper_recur(root.left)</span><br><span class="line">        R = self.helper_recur(root.right)</span><br><span class="line">        <span class="keyword">return</span> count + L + R</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper_iter</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        Q = deque()</span><br><span class="line">        Q.append(root)</span><br><span class="line">        <span class="comment"># level = 0   # expect get 2**level children</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        height = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> Q:       </span><br><span class="line">            level_Q = deque()</span><br><span class="line">            len_q = len(Q)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len_q):</span><br><span class="line">                node = Q.popleft()  <span class="comment"># 1 </span></span><br><span class="line">                <span class="keyword">if</span> node.left:</span><br><span class="line">                    level_Q.append(node.left)</span><br><span class="line">                <span class="keyword">if</span> node.right:</span><br><span class="line">                    level_Q.append(node.right)</span><br><span class="line">            height += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> len(level_Q) != <span class="number">2</span>**height:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            Q = level_Q.copy()</span><br><span class="line">        </span><br><span class="line">        ans = <span class="number">2</span>**(height)<span class="number">-1</span> + len(level_Q)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>

<ul>
<li>Time complexity : \mathcal{O}(N)O(<em>N</em>).</li>
<li>Space complexity : \mathcal{O}(d) = \mathcal{O}(\log N)O(<em>d</em>)=O(log<em>N</em>) to keep the recursion stack, where d is a tree depth.</li>
</ul>
<h3 id="242"><a href="#242" class="headerlink" title="242"></a><a name="242">242</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isAnagram</span><span class="params">(self, s: str, t: str)</span> -&gt; bool:</span></span><br><span class="line">        cs = Counter(s)</span><br><span class="line">        ct = Counter(t)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> cs == ct</span><br></pre></td></tr></table></figure>

<p><strong>Complexity analysis</strong></p>
<ul>
<li>Time complexity : O(n)<em>O</em>(<em>n</em>). Time complexity is O(n)<em>O</em>(<em>n</em>) because accessing the counter table is a constant time operation.</li>
<li>Space complexity : O(1)<em>O</em>(1). Although we do use extra space, the space complexity is O(1)<em>O</em>(1) because the table’s size stays constant no matter how large n<em>n</em> is.</li>
</ul>
<h3 id="253"><a href="#253" class="headerlink" title="253"></a><a name="253">253</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minMeetingRooms</span><span class="params">(self, intervals: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        intervals = sorted(intervals, key=<span class="keyword">lambda</span> x: x[<span class="number">0</span>])   <span class="comment"># sort according to start </span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> intervals:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 2nd start == 1st end , no need one more room</span></span><br><span class="line">        <span class="comment"># end = [intervals[0][1]]</span></span><br><span class="line">        end = []        <span class="comment"># shouldn't or two 5 for case [[1,5],[8,9],[8,9]] after first looping</span></span><br><span class="line">        <span class="keyword">for</span> interval <span class="keyword">in</span> intervals:</span><br><span class="line">            <span class="comment"># cur_earliest_end = end[0]       # 9</span></span><br><span class="line">            <span class="keyword">if</span>  <span class="keyword">not</span> end <span class="keyword">or</span> interval[<span class="number">0</span>] &lt; end[<span class="number">0</span>]:<span class="comment">#cur_earliest_end:</span></span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                heapq.heappop(end)</span><br><span class="line">            heapq.heappush(end, interval[<span class="number">1</span>])    </span><br><span class="line">        <span class="keyword">return</span> count</span><br></pre></td></tr></table></figure>

<ul>
<li>Time Complexity: O(N\log N)<em>O</em>(<em>N</em>log<em>N</em>).<ul>
<li>There are two major portions that take up time here. One is <code>sorting</code> of the array that takes O(N\log N)<em>O</em>(<em>N</em>log<em>N</em>) considering that the array consists of N<em>N</em> elements.</li>
<li>Then we have the <code>min-heap</code>. In the worst case, all N<em>N</em> meetings will collide with each other. In any case we have N<em>N</em> add operations on the heap. In the worst case we will have N<em>N</em> extract-min operations as well. Overall complexity being (NlogN)(<em>N<strong>l</strong>o<strong>g</strong>N</em>) since extract-min operation on a heap takes O(\log N)<em>O</em>(log<em>N</em>).</li>
</ul>
</li>
<li>Space Complexity: O(N)<em>O</em>(<em>N</em>) because we construct the <code>min-heap</code> and that can contain N<em>N</em> elements in the worst case as described above in the time complexity section. Hence, the space complexity is O(N)<em>O</em>(<em>N</em>).</li>
</ul>
<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbyhxbi09fj31dy0u0qan.jpg" alt="img" style="zoom:50%;" />



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public class Solution &#123;</span><br><span class="line">    public int minMeetingRooms(Interval[] intervals) &#123;</span><br><span class="line">        int[] starts = new int[intervals.length];</span><br><span class="line">        int[] ends = new int[intervals.length];</span><br><span class="line">        <span class="keyword">for</span>(int i=<span class="number">0</span>; i&lt;intervals.length; i++) &#123;</span><br><span class="line">            starts[i] = intervals[i].start;</span><br><span class="line">            ends[i] = intervals[i].end;</span><br><span class="line">        &#125;</span><br><span class="line">        Arrays.sort(starts);</span><br><span class="line">        Arrays.sort(ends);</span><br><span class="line">        int rooms = <span class="number">0</span>;</span><br><span class="line">        int endsItr = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(int i=<span class="number">0</span>; i&lt;starts.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(starts[i]&lt;ends[endsItr])</span><br><span class="line">                rooms++;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                endsItr++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rooms;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="543"><a href="#543" class="headerlink" title="543"></a><a name="543">543</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">diameterOfBinaryTree</span><span class="params">(self, root: TreeNode)</span> -&gt; int:</span></span><br><span class="line">        self.g_max = <span class="number">0</span></span><br><span class="line">        self.helper(root)</span><br><span class="line">        <span class="keyword">return</span> self.g_max</span><br><span class="line">    <span class="comment"># return height and calculate dia at root</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        <span class="comment"># if not root:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># L_diameter = self.helper(root.left)</span></span><br><span class="line">        <span class="comment"># R_diameter = self.helper(root.right)</span></span><br><span class="line">        </span><br><span class="line">        L_height = self.height(root.left)</span><br><span class="line">        R_height = self.height(root.right)</span><br><span class="line">        <span class="comment"># diameter = L_height + R_height + 1</span></span><br><span class="line">        diameter = L_height + R_height</span><br><span class="line">        <span class="comment"># self.g_max = max(self.g_max, diameter)</span></span><br><span class="line">        </span><br><span class="line">        L = self.helper(root.left)</span><br><span class="line">        R = self.helper(root.right)</span><br><span class="line">        self.g_max = max(self.g_max, diameter, L, R)</span><br><span class="line">        <span class="comment"># return 1 + max(L_height, R_height)        </span></span><br><span class="line">        <span class="keyword">return</span> diameter</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">height</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        L = self.height(root.left)  </span><br><span class="line">        R = self.height(root.right)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> + max(L, R)</span><br></pre></td></tr></table></figure>



<h3 id="852"><a href="#852" class="headerlink" title="852"></a><a name="852">852</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">peakIndexInMountainArray</span><span class="params">(self, A: List[int])</span> -&gt; int:</span></span><br><span class="line">        l, r = <span class="number">0</span>, len(A)<span class="number">-1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            mid = l + (r-l)//<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> mid &gt; <span class="number">0</span> <span class="keyword">and</span> mid &lt; len(A)<span class="number">-1</span> <span class="keyword">and</span> A[mid<span class="number">-1</span>] &lt; A[mid] <span class="keyword">and</span> A[mid] &gt; A[mid+<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">return</span> mid</span><br><span class="line">            <span class="keyword">if</span> A[mid] &lt; A[mid+<span class="number">1</span>]:</span><br><span class="line">                l = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r = mid - <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> l</span><br></pre></td></tr></table></figure>

<h5 id="Better"><a href="#Better" class="headerlink" title="Better"></a>Better</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">peakIndexInMountainArray</span><span class="params">(self, A: List[int])</span> -&gt; int:</span></span><br><span class="line">        l, r = <span class="number">0</span>, len(A)<span class="number">-1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            mid = l + (r-l)//<span class="number">2</span></span><br><span class="line">            <span class="comment"># if mid &gt; 0 and mid &lt; len(A)-1 and A[mid-1] &lt; A[mid] and A[mid] &gt; A[mid+1]:</span></span><br><span class="line">            <span class="comment">#     return mid</span></span><br><span class="line">            <span class="keyword">if</span> A[mid] &lt; A[mid+<span class="number">1</span>]:</span><br><span class="line">                l = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># r = mid - 1</span></span><br><span class="line">                r = mid</span><br><span class="line">        <span class="keyword">return</span> l</span><br></pre></td></tr></table></figure>



<h3 id="904"><a href="#904" class="headerlink" title="904"></a><a name="904">904</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Lonest subarray with k charaters!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    1 2 3 2 2 1 1 1 1 1 1 </span></span><br><span class="line"><span class="string">　　j　　　　i　　　         open ( ]close</span></span><br><span class="line"><span class="string">                          </span></span><br><span class="line"><span class="string">j   i   od                                      amount</span></span><br><span class="line"><span class="string">-1  0   &#123;1:0&#125;                                   1</span></span><br><span class="line"><span class="string">-1  1   &#123;1:0, 2:1 &#125;                             2</span></span><br><span class="line"><span class="string"> 0  2   &#123;1:0  2:1  3:2&#125;  ==&gt; &#123;2:1  3:2&#125;         2</span></span><br><span class="line"><span class="string"> 0  3   &#123;2:3  3:2     &#125;                         3</span></span><br><span class="line"><span class="string"> 0  4   &#123;2:4  3:2     &#125;                         4              record g_max</span></span><br><span class="line"><span class="string"> 2  5   &#123;2:4  3:2  1:5&#125;  ==&gt; &#123;3:2  1:5&#125;         3              </span></span><br><span class="line"><span class="string">同時維護　OrderedDict 跟指針難</span></span><br><span class="line"><span class="string">                          </span></span><br><span class="line"><span class="string">j   i   od                                      amount</span></span><br><span class="line"><span class="string">-1  0   &#123;1:0&#125;                                   1</span></span><br><span class="line"><span class="string">-1  1   &#123;1:0, 2:1&#125;                              2</span></span><br><span class="line"><span class="string"> 0  2   &#123;1:0  2:1  3:2&#125;  ==&gt; same               2</span></span><br><span class="line"><span class="string"> 0  3   &#123;1:0  2:3  3:2&#125;                         3</span></span><br><span class="line"><span class="string"> 0  4   &#123;1:0  2:4  3:2&#125;                         4              record g_max</span></span><br><span class="line"><span class="string"> 2  5   &#123;1:5  2:4  3:2&#125;  ==&gt; same               3              </span></span><br><span class="line"><span class="string">X                          </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">j   i   od                                             amount</span></span><br><span class="line"><span class="string"> 0  0   &#123;1:1&#125;                                           1</span></span><br><span class="line"><span class="string"> 0  1   &#123;1:1  2:1&#125;                                      2</span></span><br><span class="line"><span class="string"> 0  2   &#123;1:1  2:1  3:1&#125;  ==&gt; 1 2 &#123;1:0  2:1  3:1&#125;          2     i-j+1</span></span><br><span class="line"><span class="string"> 1  3   &#123;1:0  2:2  3:1&#125;                                 3</span></span><br><span class="line"><span class="string"> 1  4   &#123;1:0  2:3  3:1&#125;                                 4              record g_max</span></span><br><span class="line"><span class="string"> 1  5   &#123;1:1  2:4  3:1&#125;  ==&gt; 2 5 &#123;1:1  2:3  3:1&#125;             3                               </span></span><br><span class="line"><span class="string">                         ==&gt; 3 5 &#123;1:1  2:3  3:0&#125;             3</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">totalFruit</span><span class="params">(self, tree: List[int])</span> -&gt; int:</span></span><br><span class="line">        od = OrderedDict()</span><br><span class="line">        j = <span class="number">0</span>              </span><br><span class="line">        g_max = cur_amount = <span class="number">0</span></span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(tree)):</span><br><span class="line">            val = tree[i]</span><br><span class="line">            <span class="keyword">if</span> val <span class="keyword">not</span> <span class="keyword">in</span> od:</span><br><span class="line">                od[val] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                od[val] += <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># if len(od) &gt;= 2:</span></span><br><span class="line">            <span class="keyword">while</span> len(od) &gt; <span class="number">2</span>:</span><br><span class="line">                od[tree[j]] -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> od[tree[j]] == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">del</span> od[tree[j]]</span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line">                </span><br><span class="line">            cur_amount = i - j + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> cur_amount &gt; g_max:</span><br><span class="line">                g_max = cur_amount</span><br><span class="line">                res.append([j, i])</span><br><span class="line">        <span class="comment"># print(res)</span></span><br><span class="line">        <span class="keyword">return</span> g_max</span><br></pre></td></tr></table></figure>



<h3 id="929"><a href="#929" class="headerlink" title="929"></a><a name="929">929</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numUniqueEmails</span><span class="params">(self, emails: List[str])</span> -&gt; int:</span></span><br><span class="line">        names = set()</span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> mail <span class="keyword">in</span> emails:</span><br><span class="line">            local_name, domain_name = mail.split(<span class="string">'@'</span>)</span><br><span class="line">            local_first = local_name.split(<span class="string">'+'</span>)[<span class="number">0</span>]</span><br><span class="line">            name = <span class="string">''</span>.join(local_first.split(<span class="string">'.'</span>))</span><br><span class="line">            item = (name, domain_name)</span><br><span class="line">            print(item)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> names:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">                names.add(item)</span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># def valid_mail(self, email):</span></span><br></pre></td></tr></table></figure>



<h3 id="951"><a href="#951" class="headerlink" title="951"></a><a name="951">951</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">flipEquiv</span><span class="params">(self, root1: TreeNode, root2: TreeNode)</span> -&gt; bool:</span></span><br><span class="line">        <span class="comment"># if not root1 and not root2:</span></span><br><span class="line">        <span class="comment">#     return True</span></span><br><span class="line">        <span class="comment"># if not root1 or not root2:</span></span><br><span class="line">        <span class="comment">#     return False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.helper(root1, root2)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, l, r)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l <span class="keyword">and</span> <span class="keyword">not</span> r:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l <span class="keyword">or</span> <span class="keyword">not</span> r:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> l.val != r.val:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">             </span><br><span class="line">        <span class="comment"># ll, lr = l.left, l.right</span></span><br><span class="line">        <span class="comment"># rl, rr = r.left, r.right</span></span><br><span class="line">        <span class="keyword">return</span>  self.helper(l.left, r.left) <span class="keyword">and</span> self.helper(l.right, r.right) <span class="keyword">or</span> \</span><br><span class="line">                self.helper(l.left, r.right) <span class="keyword">and</span> self.helper(l.right, r.left)</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/10/LC/2020-02-10-LC%20Recurssion%20Arrangement/">LC/2020-02-10-LC Recurssion Arrangement</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-10</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/LC/">LC</a></span><div class="content"><h2 id="Binary-Tree"><a href="#Binary-Tree" class="headerlink" title="Binary Tree"></a>Binary Tree</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>[Maximum depth of Binary Tree]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Symmetric Tree]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Path Sum]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Count Univalue Subtrees]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#39">39 Combination Sum</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#40">40 Combination Sum Ⅱ</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#77">77 Combinations</a></td>
<td></td>
<td>easy</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#">79 Word Search</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="39"><a href="#39" class="headerlink" title="39"></a><a name="39">39</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">combinationSum</span><span class="params">(self, candidates: List[int], target: int)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> candidates: </span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        self.result = []</span><br><span class="line">        <span class="comment"># self.counters = &#123;&#125;</span></span><br><span class="line">        l = sorted(candidates, key=<span class="keyword">lambda</span> val: val)</span><br><span class="line">        self.helper(l, <span class="number">0</span>, target, [], <span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.result</span><br><span class="line"></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, l, idx, rem, item, level)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> rem == <span class="number">0</span>:</span><br><span class="line">            self.result.append(item.copy())</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> idx == len(l) <span class="keyword">or</span> rem &lt; l[idx] <span class="keyword">or</span> rem &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 2 3 6 7     7               2</span></span><br><span class="line">        elem = l[idx]</span><br><span class="line">        item.append(elem)</span><br><span class="line">        rem -= elem</span><br><span class="line">        <span class="comment"># if rem &lt; elem:        SHOULDN'T TRUNCATE HERE </span></span><br><span class="line">        <span class="comment">#     return      #1 &lt; 2       2 2 </span></span><br><span class="line">        self.helper(l, idx, rem, item, level+<span class="number">1</span>)</span><br><span class="line">        item.pop()</span><br><span class="line">        rem += elem</span><br><span class="line">        self.helper(l, idx+<span class="number">1</span>, rem, item, level+<span class="number">1</span>)</span><br></pre></td></tr></table></figure>



<h3 id="77"><a href="#77" class="headerlink" title="77"></a><a name="77">77</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">combine</span><span class="params">(self, n: int, k: int)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        self.result = []</span><br><span class="line">        self.helper(n, k, <span class="number">0</span>, []) </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.result</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, n, k, idx, item)</span>:</span>    <span class="comment"># 4, 2 # no level since already have len(item)</span></span><br><span class="line">        <span class="keyword">if</span> len(item) == k:</span><br><span class="line">            self.result.append(item.copy())</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(idx, n):</span><br><span class="line">            item.append(i+<span class="number">1</span>)</span><br><span class="line">            self.helper(n, k, i+<span class="number">1</span>, item)    <span class="comment"># i, level</span></span><br><span class="line">            item.pop()</span><br></pre></td></tr></table></figure>



<h3 id="40"><a href="#40" class="headerlink" title="40"></a><a name="40">40</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">combinationSum2</span><span class="params">(self, candidates: List[int], target: int)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        self.target = target</span><br><span class="line">        result = []</span><br><span class="line">        candidates.sort()</span><br><span class="line">        self.gen(<span class="number">0</span>, candidates, [], result, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen</span><span class="params">(self, i, nums, items, result, total)</span>:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> i == len(nums):</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        items.append(nums[i])</span><br><span class="line">        total += nums[i]</span><br><span class="line">        <span class="comment"># if sum(items) == self.target:</span></span><br><span class="line">        <span class="keyword">if</span> total == self.target:</span><br><span class="line">            <span class="keyword">if</span> items <span class="keyword">not</span> <span class="keyword">in</span> result:</span><br><span class="line">                result.append(items)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> total &lt;= self.target:   <span class="comment"># to prune as early as possible</span></span><br><span class="line">            self.gen(i+<span class="number">1</span>, nums, items.copy(), result, total)</span><br><span class="line">            </span><br><span class="line">        items.pop()</span><br><span class="line">        total -= nums[i]</span><br><span class="line">        self.gen(i+<span class="number">1</span>, nums, items.copy(), result, total)</span><br></pre></td></tr></table></figure>



<h3 id="79"><a href="#79" class="headerlink" title="79"></a><a name="79">79</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="comment"># from collections import deque</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">exist</span><span class="params">(self, board: List[List[str]], word: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> board <span class="keyword">or</span> <span class="keyword">not</span> board[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        </span><br><span class="line">        ans = <span class="literal">False</span></span><br><span class="line">        <span class="comment"># visited = [[False for j in range(len(board[0]))]for i in range(len(board))]</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(board)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>])):</span><br><span class="line">                <span class="keyword">if</span> board[i][j] == word[<span class="number">0</span>]:</span><br><span class="line">                    visited = [[<span class="literal">False</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>]))]<span class="keyword">for</span> i <span class="keyword">in</span> range(len(board))]</span><br><span class="line">                    ans = self.helper(board, i, j, word, <span class="literal">False</span>, visited) <span class="keyword">or</span> ans  </span><br><span class="line">                    <span class="keyword">if</span> ans:</span><br><span class="line">                        <span class="keyword">return</span> ans</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">    </span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    First version failed AT:</span></span><br><span class="line"><span class="string">    [["C","A","A"],</span></span><br><span class="line"><span class="string">     ["A","A","A"],</span></span><br><span class="line"><span class="string">     ["B","C","D"]]</span></span><br><span class="line"><span class="string">    "AAB"</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, board, row, col, item, ans, visited)</span>:</span></span><br><span class="line">        <span class="comment"># if not item:</span></span><br><span class="line">        <span class="comment">#     return True</span></span><br><span class="line">        <span class="keyword">if</span> visited[row][col] == <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> board[row][col] == item[<span class="number">0</span>]:</span><br><span class="line">            visited[row][col] = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> len(item) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                item = item[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> row &lt; len(board)<span class="number">-1</span>:</span><br><span class="line">            <span class="comment"># print(row, col)</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row+<span class="number">1</span>][col]:</span><br><span class="line">                tmp = visited[row+<span class="number">1</span>][col]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row+1, col, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row+<span class="number">1</span>, col, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row+<span class="number">1</span>][col] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> row &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row<span class="number">-1</span>][col]:</span><br><span class="line">                tmp = visited[row<span class="number">-1</span>][col]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row-1, col, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row<span class="number">-1</span>, col, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row<span class="number">-1</span>][col] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> col &lt; len(board[<span class="number">0</span>])<span class="number">-1</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row][col+<span class="number">1</span>]:</span><br><span class="line">                tmp = visited[row][col+<span class="number">1</span>]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row, col+1, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row, col+<span class="number">1</span>, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row][col+<span class="number">1</span>] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> col &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row][col<span class="number">-1</span>]:</span><br><span class="line">                tmp = visited[row][col<span class="number">-1</span>]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row, col-1, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row, col<span class="number">-1</span>, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row][col<span class="number">-1</span>] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/06/System-Design/2020-02-05-System%20Design%20-%20TinuURL/">System-Design/2020-02-05-System Design - TinuURL</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-06</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/System/">System</a></span><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/06/System-Design/2020-02-05-System%20Design%20-%20Push%20vs%20Pull/">System-Design/2020-02-05-System Design - Push vs Pull</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-06</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/System/">System</a></span><div class="content"><h1 id="Long-Polling-vs-WebSockets-vs-Server-Sent-Events"><a href="#Long-Polling-vs-WebSockets-vs-Server-Sent-Events" class="headerlink" title="Long-Polling vs WebSockets vs Server-Sent Events"></a>Long-Polling vs WebSockets vs Server-Sent Events</h1><h3 id="push-vs-pull"><a href="#push-vs-pull" class="headerlink" title="push vs pull"></a>push vs pull</h3><p>一般經常用到的service architecture 有 queuing, REST, RPC(Remote Procedure Call) 是服務之間怎麼交流</p>
<p>![image-20200206230736407](/Users/joe/Library/Application Support/typora-user-images/image-20200206230736407.png)</p>
<p>S 不一定要知道 C 的 ip, 上網看用戶的就是 C。 </p>
<p>![image-20200206231014572](/Users/joe/Library/Application Support/typora-user-images/image-20200206231014572.png)</p>
<p>定點對應服務</p>
<p>基本http請求就是 push請求</p>
<h2 id="Long-Polling"><a href="#Long-Polling" class="headerlink" title="Long-Polling"></a>Long-Polling</h2><p>什麼是HTTP </p>
<ul>
<li>用戶開connection 並向server請求data</li>
<li>server 算response</li>
<li>server送回response</li>
</ul>
<h4 id="Ajax-Polling-對應的也是-PUSH"><a href="#Ajax-Polling-對應的也是-PUSH" class="headerlink" title="Ajax Polling 對應的也是 PUSH"></a>Ajax Polling 對應的也是 PUSH</h4><p>每隔一段時間發一個請求去問好了沒，每0.5秒發一次</p>
<img src="/Users/joe/Library/Application Support/typora-user-images/image-20200206231603559.png" alt="image-20200206231603559" style="zoom:50%;" />

<p>老有人來煩server。</p>
<p>中間也有個latency</p>
<h3 id="HTTP-Long-Polling-對應的也是-PUSH"><a href="#HTTP-Long-Polling-對應的也是-PUSH" class="headerlink" title="HTTP Long Polling - 對應的也是 PUSH"></a>HTTP Long Polling - 對應的也是 PUSH</h3><p>不是馬上response回來，connection一直hold，等在那邊直到好了被通知再發一個真正的請求過去</p>
<p>之前的請求只是要知道「什麼時候好」</p>
<p>有個timeout　</p>
<h3 id="WebSockets-PULL"><a href="#WebSockets-PULL" class="headerlink" title="WebSockets - PULL"></a>WebSockets - PULL</h3><h4 id="Full-duplex-bidirectional"><a href="#Full-duplex-bidirectional" class="headerlink" title="Full-duplex bidirectional"></a>Full-duplex bidirectional</h4><p><strong>C、S兩邊都可以發請求，同時的</strong>。half-duplex 是只有一邊發。</p>
<p>小負擔、幾乎實時、S不需要C的請求，也可以發過去。</p>
<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbn4dopv4ij30w40ggag2.jpg" alt="image-20200206232250565" style="zoom:50%;" />

<p>Server可以PUSH, 發請求，即時拿到。</p>
<p>一般C對S發的Socket是收到response後就關掉了</p>
<p>是「不斷的」所以S可以找到C。</p>
<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbn4dvvbxfj310e0fqgu4.jpg" alt="image-20200206232544827"></p>
<p>S 可以即時PUSH!</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/06/System-Design/2020-02-05-System%20Design%20-%20NoSQL/">System-Design/2020-02-05-System Design - NoSQL</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-06</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/System/">System</a></span><div class="content"><p>SQL - ORM</p>
<h2 id="NoSQL"><a href="#NoSQL" class="headerlink" title="NoSQL"></a>NoSQL</h2><p>Not Only SQL</p>
<p>本身有幾個派別如kv, document</p>
<h4 id="Normalize-–-JOIN-在ORM用的，往往一個機器"><a href="#Normalize-–-JOIN-在ORM用的，往往一個機器" class="headerlink" title="Normalize – JOIN　在ORM用的，往往一個機器"></a>Normalize – JOIN　在ORM用的，往往一個機器</h4><h4 id="Denormalize-–-大量重複寫多份，寫麻煩，讀有利"><a href="#Denormalize-–-大量重複寫多份，寫麻煩，讀有利" class="headerlink" title="Denormalize – 大量重複寫多份，寫麻煩，讀有利　"></a>Denormalize – 大量重複寫多份，寫麻煩，讀有利　</h4><p>在nosql 裡用的 ，nosql往往為了多機器作分布</p>
<p>數據中心要同步數據怎麼辦？跨data-center Denormalize就兩邊都寫</p>
<p>寫時要保證各國的數據中心都寫進去了</p>
<p>要知道是 read-heavy or write-heavy 大多是讀的多</p>
<h5 id="缺點：冗缺、如果系統write-heavy就很不利，如logging-system、message-que"><a href="#缺點：冗缺、如果系統write-heavy就很不利，如logging-system、message-que" class="headerlink" title="缺點：冗缺、如果系統write-heavy就很不利，如logging system、message que"></a>缺點：冗缺、如果系統write-heavy就很不利，如logging system、message que</h5><p>kafka 對寫的支持很好</p>
<ul>
<li><p>要做join的話是在applicatin layer也是middle layer的　＝＝＞　<img src="/Users/joe/Library/Application Support/typora-user-images/image-20200206221633536.png" alt="image-20200206221633536" style="zoom: 25%;" /></p>
</li>
<li><p>不支持ACID - <em>ACID</em> (<em>atomicity, consistency, isolation, durability</em>) is a set of properties of database transactions intended to guarantee validity ，那麼多機器不能保證事務</p>
</li>
<li><p>nosql不好鎖，多個當然不好鎖，慢慢才最終一致</p>
</li>
<li><p>linkedin發了文章，不是需要馬上好友都看到，可以有latency的，我的follower之後才收到沒差</p>
<p>叫作 <strong><em>eventually consistency</em></strong></p>
</li>
<li><h4 id="Quorum-假如有三個人，2-1，少數服從多數"><a href="#Quorum-假如有三個人，2-1，少數服從多數" class="headerlink" title="Quorum - 假如有三個人，2:1，少數服從多數"></a>Quorum - 假如有三個人，2:1，少數服從多數</h4></li>
</ul>
<h4 id="Transaction-銀行的經典例子"><a href="#Transaction-銀行的經典例子" class="headerlink" title="Transaction 銀行的經典例子 -"></a>Transaction 銀行的經典例子 -</h4><p>銀行在意事務，所以ORM比較好。如果在一個地方取，中間</p>
<p>帳號是個變量a, 本來有1000元，一邊要存5000元，另個人從我的帳戶也取1000元。如果沒有事務保護</p>
<p>數據就亂了</p>
<p>DBMS裡在　為保證transation可靠，所以要有ACID</p>
<img src="/Users/joe/Library/Application Support/typora-user-images/image-20200206222645993.png" alt="image-20200206222645993" style="zoom:50%;" />



<h1 id="NoSQL-Cont"><a href="#NoSQL-Cont" class="headerlink" title="NoSQL Cont."></a>NoSQL Cont.</h1><ul>
<li><p>CAP Theorem</p>
</li>
<li><p>在<a href="https://zh.wikipedia.org/wiki/理論計算機科學" target="_blank" rel="noopener">理論計算機科學</a>中，<strong>CAP定理</strong>（CAP theorem），又被稱作<strong>布魯爾定理</strong>（Brewer’s theorem），它指出對於一個<a href="https://zh.wikipedia.org/wiki/分布式计算" target="_blank" rel="noopener">分布式計算系統</a>來說，不可能同時滿足以下三點：<a href="https://zh.wikipedia.org/wiki/CAP定理#cite_note-Lynch-1" target="_blank" rel="noopener">[1]</a><a href="https://zh.wikipedia.org/wiki/CAP定理#cite_note-2" target="_blank" rel="noopener">[2]</a></p>
<ul>
<li>一致性（<strong>C</strong>onsistency） （等同於所有節點訪問同一份最新的數據副本）</li>
<li><a href="https://zh.wikipedia.org/wiki/可用性" target="_blank" rel="noopener">可用性</a>（<strong>A</strong>vailability）（每次請求都能獲取到非錯的響應——但是不保證獲取的數據為最新數據）</li>
<li><a href="https://zh.wikipedia.org/w/index.php?title=网络分区&action=edit&redlink=1" target="_blank" rel="noopener">分區容錯性</a>（<strong>P</strong>artition tolerance）（以實際效果而言，分區相當於對通信的時限要求。系統如果不能在時限內達成數據一致性，就意味著發生了分區的情況，必須就當前操作在C和A之間做出選擇<a href="https://zh.wikipedia.org/wiki/CAP定理#cite_note-3" target="_blank" rel="noopener">[3]</a>。）</li>
</ul>
<p>根據定理，分布式系統只能滿足三項中的兩項而不可能滿足全部三項<a href="https://zh.wikipedia.org/wiki/CAP定理#cite_note-4" target="_blank" rel="noopener">[4]</a>。理解CAP理論的最簡單方式是想像兩個節點分處分區兩側。允許至少一個節點更新狀態會導致數據不一致，即喪失了C性質。如果為了保證數據一致性，將分區一側的節點設置為不可用，那麼又喪失了A性質。除非兩個節點可以互相通信，才能既保證C又保證A，這又會導致喪失P性質。</p>
<p><strong>BASE</strong> is often used to describe the properties of NoSQL databases. In comparison with the <a href="https://github.com/donnemartin/system-design-primer#cap-theorem" target="_blank" rel="noopener">CAP Theorem</a>, BASE chooses availability over consistency.</p>
<ul>
<li><strong>Basically available</strong> - the system guarantees availability.</li>
<li><strong>Soft state</strong> - the state of the system may change over time, even without input.</li>
<li><strong>Eventual consistency</strong> - the system will become consistent over a period of time, given that the system doesn’t receive input during that period.</li>
</ul>
</li>
</ul>
<h4 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h4><p>ORM object relational mapping, mysql oracle都是可以被java裡搞定起來</p>
<p>DDL 時都是差不多的　－　Data Definition Language，DDL</p>
<h4 id="NoSQL就有分流派了-主要就是四大流派"><a href="#NoSQL就有分流派了-主要就是四大流派" class="headerlink" title="NoSQL就有分流派了 主要就是四大流派"></a>NoSQL就有分流派了 主要就是四大流派</h4><p>Key-Value資料庫、記憶體資料庫、圖學資料庫和文件資料庫.</p>
<h4 id="Source-s-and-further-reading-key-value-store"><a href="#Source-s-and-further-reading-key-value-store" class="headerlink" title="Source(s) and further reading: key-value store"></a>Source(s) and further reading: key-value store</h4><ul>
<li><p><a href="https://en.wikipedia.org/wiki/Key-value_database" target="_blank" rel="noopener">Key-value database</a></p>
<p>如cassandra</p>
</li>
<li><p><a href="http://stackoverflow.com/questions/4056093/what-are-the-disadvantages-of-using-a-key-value-table-over-nullable-columns-or" target="_blank" rel="noopener">Disadvantages of key-value stores</a></p>
</li>
<li><p><a href="http://qnimate.com/overview-of-redis-architecture/" target="_blank" rel="noopener">Redis architecture</a>　比較是緩存服務</p>
</li>
<li><p><a href="https://www.adayinthelifeof.nl/2011/02/06/memcache-internals/" target="_blank" rel="noopener">Memcached architecture</a>　比較是緩存服務</p>
</li>
</ul>
<h4 id="Document-Store-MongoDB"><a href="#Document-Store-MongoDB" class="headerlink" title="Document Store - MongoDB"></a>Document Store - MongoDB</h4><h5 id="最重要的就是Schemaless-–-就是沒有schema"><a href="#最重要的就是Schemaless-–-就是沒有schema" class="headerlink" title="最重要的就是Schemaless – 就是沒有schema,"></a>最重要的就是Schemaless – 就是沒有schema,</h5><h4 id="Document-store"><a href="#Document-store" class="headerlink" title="Document store"></a>Document store</h4><blockquote>
<p>Abstraction: key-value store with documents stored as values</p>
</blockquote>
<p>A document store is centered around documents (XML, JSON, binary, etc), where a document stores all information for a given object. Document stores provide APIs or a query language to query based on the internal structure of the document itself. <em>Note, many key-value stores include features for working with a value’s metadata, blurring the lines between these two storage types.</em></p>
<p>Based on the underlying impleme</p>
<h5 id="Source-s-and-further-reading-document-store"><a href="#Source-s-and-further-reading-document-store" class="headerlink" title="Source(s) and further reading: document store"></a>Source(s) and further reading: document store</h5><ul>
<li><a href="https://en.wikipedia.org/wiki/Document-oriented_database" target="_blank" rel="noopener">Document-oriented database</a></li>
<li><a href="https://www.mongodb.com/mongodb-architecture" target="_blank" rel="noopener">MongoDB architecture</a></li>
<li><a href="https://blog.couchdb.org/2016/08/01/couchdb-2-0-architecture/" target="_blank" rel="noopener">CouchDB architecture</a></li>
<li><a href="https://www.elastic.co/blog/found-elasticsearch-from-the-bottom-up" target="_blank" rel="noopener">Elasticsearch architecture</a></li>
</ul>
<h4 id="Wide-column-store"><a href="#Wide-column-store" class="headerlink" title="Wide column store"></a>Wide column store</h4><p><a href="https://tva1.sinaimg.cn/large/0082zybpgy1gbn4cnj0ioj30g506f0t2.jpg" target="_blank" rel="noopener"><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbn4cnj0ioj30g506f0t2.jpg" alt="img"></a><br><strong><em><a href="http://blog.grio.com/2015/11/sql-nosql-a-brief-history.html" target="_blank" rel="noopener">Source: SQL &amp; NoSQL, a brief history</a></em></strong></p>
<blockquote>
<p>Abstraction: nested map <code>ColumnFamily&gt;</code></p>
</blockquote>
<p>Google introduced <a href="http://www.read.seas.harvard.edu/~kohler/class/cs239-w08/chang06bigtable.pdf" target="_blank" rel="noopener">Bigtable</a> as the first wide column store, which influenced the open-source <a href="https://www.mapr.com/blog/in-depth-look-hbase-architecture" target="_blank" rel="noopener">HBase</a> often-used in the Hadoop ecosystem, and <a href="http://docs.datastax.com/en/cassandra/3.0/cassandra/architecture/archIntro.html" target="_blank" rel="noopener">Cassandra</a> from Facebook. Stores such as BigTable, HBase, and Cassandra maintain keys in lexicographic order, allowing efficient retrieval of selective key ranges.</p>
<h4 id="Graph-DB-–-for-social-Network"><a href="#Graph-DB-–-for-social-Network" class="headerlink" title="Graph DB – for social Network"></a>Graph DB – for social Network</h4><h5 id="Graph-database"><a href="#Graph-database" class="headerlink" title="Graph database"></a>Graph database</h5><p><a href="https://tva1.sinaimg.cn/large/0082zybpgy1gbn4cpicsqj30h40c4gps.jpg" target="_blank" rel="noopener"><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbn4cpicsqj30h40c4gps.jpg" alt="img"></a><br><em><a href="https://en.wikipedia.org/wiki/File:GraphDatabase_PropertyGraph.png" target="_blank" rel="noopener">Source: Graph database</a></em></p>
<blockquote>
<p>Abstraction: graph</p>
</blockquote>
<p>In a graph database, each node is a record and each arc is a relationship between two nodes. Graph databases are optimized to represent complex relationships with many foreign keys or many-to-many relationships.</p>
<p>Graphs databases offer high performance for data models with complex relationships, such as a social network. They are relatively new and are not yet widely-used; it might be more difficult to find development tools and resources. Many graphs can only be accessed with <a href="https://github.com/donnemartin/system-design-primer#representational-state-transfer-rest" target="_blank" rel="noopener">REST APIs</a>.</p>
<h5 id="Source-s-and-further-reading-graph"><a href="#Source-s-and-further-reading-graph" class="headerlink" title="Source(s) and further reading: graph"></a>Source(s) and further reading: graph</h5><ul>
<li><a href="https://en.wikipedia.org/wiki/Graph_database" target="_blank" rel="noopener">Graph database</a></li>
<li><a href="https://neo4j.com/" target="_blank" rel="noopener">Neo4j</a></li>
<li><a href="https://blog.twitter.com/2010/introducing-flockdb" target="_blank" rel="noopener">FlockDB</a></li>
</ul>
<h2 id="SQL-vs-NoSQL"><a href="#SQL-vs-NoSQL" class="headerlink" title="SQL vs NoSQL"></a>SQL vs NoSQL</h2><p>mysql vs cassandra 之間的區別之類的？</p>
<p>Reasons for <strong>SQL</strong>:</p>
<ul>
<li>Structured data</li>
<li>Strict schema</li>
<li>Relational data</li>
<li>Need for complex joins 如用戶跟group</li>
<li>Transactions　事務</li>
<li>Clear patterns for scaling</li>
<li>More established: developers, community, code, tools, etc</li>
<li>Lookups by <strong><em>index</em></strong> are very fast</li>
</ul>
<p>Reasons for <strong>NoSQL</strong>:</p>
<ul>
<li>Semi-structured data　　</li>
<li><strong><em>Dynamic or flexible schema</em></strong></li>
<li>Non-relational data</li>
<li>No need for complex joins</li>
<li><strong><em>Store many TB (or PB) of data</em></strong>　</li>
<li><strong><em>Very data intensive workload</em></strong> </li>
<li>Very high throughput for IOPS (Input/Output Operations Per Second</li>
</ul>
<p>Sample data well-suited for NoSQL:</p>
<ul>
<li>Rapid ingest of clickstream and <strong><em>log data</em></strong> 之前說的頻繁寫的</li>
<li>Leaderboard or scoring data <strong><em>就 eventually consistency 就好的</em></strong></li>
<li>Temporary data, such as a shopping cart  有cache就可以搞定</li>
<li>Frequently accessed (‘hot’) tables</li>
<li>Metadata/lookup tables</li>
</ul>
<h5 id="Source-s-and-further-reading-SQL-or-NoSQL"><a href="#Source-s-and-further-reading-SQL-or-NoSQL" class="headerlink" title="Source(s) and further reading: SQL or NoSQL"></a>Source(s) and further reading: SQL or NoSQL</h5><ul>
<li><a href="https://www.youtube.com/watch?v=w95murBkYmU" target="_blank" rel="noopener">Scaling up to your first 10 million users</a></li>
<li><a href="https://www.sitepoint.com/sql-vs-nosql-differences/" target="_blank" rel="noopener">SQL vs NoSQL differences</a></li>
</ul>
<p>![image-20200206225707917](/Users/joe/Library/Application Support/typora-user-images/image-20200206225707917.png)</p>
<h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>![image-20200206225824207](/Users/joe/Library/Application Support/typora-user-images/image-20200206225824207.png)</p>
<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbn4crkjxdj311005wdge.jpg" alt="image-20200206225934479"></p>
<img src="/Users/joe/Library/Application Support/typora-user-images/image-20200206230007842.png" alt="image-20200206230007842" style="zoom:50%;" />

<p>量不大時　SQL 就夠了；如ACID、data不會變的或結構的</p>
<p>量大時才會用 NoSQL 學校一般用不到那麼大流量啊 量大時一般沒結構，的確NoSQL也是比較靈活</p>
<p>雲上一般要多個機器，硬體也都比較便宜</p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd5cj2dgicj30u00wv1g9.jpg" alt="image-20200324213805414" style="zoom: 33%;" /></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/06/System-Design/2020-02-05-System%20Design%20-%20Sharding%20&amp;%20Queue/">System-Design/2020-02-05-System Design - Sharding &amp; Queue</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-06</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/System/">System</a></span><div class="content"><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h1 id="分片"><a href="#分片" class="headerlink" title="分片"></a>分片</h1><p>partition  or  sharding</p>
<p>每個機器分一部分就是要切小塊，LB就是在做pardition　sharding更指db的存儲</p>
<p>日本放在日本的db，因為有 sharding　所以要routing去找數據</p>
<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gbmy6i9wcvj30hu0k8781.jpg" alt="img" style="zoom:50%;" />

<p>sharding　一般來說指的是db　</p>
<p>partition不一定是固定的，也可能增加了機器，每個就管得比較少了</p>
<p>照地理位置去找</p>
<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbn4cs9n1vj30yg0lcdit.jpg" alt="image-20200206202240123"></p>
<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gbmy90zsmlj30tw0k0dnz.jpg" alt="image-20200206202333357" style="zoom:50%;" />

<p>![image-20200206202407013](/Users/joe/Library/Application Support/typora-user-images/image-20200206202407013.png)</p>
<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gbmya9oquoj30ym0jck1l.jpg" alt="image-20200206202443059" style="zoom:50%;" />



<h3 id="Partition-Method"><a href="#Partition-Method" class="headerlink" title="Partition Method"></a>Partition Method</h3><p>by ID, by letter, by Term</p>
<p>Horizontal partitioning : as by ID　風險：range分得不好，所以不平衡，怎麼evenly distributed?!</p>
<p>Vertical Partitioning : 按業務去分　如下圖↓</p>
<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gbmyk67nx2j30kw0mwjyj.jpg" alt="image-20200206203421886" style="zoom:50%;" /> 

<p>業務調整、或是中間加一層就更複雜了</p>
<h2 id="Partitioning-Criteria"><a href="#Partitioning-Criteria" class="headerlink" title="Partitioning Criteria"></a>Partitioning Criteria</h2><ol>
<li>key or hash-based partitioning<br>userid每次加１的id，對100取個mod去知道哪個機器，工業中一般不用　這個是distributed hashing，用consistent hashing比較好↓</li>
<li>list partitionging 自己聲明rule 就像mongodb，自己定義</li>
<li>round-robin</li>
<li>composite</li>
</ol>
<h2 id="Consistent-Hashing"><a href="#Consistent-Hashing" class="headerlink" title="Consistent Hashing"></a>Consistent Hashing</h2><p>把所有可能的hash值分成圓五份 </p>
<p>這樣可能不均勻</p>
<p>所以就有個vnnode的概念 一個機器對應五個 vnnode</p>
<img src="/Users/joe/Library/Application Support/typora-user-images/image-20200206204214506.png" alt="image-20200206204214506" style="zoom:50%;" />

<p>可能一個對應256個vnnode</p>
<h4 id="備份↓"><a href="#備份↓" class="headerlink" title="備份↓"></a>備份↓</h4><img src="/Users/joe/Library/Application Support/typora-user-images/image-20200206204351704.png" alt="image-20200206204351704" style="zoom:50%;" />

<p>如果４～５區段掛了，全給A承擔太不公平；如果有vnnode　一台機器掛了，後面的每個機器都可以均勻分擔這個量</p>
<p>distributed hash是大挪移要全重算…　所以一致性哈希好</p>
<h2 id="Common-problems-of-Sharding"><a href="#Common-problems-of-Sharding" class="headerlink" title="Common problems of Sharding"></a>Common problems of Sharding</h2><p>因為數據不是在一處，所以要去多個地方去取。</p>
<ol>
<li>Join and Denormalization 去user table 去查 name ；<br>讀還ok寫就麻煩了</li>
<li>Referential integrity </li>
<li>Rebalancing 重弄分片；有某個zip數據量特大。</li>
</ol>
<h2 id="LinkedIn-Prob"><a href="#LinkedIn-Prob" class="headerlink" title="LinkedIn Prob."></a>LinkedIn Prob.</h2><img src="/Users/joe/Library/Application Support/typora-user-images/image-20200206205226121.png" alt="image-20200206205226121" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gbmz3ewua8j30x40jqn9w.jpg" alt="image-20200206205246002" style="zoom:50%;" />

<img src="/Users/joe/Library/Application Support/typora-user-images/image-20200206205350491.png" alt="image-20200206205350491" style="zoom:50%;" />



<h5 id="Expression-Tree"><a href="#Expression-Tree" class="headerlink" title="Expression Tree"></a>Expression Tree</h5><img src="/Users/joe/Library/Application Support/typora-user-images/image-20200206205535354.png" alt="image-20200206205535354" style="zoom:50%;" />



<h1 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a>Queue</h1><h4 id="message-queue"><a href="#message-queue" class="headerlink" title="message queue　"></a>message queue　</h4><p>不會丟，可以保證不會丟失</p>
<p>往ｑ放東西，consumer拿東西，本身是個異步過程。 Hot-spot, burst，Q就是個buffer，</p>
<p>系統可以不用等在那邊，可防止 burst</p>
<ul>
<li>An application publishes a job to the queue, then notifies the user of job status</li>
<li>A worker picks up the job from the queue, processes it, then signals the job is complete</li>
</ul>
<p>可以buffer住一堆來的請求，讓producer不用等在那邊<br>consumer一直去polling　就是異步</p>
<p>這情況同步會降低效能 </p>
<p>要確定放成功了 要拿個 task_id 之後再一直去要</p>
<p><strong><a href="https://redis.io/" target="_blank" rel="noopener">Redis</a></strong> is useful as a simple message broker but messages can be lost.</p>
<p><strong><a href="https://www.rabbitmq.com/" target="_blank" rel="noopener">RabbitMQ</a></strong> is popular but requires you to adapt to the ‘AMQP’ protocol and manage your own nodes.</p>
<p><strong><a href="https://aws.amazon.com/sqs/" target="_blank" rel="noopener">Amazon SQS</a></strong> is hosted but can have high latency and has the possibility of messages being delivered twice.</p>
<p>上面三個比較有名的 message queue的框架</p>
<p> server取完後再去把task刪了，至少這個task還是在queue裡的 </p>
<h5 id="可以取出來在db-or-que寫-in-progress，-gt-high-availability-不丟消息"><a href="#可以取出來在db-or-que寫-in-progress，-gt-high-availability-不丟消息" class="headerlink" title="可以取出來在db or que寫 in progress，==&gt; high availability　不丟消息"></a>可以取出來在db or que寫 in progress，==&gt; high availability　不丟消息</h5><p>可以retry</p>
<p>![image-20200206211146919](/Users/joe/Library/Application Support/typora-user-images/image-20200206211146919.png)</p>
<h5 id="Async-缺點：當計算快時比較建議用同步就好，因為que會有delay跟complexity"><a href="#Async-缺點：當計算快時比較建議用同步就好，因為que會有delay跟complexity" class="headerlink" title="Async 缺點：當計算快時比較建議用同步就好，因為que會有delay跟complexity"></a>Async 缺點：當計算快時比較建議用同步就好，因為que會有delay跟complexity</h5></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/06/System-Design/2020-02-05-System%20Design%20-%20Cache/">System-Design/2020-02-05-System Design - Cache</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-06</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/System/">System</a></span><div class="content"><h3 id="https-kknews-cc-zh-tw-code-8vljmng-html"><a href="#https-kknews-cc-zh-tw-code-8vljmng-html" class="headerlink" title="https://kknews.cc/zh-tw/code/8vljmng.html"></a><a href="https://kknews.cc/zh-tw/code/8vljmng.html" target="_blank" rel="noopener">https://kknews.cc/zh-tw/code/8vljmng.html</a></h3><p><a href="https://www.zhihu.com/question/319817091" target="_blank" rel="noopener">https://www.zhihu.com/question/319817091</a></p>
<h2 id="Cache"><a href="#Cache" class="headerlink" title="Cache"></a>Cache</h2><p>對比disk and memory, 內存貴，跟disk比，它寫跟讀快很多</p>
<p>local sidk cmp to memory</p>
<img src="https://camo.githubusercontent.com/7acedde6aa7853baf2eb4a53f88e2595ebe43756/687474703a2f2f692e696d6775722e636f6d2f51367a32344c612e706e67" alt="img" style="zoom:48%;" />

<p>方法算法被多次叫怎辦？就是說要加Cache。</p>
<p>Cacheing service : Memcache, Redis</p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd3rkssomcj310c0kgaj0.jpg" alt="image-20200206192031055" style="zoom:50%;" />

<h3 id="Cache-aside"><a href="#Cache-aside" class="headerlink" title="Cache aside"></a>Cache aside</h3><p>照理redis不需要知道業務邏輯，應該都是client控制的，所以redis跟db應該沒分前後</p>
<p>並發時噁心</p>
<p>機率非常低，還可以設上個ttl，讓他自動expire，減小髒的機率，髒指的就是cache、db不同</p>
<p>這個是最常用的</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd3rkxfaonj30uc0hk44g.jpg" alt="image-20200206192751483"></p>
<h2 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h2><p>分布式cache</p>
<p>如果用redis他有很多模式，最好的就是如果有三台機器，希望每台都分擔些</p>
<p>traffic用一致性哈希　不同key知道要去哪台找，每個node 就是 1/n</p>
<p>雲計算就是堆機器。</p>
<h5 id="缺點："><a href="#缺點：" class="headerlink" title="缺點："></a>缺點：</h5><p>要是一個機器掛了，有時有個備份。要是一台機器突然沒了，要是用consistent哈希，會重新算每個從 1/5變1/4。cache miss就是去　DB拿。要是突然一台掛了，瞬間會對，一致性哈希有個hash ring。目標就是當一個走了後，盡量讓原來的機器，每個機器要從1/4 –&gt; 1/3　差為1/12。每台要增加這麼多的數據量。讓遷坤大挪移緩和點。</p>
<p>一致性哈希是說讓遷移。讓</p>
<p>distributed hash　就是取模</p>
<p>CDN　content distributed network，也是緩存，更像file system。縣到市市到省</p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd3rl19ugwj30ze0k0wp2.jpg" alt="image-20200206194335424" style="zoom:50%;" />

<p>　</p>
<h3 id="Read-Write-Through"><a href="#Read-Write-Through" class="headerlink" title="Read/Write Through"></a>Read/Write Through</h3><p>使用者寫到cache, cache自己會負責跟db更新，不用你來管，對應用來說簡單多。</p>
<p>嚴格上跟memorycached、redis不一樣，這種cache是知道業務邏輯是知道schema、數據的。</p>
<h5 id="Cache-就是個Service了"><a href="#Cache-就是個Service了" class="headerlink" title="Cache　就是個Service了"></a>Cache　<strong>就是個Service了</strong></h5><p>調cache的人就舒服了什麼都不用管，服務本身在做cache</p>
<p>它會同步寫到db，必須DB完成後才能返回給３，會慢一點寫慢一點，讀仍是快</p>
<p>把client做的邏輯給cache做</p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd3rl5r877j30ea0k8go4.jpg" alt="img" style="zoom:67%;" />



<h5 id="Disadvantage-s-write-through"><a href="#Disadvantage-s-write-through" class="headerlink" title="Disadvantage(s): write through"></a>Disadvantage(s): write through</h5><ul>
<li><p>When a new node is created due to failure or scaling, the new node will not cache entries until the entry is updated in the database. <strong>Cache-aside in conjunction with write through can mitigate this issue.</strong>　來個新node要去db找來寫代價大</p>
</li>
<li><p>Most data written might never be read, which can be minimized with a TTL.　給個死掉的時間</p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd3rl9vcz3j30s60k0dty.jpg" alt="image-20200206195432938" style="zoom:50%;" />



</li>
</ul>
<h3 id="Write-behind-↓-下面"><a href="#Write-behind-↓-下面" class="headerlink" title="Write-behind　↓　下面"></a>Write-behind　↓　下面</h3><p>cache不是馬上去更新db，當大量高併發寫時，撐不住，所以先buffer一下個10秒</p>
<p>k:v1, v2, v3，直接就一次v3就好了 </p>
<p>DB可batch更新　時間到或queue到其值</p>
<p>萬一buffer時掛了怎辦？linux RO</p>
<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbn4cmhb4sj30lu0k8aao.jpg" alt="img"></p>
<h5 id="Refresh-ahead…-↓"><a href="#Refresh-ahead…-↓" class="headerlink" title="Refresh ahead… ↓"></a>Refresh ahead… ↓</h5><h5 id=""><a href="#" class="headerlink" title=""></a></h5><p>简单的说就是在缓存数据过期前，能自动的刷新缓存数据。举个例子来说，某条数据在缓存中，过期时间是60秒。我们给他设置一个参数，比如是0.8，60x0.8=48秒，那么在前48秒访问该数据，就照正常的取法，直接返回缓存中的数据。当在48-60秒这个区间取数据时，缓存先将之前缓存的结果返回给外部应用程序，然后异步的再从数据库去更新缓存中的值，以尽可能的保证缓存的值是最新的。如果取数据的的时候超过了60秒，就安装read-through的方式。<br> Refresh-ahead是对未来数据的访问情形的估算，我们猜测这个数据在过期后，仍然可能被频繁的访问，那么这种设计的策略获得的优势会更明显。<br> 但是，如果有大量的数据是用refresh-ahead策略，但是这个数据被重新缓存后，又一次都没有被访问过，那这个策略就是很失算的了。<br> 那么，有人可能会问，既然如此，我把过期的时间延长不就好了，之前60秒过期，改成6000秒过期，这样就不会用Refresh-ahead策略来刷新数据了。<br> 然而，事实是缓存的数据越久，出现脏数据的可能性也就越大，更重要的是，如果你的估算也是失误的，大量的超期缓存数据没有被实际访问，那么你就浪费了很多的内存，做了无用的事情，这也是应该避免的。</p>
<p>作者：周小春<br>链接：<a href="https://www.jianshu.com/p/6321d4f823c1" target="_blank" rel="noopener">https://www.jianshu.com/p/6321d4f823c1</a><br>来源：简书<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/05/System-Design/2020-02-04-System%20Design%20-%20LB/">System-Design/2020-02-04-System Design - LB</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-05</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/System/">System</a></span><div class="content"><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h2 id="SNAKE"><a href="#SNAKE" class="headerlink" title="SNAKE"></a>SNAKE</h2><ul>
<li>Scenario: case/interface</li>
<li>Necessary: constrain/hypothesis</li>
<li>Application: service/algo</li>
<li>Kilobit: data</li>
<li>Evolve</li>
</ul>
<p>使用redis 緩存的地方</p>
<ul>
<li>獎品，數量少，更新頻率低，最佳的全量緩存對象</li>
<li>優惠券，一次性導入，優惠券編碼緩存為set類型</li>
<li>中獎紀錄，讀寫差不多，可以緩存部分統計數據</li>
<li>黑名單</li>
</ul>
<h2 id="Loading-Balancing"><a href="#Loading-Balancing" class="headerlink" title="Loading Balancing"></a>Loading Balancing</h2><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gd3rkbx8ooj319y0acwkc.jpg" alt="image-20200205225415969" style="zoom:50%;" />

<ul>
<li><p>nginx async</p>
</li>
<li><p>HAProxy 加了機器要自己再改配置</p>
<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gblx1909c6j31c20i2h6v.jpg" alt="image-20200205225556197" style="zoom:50%;" />



</li>
</ul>
<h3 id="設計-Serverside-Load-Balancer-選server"><a href="#設計-Serverside-Load-Balancer-選server" class="headerlink" title="設計 Serverside Load Balancer 選server"></a>設計 Serverside Load Balancer 選server</h3><img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gblyao5twoj314a0jk7jx.jpg" alt="image-20200205233939163" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gblyb6gizej314y0lik65.jpg" alt="image-20200205234009523" style="zoom:50%;" />

<p>Load balancing 可以用一致性哈希的機制　key是一樣永遠會去一樣的機器</p>
<p>希望對某一個key去固定的server取緩存</p>
<h5 id="Spring-Cloud-Ribbon"><a href="#Spring-Cloud-Ribbon" class="headerlink" title="Spring Cloud - Ribbon"></a>Spring Cloud - Ribbon</h5><p>來了新的ABC Service，LB會知道，因為有Service Registration，LB會考慮第11個進來</p>
<p>Smart LB</p>
<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gblyg6va34j30z20pqgw1.jpg" alt="image-20200205234458185" style="zoom:50%;" />

<p>１ AvailabilityFilteringRule 10秒、100, 1000秒再試 exponential</p>
<p>２ WeightedResponseTimeRule 要等愈長，權重給它愈小，我相對應該要發給response快的。</p>
<p>​    但不知道是DB慢還是API自己慢，還可講更底層的 TLS(Transpor Layer Security)、握手等機制都是routing的因素，所以smart LB都要考慮</p>
<h2 id="System-Design-Primer"><a href="#System-Design-Primer" class="headerlink" title="System Design Primer"></a>System Design Primer</h2><p><a href="https://github.com/kevingo/system-design-primer-zh-tw#how-to-approach-a-system-design-interview-question" target="_blank" rel="noopener">https://github.com/kevingo/system-design-primer-zh-tw#how-to-approach-a-system-design-interview-question</a>　</p>
<img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gblyxvhf3ij30sb0ixwfc.jpg" alt="img" style="zoom:48%;" />

<ul>
<li><p>Sticky session / cookies 指的就是之前提到的 constant hash</p>
</li>
<li><p>傳輸層安全性協定（英語：Transport Layer Security，縮寫：TLS）及其前身安全通訊協定（英語：Secure Sockets Layer，縮寫：SSL）是一種安全協定，目的是為網際網路通訊提供安全及資料完整性保障。</p>
</li>
<li><p>TLS與SSL協定可加密客戶端與伺服器端的網路通訊，它們利用憑證來建立身分鏈，以確保客戶端所通訊的對象是經過驗證的合法伺服器。而進行HTTPS監聽的方法則是在客戶端與伺服器端之間建立一個中間代理人，類似中間人攻擊（man-in-the-middle）的手法，這些可執行HTTPS監聽的安全產品會先攔截流量、檢查流量內容，再重建連結。</p>
</li>
<li><p>内部自己用RPC</p>
</li>
<li><p>Load balancers can be implemented with hardware (expensive) or with software such as HAProxy.</p>
<p>Additional benefits include:</p>
<ul>
<li>SSL termination</li>
</ul>
</li>
</ul>
<pre><code>\- Decrypt incoming requests and encrypt server responses so backend servers do not have to perform these potentially expensive operations

- Removes the need to install [X.509 certificates](https://en.wikipedia.org/wiki/X.509) on each server</code></pre><ul>
<li><p><strong>Session persistence</strong> - Issue cookies and route a specific client’s requests to same instance if the web apps do not keep track of sessions === 如購物車時</p>
</li>
<li><h3 id="Fail-over"><a href="#Fail-over" class="headerlink" title="Fail-over"></a>Fail-over</h3><h4 id="Active-passive-有替補的當主要的掛了時馬上補上去"><a href="#Active-passive-有替補的當主要的掛了時馬上補上去" class="headerlink" title="Active-passive　有替補的當主要的掛了時馬上補上去"></a>Active-passive　有替補的當主要的掛了時馬上補上去</h4><p>With active-passive fail-over, heartbeats are sent between the active and the passive server on standby. If the heartbeat is interrupted, the passive server takes over the active’s IP address and resumes service.</p>
<p>The length of downtime is determined by whether the passive server is already running in ‘hot’ standby or whether it needs to start up from ‘cold’ standby. Only the active server handles traffic.</p>
<p>Active-passive failover can also be referred to as master-slave failover.</p>
<h4 id="Active-active"><a href="#Active-active" class="headerlink" title="Active-active"></a>Active-active</h4><p>In active-active, both servers are managing traffic, spreading the load between them.</p>
<p>If the servers are public-facing, the DNS would need to know about the public IPs of both servers. If the servers are internal-facing, application logic would need to know about both servers.</p>
<p>Active-active failover can also be referred to as master-master failover.</p>
</li>
</ul>
<ul>
<li><h3 id="NAT-Network-Address-Translation-NAT"><a href="#NAT-Network-Address-Translation-NAT" class="headerlink" title="NAT - Network Address Translation (NAT)"></a>NAT - Network Address Translation (NAT)</h3><p>對外會把ip映射成一個對外的ip</p>
<p>當在配置一個data center 時，內外ip的mapping</p>
<h3 id="Layer-4-load-balancing"><a href="#Layer-4-load-balancing" class="headerlink" title="Layer 4 load balancing"></a>Layer 4 load balancing</h3><p>Layer 4 load balancers look at info at the <a href="https://github.com/kevingo/system-design-primer-zh-tw#communication" target="_blank" rel="noopener">transport layer</a> to decide how to distribute requests. Generally, this involves the source, destination IP addresses, and ports in the header, but not the contents of the packet. Layer 4 load balancers forward network packets to and from the upstream server, performing <a href="https://www.nginx.com/resources/glossary/layer-4-load-balancing/" target="_blank" rel="noopener">Network Address Translation (NAT)</a>.</p>
<h3 id="Layer-7-load-balancing"><a href="#Layer-7-load-balancing" class="headerlink" title="Layer 7 load balancing"></a>Layer 7 load balancing</h3><p>Layer 7 load balancers look at the <a href="https://github.com/kevingo/system-design-primer-zh-tw#communication" target="_blank" rel="noopener">application layer</a> to decide how to distribute requests. This can involve contents of the header, message, and cookies. Layer 7 load balancers terminates network traffic, reads the message, makes a load-balancing decision, then opens a connection to the selected server. <strong>For example, a layer 7 load balancer can direct video traffic to servers that host videos while directing more sensitive user billing traffic to security-hardened servers.</strong><br>就是根據 URLroute 到不同的服務</p>
<p>spring cloud zuul裡就有得配置　path ==&gt; serviceId </p>
</li>
</ul>
<pre><code>&lt;img src=&quot;https://camo.githubusercontent.com/1d761d5688d28ce1fb12a0f1c8191bca96eece4c/687474703a2f2f692e696d6775722e636f6d2f354b656f6351732e6a7067&quot; alt=&quot;img&quot;  /&gt;

At the cost of flexibility, ***layer 4 load balancing requires less time and computing resources than Layer 7***, although the performance impact can be minimal on modern commodity hardware.</code></pre><p>  ​        愈底下愈快啊　如Application Server用IPC　肯定比http快</p>
<h3 id="Horizontal-scaling-加機器"><a href="#Horizontal-scaling-加機器" class="headerlink" title="Horizontal scaling     加機器"></a>Horizontal scaling     加機器</h3><p>Load balancers can also help with horizontal scaling, improving performance and availability. Scaling out using commodity machines is more cost efficient and results in higher availability than scaling up a single server on more expensive hardware, called <strong>Vertical Scaling　==&gt;　加CPU、RAM</strong>. It is also easier to hire for talent working on commodity hardware than it is for specialized enterprise systems.</p>
<h4 id="Disadvantage-s-horizontal-scaling"><a href="#Disadvantage-s-horizontal-scaling" class="headerlink" title="Disadvantage(s): horizontal scaling"></a>Disadvantage(s): horizontal scaling</h4><ul>
<li>Scaling horizontally introduces complexity and involves cloning servers<ul>
<li>Servers should be <strong>stateless</strong>: they should not contain any user-related data like sessions or profile pictures　<strong>不管去哪台web server機器都應該要是一樣的　不該有session這樣的東西</strong></li>
<li><strong>Sessions</strong> can be stored in a centralized data store such as a <a href="https://github.com/kevingo/system-design-primer-zh-tw#database" target="_blank" rel="noopener">database</a> (SQL, NoSQL) or a persistent <a href="https://github.com/kevingo/system-design-primer-zh-tw#cache" target="_blank" rel="noopener">cache</a> (Redis, Memcached). <strong>Session 就是 Stateful</strong></li>
</ul>
</li>
<li>Downstream servers such as caches and databases need to handle more simultaneous connections as upstream servers scale out</li>
</ul>
<p>​        </p>
<h3 id="Disadvantage-s-load-balancer"><a href="#Disadvantage-s-load-balancer" class="headerlink" title="Disadvantage(s): load balancer"></a>Disadvantage(s): load balancer</h3><ul>
<li><p>The load balancer can become a performance bottleneck if it does not have enough resources or if it is not configured properly.　掛了就沒</p>
</li>
<li><p>Introducing a load balancer to help eliminate single points of failure results in increased complexity.</p>
</li>
</ul>
<ul>
<li><p>A single load balancer is a single point of failure, configuring multiple load balancers further increases complexity.</p>
</li>
<li><h3 id="Source-s-and-further-reading"><a href="#Source-s-and-further-reading" class="headerlink" title="Source(s) and further reading"></a>Source(s) and further reading</h3><ul>
<li><a href="https://www.nginx.com/blog/inside-nginx-how-we-designed-for-performance-scale/" target="_blank" rel="noopener">NGINX architecture</a></li>
<li><a href="http://www.haproxy.org/download/1.2/doc/architecture.txt" target="_blank" rel="noopener">HAProxy architecture guide</a></li>
<li><a href="http://www.lecloud.net/post/7295452622/scalability-for-dummies-part-1-clones" target="_blank" rel="noopener">Scalability</a></li>
<li><a href="https://en.wikipedia.org/wiki/Load_balancing_(computing)" target="_blank" rel="noopener">Wikipedia</a></li>
<li><a href="https://www.nginx.com/resources/glossary/layer-4-load-balancing/" target="_blank" rel="noopener">Layer 4 load balancing</a></li>
<li><a href="https://www.nginx.com/resources/glossary/layer-7-load-balancing/" target="_blank" rel="noopener">Layer 7 load balancing</a></li>
<li><a href="http://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-listener-config.html" target="_blank" rel="noopener">ELB listener config</a>　　這個是亞馬遜自己開發的</li>
</ul>
</li>
</ul>
<p>LB 某種意義上就是 reversed proxy (Web Server)了</p>
<p>ref : </p>
<p><a href="https://www.youtube.com/watch?v=RlkA1NRoYJ8&amp;list=PLbhaS_83B97vSWVslD63vjIi5OTYmSVrk&amp;index=80" target="_blank" rel="noopener">https://www.youtube.com/watch?v=RlkA1NRoYJ8&amp;list=PLbhaS_83B97vSWVslD63vjIi5OTYmSVrk&amp;index=80</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/05/Web/2020-02-03-Database/">Web/2020-02-03-Database</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-05</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Web/">Web</a></span><div class="content"><h3 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h3><p>用一條SQL 語句 查詢出每門課都大於80 分的學生姓名<br>name kecheng fenshu<br>張三 語文 81<br>張三 數學 75<br>李四 語文 76<br>李四 數學 90<br>王五 語文 81<br>王五 數學 100<br>王五 英語 90</p>
<p>A: select distinct name from table where name not in (select distinct name from table where fenshu&lt;=80);<br>  select name from table group by name having min(fenshu)&gt;80;</p>
<p> select name from table group by name having count(kecheng)&gt;=3 and min(fenshu)&gt;=80;</p>
<h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> redis <span class="keyword">import</span> StrictRedis</span><br><span class="line">rds = StrictRedis(host=<span class="string">'127.0.0.1'</span>, port=<span class="number">6379</span>, db=<span class="number">4</span>, password=<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">producer</span><span class="params">()</span>:</span></span><br><span class="line">	info = &#123;<span class="string">"job_id"</span>: job_id, <span class="string">"dir"</span>: E_dir, <span class="string">"paras"</span>: params&#125;</span><br><span class="line">	rds.rpush(task_que_name, json.dumps(info))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">status_checker</span><span class="params">()</span>:</span></span><br><span class="line">  result_check = rds.hmget(result_que_name, job_id)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">worker</span><span class="params">()</span>:</span></span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># job = q.get</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span>:</span><br><span class="line">            <span class="comment"># running = True</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="string">""" Get job_id from task_que """</span></span><br><span class="line">                _, info = rds.blpop(task_que_name)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># &#123;'job_id': '9c5c2780-32e0-11ea-805b-005056ab266c', 'dir': 'M_', 'paras': &#123;'_name': 'testxxxxx7373'&#125;&#125;</span></span><br><span class="line">                info = json.loads(info.decode())    <span class="comment"># info is byte from redis</span></span><br><span class="line">                result = foo(info[<span class="string">"dir"</span>], info[<span class="string">"paras"</span>])</span><br><span class="line">                <span class="comment"># time.sleep(500)</span></span><br><span class="line"></span><br><span class="line">                rds.hmset(result_que_name, &#123;info[<span class="string">"job_id"</span>]: json.dumps(result)&#125;)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                print(<span class="string">"Caught exception: &#123;&#125;"</span>.format(e))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>



<h3 id=""><a href="#" class="headerlink" title=""></a></h3></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/05/Web/2018-02-04-Web-Arrangement/">Web/2018-02-04-Web-Arrangement</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-05</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Web/">Web</a></span><div class="content"><h3 id="TCP-vs-UDP"><a href="#TCP-vs-UDP" class="headerlink" title="TCP vs UDP"></a>TCP vs UDP</h3><img src="/Users/joe/Library/Application Support/typora-user-images/image-20200205172545061.png" alt="image-20200205172545061" style="zoom:50%;" />

<p>ISO, the International Organization for Standardization</p>
<p>Open System Interconnection Model，</p>
<table>
<thead>
<tr>
<th align="right"></th>
<th align="left">TCP</th>
<th>UDP</th>
</tr>
</thead>
<tbody><tr>
<td align="right">Acronym for</td>
<td align="left">Transmission Control Protocol</td>
<td>User Datagram Protocol or Universal Datagram Protocol</td>
</tr>
<tr>
<td align="right">Connection</td>
<td align="left">Transmission Control Protocol is a connection-oriented protocol.</td>
<td>User Datagram Protocol is a connectionless protocol.</td>
</tr>
<tr>
<td align="right">Function</td>
<td align="left">As a message makes its way across the <a href="https://www.diffen.com/difference/Internet_vs_World_Wide_Web" target="_blank" rel="noopener">internet</a> from one computer to another. This is connection based.</td>
<td>UDP is also a protocol used in message transport or transfer. This is not connection based which means that one program can send a load of packets to another and that would be the end of the relationship.</td>
</tr>
<tr>
<td align="right">Usage</td>
<td align="left">TCP is suited for applications that require high reliability, and transmission time is relatively less critical.</td>
<td>UDP is suitable for applications that need fast, efficient transmission, such as games. UDP’s stateless nature is also useful for servers that answer small queries from huge numbers of clients.</td>
</tr>
<tr>
<td align="right">Use by other protocols</td>
<td align="left">HTTP, HTTPs, FTP, SMTP, Telnet</td>
<td>DNS, DHCP, TFTP, SNMP, RIP, VOIP.</td>
</tr>
<tr>
<td align="right">Ordering of data packets</td>
<td align="left">TCP rearranges <a href="https://www.diffen.com/difference/Data_vs_Information" target="_blank" rel="noopener">data</a> packets in the order specified.</td>
<td>UDP has no inherent order as all packets are independent of each other. If ordering is required, it has to be managed by the application layer.</td>
</tr>
<tr>
<td align="right">Speed of transfer</td>
<td align="left">The speed for TCP is slower than UDP.</td>
<td>UDP is faster because error recovery is not attempted. It is a “best effort” protocol.</td>
</tr>
<tr>
<td align="right">Reliability</td>
<td align="left">There is absolute guarantee that the data transferred remains intact and arrives in the same order in which it was sent.</td>
<td>There is no guarantee that the messages or packets sent would reach at all.</td>
</tr>
<tr>
<td align="right">Header Size</td>
<td align="left">TCP header size is 20 bytes</td>
<td>UDP Header size is 8 bytes.</td>
</tr>
<tr>
<td align="right">Common Header Fields</td>
<td align="left">Source port, Destination port, Check Sum</td>
<td>Source port, Destination port, Check Sum</td>
</tr>
<tr>
<td align="right">Streaming of data</td>
<td align="left">Data is read as a byte stream, no distinguishing indications are transmitted to signal message (segment) boundaries.</td>
<td>Packets are sent individually and are checked for integrity only if they arrive. Packets have definite boundaries which are honored upon receipt, meaning a read operation at the receiver socket will yield an entire message as it was originally sent.</td>
</tr>
<tr>
<td align="right">Weight</td>
<td align="left">TCP is heavy-weight. TCP requires three packets to set up a socket connection, before any user data can be sent. TCP handles reliability and congestion control.</td>
<td>UDP is lightweight. There is no ordering of messages, no tracking connections, etc. It is a small transport layer designed on top of IP.</td>
</tr>
<tr>
<td align="right">Data Flow Control</td>
<td align="left">TCP does Flow Control. TCP requires three packets to set up a socket connection, before any user data can be sent. TCP handles reliability and congestion control.</td>
<td>UDP does not have an option for flow control</td>
</tr>
<tr>
<td align="right">Error Checking</td>
<td align="left">TCP does error checking and error recovery. Erroneous packets are retransmitted from the source to the destination.</td>
<td>UDP does error checking but simply discards erroneous packets. Error recovery is not attempted.</td>
</tr>
<tr>
<td align="right">Fields</td>
<td align="left">1. Sequence Number, 2. AcK number, 3. Data offset, 4. Reserved, 5. Control bit, 6. Window, 7. Urgent Pointer 8. Options, 9. Padding, 10. Check Sum, 11. Source port, 12. Destination port</td>
<td>1. Length, 2. Source port, 3. Destination port, 4. Check Sum</td>
</tr>
<tr>
<td align="right">Acknowledgement</td>
<td align="left">Acknowledgement segments</td>
<td>No Acknowledgment</td>
</tr>
<tr>
<td align="right">Handshake</td>
<td align="left">SYN, SYN-ACK, ACK</td>
<td>No handshake (connectionless protocol)</td>
</tr>
</tbody></table>
<h3 id="TCP-Keep-Alive"><a href="#TCP-Keep-Alive" class="headerlink" title="TCP Keep Alive"></a>TCP Keep Alive</h3><p>刚刚被问到请求头的keep-alive，虽然没能答上来，但回头一查，真是好问题！</p>
<p>【补习ing……】</p>
<p>1、什么是<strong>Keep-Alive模式</strong>？</p>
<p>HTTP协议采用请求-应答模式，有普通的非KeepAlive模式，也有KeepAlive模式。</p>
<p>非KeepAlive模式时，每个请求/应答客户和服务器都要新建一个连接，完成 之后立即断开连接（HTTP协议为无连接的协议）；当使用Keep-Alive模式（又称持久连接、连接重用）时，Keep-Alive功能使客户端到服 务器端的连接持续有效，当出现对服务器的后继请求时，Keep-Alive功能避免了建立或者重新建立连接。</p>
<p>2、如何启用或者关闭<strong>Keep-Alive模式？</strong></p>
<p><strong>浏览器发起建议，服务器视情况统一。</strong></p>
<p>（1）http 1.0中默认是关闭的，如果客户端浏览器支持Keep-Alive，那么就在HTTP请求头中添加一个字段 <strong>Connection: Keep-Alive</strong>，当服务器收到附带有Connection: Keep-Alive的请求时，它也会在响应头中添加一个同样的字段来使用Keep-Alive。这样一来，客户端和服务器之间的HTTP连接就会被保持，不会断开（超过Keep-Alive规定的时间，意外断电等情况除外），当客户端发送另外一个请求时，就使用这条已经建立的连接。</p>
<p>也有可能是Keep-Alive</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Keep-Alive: timeout&#x3D;5, max&#x3D;100</span><br><span class="line">timeout：过期时间5秒（对应httpd.conf里的参数是：KeepAliveTimeout），max是最多一百次请求，强制断掉连接</span><br></pre></td></tr></table></figure>



<p>（2）http 1.1中默认启用Keep-Alive， 默认情况下所在HTTP1.1中所有连接都被保持，除非在请求头或响应头中指明要关闭：Connection: Close ，这也就是为什么Connection: Keep-Alive字段再没有意义的原因。另外，还添加了一个新的字段Keep-Alive:，因为这个字段并没有详细描述用来做什么，可忽略它</p>
<p>目前大部分浏览器都是用http1.1协议，也就是说默认都会发起Keep-Alive的连接请求了，所以是否能完成一个完整的Keep- Alive连接就看服务器设置情况。</p>
<p>3、启用Keep-Alive的优点</p>
<p>从上面的分析来看，启用Keep-Alive模式肯定更高效，性能更高。因为避免了建立/释放连接的开销。下面是RFC 2616 上的总结：</p>
<p>（1）TCP连接更少，这样就会节约TCP连接在建立、释放过程中，主机和路由器上的CPU和内存开销。<br>By opening and closing fewer TCP connections, CPU time is saved in routers and hosts (clients, servers, proxies, gateways, tunnels, or caches), and memory used for TCP protocol control blocks can be saved in hosts.<br><strong>HTTP requests and responses can be pipelined on a connection. Pipelining allows a client to make multiple requests without waiting for each response, allowing a single TCP connection to be used much more efficiently, with much lower elapsed time.</strong></p>
<p>（2）网络拥塞也减少了，拿到响应的延时也减少了<br><strong>Network congestion</strong> is reduced by reducing the number of packets caused by TCP opens, and by allowing TCP sufficient time to determine the congestion state of the network.<br><strong>Latency</strong> on subsequent requests is reduced since there is no time spent in TCP’s connection opening handshake.</p>
<p>（3）错误处理更优雅：不会粗暴地直接关闭连接，而是report，retry<br>HTTP can evolve more gracefully, since errors can be reported without the penalty of closing the TCP connection. Clients using future versions of HTTP might optimistically try a new feature, but if communicating with an older server, retry with old semantics after an error is reported.<br>RFC 2616 （P47）还指出：单用户客户端与任何服务器或代理之间的连接数不应该超过2个。一个代理与其它服务器或代码之间应该使用不超过2 * N的活跃并发连接。这是为了提高HTTP响应时间，避免拥塞（冗余的连接并不能代码执行性能的提升）。</p>
<p>4、Keep-Alive模式，客户端如何判断请求所得到的响应数据已经接收完成（或者说如何知道服务器已经发生完了数据）？</p>
<p>对于非持续连接，浏览器可以通过连接是否关闭来界定请求或响应实体的边界；而对于持续连接，这种方法显然不奏效。有时，尽管我已经发送完所有数据，但浏览器并不知道这一点，它无法得知这个打开的连接上是否还会有新数据进来，只能傻傻地等了。</p>
<p>（1）使用消息首部字段Conent-Length</p>
<p>Conent-Length表示实体内容长度，当客户端向服务器请求一个静态页面或者一张图片时，服务器可以很清楚的知道内容大小，然后通过Content-length消息首部字段告诉客户端 需要接收多少数据。</p>
<p>（2）使用消息首部字段Transfer-Encoding</p>
<p>如果是动态页面等时，服务器是不可能预先知道内容大小。因为对于动态生成的内容来说，在内容创建完之前，长度是不可知的。这时候要想准确获取长度，只能开一个足够大的 buffer，等内容全部生成好再计算。但这样做一方面需要更大的内存开销，另一方面也会让客户端等更久。所以不可能这么做。Conent-Length就失效了。</p>
<p>这时就可以使用Transfer-Encoding：chunk模式：服务器就需要使用Transfer-Encoding: chunked这样的方式来代替Content-Length。即如果要一边产生数据，一边发给客户端。</p>
<p>5、 分块编码（Transfer-Encoding: chunked）</p>
<ol>
<li><p>Transfer-Encoding，是一个 HTTP 头部字段（响应头域），字面意思是「传输编码」。最新的 HTTP 规范里，只定义了一种编码传输：分块编码(chunked)。</p>
</li>
<li><p>分块传输编码（Chunked transfer encoding）是超文本传输协议（HTTP）中的一种数据传输机制，允许HTTP由网页服务器发送给客户端的数据可以分成多个部分。分块传输编码只在HTTP协议1.1版本（HTTP/1.1）中提供。</p>
</li>
<li><p>数据分解成一系列数据块，并以一个或多个块发送，这样服务器可以发送数据而不需要预先知道发送内容的总大小。</p>
</li>
<li><p>具体方法</p>
</li>
<li><ol>
<li>在头部加入 Transfer-Encoding: chunked 之后，就代表这个报文采用了分块编码。这时，报文中的实体需要改为用一系列分块来传输。</li>
<li>每个分块包含十六进制的长度值和数据，长度值独占一行，长度不包括它结尾的 CRLF(\r\n)，也不包括分块数据结尾的 CRLF。</li>
<li>最后一个分块长度值必须为 0，对应的分块数据没有内容，表示实体结束。</li>
</ol>
</li>
<li><p>Content-Encoding 和 Transfer-Encoding 二者经常会结合来用，其实就是针对 Transfer-Encoding 的分块再进行 Content-Encoding压缩。</p>
</li>
</ol>
<p>例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line">Content-Type: text&#x2F;plain</span><br><span class="line">Transfer-Encoding: chunked</span><br><span class="line"></span><br><span class="line">25\r\n</span><br><span class="line">This is the data in the first chunk\r\n</span><br><span class="line"></span><br><span class="line">1C\r\n</span><br><span class="line">and this is the second one\r\n</span><br><span class="line"></span><br><span class="line">3\r\n</span><br><span class="line">con\r\n</span><br><span class="line"></span><br><span class="line">8\r\n</span><br><span class="line">sequence\r\n</span><br><span class="line"></span><br><span class="line">0\r\n</span><br><span class="line">\r\n</span><br></pre></td></tr></table></figure>



<h3 id="3-ways-handshake"><a href="#3-ways-handshake" class="headerlink" title="3 ways handshake"></a>3 ways handshake</h3><p><a href="https://notfalse.net/7/three-way-handshake" target="_blank" rel="noopener">https://notfalse.net/7/three-way-handshake</a></p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gblnwn98uhj30fq0gedgq.jpg" alt="三向交握 範例"></p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gblnxhmf7cj30xs0mfwi6.jpg" alt="TCP-Header-Format"></p>
<h3 id="HTTP-methods"><a href="#HTTP-methods" class="headerlink" title="HTTP methods"></a>HTTP methods</h3><p>Restfule API - GET POST PUT DELETE</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/01/15/Python/2020-01-15-bisect%20in%20python%20/">Python/2020-01-15-bisect in python </a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Python/">Python</a></span><div class="content"><h3 id="Finding-Pos"><a href="#Finding-Pos" class="headerlink" title="Finding Pos"></a>Finding Pos</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bisect</span><br><span class="line"> </span><br><span class="line">a = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">15</span>,<span class="number">20</span>]</span><br><span class="line">position = bisect.bisect(a,<span class="number">13</span>)</span><br><span class="line">print(position)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 用可变序列内置的insert方法插入</span></span><br><span class="line">a.insert(position,<span class="number">13</span>)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<p>5<br>[1, 4, 6, 8, 12, 13, 15, 20]</p>
<hr>
<h3 id="Insert"><a href="#Insert" class="headerlink" title="Insert"></a>Insert</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bisect</span><br><span class="line"> </span><br><span class="line">a = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">15</span>,<span class="number">20</span>]</span><br><span class="line">bisect.insort(a,<span class="number">13</span>)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/01/15/Python/2020-02-26-HackerRank_practice/">Python/2020-02-26-HackerRank_practice</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Python/">Python</a></span><div class="content"><h2 id="Read-input-from-STDIN-Print-output-to-STDOUT"><a href="#Read-input-from-STDIN-Print-output-to-STDOUT" class="headerlink" title="Read input from STDIN. Print output to STDOUT*"></a>Read input from STDIN. Print output to STDOUT*</h2><p><strong>Sample Input</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">sam 99912222</span><br><span class="line">tom 11122222</span><br><span class="line">harry 12299933</span><br><span class="line">sam</span><br><span class="line">edward</span><br><span class="line">harry</span><br></pre></td></tr></table></figure>

<p><strong>Sample Output</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sam&#x3D;99912222</span><br><span class="line">Not found</span><br><span class="line">harry&#x3D;12299933</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">n = int(input())</span><br><span class="line"></span><br><span class="line">book = [input().split() <span class="keyword">for</span> _ <span class="keyword">in</span> range(n)]  <span class="comment"># [[name1, phone1], [name2, phone2]...]</span></span><br><span class="line"><span class="comment"># print(book)</span></span><br><span class="line">d = &#123;k:v <span class="keyword">for</span> k, v <span class="keyword">in</span> book&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        name = input()</span><br><span class="line">        <span class="comment"># if not name: break</span></span><br><span class="line">        <span class="keyword">if</span> name <span class="keyword">in</span> d:</span><br><span class="line">            print(<span class="string">'&#123;&#125;=&#123;&#125;'</span>.format(name, d[name]))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'Not found'</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">countApplesAndOranges</span><span class="params">(s, t, a, b, apples, oranges)</span>:</span></span><br><span class="line">    <span class="comment"># print(apples ,oranges)</span></span><br><span class="line">    </span><br><span class="line">    aa = map(<span class="keyword">lambda</span> a, x: a+x, [a]*len(apples), apples)</span><br><span class="line">    oo = map(<span class="keyword">lambda</span> b, x: b+x, [b]*len(oranges), oranges)</span><br><span class="line"></span><br><span class="line">    count_a = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> aa:</span><br><span class="line">        <span class="keyword">if</span> s &lt;= a &lt;= t:</span><br><span class="line">            count_a += <span class="number">1</span></span><br><span class="line">    print(count_a)</span><br><span class="line">    count_o = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> o <span class="keyword">in</span> oo:</span><br><span class="line">        <span class="keyword">if</span> s &lt;= o &lt;= t:</span><br><span class="line">            count_o += <span class="number">1</span></span><br><span class="line">    print(count_o)</span><br></pre></td></tr></table></figure>



<h3 id="GCD-x-LCM"><a href="#GCD-x-LCM" class="headerlink" title="GCD  x LCM"></a>GCD  x LCM</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Complete the 'getTotalX' function below.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The function is expected to return an INTEGER.</span></span><br><span class="line"><span class="comment"># The function accepts following parameters:</span></span><br><span class="line"><span class="comment">#  1. INTEGER_ARRAY a</span></span><br><span class="line"><span class="comment">#  2. INTEGER_ARRAY b</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getTotalX</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="comment"># Write your code here</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> a <span class="keyword">or</span> <span class="keyword">not</span> b:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(A)</span>:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        12 16 18 40</span></span><br><span class="line"><span class="string">        0   4  6  ４</span></span><br><span class="line"><span class="string">        0.  0. 2  ０</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="comment"># arr = sorted(A, key=lambda x: x)</span></span><br><span class="line">        <span class="comment"># p = arr[0]</span></span><br><span class="line">        <span class="comment"># while p:</span></span><br><span class="line">        <span class="comment">#     prev_p = p</span></span><br><span class="line">        <span class="comment">#     for j in range(len(arr)):</span></span><br><span class="line">        <span class="comment">#         arr[j] = arr[j] % p</span></span><br><span class="line">        <span class="comment">#     for k in range(len(arr)):</span></span><br><span class="line">        <span class="comment">#         if arr[j] != 0:</span></span><br><span class="line">        <span class="comment">#             p =  arr[j]</span></span><br><span class="line">        <span class="comment">#         if p != prev_p:</span></span><br><span class="line">        <span class="comment">#             break</span></span><br><span class="line">        <span class="comment"># return prev_p</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> a &lt; b:</span><br><span class="line">            a, b = b, a</span><br><span class="line">        <span class="keyword">while</span> a:</span><br><span class="line">            <span class="comment"># print("a:&#123;&#125;, b:&#123;&#125;".format(a, b))</span></span><br><span class="line">            r = a % b       <span class="comment"># 20 16</span></span><br><span class="line">            <span class="keyword">if</span> r == <span class="number">0</span>:      <span class="comment"># 4</span></span><br><span class="line">                <span class="keyword">break</span>       </span><br><span class="line">            a, b = b, r                         </span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">GCD</span><span class="params">(arr)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> len(arr) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> arr[<span class="number">0</span>]</span><br><span class="line">        gcd = find_gcd(arr[<span class="number">0</span>], arr[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, len(arr)):</span><br><span class="line">            gcd = find_gcd(gcd, arr[i])</span><br><span class="line">        <span class="keyword">return</span> gcd</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">LCM</span><span class="params">(arr)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> len(arr) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> arr[<span class="number">0</span>]</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">find_lcm</span><span class="params">(a, b)</span>:</span></span><br><span class="line">            gcd = find_gcd(a, b)</span><br><span class="line">            <span class="keyword">return</span> a*b/gcd</span><br><span class="line">        lcm = find_lcm(arr[<span class="number">0</span>], arr[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">2</span>, len(arr)):</span><br><span class="line">            lcm = find_lcm(lcm, arr[j])</span><br><span class="line">        <span class="keyword">return</span> lcm</span><br><span class="line"></span><br><span class="line">    gcd = GCD(b)</span><br><span class="line">    <span class="comment"># print('GCD: &#123;&#125;'.format(gcd))</span></span><br><span class="line">    lcm = LCM(a)</span><br><span class="line">    <span class="comment"># print('LCM: &#123;&#125;'.format(lcm))</span></span><br><span class="line">    n = int(gcd/lcm)</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> gcd % (k*lcm) == <span class="number">0</span>:</span><br><span class="line">            res += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    fptr = open(os.environ[<span class="string">'OUTPUT_PATH'</span>], <span class="string">'w'</span>)</span><br><span class="line"></span><br><span class="line">    first_multiple_input = input().rstrip().split()</span><br><span class="line"></span><br><span class="line">    n = int(first_multiple_input[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    m = int(first_multiple_input[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    arr = list(map(int, input().rstrip().split()))</span><br><span class="line"></span><br><span class="line">    brr = list(map(int, input().rstrip().split()))</span><br><span class="line"></span><br><span class="line">    total = getTotalX(arr, brr)</span><br><span class="line"></span><br><span class="line">    fptr.write(str(total) + <span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">    fptr.close()</span><br></pre></td></tr></table></figure>



<h3 id="Exceptions-String-to-Integer"><a href="#Exceptions-String-to-Integer" class="headerlink" title="Exceptions - String to Integer"></a><del>Exceptions - String to Integer</del></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">S = input().strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    print(int(S))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">'Bad String'</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Birthday-Chocolate"><a href="#Birthday-Chocolate" class="headerlink" title="Birthday Chocolate"></a><del>Birthday Chocolate</del></h3><p><strong>Sample Input 0</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">1 2 1 3 2</span><br><span class="line">3 2</span><br></pre></td></tr></table></figure>

<p><strong>Sample Output 0</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">birthday</span><span class="params">(s, d, m)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s <span class="keyword">or</span> <span class="keyword">not</span> d <span class="keyword">or</span> <span class="keyword">not</span> m:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(m<span class="number">-1</span>, len(s)):        <span class="comment"># use m-1 instead of m to solve m==1 case, where the loop isn't gonna entered</span></span><br><span class="line">        <span class="keyword">if</span> sum(s[j:i+<span class="number">1</span>]) == d:</span><br><span class="line">            res += <span class="number">1</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    fptr = open(os.environ[<span class="string">'OUTPUT_PATH'</span>], <span class="string">'w'</span>)</span><br><span class="line"></span><br><span class="line">    n = int(input().strip())</span><br><span class="line"></span><br><span class="line">    s = list(map(int, input().rstrip().split()))</span><br><span class="line"></span><br><span class="line">    dm = input().rstrip().split()</span><br><span class="line"></span><br><span class="line">    d = int(dm[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    m = int(dm[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    result = birthday(s, d, m)</span><br><span class="line"></span><br><span class="line">    fptr.write(str(result) + <span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">    fptr.close()</span><br></pre></td></tr></table></figure>



<h3 id="DivisorSum"><a href="#DivisorSum" class="headerlink" title="DivisorSum"></a><del>DivisorSum</del></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Calculator</span><span class="params">(AdvancedArithmetic)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">divisorSum</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> n % j == <span class="number">0</span>:</span><br><span class="line">                res += j</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="DivisibleSumPair"><a href="#DivisibleSumPair" class="headerlink" title="DivisibleSumPair"></a><del>DivisibleSumPair</del></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">divisibleSumPairs</span><span class="params">(n, k, ar)</span>:</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, n):</span><br><span class="line">            <span class="keyword">if</span> (ar[i] + ar[j]) % k == <span class="number">0</span>:</span><br><span class="line">                res += <span class="number">1</span></span><br><span class="line">    <span class="comment"># print(res)</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="Count-B-Sort-Swapping"><a href="#Count-B-Sort-Swapping" class="headerlink" title="Count B-Sort Swapping"></a><del>Count B-Sort Swapping</del></h3><h3 id="Generics"><a href="#Generics" class="headerlink" title="Generics"></a>Generics</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Printer</span> &lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *    Method Name: printArray</span></span><br><span class="line"><span class="comment">    *    Print each element of the generic array on a new line. Do not return anything.</span></span><br><span class="line"><span class="comment">    *    <span class="doctag">@param</span> A generic array</span></span><br><span class="line"><span class="comment">    **/</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Write your code here</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;E&gt; <span class="function"><span class="keyword">void</span> <span class="title">printArray</span><span class="params">(E[] generic)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(E element : generic) &#123;</span><br><span class="line">            System.out.println(element); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="BST-Height-according-to-Edges"><a href="#BST-Height-according-to-Edges" class="headerlink" title="BST Height according to Edges"></a><del>BST Height according to Edges</del></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getHeight</span><span class="params">(self,root)</span>:</span></span><br><span class="line">    <span class="comment">#Write your code here</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> root.left <span class="keyword">and</span> <span class="keyword">not</span> root.right:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    L = self.getHeight(root.left)</span><br><span class="line">    R = self.getHeight(root.right)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> max(L, R) + <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h3 id="RM-Duplicated-from-Sorted-Linked-List"><a href="#RM-Duplicated-from-Sorted-Linked-List" class="headerlink" title="RM Duplicated from Sorted Linked List"></a>RM Duplicated from Sorted Linked List</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">removeDuplicates</span><span class="params">(self,head)</span>:</span></span><br><span class="line">    <span class="comment">#Write your code here</span></span><br><span class="line">    dummy = Node(<span class="string">"INIT"</span>)</span><br><span class="line">    dummy.next = head</span><br><span class="line">    self.helper(head, dummy)</span><br><span class="line">    <span class="keyword">return</span> dummy.next</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root, prev)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">if</span> prev.data == root.data:</span><br><span class="line">        prev.next = root.next</span><br><span class="line">        self.helper(root.next, prev)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        self.helper(root.next, root)</span><br></pre></td></tr></table></figure>



<h3 id="IsPrime-w-Input-Parsing"><a href="#IsPrime-w-Input-Parsing" class="headerlink" title="IsPrime w/ Input() Parsing"></a>IsPrime w/ Input() Parsing</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Enter your code here. Read input from STDIN. Print output to STDOUT</span></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line">num = int(input().strip())</span><br><span class="line"></span><br><span class="line">arr = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(num):</span><br><span class="line">    arr.append(int(input().strip()))</span><br><span class="line"><span class="comment"># print('arr: &#123;&#125;'.format(arr))</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(self, arr)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(arr)):</span><br><span class="line">            <span class="keyword">if</span> self.isPrime(arr[i]):</span><br><span class="line">                print(<span class="string">'Prime'</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'Not prime'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isPrime</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        end = int(math.sqrt(n)) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">2</span>, end):</span><br><span class="line">            <span class="keyword">if</span>  n % j == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>



<h3 id="Day-26-Nested-Logic"><a href="#Day-26-Nested-Logic" class="headerlink" title="Day 26 - Nested Logic"></a>Day 26 - Nested Logic</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">actual = list(map(int, input().strip().split()))</span><br><span class="line">expect = list(map(int, input().strip().split()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(self, actual, expect)</span>:</span></span><br><span class="line">        da, ma, ya = actual</span><br><span class="line">        de, me, ye = expect</span><br><span class="line">        <span class="keyword">if</span> ya &lt; ye <span class="keyword">or</span> da &lt;= de <span class="keyword">and</span> ma &lt;= me <span class="keyword">and</span> ya &lt;= ye:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> ya &gt; ye:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">10000</span></span><br><span class="line">        <span class="keyword">elif</span> ma &gt; me:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">500</span> * (ma - me) </span><br><span class="line">        <span class="keyword">elif</span> da &gt; de:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">15</span> * (da - de)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    sol = Solution()</span><br><span class="line">    print(sol.foo(actual, expect))</span><br></pre></td></tr></table></figure>



<h3 id="Day-27-Test"><a href="#Day-27-Test" class="headerlink" title="Day 27 - Test"></a>Day 27 - Test</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">minimum_index</span><span class="params">(seq)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> len(seq) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">"Cannot get the minimum value index from an empty sequence"</span>)</span><br><span class="line">    min_idx = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(seq)):</span><br><span class="line">        <span class="keyword">if</span> seq[i] &lt; seq[min_idx]:</span><br><span class="line">            min_idx = i</span><br><span class="line">    <span class="keyword">return</span> min_idx</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestDataEmptyArray</span><span class="params">(object)</span>:</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_array</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="comment"># complete this function</span></span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestDataUniqueValues</span><span class="params">(object)</span>:</span></span><br><span class="line">    arr = [<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_array</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="comment"># complete this function</span></span><br><span class="line">        <span class="keyword">return</span> TestDataUniqueValues.arr</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_expected_result</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="comment"># complete this function</span></span><br><span class="line">        <span class="keyword">return</span> minimum_index(TestDataUniqueValues.arr)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestDataExactlyTwoDifferentMinimums</span><span class="params">(object)</span>:</span></span><br><span class="line">    arr = [<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_array</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="comment"># complete this function</span></span><br><span class="line">        <span class="keyword">return</span> TestDataExactlyTwoDifferentMinimums.arr</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_expected_result</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="comment"># complete this function</span></span><br><span class="line">        <span class="keyword">return</span> minimum_index(TestDataExactlyTwoDifferentMinimums.arr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">TestWithEmptyArray</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        seq = TestDataEmptyArray.get_array()</span><br><span class="line">        result = minimum_index(seq)</span><br><span class="line">    <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">assert</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">TestWithUniqueValues</span><span class="params">()</span>:</span></span><br><span class="line">    seq = TestDataUniqueValues.get_array()</span><br><span class="line">    <span class="keyword">assert</span> len(seq) &gt;= <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> len(list(set(seq))) == len(seq)</span><br><span class="line"></span><br><span class="line">    expected_result = TestDataUniqueValues.get_expected_result()</span><br><span class="line">    result = minimum_index(seq)</span><br><span class="line">    <span class="keyword">assert</span> result == expected_result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">TestiWithExactyTwoDifferentMinimums</span><span class="params">()</span>:</span></span><br><span class="line">    seq = TestDataExactlyTwoDifferentMinimums.get_array()</span><br><span class="line">    <span class="keyword">assert</span> len(seq) &gt;= <span class="number">2</span></span><br><span class="line">    tmp = sorted(seq)</span><br><span class="line">    <span class="keyword">assert</span> tmp[<span class="number">0</span>] == tmp[<span class="number">1</span>] <span class="keyword">and</span> (len(tmp) == <span class="number">2</span> <span class="keyword">or</span> tmp[<span class="number">1</span>] &lt; tmp[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    expected_result = TestDataExactlyTwoDifferentMinimums.get_expected_result()</span><br><span class="line">    result = minimum_index(seq)</span><br><span class="line">    <span class="keyword">assert</span> result == expected_result</span><br><span class="line"></span><br><span class="line">TestWithEmptyArray()</span><br><span class="line">TestWithUniqueValues()</span><br><span class="line">TestiWithExactyTwoDifferentMinimums()</span><br><span class="line">print(<span class="string">"OK"</span>)</span><br></pre></td></tr></table></figure>



<h3 id="Draw-Book"><a href="#Draw-Book" class="headerlink" title="Draw Book"></a>Draw Book</h3><p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcx0ix4kyej31in0u0djo.jpg" alt="image-20200317163814705"></p>
<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gcx0kem3spj313w0880tq.jpg" alt="image-20200317163936950" style="zoom:67%;" />



<h3 id="Day-28-RegEX-Pattern"><a href="#Day-28-RegEX-Pattern" class="headerlink" title="Day 28 RegEX, Pattern"></a>Day 28 RegEX, Pattern</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    pattern = re.compile(<span class="string">'@gmail.com$'</span>)</span><br><span class="line"></span><br><span class="line">    N = int(input())</span><br><span class="line">    res = []</span><br><span class="line">    <span class="comment"># heapq.heapify(res)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> N_itr <span class="keyword">in</span> range(N):</span><br><span class="line">        firstNameEmailID = input().strip().split()</span><br><span class="line"></span><br><span class="line">        firstName = firstNameEmailID[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        emailID = firstNameEmailID[<span class="number">1</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># if emailID.split('@')[1].split('.')[0] != 'gmail':</span></span><br><span class="line">        <span class="comment">#     continue</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> pattern.search(emailID):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># heapq.heappush(res, firstName)</span></span><br><span class="line">        res.append(firstName)</span><br><span class="line">    </span><br><span class="line">    res.sort()</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(len(res)):</span><br><span class="line">        <span class="comment"># print(heapq.heappop(res))</span></span><br><span class="line">        print(res[j])</span><br></pre></td></tr></table></figure>



<h3 id="Level-Order-BFS"><a href="#Level-Order-BFS" class="headerlink" title="Level Order BFS~~"></a>Level Order BFS~~</h3></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/01/11/LC/2020-01-20-High%20Freqs/">LC/2020-01-20-High Freqs</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/LC/">LC</a></span><div class="content"><table>
<thead>
<tr>
<th>Both</th>
</tr>
</thead>
<tbody><tr>
<td>161, 138, 220, <del>23</del>, <del>56</del>, 17, 652, 450, 219, 503, <del>199</del>, 91, 277, 632, 496, 322, <del>33</del>, 243, 244, 245, <del>200</del>, 560, 309, 516, 332, 692, 224, 75, 124, 76, 518</td>
</tr>
</tbody></table>
<p><del>953</del><br><del>301</del><br><del>238</del><br><del>67</del><br><del>273</del><br><del>973</del><br><del>560</del><br><del>158</del><br><del>621</del><br><del>680</del><br><del>297</del><br><del>125</del><br><del>253</del><br><del><strong><em>282</em></strong></del><br><del>523</del><br>426<br><del>76</del><br><del>438</del><br><del>173353</del><br><strong><del>269</del> NOTYET Alien Dictionary</strong><br><del>896</del><br><strong>785 Graph Bipartie</strong><br><del>278</del><br><del>340</del><br><del>23</del><br><del>199</del><br><strong>415</strong><br><del>124</del><br><del>71</del><br><del>**986</del><strong>~<br><del>211</del><br><del>98</del><br>**65</strong><br><del>349</del><br><strong>543 diameter of binary tree</strong><br><strong>133</strong></p>
<p>— 1/29 —</p>
<p><del>88</del><br><del>350</del><br><del>825</del><br><del>958</del><br><del>34</del><br><del>304</del><br><del>42</del><br><del>56</del><br><del>31</del><br><strong>721 Account Merge</strong><br><del>161</del><br><strong>489</strong><br><del>1027</del></p>
<p>— opened pages 1/29 — </p>
<p><del>270</del><br><del>215</del><br><del><em>236 lowest common ancestor</em> vs 235 lca of bst</del><br><em>987 vertical order trav</em><br>15<br><strong>636 executive time of functions</strong><br><del>1</del><br>43<br>29<br>139<br>319<br>126<br>708<br>935</p>
<p>—opened pages 1/31 —</p>
<p>314 vertical order trav<br><del>921</del><br>143 reorder linkedlist<br>10<br>246<br>91<br>1004<br><del>162</del><br>824<br>380<br>1094<br>398<br>50<br>227<br><del>20</del></p>
<p>— 2/1 opened pages — </p>
<p>863<br>416<br>33<br>463<br>1146<br>742<br>224<br><del>286</del><br>317<br>405<br><del>111</del><br>157<br>691<br>257<br>79<br>22<br><del>449</del><br>689<br>885<br>647<br>358<br>540<br>78<br>283<br>670<br>166<br>381<br>794<br><strong><del>207</del></strong><br>642<br>767<br><del>200</del><br>329<br>614<br>138<br>549<br>339<br><del>109</del><br>32<br>75<br>312<br>597<br>341<br>528<br>311<br>146<br>277<br>394<br>428<br>37<br><del>53</del><br>5<br>567<br>387<br>348<br><del>51</del><br>295<br>480<br>496<br>1123<br>223<br>694<br>468<br>865<br>151<br><del>210</del><br>13<br>378<br>36<br><del>3</del><br>977<br>129<br>325<br>81<br>938<br>247<br><del>46</del><br>1008<br>228<br>388<br>25<br>8<br>498<br>791<br><del>102</del><br><del>127</del><br>212<br><del>112</del><br>218<br>766<br>240<br>674<br><del>121</del><br><del>114</del><br>137<br><del>145</del><br>239<br>188<br>414<br>242<br><del>208</del><br><del>105</del><br><del>285</del><br>494<br>430<br><del>153</del><br><del>49</del><br>1021<br><del>252</del><br>54<br>181<br>21<br>140<br>24<br><del>344</del><br>347<br>230<br><del>739</del><br>2<br>692<br>45<br>1108<br>73<br>17<br><del>113</del><br>94<br>41<br>12<br>4<br><del>235</del><br><del>110</del><br>202<br>103<br>206<br>39<br>62<br>189<br><del>122</del><br>28<br>136<br><del>70</del><br>11<br>9<br>104<br>26<br>7</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/01/11/LC/2020-02-09-LC-Explore/">LC/2020-02-09-LC-Explore</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/LC/">LC</a></span><div class="content"><h2 id="Thoughts"><a href="#Thoughts" class="headerlink" title="Thoughts"></a>Thoughts</h2><ul>
<li><em>Find permutatino of s within b ==&gt; find all anagram of s within b</em></li>
</ul>
<h2 id="Easy"><a href="#Easy" class="headerlink" title="Easy"></a>Easy</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>Coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#67">67 Add Binary</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">10101 =&gt; 10101</span></span><br><span class="line"><span class="string">1011  =&gt; 1101</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1100110 =&gt; 010011</span></span><br><span class="line"><span class="string">10111   =&gt; 11101</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addBinary</span><span class="params">(self, a: str, b: str)</span> -&gt; str:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> a:</span><br><span class="line">            <span class="keyword">return</span> b</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> b:</span><br><span class="line">            <span class="keyword">return</span> a</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> len(b) &gt; len(a):</span><br><span class="line">            a, b = b, a</span><br><span class="line">        </span><br><span class="line">        a, b = a[::<span class="number">-1</span>], b[::<span class="number">-1</span>] <span class="comment"># 10101, 1101</span></span><br><span class="line">        carry = <span class="number">0</span></span><br><span class="line">        i, j = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        res = <span class="string">''</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; len(b):</span><br><span class="line">            m = ord(a[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">            n = ord(b[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># carry, digit = (m+n)//2, (m+n)%2+carry</span></span><br><span class="line">            carry, digit = (m+n+carry)//<span class="number">2</span>, (m+n+carry)%<span class="number">2</span></span><br><span class="line">            res += str(digit)</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># i == 4</span></span><br><span class="line">        <span class="keyword">while</span> i &lt;= len(a) - <span class="number">1</span>:  <span class="comment"># 4 &lt;= 5-1</span></span><br><span class="line">            m = ord(a[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">            carry, digit = (m+carry)//<span class="number">2</span>, (m+carry)%<span class="number">2</span></span><br><span class="line">            res += str(digit)</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">if</span> carry == <span class="number">1</span>:</span><br><span class="line">            res += str(carry)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> res[::<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>



<p>fib memory</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(n, mem=[])</span>:</span></span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">0</span> <span class="keyword">or</span> n == <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">if</span> mem[n] == <span class="number">0</span>:</span><br><span class="line">      mem[n] = fib(n<span class="number">-1</span>) + fib(n<span class="number">-1</span>)</span><br><span class="line">  <span class="keyword">return</span> mem[n]</span><br></pre></td></tr></table></figure>





<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#17">17 Letter Combinations of a Phone Number</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#301">301 Remove Invalid Parentheses</a></td>
<td></td>
<td></td>
<td></td>
<td>HARD</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#139">139 Word Break</a></td>
<td></td>
<td>DP</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h3 id="Bit-Manipulation"><a href="#Bit-Manipulation" class="headerlink" title="Bit Manipulation"></a>Bit Manipulation</h3><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#190">190 Reverse Bits</a></td>
<td>zfill(“1100”) –&gt; 前面補齊0讓這串到32位</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#7">7 Reverse Interger</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#191">191 Number of 1’s bits</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#461">461 Hamming Distance</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h3 id="7"><a href="#7" class="headerlink" title="7"></a><a name="7">7</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverse</span><span class="params">(self, x: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">0</span>:<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        flag = <span class="number">-1</span> <span class="keyword">if</span> x &lt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">        y = list(str(abs(x)))</span><br><span class="line">        self.helper(y, <span class="number">0</span>, len(y)<span class="number">-1</span>)</span><br><span class="line">        </span><br><span class="line">        res = int(<span class="string">''</span>.join(y))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># print(res)</span></span><br><span class="line">        <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> flag*res <span class="keyword">if</span> flag*res &lt;= <span class="number">2</span>**<span class="number">31</span><span class="number">-1</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> flag*res <span class="keyword">if</span> flag*res &gt;= <span class="number">-2</span>**<span class="number">31</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, s, l, r)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> l &gt;= r:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        s[l], s[r] = s[r], s[l]</span><br><span class="line">        self.helper(s, l+<span class="number">1</span>, r<span class="number">-1</span>)</span><br></pre></td></tr></table></figure>



<h3 id="190"><a href="#190" class="headerlink" title="190"></a><a name="190">190</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverseBits</span><span class="params">(self, n: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> int(bin(n)[<span class="number">2</span>:].zfill(<span class="number">32</span>)[::<span class="number">-1</span>], <span class="number">2</span>)</span><br></pre></td></tr></table></figure>



<h3 id="191"><a href="#191" class="headerlink" title="191"></a><a name="191">191</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hammingWeight</span><span class="params">(self, n: int)</span> -&gt; int:</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        mask = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> n:</span><br><span class="line">            <span class="comment"># print(n)</span></span><br><span class="line">            <span class="keyword">if</span> n &amp; mask != <span class="number">0</span>:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">            n &gt;&gt;= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> count</span><br></pre></td></tr></table></figure>



<h3 id="461"><a href="#461" class="headerlink" title="461"></a><a name="461">461</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hammingDistance</span><span class="params">(self, x: int, y: int)</span> -&gt; int:</span></span><br><span class="line">        ans = x ^ y</span><br><span class="line">        <span class="keyword">return</span> self.count1s(ans)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">count1s</span><span class="params">(self, num)</span>:</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        mask = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> num:</span><br><span class="line">            <span class="keyword">if</span> num &amp; mask != <span class="number">0</span>:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">            num &gt;&gt;= <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> count</span><br></pre></td></tr></table></figure>





<h2 id="Sorting-and-Searching"><a href="#Sorting-and-Searching" class="headerlink" title="Sorting and Searching"></a>Sorting and Searching</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#29">29 Divide Two Integers</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#50">50 Pow</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#75">75 Sort Colors</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#692">692 Top K frequent words</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#973">973 K Close points to origin</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#215">215 K largest element in an Array</a></td>
<td></td>
<td>heap</td>
<td>Q-select</td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#34">34 Find First and Last Position of Element in Sorted Array</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h3 id="215"><a href="#215" class="headerlink" title="215"></a><a name="215">215</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">def partition(l, r, arr)</span></span><br><span class="line"><span class="string">    3 5 2 1 5 6 4   k=2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    pvt 3 l 2 r 4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    fn to set 3 at idx2</span></span><br><span class="line"><span class="string">    while l&lt;r:</span></span><br><span class="line"><span class="string">        while arr[i] 5 &lt; 3: wrong</span></span><br><span class="line"><span class="string">            l ++</span></span><br><span class="line"><span class="string">        l 2</span></span><br><span class="line"><span class="string">        while arr[j]  &gt; 3: till 1 idx -4 == idx 3</span></span><br><span class="line"><span class="string">            r -- </span></span><br><span class="line"><span class="string">        r 3</span></span><br><span class="line"><span class="string">        swap(arr[l], arr[r])</span></span><br><span class="line"><span class="string">      3 1 2 5 5 6 4 </span></span><br><span class="line"><span class="string">          l</span></span><br><span class="line"><span class="string">          r</span></span><br><span class="line"><span class="string">      2 1 3 5 5 6 4   </span></span><br><span class="line"><span class="string">        return l</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">2 1 3 5 5 6 4   </span></span><br><span class="line"><span class="string">1 2 3 4 5 6  2nd large means idx 4 == 6 - 2 </span></span><br><span class="line"><span class="string">K largest means K_idx = len(arr) - K small</span></span><br><span class="line"><span class="string">while l &lt; r</span></span><br><span class="line"><span class="string">    idx = partition()    </span></span><br><span class="line"><span class="string">    K_idx = len(arr) - K</span></span><br><span class="line"><span class="string">    if K_idx &lt; idx:</span></span><br><span class="line"><span class="string">        r = idx - 1</span></span><br><span class="line"><span class="string">    elif k_idx &gt; idx:</span></span><br><span class="line"><span class="string">        l = idx +1</span></span><br><span class="line"><span class="string">    else:</span></span><br><span class="line"><span class="string">        break</span></span><br><span class="line"><span class="string">return arr[K_idx]</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span><span class="params">(self, nums: List[int], k: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="comment"># return self.helper_heapq(nums, k)</span></span><br><span class="line">        <span class="keyword">return</span> self.helper_Q_select(nums, k)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper_Q_select</span><span class="params">(self, nums, k)</span>:</span></span><br><span class="line">        <span class="comment"># if i &gt;= j:</span></span><br><span class="line">        <span class="comment">#     return 0</span></span><br><span class="line">        </span><br><span class="line">        i, j = <span class="number">0</span>, len(nums)<span class="number">-1</span></span><br><span class="line">        <span class="comment"># 1 2 3 4 5 6</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># k = 2 ==&gt; idx 4.  6-2</span></span><br><span class="line">        k_idx = len(nums) - k</span><br><span class="line">        <span class="keyword">while</span> i &lt; j:</span><br><span class="line">            <span class="comment"># pvt_idx = self.partition(i, j, nums)</span></span><br><span class="line">            pvt_idx = self.partition(nums, i, j)</span><br><span class="line">            <span class="keyword">if</span> k_idx &lt; pvt_idx:</span><br><span class="line">                j = pvt_idx - <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> k_idx &gt; pvt_idx:</span><br><span class="line">                i = pvt_idx + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> nums[k_idx]</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partition</span><span class="params">(self, arr,low,high)</span>:</span> </span><br><span class="line">        i = low<span class="number">-1</span>        <span class="comment"># index of smaller element </span></span><br><span class="line">        pivot = arr[high]     <span class="comment"># pivot </span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(low , high): </span><br><span class="line"></span><br><span class="line">            <span class="comment"># If current element is smaller than or </span></span><br><span class="line">            <span class="comment"># equal to pivot </span></span><br><span class="line">            <span class="keyword">if</span>   arr[j] &lt;= pivot: </span><br><span class="line"></span><br><span class="line">                <span class="comment"># increment index of smaller element </span></span><br><span class="line">                i = i+<span class="number">1</span> </span><br><span class="line">                arr[i],arr[j] = arr[j],arr[i] </span><br><span class="line"></span><br><span class="line">        arr[i+<span class="number">1</span>],arr[high] = arr[high],arr[i+<span class="number">1</span>] </span><br><span class="line">        <span class="keyword">return</span> i+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partition_X</span><span class="params">(self, l, r, arr)</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">swap</span><span class="params">(x, y)</span>:</span></span><br><span class="line">            x, y = y, x</span><br><span class="line">        </span><br><span class="line">        i, j = l, r</span><br><span class="line">        pvt = arr[l]</span><br><span class="line">        <span class="keyword">while</span> i &lt; j:</span><br><span class="line">            <span class="keyword">while</span> arr[i] &lt; pvt <span class="keyword">and</span> i &lt; j:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> arr[j] &gt; pvt <span class="keyword">and</span> i &lt; j:</span><br><span class="line">                j -= <span class="number">1</span></span><br><span class="line">            swap(arr[i], arr[j])</span><br><span class="line">                 </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper_heapq</span><span class="params">(self, nums: List[int], k: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="comment"># l = nums</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        heapq.heapify(nums) <span class="comment">#O(N)</span></span><br><span class="line">        ks = len(nums) - k + <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(ks<span class="number">-1</span>):</span><br><span class="line">            heapq.heappop(nums) <span class="comment"># ks * O(lgN)</span></span><br><span class="line">        <span class="keyword">return</span> heapq.heappop(nums)</span><br></pre></td></tr></table></figure>

<ul>
<li>Time complexity : O(<em>N</em>) in the average case, O(<em>N</em>2) in the worst case.</li>
<li>Space complexity : O(1).</li>
</ul>
<h2 id="DP"><a href="#DP" class="headerlink" title="DP"></a>DP</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#32">32 Longest Valid Parentheses</a></td>
<td></td>
<td>Stack</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#518">518 coin changes 2</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#91">91 Decode Ways</a></td>
<td></td>
<td>backtracking並紀錄樹的每條路徑，就像wrod break時做的dfs</td>
<td></td>
<td></td>
<td></td>
<td>dp[0] = 1</td>
</tr>
</tbody></table>
<h3 id="91"><a href="#91" class="headerlink" title="91"></a><a name="91">91</a></h3><p><a href="https://www.tianmaying.com/tutorial/LC91" target="_blank" rel="noopener">https://www.tianmaying.com/tutorial/LC91</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numDecodings</span><span class="params">(self, s)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s: <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        len_s = len(s)</span><br><span class="line">        dp = [<span class="number">1</span>] + [<span class="number">0</span>] * len_s</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len_s + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> s[i - <span class="number">1</span>] != <span class="string">'0'</span>: </span><br><span class="line">                dp[i] += dp[i - <span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> i &gt;= <span class="number">2</span> <span class="keyword">and</span> <span class="number">10</span> &lt;= int(s[i - <span class="number">2</span>: i]) &lt;= <span class="number">26</span>: </span><br><span class="line">                dp[i] += dp[i - <span class="number">2</span>]</span><br><span class="line">        <span class="keyword">return</span> dp[len_s]</span><br></pre></td></tr></table></figure>



<h3 id="29"><a href="#29" class="headerlink" title="29"></a><a name="29">29</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">for example, if we want to calc (17/2)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ret = 0;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">17-2 ,ret+=1; left=15</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">15-4 ,ret+=2; left=11</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">11-8 ,ret+=4; left=3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">3-2 ,ret+=1; left=1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ret=8;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">divide</span><span class="params">(self, dividend: int, divisor: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type dividend: int</span></span><br><span class="line"><span class="string">        :type divisor: int</span></span><br><span class="line"><span class="string">        :rtype: int</span></span><br><span class="line"><span class="string">        """</span>        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> dividend:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        flag = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> dividend * divisor &lt; <span class="number">0</span>:</span><br><span class="line">            flag = <span class="number">-1</span></span><br><span class="line">        </span><br><span class="line">        dividend, divisor = abs(dividend), abs(divisor)</span><br><span class="line">        Q = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> dividend &gt;= divisor:</span><br><span class="line">            temp, q = divisor, <span class="number">1</span></span><br><span class="line">            print(<span class="string">'temp out'</span>, temp)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> dividend &gt;= temp:</span><br><span class="line">                dividend -= temp</span><br><span class="line">                Q += q</span><br><span class="line">                temp &lt;&lt;= <span class="number">1</span>				<span class="comment"># CRUCIAL!! &lt;&lt;=</span></span><br><span class="line">                <span class="comment"># print('temp ', temp)</span></span><br><span class="line">                q &lt;&lt;= <span class="number">1</span></span><br><span class="line">                <span class="comment"># print('q ', q)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"># q = 0</span></span><br><span class="line">        <span class="comment"># while dividend:</span></span><br><span class="line">        <span class="comment">#     dividend -= divisor</span></span><br><span class="line">        <span class="comment">#     q += 1</span></span><br><span class="line">            </span><br><span class="line">             </span><br><span class="line">        <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> min(Q, <span class="number">2</span>**<span class="number">31</span><span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> max(<span class="number">-1</span>*Q, <span class="number">-1</span>*<span class="number">2</span>**<span class="number">31</span>)</span><br></pre></td></tr></table></figure>



<h3 id="32"><a href="#32" class="headerlink" title="32"></a><a name="32">32</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">longestValidParentheses</span><span class="params">(self, s: str)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s: <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="comment"># S ( pushback the index</span></span><br><span class="line">        <span class="comment">#   ) pop</span></span><br><span class="line">        <span class="comment"># S = []</span></span><br><span class="line">        g_max = <span class="number">0</span></span><br><span class="line">        stack = []</span><br><span class="line">        stack.append(<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">            <span class="keyword">if</span> s[i] == <span class="string">"("</span>:</span><br><span class="line">                stack.append(i)</span><br><span class="line">            <span class="keyword">elif</span> s[i] == <span class="string">")"</span>:</span><br><span class="line">                <span class="keyword">if</span> stack:       <span class="comment"># to prevent OOR</span></span><br><span class="line">                    val = stack.pop()</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> stack:</span><br><span class="line">                    stack.append(i)</span><br><span class="line">                g_max = max(g_max, i-stack[<span class="number">-1</span>])     <span class="comment"># pop後，拿棧頂的值</span></span><br><span class="line">        <span class="keyword">return</span> g_max</span><br></pre></td></tr></table></figure>



<h3 id="34"><a href="#34" class="headerlink" title="34"></a><a name="34">34</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bisect <span class="keyword">import</span> * <span class="comment"># bisect_left() bisect_right()</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">searchRange</span><span class="params">(self, nums: List[int], target: int)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> [<span class="number">-1</span>, <span class="number">-1</span>]</span><br><span class="line">        <span class="comment"># if len(nums) == 1:</span></span><br><span class="line">        <span class="comment">#     if nums[0] == target:</span></span><br><span class="line">        <span class="comment">#         return [0,0]</span></span><br><span class="line">        <span class="comment">#     else:</span></span><br><span class="line">        <span class="comment">#         return [-1,-1]</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># l, r = 0, len(nums)-1</span></span><br><span class="line">        l, r = <span class="number">0</span>, len(nums)</span><br><span class="line">        <span class="keyword">while</span> l&lt;r:</span><br><span class="line">            mid = l + (r-l)//<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> target &lt;= nums[mid]:     <span class="comment"># [5,7,7,8,8,10]</span></span><br><span class="line">                r = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                l = mid + <span class="number">1</span></span><br><span class="line">                <span class="comment"># r = mid</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># i, j = 0, len(nums)-1</span></span><br><span class="line">        i, j = <span class="number">0</span>, len(nums)</span><br><span class="line">        <span class="keyword">while</span> i&lt;j:</span><br><span class="line">            mid = i + (j-i)//<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> target &lt; nums[mid]:</span><br><span class="line">                j = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                i = mid + <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># print(l, i)</span></span><br><span class="line">        <span class="keyword">if</span> l == i:<span class="comment"># and nums[l] != target:</span></span><br><span class="line">            <span class="keyword">return</span> [<span class="number">-1</span>, <span class="number">-1</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> [l, i<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>



<h3 id="50"><a href="#50" class="headerlink" title="50"></a><a name="50">50</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">myPow</span><span class="params">(self, x: float, n: int)</span> -&gt; float:</span></span><br><span class="line">        <span class="string">''' TLE</span></span><br><span class="line"><span class="string">        res = 1.0</span></span><br><span class="line"><span class="string">        for _ in range(abs(n)):</span></span><br><span class="line"><span class="string">            if n &gt; 0:</span></span><br><span class="line"><span class="string">                res *= x</span></span><br><span class="line"><span class="string">            else:</span></span><br><span class="line"><span class="string">                res /= x</span></span><br><span class="line"><span class="string">        return res</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        </span><br><span class="line">        m = abs(n)</span><br><span class="line">        p, q = <span class="number">1</span>, x</span><br><span class="line">        <span class="keyword">while</span> m &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> (m &amp; <span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">                p *= q</span><br><span class="line">            m //= <span class="number">2</span></span><br><span class="line">            q *= q</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>/p <span class="keyword">if</span> n &lt; <span class="number">0</span> <span class="keyword">else</span> p</span><br></pre></td></tr></table></figure>



<h5 id="Recursive"><a href="#Recursive" class="headerlink" title="Recursive"></a>Recursive</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myPow</span><span class="params">(self, x, n)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    :type x: float</span></span><br><span class="line"><span class="string">    :type n: int</span></span><br><span class="line"><span class="string">    :rtype: float</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1.0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">    </span><br><span class="line">    m = n // <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">0</span>:</span><br><span class="line">        m = -m</span><br><span class="line">        x = <span class="number">1</span>/x</span><br><span class="line">        </span><br><span class="line">    res = self.myPow(x, m)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (n &amp; <span class="number">1</span>) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> res * res</span><br><span class="line">    <span class="keyword">return</span> res * res * x</span><br></pre></td></tr></table></figure>





<h2 id="Recursion"><a href="#Recursion" class="headerlink" title="Recursion"></a>Recursion</h2><h3 id="17"><a href="#17" class="headerlink" title="17"></a><a name="17">17</a></h3><p><em>Given a string containing digits from <code>2-9</code> inclusive, return all possible letter combinations that the number could represent.</em></p>
<p><em>A mapping of digit to letters (just like on the telephone buttons) is given below. Note that 1 does not map to any letters.</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2 3 4</span></span><br><span class="line"><span class="comment"># a d g</span></span><br><span class="line"><span class="comment"># b e h</span></span><br><span class="line"><span class="comment"># c f i</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">letterCombinations</span><span class="params">(self, digits: str)</span> -&gt; List[str]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> digits:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        self.d = &#123;<span class="string">'1'</span>:<span class="string">''</span>, <span class="string">'2'</span>:<span class="string">'abc'</span>, <span class="string">'3'</span>:<span class="string">'def'</span>, <span class="string">'4'</span>:<span class="string">'ghi'</span>, <span class="string">'5'</span>:<span class="string">'jkl'</span>, <span class="string">'6'</span>:<span class="string">'mno'</span>, <span class="string">'7'</span>:<span class="string">'pqrs'</span>, <span class="string">'8'</span>:<span class="string">'tuv'</span>, <span class="string">'9'</span>:<span class="string">'wxyz'</span>&#125;</span><br><span class="line">                           </span><br><span class="line">        <span class="comment"># states = [1 for i in range(len(digits))]    # 234 -&gt; [1,1,1]</span></span><br><span class="line">        <span class="comment"># item = </span></span><br><span class="line">        self.result = []</span><br><span class="line">        item = <span class="string">''</span></span><br><span class="line">        self.helper(<span class="number">0</span>, digits, item)</span><br><span class="line">        <span class="keyword">return</span> self.result</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, level ,digits, item)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> level == len(digits) <span class="keyword">and</span> item <span class="keyword">not</span> <span class="keyword">in</span> self.result:</span><br><span class="line">            <span class="keyword">if</span> len(item) == len(digits):</span><br><span class="line">                self.result.append(item)</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">        ref = digits[level:]</span><br><span class="line">        <span class="comment"># for num in range(len(ref)): # didn't require permutation so we don</span></span><br><span class="line">            <span class="comment"># chars = self.d[ref[num]]</span></span><br><span class="line">        <span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">            chars = self.d[ref[<span class="number">0</span>]]</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> chars:</span><br><span class="line">                item += c</span><br><span class="line">                self.helper(level+<span class="number">1</span>, digits, item)</span><br><span class="line">                item = item[:<span class="number">-1</span>] <span class="comment">#item[-1] +   # shouldn't be pop()</span></span><br><span class="line">                self.helper(level+<span class="number">1</span>, digits, item)</span><br><span class="line">            <span class="comment"># item = item[:-1]</span></span><br><span class="line">            <span class="comment"># level += 1</span></span><br></pre></td></tr></table></figure>



<h3 id="139"><a href="#139" class="headerlink" title="139"></a><a name="139">139</a></h3><h5 id="DP-1"><a href="#DP-1" class="headerlink" title="DP"></a>DP</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#       l e e t c o d e</span></span><br><span class="line"><span class="comment"># dp [F F F F T             ] </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in s:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wordBreak</span><span class="params">(self, s: str, wordDict: List[str])</span> -&gt; bool:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        # dp0 means "" in d == &gt; True</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        # dp1 = dp0 &amp;&amp; l in dict?  s[0:1]</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        # dp2 = dp0 &amp;&amp; le in dict? s[0:2]  or  </span></span><br><span class="line"><span class="string">        #       dp1 &amp;&amp; e in dict?  s[1:2]</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        # dp3 = dp0 &amp;&amp; lee in dict?  s[0:3]  or  </span></span><br><span class="line"><span class="string">        #       dp1 &amp;&amp; ee in dict?   s[1:3] or</span></span><br><span class="line"><span class="string">        #       dp2 &amp;&amp; e in dict?    s[2:3]</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        # dp4 = dp0 &amp;&amp; leet in dict?  or  </span></span><br><span class="line"><span class="string">        #       dp1 &amp;&amp; ed in dict? or</span></span><br><span class="line"><span class="string">        #       dp2 &amp;&amp; d in dict? or</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        dp = [<span class="number">1</span>] + [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s))]</span><br><span class="line">        wordSet = set(wordDict)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(s)+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, i):</span><br><span class="line">                <span class="comment"># dp[i] += dp[i] + wordDict.get(s[i-1:j-1])   # dp1 = dp0 + d.get(s[0:1])</span></span><br><span class="line">                dp[i] += dp[j] <span class="keyword">and</span> s[j:i] <span class="keyword">in</span> wordSet <span class="comment">#wordDict.get(s[j:i])</span></span><br><span class="line">                <span class="comment"># print(dp)</span></span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>





<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbpjjeli2bj31kn0u0n0n.jpg" alt="image-20200209021111564" style="zoom:50%;" />

<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbq8o5w8lhj31l80tc0w1.jpg" alt="image-20200209002506411"></p>
<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbpjjp0joyj31k70u0wiw.jpg" alt="image-20200209003837603" style="zoom:50%;" />



<h5 id="bfs"><a href="#bfs" class="headerlink" title="bfs"></a>bfs</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wordBreak</span><span class="params">(self, s: str, wordDict: List[str])</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line">        q = deque([s])</span><br><span class="line">        seen = set() </span><br><span class="line">        <span class="keyword">while</span> q:</span><br><span class="line">            s = q.popleft()    <span class="comment"># popleft() = BFS ; pop() = DFS</span></span><br><span class="line">            <span class="keyword">for</span> word <span class="keyword">in</span> wordDict:</span><br><span class="line">                <span class="keyword">if</span> s.startswith(word):</span><br><span class="line">                    new_s = s[len(word):]</span><br><span class="line">                    <span class="keyword">if</span> new_s == <span class="string">""</span>: </span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">if</span> new_s <span class="keyword">not</span> <span class="keyword">in</span> seen:</span><br><span class="line">                        q.append(new_s)</span><br><span class="line">                        seen.add(new_s)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>



<h3 id="301"><a href="#301" class="headerlink" title="301"></a><a name="301">301</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">removeInvalidParentheses</span><span class="params">(self, s)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type s: str</span></span><br><span class="line"><span class="string">        :rtype: List[str]</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">                  </span><br><span class="line">        ans = []</span><br><span class="line">        lefts_to_remove, rights_to_remove = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        lefts, rights = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">            <span class="keyword">if</span> s[i] == <span class="string">'('</span>:</span><br><span class="line">                lefts += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> s[i] == <span class="string">')'</span>:</span><br><span class="line">                <span class="keyword">if</span> lefts &gt; <span class="number">0</span>:</span><br><span class="line">                    lefts -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    rights_to_remove += <span class="number">1</span> <span class="comment">#if right doesn't have a matching left, it should be removed</span></span><br><span class="line">        lefts_to_remove = lefts <span class="comment">#if we have more lefts than rights, extra lefts should be removed</span></span><br><span class="line">        </span><br><span class="line">        self.backtracking(<span class="number">0</span>, <span class="number">0</span>, s, <span class="number">0</span>, <span class="string">''</span>, ans, lefts_to_remove, rights_to_remove)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ans:</span><br><span class="line">            ans.append(<span class="string">''</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">                    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">backtracking</span><span class="params">(self, lefts, rights, s, ind, cur_str, ans, lefts_to_remove, rights_to_remove)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> ind == len(s):</span><br><span class="line">            <span class="keyword">if</span> lefts == rights <span class="keyword">and</span> lefts_to_remove==<span class="number">0</span> <span class="keyword">and</span> rights_to_remove==<span class="number">0</span> <span class="keyword">and</span> cur_str <span class="keyword">not</span> <span class="keyword">in</span> ans:</span><br><span class="line">                ans.append(cur_str)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> s[ind] == <span class="string">'('</span>:</span><br><span class="line">            <span class="keyword">if</span> lefts_to_remove &gt; <span class="number">0</span>:</span><br><span class="line">                self.backtracking(lefts, rights, s, ind+<span class="number">1</span>, cur_str, ans, lefts_to_remove<span class="number">-1</span>, rights_to_remove)</span><br><span class="line">            self.backtracking(lefts+<span class="number">1</span>, rights, s, ind+<span class="number">1</span>, cur_str+<span class="string">'('</span>, ans, lefts_to_remove, rights_to_remove)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">elif</span> s[ind] == <span class="string">')'</span>:</span><br><span class="line">            <span class="keyword">if</span> (lefts==<span class="number">0</span> <span class="keyword">or</span> lefts&gt;=rights) <span class="keyword">and</span> rights_to_remove &gt; <span class="number">0</span>:</span><br><span class="line">                self.backtracking(lefts, rights, s, ind+<span class="number">1</span>, cur_str, ans, lefts_to_remove, rights_to_remove<span class="number">-1</span>)</span><br><span class="line">            <span class="keyword">if</span> lefts &gt; rights:</span><br><span class="line">                self.backtracking(lefts, rights+<span class="number">1</span>, s, ind+<span class="number">1</span>, cur_str+<span class="string">')'</span>, ans, lefts_to_remove, rights_to_remove)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.backtracking(lefts, rights, s, ind+<span class="number">1</span>, cur_str+s[ind], ans, lefts_to_remove, rights_to_remove)</span><br></pre></td></tr></table></figure>





<h2 id="Lai-Offer"><a href="#Lai-Offer" class="headerlink" title="Lai Offer"></a>Lai Offer</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#75">75 Sort Colors</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="75"><a href="#75" class="headerlink" title="75"></a><a name="75">75</a></h3><p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbpekpqfdcj30b60900u8.jpg" alt="image-20200208231937717"></p>
<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbpeq1jl8ij30rw116k6y.jpg" alt="image-20200208232444790"></p>
<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbpet5afu8j30u00zxnax.jpg" alt="image-20200208232746397"></p>
<h3 id="518"><a href="#518" class="headerlink" title="518"></a><a name="518">518</a></h3><img src="/Users/joe/Library/Application Support/typora-user-images/image-20200209233108458.png" alt="image-20200209233108458" style="zoom:50%;" />





<h3 id="973"><a href="#973" class="headerlink" title="973"></a><a name="973">973</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kClosest</span><span class="params">(self, points: List[List[int]], K: int)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="string">''' N*log(N)</span></span><br><span class="line"><span class="string">        # Q-sort tech</span></span><br><span class="line"><span class="string">        # [dis1, dis2, dis3]</span></span><br><span class="line"><span class="string">        if not points or not K:</span></span><br><span class="line"><span class="string">            return 0</span></span><br><span class="line"><span class="string">        l = []</span></span><br><span class="line"><span class="string">        for xy in points:</span></span><br><span class="line"><span class="string">            heapq.heappush(l, (self.distance(xy), xy[0], xy[1]))  # n*log(n)</span></span><br><span class="line"><span class="string">            # if len(l) &gt; K:</span></span><br><span class="line"><span class="string">            #     heapq._heappop_max(l)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        # map(points, self.distance)</span></span><br><span class="line"><span class="string">        # for point in points:</span></span><br><span class="line"><span class="string">        #     self.distance(point)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        res = []</span></span><br><span class="line"><span class="string">        for i in range(K):</span></span><br><span class="line"><span class="string">            dis, x, y = heapq.heappop(l)</span></span><br><span class="line"><span class="string">            res.append([x,y])</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">        return res</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        l = []</span><br><span class="line">        <span class="keyword">for</span> xy <span class="keyword">in</span> points:</span><br><span class="line">            dist = self.distance(xy)</span><br><span class="line">            dist = <span class="number">-1</span>*dist</span><br><span class="line">            <span class="keyword">if</span> len(l) &lt;= K<span class="number">-1</span>:</span><br><span class="line">                heapq.heappush(l, (dist, xy))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># print('---', dist)</span></span><br><span class="line">                <span class="keyword">if</span> dist &gt; l[<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    heapq.heappop(l)</span><br><span class="line">                    heapq.heappush(l, (dist, xy))</span><br><span class="line">                    </span><br><span class="line">        res = []</span><br><span class="line">        <span class="comment"># for i in range(len(l)):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(K):</span><br><span class="line">            res.append(heapq.heappop(l)[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">distance</span><span class="params">(self, xy)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> math.sqrt(xy[<span class="number">0</span>]**<span class="number">2</span> + xy[<span class="number">1</span>]**<span class="number">2</span>)<span class="comment">#, xy[0], xy[1]</span></span><br></pre></td></tr></table></figure>



<h5 id="Build-in"><a href="#Build-in" class="headerlink" title="Build-in"></a>Build-in</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Python program for implementation of  </span></span><br><span class="line"><span class="comment"># above approach </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># Function to return required answer </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pClosest</span><span class="params">(points, K)</span>:</span> </span><br><span class="line">  </span><br><span class="line">    points.sort(key = <span class="keyword">lambda</span> K: K[<span class="number">0</span>]**<span class="number">2</span> + K[<span class="number">1</span>]**<span class="number">2</span>) </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> points[:K] </span><br><span class="line">  </span><br><span class="line"><span class="comment"># Driver program </span></span><br><span class="line">points = [[<span class="number">3</span>, <span class="number">3</span>], [<span class="number">5</span>, <span class="number">-1</span>], [<span class="number">-2</span>, <span class="number">4</span>]] </span><br><span class="line">  </span><br><span class="line">K = <span class="number">2</span></span><br><span class="line">  </span><br><span class="line">print(pClosest(points, K))</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/01/11/LC/2020-01-11-LC-Discussion/">LC/2020-01-11-LC-Discussion</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/LC/">LC</a></span><div class="content"><h3 id="題目太長先跳過："><a href="#題目太長先跳過：" class="headerlink" title="題目太長先跳過："></a>題目太長先跳過：</h3><p>489robot room cleaner, 785, 721, 65validnumber, 133 clone graph, 636 executive time of functions, 269 alien dictionary</p>
<p>太計算特定型而非算法技巧型的的 - 29Divide Two Integers</p>
<p>知道大方向就好先不熟練的 - 935Knight Dialer</p>
<table>
<thead>
<tr>
<th></th>
<th>Thoughts1</th>
<th>Thoughts2</th>
<th></th>
<th>Status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#84">84 Largest Rectangle in Histogram</a></td>
<td>● Stack:  Greedy:   <br /></td>
<td>Greedy<br />● Time: O(n^2) ==&gt; O(3n) <br />● Space: O(2n) ==&gt; O(3n)</td>
<td>Self-minimum</td>
<td>v</td>
<td></td>
<td>Not in<br />~42, 907</td>
</tr>
<tr>
<td><a href="#85">85 Maximal Rectangle</a></td>
<td></td>
<td>Greedy<br />● Time: O(n^2) ==&gt; O(m*3n) <br />● Space: O(2n) ==&gt; O(3n)</td>
<td>Self-minimum x len(arr_2d)</td>
<td>v</td>
<td></td>
<td>Not in</td>
</tr>
<tr>
<td><a href="#907">907 sum of subarrays minumums</a></td>
<td></td>
<td>Greedy<br />● Time: O(n^2) ==&gt; O(3n) <br />● Space: O(2n) ==&gt; O(3n)</td>
<td>Self-minimum</td>
<td>v</td>
<td></td>
<td>Not in<br />~84</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#392">392 Is SubSequence</a></td>
<td>with deque()</td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td>Not in</td>
</tr>
<tr>
<td><a href="#792">792 Number of Matching Subsequences</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td>Not in</td>
</tr>
<tr>
<td><a href="#1055">1055 Shortest Way to From String</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td>Not in</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>High Freq.</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#953">953 LeetCode 953 Verifying an Alien Dictionary</a></td>
<td></td>
<td>邊界check要另做</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><strong><a href="#301">301Remove Invalid Parentheses</a></strong></td>
<td></td>
<td></td>
<td></td>
<td>HARD</td>
<td>HARD..</td>
<td>TRY BFS sol on <em>geeksforgeeks</em></td>
</tr>
<tr>
<td><a href="#238">238 product of array except self</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#67">67 Add Binary</a></td>
<td></td>
<td></td>
<td></td>
<td>△</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#273">273 Integer to English Words</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#973">973 K Closest Points to Origin</a></td>
<td>heapq</td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#560">560 Subarray Sum equals K</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#158">158 Read N Characters Given Read4 Ⅱ</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#621">621 Task Scheduler</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#325">325 Maximum Size Subarray Sum Equals k</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>~ 560</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#243">243 Shortest Word Distance Ⅰ</a> ~ <a href="#245">245 Ⅲ</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Heap</strong><br />●　O(N) for all arr’s heapify<br />●　O(NlogN) if insert one after one<br /> ● O(lgN) for pop() &amp; insert(), 从 n/2 地方开始进行调整</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#215">215 Kth largest elem in unsorted array</a></td>
<td>Heapify<br />O(N + klgN) – N for heapify, klgN for pop() k elem</td>
<td>Q-sort<br />O(N)</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#378">378 Kth Smallest Element in a Sorted Matrix</a></td>
<td>heap</td>
<td>m-sort, w/ heap helping manage running idx</td>
<td></td>
<td>v</td>
<td><a href="https://www.bilibili.com/video/av58960675/" target="_blank" rel="noopener">https://www.bilibili.com/video/av58960675/</a><br />仍是需要注意實踐的方式還有熟練度<br />v</td>
<td>~23</td>
</tr>
<tr>
<td><a href="#240">240 Search a 2D Matrix II – Sorted nxn Matrix</a></td>
<td><u>Binary</u> OK!<br />O(m x lg(n) x lg(DIFF))</td>
<td>D&amp;C <br />O(n)</td>
<td></td>
<td>v</td>
<td></td>
<td>~74</td>
</tr>
<tr>
<td><a href="#74">74 Search a 2D Matrix</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>~240, but A[i+1][0] &gt; A[i-1][n-1]</td>
</tr>
<tr>
<td><a href="#23">23 Merge K Sorted Lists</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>~378</td>
</tr>
<tr>
<td><a href="#692">692 Top K frequent words</a></td>
<td>heapify</td>
<td>Sorting</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#252">252 Meeting Room</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>~253, 56</td>
</tr>
<tr>
<td><a href="#253">253 Meeting Room Ⅱ</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td>~252, 56</td>
</tr>
<tr>
<td><a href="#56">56 Merge Intervals</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>~252, 253, 435</td>
</tr>
<tr>
<td><a href="#435">435 Non-overlapping Intervals</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>~56, 252, 253</td>
</tr>
<tr>
<td><strong><a href="#282">282 Expression Add Operators</a></strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#438">438. Find All Anagrams in a String</a></td>
<td>照bucket sort方式编码然后loop找，但發生 Time Limit Exceeded</td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>~49</td>
</tr>
<tr>
<td><a href="#173">173 Binary Search Tree Iterator</a></td>
<td>heapq, easy</td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#269">269 Alien Dictionary</a></td>
<td><a href="https://leetcode.jp/leetcode-269-alien-dictionary-%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">leetcode.jp-269 wwwlink</a></td>
<td></td>
<td></td>
<td>HARD</td>
<td></td>
<td>~207, 210</td>
</tr>
<tr>
<td><a href="#921">921 Minimum Add to Make Parentheses Valid</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>too easy</td>
</tr>
<tr>
<td><a href="#286">286 Walls and Gates</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#20">20 Valid Parentheses</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#146">146 LRU Cache</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#231">231 326 342 Power of 2, 3, 4</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#739">739 Daily Temperatures</a></td>
<td></td>
<td>Write down and observe the pattern</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>It seems like we don’t have to use any stacks when we implement DFS recursively. But actually, we are using the implicit stack provided by the system, also known as the <a href="https://en.wikipedia.org/wiki/Call_stack" target="_blank" rel="noopener">Call Stack</a>.</p>
<h3 id="An-Example"><a href="#An-Example" class="headerlink" title="An Example"></a>An Example</h3><hr>
<p>Let’s take a look at an example. We want to find a path between node 0 and node 3 in the graph below. We also show you the stack’s status during each call.</p>
<p><img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gbkp0e5xzdj317m0jkwgf.jpg" alt="img"></p>
<p>In each stack element, there is an integer <code>cur</code>, an integer <code>target</code>, a reference to array <code>visited</code> and a reference to array <code>edges</code>, which are exactly the parameters we have in the DFS function. We only show <code>cur</code> in the stack above.</p>
<p>Each element costs constant space. And the size of the stack is exactly the depth of DFS. So in the worst case, it costs O(h) to maintain the system stack, where h is the maximum depth of DFS. You should never forget to take the system stack into consideration when calculating the space complexity.</p>
<h2 id="Arrays"><a href="#Arrays" class="headerlink" title="Arrays:"></a>Arrays:</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#349">349 Intersection of Two Arrays</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#350">350 Intersection of Two Arrays Ⅱ</a></td>
<td>Two pointers:<br />Time Complexity: O(<em>n</em>log<em>n</em>+<em>m</em>log<em>m</em>), where n<em>n</em> and m<em>m</em> are the lengths of the arrays.<br />Space complexity: \mathcal{O}(1)O(1). We sort the arrays in-place.</td>
<td>Time complexity: \mathcal{O}(n + m)O(<em>n</em>+<em>m</em>), where n<em>n</em> and m<em>m</em> are the lengths of the arrays. We iterate through the first, and then through the second array; insert and lookup operations in the hash map take a constant time. <br />Space complexity: \mathcal{O}(\min(n, m))O(min(<em>n</em>,<em>m</em>)). We use hash map to store numbers (and their counts) from the smaller array.</td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#896">896 Monotonic rAray</a></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td>too ye</td>
</tr>
<tr>
<td><a href="#31">31 Next Permutation</a></td>
<td></td>
<td></td>
<td>v</td>
<td>Once</td>
<td></td>
</tr>
<tr>
<td><a href="#825">825 Friends of Appropriate Ages</a></td>
<td></td>
<td></td>
<td>v</td>
<td>Abstract</td>
<td></td>
</tr>
<tr>
<td><strong>TWO WAYS recording</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#42">42 Trapping Rain Water</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>~84</td>
</tr>
<tr>
<td><a href="#238">238 Product of Array Except Self</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Linked-List"><a href="#Linked-List" class="headerlink" title="Linked List"></a>Linked List</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>cedod</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#206">206 Reverse Linked List</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#92">92 Reverse Linked List Ⅱ</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#141">141 Cycle Linked List</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#142">142 Cycle Linked List 2</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#143">143 Reorder Linked List</a></td>
<td></td>
<td>最後要記得cur.next =None, 不然會有cycle</td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#138">138 Copy List with Random Pointer</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#234">234 Palindrome Linked List</a></td>
<td>turned into list + 2 pointer trvs</td>
<td>Add dummy node before head and check fast==None or fast.next == None to know odd/even nodes. <br />Then, reverse 2nd part and compare 1st part and 2nd part.</td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#83">83 Remove Duplicated from Sorted List</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Sliding-Window"><a href="#Sliding-Window" class="headerlink" title="Sliding Window"></a>Sliding Window</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th>coded</th>
<th>Status</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#209">209 Minimum Size Subarray Sum</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#159">159 Longest Substring with At Most Two Distinct Characters</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>~340</td>
</tr>
<tr>
<td><a href="#340">340 Longest Substring with At Most k Distinct Characters</a></td>
<td></td>
<td></td>
<td>v 比159多了個 k==0 的check</td>
<td>v</td>
<td>~159, ~3</td>
</tr>
<tr>
<td><a href="#3">3 Longest Substring Without Repeating Characters</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>３３3232222232322</p>
<p>status</p>
<p>Coded 32324</p>
<p>Greedy</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>135 分發糖果</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Not in</td>
</tr>
<tr>
<td>376 搖擺序列</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Not in</td>
</tr>
<tr>
<td>402 移除K個數字</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Not in</td>
</tr>
<tr>
<td>55</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Not in</td>
</tr>
<tr>
<td><strong>45</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="Backtracking"><a href="#Backtracking" class="headerlink" title="Backtracking"></a>Backtracking</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#78">78 Subsets</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#90">90 Subsets Ⅱ</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#40">40 Combination Sum Ⅱ</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>~113</td>
</tr>
<tr>
<td><a href="#22">22 Generate Parentheses</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>△ 未想出return條件；<br />　 然後item的更新仍該在result更新前</td>
<td></td>
</tr>
<tr>
<td><a href="#51">51 N-Queens</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Merge</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#315">315 Count of Smaller Numbers After Self</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>X</td>
<td></td>
</tr>
<tr>
<td>high freq.</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#46">46 Permutations</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#47">47 Permutations Ⅱ</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#88">88 Merge Sorted Array</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<p>D&amp;C</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#125">125 Valid Palindrome</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#680">680 Valid Palindrome Ⅱ</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="Binary-Tree-amp-Graph"><a href="#Binary-Tree-amp-Graph" class="headerlink" title="Binary Tree &amp; Graph"></a>Binary Tree &amp; Graph</h2><p>A <strong>binary tree</strong> is a data structure in which each node has at most 2 children, which aer referred to as the left and right child respectively.</p>
<p><strong>Complete Binary Tree</strong> :<br>Every level, except possibly the last, is completely filled. And all nodes in the last level are as far left as possible.</p>
<p><strong>Full Tree</strong><br>A <strong>full binary tree</strong> (sometimes referred to as a <strong>proper</strong> or <strong>plane</strong> binary tree) is a tree in which every node has either 0 or 2 children.</p>
<h4 id="Traversals"><a href="#Traversals" class="headerlink" title="Traversals"></a>Traversals</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span><span class="params">(object)</span>:</span></span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, value)</span>:</span></span><br><span class="line">		self.value = value</span><br><span class="line">		self.left, self.right = <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BinaryTree</span><span class="params">(object)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, root)</span>:</span></span><br><span class="line">    self.root = Node(root)</span><br><span class="line">	</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">print_tree</span><span class="params">(self, traversal_type)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> traversal_type == <span class="string">"preorder"</span>:</span><br><span class="line">      <span class="keyword">return</span> self.preorder_print(tree.root, <span class="string">""</span>)</span><br><span class="line">    <span class="keyword">elif</span> traversal_type == <span class="string">"inorder"</span>:</span><br><span class="line">      <span class="keyword">return</span> self.inorder_print(tree.root, <span class="string">""</span>)</span><br><span class="line">    <span class="keyword">elif</span> traversal_type == <span class="string">"postorder"</span>:</span><br><span class="line">      <span class="keyword">return</span> self.postorder_print(tree.root, <span class="string">""</span>)    </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      print(<span class="string">"Trav type not supported"</span>)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">preorder_print</span><span class="params">(self, start, traversal)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> start:</span><br><span class="line">      traversal += (str(start.value) + <span class="string">"_"</span>)</span><br><span class="line">      traversal = self.preorder_print(start.left, traversal)</span><br><span class="line">			traversal = self.preorder_print(start.right, traversal)</span><br><span class="line">		<span class="keyword">return</span> traversal</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">inorder_print</span><span class="params">(self, start, traversal)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> start:</span><br><span class="line">      traversal = self.preorder_print(start.left, traversal)</span><br><span class="line">			traversal += (str(start.value) + <span class="string">"_"</span>)</span><br><span class="line">			traversal = self.preorder_print(start.right, traversal)</span><br><span class="line">		<span class="keyword">return</span> traversal</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">postorder_print</span><span class="params">(self, start, traversal)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> start:</span><br><span class="line">      traversal = self.preorder_print(start.left, traversal)</span><br><span class="line">			traversal = self.preorder_print(start.right, traversal)</span><br><span class="line">			traversal += (str(start.value) + <span class="string">"_"</span>)     </span><br><span class="line">		<span class="keyword">return</span> traversal  </span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 1-2-4-5-3-6-7</span></span><br><span class="line"><span class="comment"># 4-2-5-1-6-3-7</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">tree = BinaryTree(<span class="number">1</span>)</span><br><span class="line">tree.root.left = Node(<span class="number">2</span>)</span><br><span class="line">tree.root.right = Nonde(<span class="number">3</span>)</span><br><span class="line">tree.root.left.left = Node(<span class="number">4</span>)</span><br><span class="line">tree.root.left.right = Node(<span class="number">5</span>)</span><br><span class="line">tree.root.right.left = Node(<span class="number">6</span>)</span><br><span class="line">tree.root.right.right = Node(<span class="number">7</span>)</span><br></pre></td></tr></table></figure>

<h4 id="Height"><a href="#Height" class="headerlink" title="Height"></a>Height</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">height</span><span class="params">(self, root)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    l = self.height(root.left)</span><br><span class="line">    r = self.height(root.right)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> + max(l, r)</span><br></pre></td></tr></table></figure>

<h4 id="Size"><a href="#Size" class="headerlink" title="Size"></a>Size</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">size_</span><span class="params">(self, root)</span>:</span></span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> + self.size_(root.left) + self.size_(root.right)</span><br><span class="line"> <span class="keyword">or</span> </span><br><span class="line">	BFS</span><br></pre></td></tr></table></figure>



<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>DFS preorder</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#113">113 Path Sum Ⅱ</a></td>
<td></td>
<td></td>
<td>v</td>
<td>△ return的時機未抓好，造成items未被pop()足夠</td>
<td>~40</td>
</tr>
<tr>
<td><a href="#236">236 Lowest Common Ancestor of a Binary Tree</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#114">114 Flatten Binary Tree to Linked List</a></td>
<td>左边先拉平，常规思维</td>
<td>右边从底部建上来，酷</td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td>BFS</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#199">199 Binary Tree Right Side View</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><em>HIgh Freq.</em></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#105">105 Construct Binary Tree from Preorder and Inorder Traversal</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#110">110 Balanced Binary Tree</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#111">111 Minimum Depth of Binary Tree</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#112">112 Path Sum</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#113">113 Path Sum Ⅱ</a> repeated</td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#124">124 Binary Tree Maximum Path Sum</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#297">297 Serialize and Deserialize Binary Tree</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td>GRAPH<br />adjacent matrix &amp; table</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#207">207 Course Schedule</a></td>
<td>DFS</td>
<td>BFS Topological sorting<br /><a href="https://leetcode.jp/leetcode-207-course-schedule%e8%a7%a3%e9%a2%98%e6%80%9d%e8%b7%af%e5%88%86%e6%9e%90/" target="_blank" rel="noopener">leecode.jp link</a></td>
<td>v</td>
<td>v</td>
<td>~210, 269</td>
</tr>
<tr>
<td><a href="#133">133 Clone Graph</a></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td>High Freq.</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#210">210 Course Schedule Ⅱ</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#269">269 Alien Dictionary</a></td>
<td></td>
<td></td>
<td>Too HARD</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#102">102 Binary Tree Level Order Traversal</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#145">145 Binary Tree Postorder Traversal</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#958">958 Completeness of a Binary Tree</a></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#104">104 Maximum Depth of Binary Tree</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#111">111 Minimum Depth of Binary Tree</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#144">144 Binary Tree Preorder Traversal</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td>[94 Binary Tree Inorder Traversal][#94]</td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#101">101 Symmetric Tree</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#112">112 Path Sum</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#113">113 Path Sum Ⅱ</a></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="B-Search-amp-B-Search-Tree"><a href="#B-Search-amp-B-Search-Tree" class="headerlink" title="B-Search &amp; B-Search Tree"></a>B-Search &amp; B-Search Tree</h2><img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gbfy37o6xtj31ds0u04qp.jpg" alt="image-20200131174932656" style="zoom:50%;" />

<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>B-Search<br />1. 如果搭配(l+1, r-1)條件應該要是 l&lt;=r 才對。不然兩個元素時，第二個元素是target就會找不到！<br /></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#35">35 Search Insertion Position</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>邊界條件需要特別思考<br />Not in</td>
</tr>
<tr>
<td><a href="#34">34 Search for a Range</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td>X　討論複雜</td>
<td></td>
<td></td>
</tr>
<tr>
<td>B-Search 模板：<a href="https://www.jianshu.com/p/b72c80fdb240" target="_blank" rel="noopener">https://www.jianshu.com/p/b72c80fdb240</a><br /><a href="https://www.jianshu.com/p/b72c80fdb240" target="_blank" rel="noopener">https://www.jianshu.com/p/b72c80fdb240</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#69">69 Sqrt(x)</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v<br />Template1</td>
<td></td>
</tr>
<tr>
<td><a href="#374">374 Guess Number Higher or Lower</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v<br />Tempalte1</td>
<td>Not in</td>
</tr>
<tr>
<td><a href="#33">33 Search in Rotated Sorted Array</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>Not yet, should be Template1</td>
<td></td>
</tr>
<tr>
<td><a href="#278">278 First Bad Version</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v <br />Template2</td>
<td></td>
</tr>
<tr>
<td><a href="#162">162 Find Peak Element</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>△<br />Template2, 但r值却是设为了 len(nums)-1 ?!</td>
<td></td>
</tr>
<tr>
<td><a href="#153">153 Find Minimum in Rotated Sorted Array</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><br />Template2</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>B-Search Tree (BST)　<br />左子樹所有節點的值都&lt;=根<br />左右子樹也分別為B-Search Tree<br />等於的情況只能出現在左子樹或右子樹的某一側<br />由於中序是小到大的，所以又叫B-Sort Tree<br />插入</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#449">449 Serialize and Deserialize BST</a><br />BST的查找跟復原只有前序可以；中序會全向右靠；後序的話根要最後才生出，不合理</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#315">315 Count of Smaller Numbers After Self</a></td>
<td></td>
<td></td>
<td></td>
<td>△</td>
<td></td>
<td>Not In</td>
</tr>
<tr>
<td>High Freq.</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#270">270 Closest Binary Search Tree Value</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#98">98 Validate Binary Search Tree</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#285">285 Inorder Successor in BST</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#173">173 Binary Search Tree Iterator</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#700">700 Search in a Binary Search Tree</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#701">701 Insert into a Binary Search Tree</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#235">235 Lowest Common Ancestor of a Binary Search Tree</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>vs 236, ancestor of Binary Tree</td>
</tr>
<tr>
<td><a href="#108">108 Construct Sorted Array to BST</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#109">109 Construct Sorted List to BST</a></td>
<td></td>
<td></td>
<td>就是先把Linked List轉成 array存好，然後套108的</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="Hash-amp-String"><a href="#Hash-amp-String" class="headerlink" title="Hash &amp; String"></a>Hash &amp; String</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Hash <br />如果用array當最基本的hash來排序，複雜度會是<br />O(表長＋n) – 遍歷表長 + 把elem塞進表；當ｎ遠大於表長時吃香<br />用哈希fn將key轉換為整數再對表長取餘，從而關鍵字值被轉換為哈希表的表長範圍內的整數。<br />衝突就是表長不夠大。<br />拉鏈法來解決衝突，插入是頭插法，所以不需要last指針，也就O(1)就插進去了。<br />找的時候是找hash_key 對應的那條linked-list<br />TABLE_LEN選為質數好，可少衝突</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#409">409. Longest Palindrome</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>Not in</td>
</tr>
<tr>
<td><a href="#290">290 Word Pattern</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>Not in</td>
</tr>
<tr>
<td><a href="#49">49 Group Anagrams</a></td>
<td></td>
<td>sort(string)</td>
<td>onehot coding string</td>
<td>v</td>
<td>v</td>
<td>~438</td>
</tr>
<tr>
<td><a href="#3">3 Longest Substring Without Repeating Characters</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#187">187 Repeated DNA Sequences</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>No t in</td>
</tr>
<tr>
<td><a href="#76">76 [ Minimum Window Substring]</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>~209</td>
</tr>
<tr>
<td><a href="#161">161 One Edit Distance</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#415">415 Add Strings</a></td>
<td></td>
<td></td>
<td>注意地方：<br />1. # if len(num1) &gt; len(num2)    ## CAUTIOUS!!! SHOULD USE WHILE<br/>        while len(num1) &gt; len(num2) and i &lt; len(num1)-1:<br />2. 最後要的答案反轉跟res在append時的type要是str()</td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#71">71 Simplify Path</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="Searching"><a href="#Searching" class="headerlink" title="Searching"></a>Searching</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#200">200 Number of Islands</a></td>
<td></td>
<td>BFS 得到TLE…<br />np.pad(A, ((1,1), (1,1)))<br />分別是在前、後、上、下補０</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#127">127 Word Ladder</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#473">473 Matchsticks to Square</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Not in</td>
</tr>
<tr>
<td><a href="#107">107 Trapping Rain Water Ⅱ</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Not in</td>
</tr>
</tbody></table>
<h2 id="Dynamic-Programming"><a href="#Dynamic-Programming" class="headerlink" title="Dynamic Programming"></a>Dynamic Programming</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#70">70 Climbing Stairs</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#198">198 House Robber</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>Not in</td>
</tr>
<tr>
<td><a href="#53">53 Maximum Subarray</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#322">322 Coin Change</a> <br />dp[i]代表金额的最優解，就是最小使用張數</td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v<br />需要注意dp[i-coin]+1的這個１的位置</td>
<td>No t in</td>
</tr>
<tr>
<td><a href="#120">120 Triangle</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Not in   ~64</td>
</tr>
<tr>
<td><a href="#300">300 Longest Increasing Subsequence</a></td>
<td></td>
<td></td>
<td></td>
<td>v<br /> O(nlg(n)) should combine with <a>35</a></td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#64">64 Minimum Path Sum</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>Not in ~120</td>
</tr>
<tr>
<td><a href="#174">174 Dungeon Game</a></td>
<td></td>
<td></td>
<td></td>
<td>之後看…難</td>
<td></td>
<td>Not in</td>
</tr>
<tr>
<td>High Freq.</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#121">121 Best Time to Buy and Sell Stock</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#122">122 Best Time to Buy and Sell StockⅡ</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#523">523 Continuous Subarray Sum</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v 需考慮k 為０的情況</td>
<td></td>
</tr>
<tr>
<td><a href="#304">304 Range Sum Query 2D - Immutable</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v 要注意m, n代表pre_sum的長度所以要補加１，然後matrix都是拿 m-1, n-1的</td>
<td></td>
</tr>
<tr>
<td><a href="#303">303 Range Suym Query - Immutable</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v<br />做個pre_sum 就ｏｋ要注意長度需加１</td>
<td>Not in, but for prep of 304</td>
</tr>
<tr>
<td><a href="#1027">1027 Longest Arithmetic Sequence</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#1143">1143 Longest Common Subsequence</a></td>
<td></td>
<td></td>
<td>Sub array的话会更严格</td>
<td>v</td>
<td>v</td>
<td><a href="https://www.itread01.com/content/1546179722.html" target="_blank" rel="noopener">https://www.itread01.com/content/1546179722.html</a></td>
</tr>
<tr>
<td><a href="#139">139 word break</a></td>
<td></td>
<td>dfs</td>
<td>dp</td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Complex-Data-Structure"><a href="#Complex-Data-Structure" class="headerlink" title="Complex Data Structure"></a>Complex Data Structure</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>Status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#208">208 Implement Trie(Prefix Tree)</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#211">211 Add and Search Word - Data Structure Design</a></td>
<td></td>
<td>Trie Tree</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#547">547 Friend Circles</a></td>
<td></td>
<td>並查集</td>
<td></td>
<td></td>
<td></td>
<td>Not in</td>
</tr>
<tr>
<td><a href="#307">307 Range Sum Query - Mutable</a></td>
<td></td>
<td>線段樹！讓update跟query都可是 lg(n)</td>
<td></td>
<td></td>
<td></td>
<td>Not in</td>
</tr>
</tbody></table>
<p>馬走日</p>
<p>八皇后</p>
<h3 id="84"><a href="#84" class="headerlink" title="84"></a>84</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">largestRectangleArea</span><span class="params">(<span class="keyword">int</span>[] heights)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (heights.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>[] leftBiggerCount = <span class="keyword">new</span> <span class="keyword">int</span>[heights.length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; heights.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> index = i - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (index &gt;= <span class="number">0</span> ＆＆ heights[index] &gt; heights[i]) &#123;</span><br><span class="line">            count += leftBiggerCount[index];</span><br><span class="line">            index -= leftBiggerCount[index];</span><br><span class="line">        &#125;</span><br><span class="line">        leftBiggerCount[i] = count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>[] rightBiggerCount = <span class="keyword">new</span> <span class="keyword">int</span>[heights.length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = heights.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> index = i + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (index &lt; heights.length ＆＆ heights[index] &gt;= heights[i]) &#123;</span><br><span class="line">            count += rightBiggerCount[index];</span><br><span class="line">            index += rightBiggerCount[index];</span><br><span class="line">        &#125;</span><br><span class="line">        rightBiggerCount[i] = count;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; heights.length; i++) &#123;</span><br><span class="line">        max = Math.max(max, (rightBiggerCount[i] + leftBiggerCount[i] - <span class="number">1</span>) * heights[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> max;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="TLE"><a href="#TLE" class="headerlink" title="TLE"></a>TLE</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">heights      [2 1 5 6 2 3]</span></span><br><span class="line"><span class="string">dis_l        [0 1 0 0 3 0]</span></span><br><span class="line"><span class="string">dis_r        [0 4 1 0 1 0]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">For idx in range(len(heights)):</span></span><br><span class="line"><span class="string">    (dis_l + 1 + dis_r) * heights[idx]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">res   [0 (1+4+1)*1, (0+1+1)*2, 0, (1+1+1)*2, 0]</span></span><br><span class="line"><span class="string">return max(res)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestRectangleArea</span><span class="params">(self, heights: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> heights:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        n = len(heights)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># left[i], right[i] represent how many bars are &gt;= than the current bar</span></span><br><span class="line"></span><br><span class="line">        left = [<span class="number">1</span>] * n		<span class="comment"># SHOULD START fr 1 to avoid -1 idx problem for left arr</span></span><br><span class="line">        right = [<span class="number">1</span>] * n</span><br><span class="line">        max_rect = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># calculate left</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</span><br><span class="line">            j = i - <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> j &gt;= <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> heights[j] &gt;= heights[i]:</span><br><span class="line">                    left[i] += left[j]</span><br><span class="line">                    j -= left[j]</span><br><span class="line">                <span class="keyword">else</span>: <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># calculate right</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            j = i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> j &lt; n:</span><br><span class="line">                <span class="keyword">if</span> heights[j] &gt;= heights[i]:</span><br><span class="line">                    right[i] += right[j]</span><br><span class="line">                    j += right[j]</span><br><span class="line">                <span class="keyword">else</span>: <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</span><br><span class="line">            max_rect = max(max_rect, heights[i] * (left[i] + right[i] - <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> max_rect</span><br></pre></td></tr></table></figure>



<ul>
<li><p>85 </p>
</li>
</ul>
<p>v1 ~v5 </p>
<p>local </p>
<h3 id="3"><a href="#3" class="headerlink" title="3"></a><a name="3">3</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">''' </span></span><br><span class="line"><span class="string">  a b c a b c b b </span></span><br><span class="line"><span class="string">          j   i</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[a b c b] ==&gt; [c b]</span></span><br><span class="line"><span class="string">j = i = -1</span></span><br><span class="line"><span class="string">d = &#123;a:3, b:4, c:5&#125;</span></span><br><span class="line"><span class="string">j = d[a]+1  ==&gt;0, </span></span><br><span class="line"><span class="string">i = 3</span></span><br><span class="line"><span class="string">(0, 3]   3 - 0 ==&gt; leng=3</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">i 6</span></span><br><span class="line"><span class="string">j 4 ...however, we didn't del a from lkup</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(self, s: str)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        j = <span class="number">-1</span></span><br><span class="line">        lkup = &#123;&#125;</span><br><span class="line">        res_max = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s)):</span><br><span class="line">            <span class="keyword">if</span> s[i] <span class="keyword">not</span> <span class="keyword">in</span> lkup:</span><br><span class="line">                lkup[s[i]] = i</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                j = max(lkup[s[i]], j)  <span class="comment"># should be b4 next line, </span></span><br><span class="line">                                <span class="comment"># if abba, j should stay at idx2, not go back idx0</span></span><br><span class="line">                </span><br><span class="line">                <span class="comment"># del lkup[s[i]]</span></span><br><span class="line">                lkup[s[i]] = i</span><br><span class="line">                <span class="comment"># <span class="doctag">TODO:</span> del a</span></span><br><span class="line">                <span class="comment"># tmp = []</span></span><br><span class="line">                <span class="comment"># for k in lkup.keys():</span></span><br><span class="line">                <span class="comment">#     if lkup[k] &lt; i:</span></span><br><span class="line">                <span class="comment">#         # del lkup[k]</span></span><br><span class="line">                <span class="comment">#         tmp.append(k)</span></span><br><span class="line">                <span class="comment"># for k in tmp:</span></span><br><span class="line">                <span class="comment">#     del lkup[k]</span></span><br><span class="line">            res_max = max(res_max, i - j)  <span class="comment"># 2 - (-1) =&gt; 3</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> res_max</span><br></pre></td></tr></table></figure>



<h3 id="20"><a href="#20" class="headerlink" title="20"></a><a name="20">20</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValid</span><span class="params">(self, s: str)</span> -&gt; bool:</span></span><br><span class="line">        d = &#123;<span class="string">'('</span>: <span class="string">')'</span>, <span class="string">'['</span>:<span class="string">']'</span>, <span class="string">'&#123;'</span>:<span class="string">'&#125;'</span>&#125;</span><br><span class="line">        </span><br><span class="line">        S = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">            <span class="keyword">if</span> c == <span class="string">'('</span> <span class="keyword">or</span> c == <span class="string">'['</span> <span class="keyword">or</span> c ==<span class="string">'&#123;'</span>:</span><br><span class="line">                S.append(c)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> S:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    elem = S.pop()</span><br><span class="line">                    <span class="keyword">if</span> d[elem] != c:</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> S</span><br></pre></td></tr></table></figure>



<h3 id="22"><a href="#22" class="headerlink" title="22"></a><a name="22">22</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2 ==&gt; 4 symbols</span></span><br><span class="line"><span class="comment"># (()), ()()</span></span><br><span class="line"><span class="comment"># ((((, ((()</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">generateParenthesis</span><span class="params">(self, n: int)</span> -&gt; List[str]:</span></span><br><span class="line">        self.n = n</span><br><span class="line">        result = []</span><br><span class="line">        self.gen(<span class="number">0</span>, <span class="string">''</span>, <span class="string">""</span>, result, n, n)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen</span><span class="params">(self, i, symbol, item, result, left, right)</span>:</span></span><br><span class="line">        <span class="comment"># if i &gt;= self.n * 2:</span></span><br><span class="line">        <span class="comment">#     return</span></span><br><span class="line">        item = item + symbol <span class="comment"># item.push_back()</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> left <span class="keyword">and</span> <span class="keyword">not</span> right:</span><br><span class="line">            result.append(item) <span class="comment"># result.push_back(item)</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> left &gt; <span class="number">0</span>:    <span class="comment"># pruning </span></span><br><span class="line">            self.gen(i+<span class="number">1</span>, <span class="string">'('</span>, item, result, left<span class="number">-1</span>, right)   </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> right &gt; <span class="number">0</span> <span class="keyword">and</span> right &gt; left:</span><br><span class="line">            self.gen(i+<span class="number">1</span>, <span class="string">')'</span>, item, result, left, right<span class="number">-1</span>)</span><br></pre></td></tr></table></figure>



<h3 id="23"><a href="#23" class="headerlink" title="23"></a><a name="23">23</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mergeKLists</span><span class="params">(self, lists: List[ListNode])</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="comment"># val, index </span></span><br><span class="line">        <span class="comment"># 1, 0</span></span><br><span class="line">        <span class="comment"># 1, 1</span></span><br><span class="line">        <span class="comment"># 2, 2</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> lists:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># if not lists[0]:</span></span><br><span class="line">        <span class="comment">#     return None</span></span><br><span class="line">        </span><br><span class="line">        l = []  <span class="comment"># for heapq</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(lists)):</span><br><span class="line">            <span class="keyword">if</span> lists[i]:                <span class="comment"># CAUTION! for [[],[1]]</span></span><br><span class="line">                val, idx = lists[i].val, i</span><br><span class="line">                heapq.heappush(l, (val, idx))</span><br><span class="line">            <span class="comment"># lists[idx] = lists[idx].next  # CAUTION! 別跟31行重覆了</span></span><br><span class="line">        </span><br><span class="line">        root = curr = ListNode(<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> l:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            val, idx = heapq.heappop(l)</span><br><span class="line">            <span class="comment"># print(val, idx)</span></span><br><span class="line">            <span class="comment"># for update heapq</span></span><br><span class="line">            lists[idx] = lists[idx].next</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> lists[idx] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                heapq.heappush(l, (lists[idx].val, idx))</span><br><span class="line">                </span><br><span class="line">            <span class="comment"># for Result</span></span><br><span class="line">            curr.next = ListNode(val)</span><br><span class="line">            curr = curr.next</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> root.next</span><br></pre></td></tr></table></figure>



<h3 id="31"><a href="#31" class="headerlink" title="31"></a><a name="31">31</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">nextPermutation</span><span class="params">(self, nums: List[int])</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Do not return anything, modify nums in-place instead.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment">#　把頂點前的那個值跟最後的換，然後後半進行排序</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums <span class="keyword">or</span> <span class="keyword">not</span> len(nums):</span><br><span class="line">            <span class="keyword">return</span> nums</span><br><span class="line">        <span class="keyword">if</span> len(nums) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> nums</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#    1,2,6,4,2</span></span><br><span class="line">        <span class="comment"># =&gt; 1,4,2,2,6 </span></span><br><span class="line">        replace = len(nums)<span class="number">-2</span></span><br><span class="line">        <span class="keyword">while</span> replace &gt;= <span class="number">0</span> <span class="keyword">and</span> nums[replace] &gt;= nums[replace+<span class="number">1</span>]:   <span class="comment"># CAUTIOUS! "&gt;="</span></span><br><span class="line">            replace -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> replace &lt; <span class="number">0</span>:  <span class="comment"># 5,1,1 # 6,5,4,3,2,1</span></span><br><span class="line">            <span class="comment"># nums = sorted(nums)    # sorted function not in-place</span></span><br><span class="line">            i = <span class="number">0</span></span><br><span class="line">            p, q = i, len(nums)<span class="number">-1</span>-i</span><br><span class="line">            <span class="keyword">while</span> p &lt; q:</span><br><span class="line">                nums[p], nums[q]= nums[q], nums[p]</span><br><span class="line">                p += <span class="number">1</span></span><br><span class="line">                q -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        print(replace)</span><br><span class="line">        </span><br><span class="line">        next_larger = replace + <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span>  next_larger &lt; len(nums) <span class="keyword">and</span> nums[next_larger] &gt; nums[replace]:</span><br><span class="line">            next_larger += <span class="number">1</span></span><br><span class="line">        next_larger -= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        print(next_larger)</span><br><span class="line">        nums[replace], nums[next_larger] = nums[next_larger], nums[replace]</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        p, q = replace+<span class="number">1</span>, len(nums)<span class="number">-1</span></span><br><span class="line">        print(nums, p, q)</span><br><span class="line">        <span class="keyword">while</span> p &lt; q:</span><br><span class="line">            nums[p], nums[q]= nums[q], nums[p]</span><br><span class="line">            p += <span class="number">1</span></span><br><span class="line">            q -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment"># return</span></span><br></pre></td></tr></table></figure>



<h3 id="33"><a href="#33" class="headerlink" title="33"></a><a name="33">33</a></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//对于特殊情况的判断</span></span><br><span class="line">		<span class="keyword">if</span>(nums.<span class="built_in">size</span>()==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">if</span>(nums.<span class="built_in">size</span>()==<span class="number">1</span> &amp;&amp; nums[<span class="number">0</span>]==target) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(nums.<span class="built_in">size</span>()==<span class="number">1</span> &amp;&amp; nums[<span class="number">0</span>]!=target) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">int</span> index= <span class="number">0</span> ; <span class="comment">//记录轴点</span></span><br><span class="line">		<span class="keyword">int</span> <span class="built_in">size</span> = nums.<span class="built_in">size</span>();<span class="comment">//记录下初始数组的长度</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(nums[i]&lt;nums[i<span class="number">-1</span>])&#123;</span><br><span class="line">				index = i; <span class="comment">//找到轴点后结束循环</span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			nums.push_back(nums[i]); <span class="comment">//在找到轴点之前，将轴点前数字依次放在数组尾部</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> left = index; <span class="comment">//left = 轴点</span></span><br><span class="line">		<span class="keyword">int</span> right = nums.<span class="built_in">size</span>()<span class="number">-1</span>; <span class="comment">//right = 数组当前长度-1 </span></span><br><span class="line">		<span class="keyword">int</span> ans = <span class="number">-1</span>;<span class="comment">//ans表示最终的位置</span></span><br><span class="line">		<span class="keyword">while</span>(left&lt;=right)&#123;</span><br><span class="line">			<span class="keyword">int</span> mid = (left+right)/<span class="number">2</span>; <span class="comment">//计算中点</span></span><br><span class="line">			<span class="keyword">if</span>(nums[mid]==target)&#123;</span><br><span class="line">				ans = mid; <span class="comment">//如果nums[mid] == target </span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(nums[mid]&lt;target) left = mid+<span class="number">1</span>; <span class="comment">//如果nums[mid]&lt;target 修改left</span></span><br><span class="line">			<span class="keyword">if</span>(nums[mid]&gt;target) right = mid<span class="number">-1</span>; <span class="comment">//如果 nums[mid]&gt;target 修改 right</span></span><br><span class="line">			<span class="keyword">if</span>(nums[right] == target ) ans = right; <span class="comment">//如果 nums[right] == target 将 ans修改为right 否则ans为-1</span></span><br><span class="line">			<span class="keyword">else</span> ans = <span class="number">-1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans % <span class="built_in">size</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h3 id="34"><a href="#34" class="headerlink" title="34"></a><a name="34">34</a></h3><h5 id="Use-bisect-built-in-for-‘r’"><a href="#Use-bisect-built-in-for-‘r’" class="headerlink" title="Use bisect built-in for ‘r’ !"></a>Use bisect built-in for ‘r’ !</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> bisect <span class="keyword">import</span> * <span class="comment"># bisect_left() bisect_right()</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">searchRange</span><span class="params">(self, nums: List[int], target: int)</span> -&gt; List[int]:</span></span><br><span class="line">        l, r = <span class="number">0</span>, len(nums)</span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            mid = l + (r-l)//<span class="number">2</span></span><br><span class="line">                    <span class="comment"># 5 7 7  8 8 10</span></span><br><span class="line">            <span class="keyword">if</span> target &lt;= nums[mid]:</span><br><span class="line">                r = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                l = mid + <span class="number">1</span></span><br><span class="line">        ans_l = l   <span class="comment"># == bisect_left(nums, traget)</span></span><br><span class="line">        <span class="comment"># if nums[l] != target:</span></span><br><span class="line">        <span class="comment">#     ans_l = -1</span></span><br><span class="line">        </span><br><span class="line">        ans_r = bisect_right(nums, target) <span class="comment"># SHOULDN'T  - 1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ans_l == ans_r:</span><br><span class="line">            ans_l = ans_r = <span class="number">-1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ans_r -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> (ans_l, ans_r)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bisect_right</span><span class="params">(a, x, lo=<span class="number">0</span>, hi=None)</span>:</span></span><br><span class="line">    <span class="string">"""Return the index where to insert item x in list a, assuming a is sorted.</span></span><br><span class="line"><span class="string">    The return value i is such that all e in a[:i] have e &lt;= x, and all e in</span></span><br><span class="line"><span class="string">    a[i:] have e &gt; x.  So if x already appears in the list, a.insert(x) will</span></span><br><span class="line"><span class="string">    insert just after the rightmost x already there.</span></span><br><span class="line"><span class="string">    Optional args lo (default 0) and hi (default len(a)) bound the</span></span><br><span class="line"><span class="string">    slice of a to be searched.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> lo &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">'lo must be non-negative'</span>)</span><br><span class="line">    <span class="keyword">if</span> hi <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        hi = len(a)</span><br><span class="line">    <span class="keyword">while</span> lo &lt; hi:</span><br><span class="line">        mid = (lo+hi)//<span class="number">2</span></span><br><span class="line">        <span class="comment"># Use __lt__ to match the logic in list.sort() and in heapq</span></span><br><span class="line">        <span class="keyword">if</span> x &lt; a[mid]: hi = mid</span><br><span class="line">        <span class="keyword">else</span>: lo = mid+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> lo</span><br></pre></td></tr></table></figure>



<h5 id="W-O-Bisect"><a href="#W-O-Bisect" class="headerlink" title="W/O Bisect"></a>W/O Bisect</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">searchRange</span><span class="params">(self, nums, target)</span>:</span></span><br><span class="line">        n = len(nums)</span><br><span class="line">        left, right = <span class="number">-1</span>, <span class="number">-1</span></span><br><span class="line">        l, r = <span class="number">0</span>, n<span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            m = (l+r)/<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> nums[m] &lt; target: l = m+<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>: r = m</span><br><span class="line">        <span class="keyword">if</span> nums[l] != target: <span class="keyword">return</span> <span class="number">-1</span>, <span class="number">-1</span></span><br><span class="line">        left = l</span><br><span class="line">        l, r = left, n<span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            m = (l+r)/<span class="number">2</span>+<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> nums[m] == target: l = m</span><br><span class="line">            <span class="keyword">else</span>: r = m<span class="number">-1</span></span><br><span class="line">        right = l</span><br><span class="line">        <span class="keyword">return</span> left, right</span><br></pre></td></tr></table></figure>



<h3 id="35"><a href="#35" class="headerlink" title="35"></a><a name="35">35</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">searchInsert</span><span class="params">(self, nums: List[int], target: int)</span> -&gt; int:</span></span><br><span class="line">        l = <span class="number">0</span></span><br><span class="line">        r = len(nums)<span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            mid = (l + r)//<span class="number">2</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> target == nums[mid]:</span><br><span class="line">                <span class="keyword">return</span> mid</span><br><span class="line">            <span class="keyword">elif</span> target &lt;= nums[mid]:</span><br><span class="line">                r = mid<span class="number">-1</span></span><br><span class="line">            <span class="keyword">else</span>: </span><br><span class="line">                l = mid+<span class="number">1</span></span><br><span class="line">        <span class="comment"># res = l if nums[l]&gt;target else l-1 </span></span><br><span class="line">        <span class="keyword">if</span> target &gt; nums[l]:</span><br><span class="line">            res = l+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res = l</span><br><span class="line">        <span class="keyword">return</span> res    <span class="comment">### 該思考比mid大或小的時候；還有該思考邊界條件時</span></span><br></pre></td></tr></table></figure>



<h3 id="42"><a href="#42" class="headerlink" title="42"></a><a name="42">42</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">trap</span><span class="params">(self, height: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="comment"># height = [0,1,0,2,1,0,1,3,2,1,2,1]</span></span><br><span class="line">        <span class="comment"># l_max =  [0 0 1 1 2 2 2 2 3 3 3 3]</span></span><br><span class="line">        <span class="comment"># r_max =  [3 3 3 3 3 3 3 2 2 2 1 0]</span></span><br><span class="line">        <span class="comment"># min_nbr = min(l_max[i], r_max[i])</span></span><br><span class="line">        <span class="comment"># water[i] = height[i] &lt; min_nbr ? (min_nbr-height[i]) * 1:0</span></span><br><span class="line">        <span class="comment"># return sum(water)</span></span><br><span class="line">    </span><br><span class="line">        n = len(height)</span><br><span class="line">        l_max = [<span class="number">0</span>] * n</span><br><span class="line">        cur_max = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            l_max[i] = cur_max</span><br><span class="line">            cur_max = max(height[i], cur_max)</span><br><span class="line">            </span><br><span class="line">        r_max = [<span class="number">0</span>] * n</span><br><span class="line">        cur_max = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> reversed(range(n)):</span><br><span class="line">            r_max[j] = cur_max</span><br><span class="line">            cur_max = max(height[j], cur_max)</span><br><span class="line">            </span><br><span class="line">        </span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(n):</span><br><span class="line">            min_nbr = min(l_max[k], r_max[k])</span><br><span class="line">            res += (min_nbr-height[k])*<span class="number">1</span> <span class="keyword">if</span> height[k] &lt; min_nbr <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="46-amp-47"><a href="#46-amp-47" class="headerlink" title="46 &amp; 47"></a><a name="46">46</a> &amp; <a name="47">47</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">permuteUnique</span><span class="params">(self, nums: List[int])</span> -&gt; List[List[int]]:</span></span><br><span class="line">        c_map = Counter(nums)</span><br><span class="line">        <span class="comment"># 1: 2</span></span><br><span class="line">        <span class="comment"># 2: 1</span></span><br><span class="line">        keys = sorted(dict(c_map))  <span class="comment">#[1, 2]</span></span><br><span class="line">        arr = []</span><br><span class="line">        counts = []</span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> keys:</span><br><span class="line">            arr.append(key)     <span class="comment"># [1, 2]</span></span><br><span class="line">            counts.append(c_map[key])   <span class="comment"># [2, 1]</span></span><br><span class="line">        item = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums))]</span><br><span class="line">        self.result = []</span><br><span class="line">        self.helper(arr, counts, item, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> self.result</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, arr, counts, item, level)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> len(item) == level:</span><br><span class="line">            <span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> self.result:</span><br><span class="line">                self.result.append(item.copy())</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(arr)):</span><br><span class="line">            <span class="keyword">if</span> counts[i] == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="comment"># item.append(arr[i])</span></span><br><span class="line">            item[level] = arr[i]</span><br><span class="line">            counts[i] -= <span class="number">1</span></span><br><span class="line">            self.helper(arr, counts.copy(), item.copy(), level+<span class="number">1</span>)</span><br><span class="line">            counts[i] += <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h3 id="49"><a href="#49" class="headerlink" title="49"></a><a name="49">49</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># def __init__(self):</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">groupAnagrams</span><span class="params">(self, strs: List[str])</span> -&gt; List[List[str]]:</span></span><br><span class="line">        </span><br><span class="line">        d = &#123;&#125;</span><br><span class="line">        <span class="comment"># build a one-hot mapping </span></span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> strs:</span><br><span class="line">            onehot = self.chars2onehot(s)</span><br><span class="line">            <span class="comment"># if onehot not in d: # unhashable type: 'list' CAUTIOUS! should turn into tuple for hashable</span></span><br><span class="line">            <span class="keyword">if</span> tuple(onehot) <span class="keyword">not</span> <span class="keyword">in</span> d:</span><br><span class="line">                d[tuple(onehot)] = [s]  <span class="comment"># [100101] ==&gt; eat</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                d[tuple(onehot)].append(s)</span><br><span class="line">            <span class="comment"># d[onehot] = d.get(onehot, 0) + 1</span></span><br><span class="line">            <span class="comment"># &#123;[1 0 0 0 0 1 0 0 1 0 ]&#125;</span></span><br><span class="line">        </span><br><span class="line">        ret = []</span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> d.keys():</span><br><span class="line">            ret.append(d[key])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">chars2onehot</span><span class="params">(self, s)</span>:</span></span><br><span class="line">        onehot = [<span class="number">0</span>] * <span class="number">26</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">            onehot[ord(c)<span class="number">-97</span>] += <span class="number">1</span>  <span class="comment"># 97 is ord('a') CAUTIOUS!!</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> onehot</span><br></pre></td></tr></table></figure>



<h3 id="56"><a href="#56" class="headerlink" title="56"></a><a name="56">56</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18</span></span><br><span class="line"><span class="string">  *---*</span></span><br><span class="line"><span class="string"> cur_i cur_j</span></span><br><span class="line"><span class="string">    *-------*</span></span><br><span class="line"><span class="string">    tmp_i   cur_j</span></span><br><span class="line"><span class="string">                   *---*</span></span><br><span class="line"><span class="string">               tmp_i   tmp_j</span></span><br><span class="line"><span class="string">                                    *--------*</span></span><br><span class="line"><span class="string">start i to end j</span></span><br><span class="line"><span class="string">push (i,j) into priority que, so that the min-heap use i as key</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">while min-heap:</span></span><br><span class="line"><span class="string">    pop the (i, j) pair and if curr j &gt; than next i of pop() from min-heap, keep poping()</span></span><br><span class="line"><span class="string">    if j &lt;= next i:</span></span><br><span class="line"><span class="string">        count += 1</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">merge</span><span class="params">(self, intervals: List[List[int]])</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> intervals:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        l = []</span><br><span class="line">        intervals = sorted(intervals)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># for idx in range(len(intervals)):</span></span><br><span class="line">        <span class="comment">#     heapq.heappush(l, intervals[idx])         # n*lg(n)</span></span><br><span class="line">        heapq.heapify(intervals)    <span class="comment"># O(n)</span></span><br><span class="line">        l, h = heapq.heappop(intervals)</span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">while</span> intervals:</span><br><span class="line">            next_int = heapq.heappop(intervals)</span><br><span class="line">            <span class="keyword">if</span> next_int[<span class="number">0</span>] &lt;= h:        <span class="comment"># CAUTIOUS, SHOULD BE '='</span></span><br><span class="line">                h = max(h, next_int[<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append([l, h])          </span><br><span class="line">                l = next_int[<span class="number">0</span>]</span><br><span class="line">                h = next_int[<span class="number">1</span>]</span><br><span class="line">        result.append([l, h])    </span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>



<h3 id="71"><a href="#71" class="headerlink" title="71"></a><a name="71">71</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">simplifyPath</span><span class="params">(self, path: str)</span> -&gt; str:</span></span><br><span class="line">        stack = list()</span><br><span class="line">        path = [p <span class="keyword">for</span> p <span class="keyword">in</span> path.split(<span class="string">'/'</span>) <span class="keyword">if</span> p]</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> path:</span><br><span class="line">            <span class="keyword">if</span> f == <span class="string">'.'</span>: </span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">elif</span> f == <span class="string">'..'</span>: </span><br><span class="line">                <span class="keyword">if</span> stack: </span><br><span class="line">                    stack.pop()</span><br><span class="line">            <span class="keyword">else</span>: </span><br><span class="line">                stack.append(f)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'/'</span>+<span class="string">'/'</span>.join(stack)</span><br></pre></td></tr></table></figure>



<h3 id="74"><a href="#74" class="headerlink" title="74"></a><a name="74">74</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">searchMatrix</span><span class="params">(self, matrix: List[List[int]], target: int)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> matrix <span class="keyword">or</span> <span class="keyword">not</span> matrix[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        i, j = <span class="number">0</span>, len(matrix[<span class="number">0</span>])<span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; len(matrix) <span class="keyword">and</span> j &gt;= <span class="number">0</span>: <span class="comment"># target != curr:</span></span><br><span class="line">            curr = matrix[i][j]</span><br><span class="line">            print(curr)</span><br><span class="line">            <span class="keyword">if</span> curr &gt; target:   <span class="comment"># 7 &gt; 3</span></span><br><span class="line">                j = j - <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> curr &lt; target:    <span class="comment"># 7 &lt; 13</span></span><br><span class="line">                i = i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>



<h3 id="78"><a href="#78" class="headerlink" title="78"></a><a name ="78">78</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">subsets</span><span class="params">(self, nums: List[int])</span> -&gt; List[List[int]]:</span></span><br><span class="line">        result = [[]]</span><br><span class="line">        self.helper(<span class="number">0</span>, nums, [], result)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, i, nums, item, result)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= len(nums):</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        item += [nums[i]]</span><br><span class="line">        result.append(item)</span><br><span class="line">        self.helper(i+<span class="number">1</span>, nums, item.copy(), result)</span><br><span class="line">        item = item[:<span class="number">-1</span>]</span><br><span class="line">        self.helper(i+<span class="number">1</span>, nums, item.copy(), result)</span><br></pre></td></tr></table></figure>



<h3 id="83"><a href="#83" class="headerlink" title="83"></a><a name="83">83</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">deleteDuplicates</span><span class="params">(self, head: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head :</span><br><span class="line">            <span class="keyword">return</span> head</span><br><span class="line"></span><br><span class="line">        cur = head</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> cur.next:</span><br><span class="line">            <span class="keyword">if</span> cur.next.val == cur.val: <span class="comment"># TODO check cur.next</span></span><br><span class="line">                cur.next = cur.next.next</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur = cur.next</span><br><span class="line">        <span class="keyword">return</span> head</span><br></pre></td></tr></table></figure>



<h3 id="88"><a href="#88" class="headerlink" title="88"></a><a name="88">88</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">merge</span><span class="params">(self, nums1: List[int], m: int, nums2: List[int], n: int)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Do not return anything, modify nums1 in-place instead.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> len(nums1) &lt; len(nums2):</span><br><span class="line">            nums1, nums2 = nums2, nums1</span><br><span class="line">            </span><br><span class="line">        num_zeros = len(nums1) - len(nums2)</span><br><span class="line">        idx_1 = num_zeros - <span class="number">1</span></span><br><span class="line">        idx_2 = len(nums2) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        k = <span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> idx_1 &gt;= <span class="number">0</span> <span class="keyword">and</span> idx_2 &gt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> nums1[idx_1] &gt;= nums2[idx_2]: <span class="comment"># CAUTIOUS! case of "="</span></span><br><span class="line">                nums1[k] = nums1[idx_1]</span><br><span class="line">                idx_1 -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> nums1[idx_1] &lt; nums2[idx_2]:</span><br><span class="line">                nums1[k] = nums2[idx_2]            </span><br><span class="line">                idx_2 -= <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">            k -= <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">        <span class="comment"># if idx_2 &lt; 0:</span></span><br><span class="line">        <span class="comment">#     nums1[0:len(nums1)+k] = nums1[:]</span></span><br><span class="line">        <span class="keyword">if</span> idx_1 &lt; <span class="number">0</span>:</span><br><span class="line">            nums1[<span class="number">0</span>:len(nums1)+k+<span class="number">1</span>] = nums2[<span class="number">0</span>:idx_2+<span class="number">1</span>]</span><br></pre></td></tr></table></figure>



<h3 id="92"><a href="#92" class="headerlink" title="92"></a><a name="92">92</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverseBetween</span><span class="params">(self, head: ListNode, m: int, n: int)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> m == n:</span><br><span class="line">            <span class="keyword">return</span> head</span><br><span class="line">        </span><br><span class="line">        dummy = ListNode(<span class="number">0</span>)</span><br><span class="line">        dummy.next = head</span><br><span class="line">        cur = dummy</span><br><span class="line">        prev = <span class="literal">None</span></span><br><span class="line">        k = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> k &lt; m:</span><br><span class="line">            prev = cur</span><br><span class="line">            cur = cur.next</span><br><span class="line">            k += <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">        <span class="comment"># self.reverseList(start, end)</span></span><br><span class="line">        start = self.reverseList(cur, m, n)</span><br><span class="line">        prev.next = start    </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverseList</span><span class="params">(self, head: ListNode, m, n)</span>:</span><span class="comment">#end: ListNode) -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span> head</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># X X X</span></span><br><span class="line">        cur = head</span><br><span class="line">        dummy = ListNode(<span class="number">0</span>)</span><br><span class="line">        dummy.next = cur</span><br><span class="line">        <span class="comment"># prev.next = cur</span></span><br><span class="line">        count = n - m</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> count:</span><br><span class="line">        <span class="comment"># while cur.next != end:</span></span><br><span class="line">            tmp = cur.next</span><br><span class="line">            cur.next = tmp.next</span><br><span class="line">            tmp.next = dummy.next</span><br><span class="line">            dummy.next = tmp</span><br><span class="line">            <span class="comment"># cur = tmp</span></span><br><span class="line">            count -= <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br></pre></td></tr></table></figure>



<h3 id="94"><a href="#94" class="headerlink" title="94"></a><a name="94">94</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inorderTraversal</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        ans = []</span><br><span class="line">        stack = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> stack <span class="keyword">or</span> root:</span><br><span class="line">            <span class="keyword">if</span> root:</span><br><span class="line">                stack.append(root)</span><br><span class="line">                root = root.left</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tmpNode = stack.pop()</span><br><span class="line">                ans.append(tmpNode.val)</span><br><span class="line">                root = tmpNode.right</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">    </span><br><span class="line">    <span class="string">''' Recursive</span></span><br><span class="line"><span class="string">    def inorderTraversal(self, root: TreeNode) -&gt; List[int]:</span></span><br><span class="line"><span class="string">        if not root:</span></span><br><span class="line"><span class="string">            return []</span></span><br><span class="line"><span class="string">        self.res = []</span></span><br><span class="line"><span class="string">        self.helper(root)</span></span><br><span class="line"><span class="string">        return self.res</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    def helper(self, node):</span></span><br><span class="line"><span class="string">        if not node:</span></span><br><span class="line"><span class="string">            return </span></span><br><span class="line"><span class="string">        self.helper(node.left)</span></span><br><span class="line"><span class="string">        self.res.append(node.val)</span></span><br><span class="line"><span class="string">        self.helper(node.right)</span></span><br><span class="line"><span class="string">    '''</span></span><br></pre></td></tr></table></figure>



<h3 id="98"><a href="#98" class="headerlink" title="98"></a><a name="98">98</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># def isValidBST(self, root: TreeNode) -&gt; bool:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValidBST</span><span class="params">(self, root, lo=float<span class="params">(<span class="string">'-inf'</span>)</span>, hi=float<span class="params">(<span class="string">'inf'</span>)</span>)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type root: TreeNode</span></span><br><span class="line"><span class="string">        :rtype: bool</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> lo &lt; root.val &lt; hi:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.isValidBST(root.left, lo, min(root.val, hi)) <span class="keyword">and</span> \</span><br><span class="line">               self.isValidBST(root.right, max(lo, root.val), hi)</span><br></pre></td></tr></table></figure>



<h3 id="101"><a href="#101" class="headerlink" title="101"></a><a name="101">101</a></h3><h5 id="BFS"><a href="#BFS" class="headerlink" title="BFS"></a>BFS</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isSymmetric</span><span class="params">(self, root: TreeNode)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        </span><br><span class="line">        Q = deque()</span><br><span class="line">        Q.append(root)</span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            level_len = len(Q)</span><br><span class="line">            level_l = []</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(level_len):</span><br><span class="line">                v = Q.popleft()</span><br><span class="line">                <span class="comment"># level_l.append(v.val) # CRUCIAL!!!</span></span><br><span class="line">                <span class="keyword">if</span> v.left:</span><br><span class="line">                    Q.append(v.left)</span><br><span class="line">                    level_l.append(v.left.val)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    level_l.append(<span class="literal">None</span>)</span><br><span class="line">                <span class="keyword">if</span> v.right:</span><br><span class="line">                    Q.append(v.right)</span><br><span class="line">                    level_l.append(v.right.val)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    level_l.append(<span class="literal">None</span>)</span><br><span class="line">                <span class="comment"># level_l.append(v.left)  # CRUCIAL!!! 麻煩！！！……　之後的list裡無法比較</span></span><br><span class="line">                <span class="comment"># level_l.append(v.right) # CRUCIAL!!!</span></span><br><span class="line">                    </span><br><span class="line">            <span class="keyword">if</span> len(level_l) &gt; <span class="number">1</span>:</span><br><span class="line">                mid = len(level_l)//<span class="number">2</span></span><br><span class="line">                print(level_l)</span><br><span class="line">                <span class="keyword">if</span> level_l[:mid] != level_l[mid:][::<span class="number">-1</span>]:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h5 id="Recursive"><a href="#Recursive" class="headerlink" title="Recursive"></a>Recursive</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isSymmetric</span><span class="params">(self, root: TreeNode)</span> -&gt; bool:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">isSymmetricHelper</span><span class="params">(left,right)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> left <span class="keyword">and</span> <span class="keyword">not</span> right:<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> right <span class="keyword">or</span> <span class="keyword">not</span> left:<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">if</span> left.val!=right.val:<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">return</span> isSymmetricHelper(left.left,right.right) <span class="keyword">and</span> \</span><br><span class="line">        isSymmetricHelper(left.right,right.left)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:<span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> isSymmetricHelper(root.left,root.right)</span><br></pre></td></tr></table></figure>



<h3 id="102"><a href="#102" class="headerlink" title="102"></a><a name="102">102</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">levelOrder</span><span class="params">(self, root: TreeNode)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        que = deque([root])</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">while</span> que:</span><br><span class="line">            <span class="comment"># node = que.popleft()</span></span><br><span class="line">            level_length = len(que)</span><br><span class="line">            level_res = []</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(level_length):</span><br><span class="line">                node = que.popleft()</span><br><span class="line">                level_res.append(node.val)</span><br><span class="line">                <span class="keyword">if</span> node.left:</span><br><span class="line">                    <span class="comment"># level_l.append(node.left)</span></span><br><span class="line">                    que.append(node.left)</span><br><span class="line">                <span class="keyword">if</span> node.right:</span><br><span class="line">                    <span class="comment"># level_l.append(node.right)</span></span><br><span class="line">                    que.append(node.right)</span><br><span class="line">            </span><br><span class="line">            res.append(level_res.copy())</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="104"><a href="#104" class="headerlink" title="104"></a><a name="104">104</a></h3><h5 id="Bottom-Up"><a href="#Bottom-Up" class="headerlink" title="Bottom-Up"></a>Bottom-Up</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxDepth</span><span class="params">(self, root: TreeNode)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.height(root)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">height</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        l = self.height(root.left)</span><br><span class="line">        r = self.height(root.right)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> + max(l, r)</span><br></pre></td></tr></table></figure>

<h5 id="Top-Down"><a href="#Top-Down" class="headerlink" title="Top-Down"></a>Top-Down</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxDepth</span><span class="params">(self, root: TreeNode)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root: </span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> self.topdown(root, <span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">topdown</span><span class="params">(self, node, level)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> node:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> node.left <span class="keyword">and</span> <span class="keyword">not</span> node.right:</span><br><span class="line">            <span class="keyword">return</span> level</span><br><span class="line">        </span><br><span class="line">        l = self.topdown(node.left, level+<span class="number">1</span>)</span><br><span class="line">        r = self.topdown(node.right, level+<span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> max(l, r)</span><br><span class="line">    </span><br><span class="line"><span class="comment">#     def maxDepth(self, root: TreeNode) -&gt; int:</span></span><br><span class="line"><span class="comment">#         if not root:</span></span><br><span class="line"><span class="comment">#             return 0</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#         return self.height(root)</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#     def height(self, root):</span></span><br><span class="line"><span class="comment">#         if not root:</span></span><br><span class="line"><span class="comment">#             return 0</span></span><br><span class="line"><span class="comment">#         l = self.height(root.left)</span></span><br><span class="line"><span class="comment">#         r = self.height(root.right)</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#         return 1 + max(l, r)</span></span><br></pre></td></tr></table></figure>



<h3 id="105"><a href="#105" class="headerlink" title=" 105"></a><a name="105"> 105</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># preorder: [3,9,20]</span></span><br><span class="line"><span class="comment"># inorder:  [9,3,20]</span></span><br><span class="line">    <span class="number">3</span></span><br><span class="line">   / \</span><br><span class="line">  <span class="number">9</span>  <span class="number">20</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">buildTree</span><span class="params">(self, inorder, preorder)</span>:</span></span><br><span class="line">		<span class="keyword">if</span> <span class="keyword">not</span> inorder:</span><br><span class="line">      <span class="keyword">return</span> inorder</span><br><span class="line">    <span class="comment">#val = preorder.pop(0)</span></span><br><span class="line">    <span class="comment">#idx = inorder.index(val)	# lg(n)</span></span><br><span class="line">    <span class="comment">#result = node = TreeNode(inorder[idx])</span></span><br><span class="line">    <span class="comment">#result = TreeNode(-1)</span></span><br><span class="line">    root = self.build(inorder, preorder)<span class="comment">#, None, result)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> root</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">build</span><span class="params">(self, inorder, preorder)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> node:</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    val = inorder.index(preorder.pop(<span class="number">0</span>))</span><br><span class="line">    <span class="comment">#result = item</span></span><br><span class="line">    item = root = TreeNode(val)</span><br><span class="line">    root.left = self.build(inorder[:mid], preorder)</span><br><span class="line">    root.right = self.build(inorder[mid+<span class="number">1</span>:], preorder)</span><br><span class="line">		</span><br><span class="line">    <span class="keyword">return</span> root</span><br></pre></td></tr></table></figure>



<h3 id="109-amp-108"><a href="#109-amp-108" class="headerlink" title="109 &amp; 108"></a><a name="109">109</a> &amp; <a name="108">108</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sortedListToBST</span><span class="params">(self, head: ListNode)</span> -&gt; TreeNode:</span></span><br><span class="line">        tree = []</span><br><span class="line">        <span class="keyword">while</span> head:</span><br><span class="line">            tree.append(head.val)</span><br><span class="line">            head = head.next</span><br><span class="line">    		<span class="comment"># 下面這塊是單就 108</span></span><br><span class="line">    		root = self.constructTree(tree)        </span><br><span class="line">        <span class="keyword">return</span> root</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">constructTree</span><span class="params">(self, tree)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> tree:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        mid = len(tree)//<span class="number">2</span></span><br><span class="line">        root = TreeNode(tree[mid])</span><br><span class="line">        root.left = self.constructTree(tree[:mid])</span><br><span class="line">        root.right = self.constructTree(tree[mid+<span class="number">1</span>:])</span><br><span class="line">        <span class="keyword">return</span> root</span><br></pre></td></tr></table></figure>



<h3 id="110"><a href="#110" class="headerlink" title="110"></a><a name="110">110</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isBalanced</span><span class="params">(self, root: TreeNode)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># if not root.left and not root.right:</span></span><br><span class="line">        <span class="comment">#     return True</span></span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">height</span><span class="params">(node)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> node:</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            l = height(node.left)</span><br><span class="line">            r = height(node.right)</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span> + max(l, r)</span><br><span class="line">        </span><br><span class="line">        L = height(root.left)</span><br><span class="line">        R = height(root.right)</span><br><span class="line">        <span class="comment"># return abs(L-R) &lt;= 1 and height(root.left) and height(root.right)</span></span><br><span class="line">        <span class="keyword">return</span> abs(L-R) &lt;= <span class="number">1</span> <span class="keyword">and</span> self.isBalanced(root.left) <span class="keyword">and</span> self.isBalanced(root.right)</span><br></pre></td></tr></table></figure>



<h3 id="111"><a href="#111" class="headerlink" title="111"></a><a name="111">111</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minDepth</span><span class="params">(self, root: TreeNode)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> self.helper(root)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> root.left <span class="keyword">and</span> root.right:</span><br><span class="line">            ans = min(self.helper(root.right), self.helper(root.left)) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># if not root.left and not root.right:</span></span><br><span class="line">            <span class="comment">#     ans = 0</span></span><br><span class="line">            <span class="comment"># elif (not root.left and root.right) or (root.left and not root.right):</span></span><br><span class="line">            l = self.helper(root.left)</span><br><span class="line">            r = self.helper(root.right)</span><br><span class="line">            ans = <span class="number">1</span> + max(l, r)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>



<h3 id="112"><a href="#112" class="headerlink" title="112"></a><a name="112">112</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">de = [(root, sum - root.val), ]</span><br><span class="line"><span class="keyword">while</span> de:</span><br><span class="line">    node, curr_sum = de.pop()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> node.left <span class="keyword">and</span> <span class="keyword">not</span> node.right <span class="keyword">and</span> curr_sum == <span class="number">0</span>:  </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> node.right:</span><br><span class="line">        de.append((node.right, curr_sum - node.right.val))</span><br><span class="line">    <span class="keyword">if</span> node.left:</span><br><span class="line">        de.append((node.left, curr_sum - node.left.val))</span><br><span class="line"><span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>



<h3 id="113"><a href="#113" class="headerlink" title="113"></a><a name="113">113</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pathSum</span><span class="params">(self, root: TreeNode, sum: int)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        self.sum = sum</span><br><span class="line">        result = []</span><br><span class="line">        self.pre(root, [], result)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pre</span><span class="params">(self, node, items, result)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> node:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        items.append(node.val)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> node.left <span class="keyword">and</span> <span class="keyword">not</span> node.right <span class="keyword">and</span> sum(items) == self.sum:</span><br><span class="line">            result.append(items.copy())</span><br><span class="line">            <span class="comment"># return    # CAN't return here, since items needs to POP</span></span><br><span class="line">            </span><br><span class="line">        self.pre(node.left, items, result)</span><br><span class="line">        self.pre(node.right, items, result)</span><br><span class="line">        items.pop() <span class="comment"># should be post-order</span></span><br></pre></td></tr></table></figure>



<h3 id="121"><a href="#121" class="headerlink" title="121"></a><a name="121">121</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="comment"># dp[0] = 7</span></span><br><span class="line">        <span class="comment"># dp[1] = prices[1]&gt;prices[0]?diff(prices[1], prices[0]), 0</span></span><br><span class="line">        <span class="comment"># dp[2] = max(prices[2]-curr_min, g_max_profit)</span></span><br><span class="line">        <span class="comment"># curr_min to record minimum</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> prices:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        cur_min = prices[<span class="number">0</span>]</span><br><span class="line">        max_profit = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(prices)):</span><br><span class="line">            cur_min = min(cur_min, prices[i])</span><br><span class="line">            max_profit = max(max_profit, prices[i]-cur_min)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> max_profit</span><br></pre></td></tr></table></figure>



<h3 id="122"><a href="#122" class="headerlink" title="122"></a><a name="122">122</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(prices)<span class="number">-1</span>):</span><br><span class="line">               <span class="keyword">if</span> prices[i+<span class="number">1</span>]  &gt; prices[i]:</span><br><span class="line">                    res += prices[i+<span class="number">1</span>] - prices[i]</span><br><span class="line">                    </span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="133"><a href="#133" class="headerlink" title="133"></a><a name="133">133</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string"># Definition for a Node.</span></span><br><span class="line"><span class="string">class Node:</span></span><br><span class="line"><span class="string">    def __init__(self, val = 0, neighbors = []):</span></span><br><span class="line"><span class="string">        self.val = val</span></span><br><span class="line"><span class="string">        self.neighbors = neighbors</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque, OrderedDict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cloneGraph</span><span class="params">(self, node: <span class="string">'Node'</span>)</span> -&gt; 'Node':</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> node:</span><br><span class="line">            <span class="keyword">return</span> node</span><br><span class="line">        Q = deque()</span><br><span class="line">        Q.append(node)</span><br><span class="line">        </span><br><span class="line">        visited = OrderedDict()</span><br><span class="line">        new_node = Node(node.val)</span><br><span class="line">        visited[node] = new_node</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            v_old = Q.popleft()</span><br><span class="line">            copy_v = visited[v_old]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> v_old: </span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">for</span> vn <span class="keyword">in</span> v_old.neighbors:</span><br><span class="line">                <span class="comment"># node = Node()</span></span><br><span class="line">                <span class="keyword">if</span> vn <span class="keyword">not</span> <span class="keyword">in</span> visited:    <span class="comment"># visited contains old nodes</span></span><br><span class="line">                    Q.append(vn)</span><br><span class="line">                    new_tmp = Node(vn.val)</span><br><span class="line">                    visited[vn] = new_tmp</span><br><span class="line">                    copy_v.neighbors.append(new_tmp)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    copy_v.neighbors.append(visited[vn]) </span><br><span class="line">        <span class="comment"># return new_node</span></span><br><span class="line">        <span class="keyword">return</span> visited[next(iter(visited))] <span class="comment"># same as return new_node</span></span><br><span class="line">                </span><br><span class="line">                <span class="comment"># nb_l.append()</span></span><br><span class="line">                <span class="comment"># nodenb_l</span></span><br></pre></td></tr></table></figure>



<h3 id="138"><a href="#138" class="headerlink" title="138"></a><a name="138">138</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string"># Definition for a Node.</span></span><br><span class="line"><span class="string">class Node:</span></span><br><span class="line"><span class="string">    def __init__(self, x: int, next: 'Node' = None, random: 'Node' = None):</span></span><br><span class="line"><span class="string">        self.val = int(x)</span></span><br><span class="line"><span class="string">        self.next = next</span></span><br><span class="line"><span class="string">        self.random = random</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">copyRandomList</span><span class="params">(self, head: <span class="string">'Node'</span>)</span> -&gt; 'Node':</span></span><br><span class="line">        queue = []</span><br><span class="line">        copy = &#123;&#125;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        queue.append(head)</span><br><span class="line">        copy[head] = Node(head.val,<span class="literal">None</span>,<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">while</span> queue:</span><br><span class="line">            cur = queue.pop(<span class="number">0</span>)</span><br><span class="line">            n,r = cur.next,cur.random</span><br><span class="line">            <span class="keyword">if</span> n:</span><br><span class="line">                <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> copy:</span><br><span class="line">                    copy[n] = Node(n.val,<span class="literal">None</span>,<span class="literal">None</span>)</span><br><span class="line">                queue.append(n)</span><br><span class="line">                copy[cur].next = copy[n]</span><br><span class="line">            <span class="keyword">if</span> r:</span><br><span class="line">                <span class="keyword">if</span> r <span class="keyword">not</span> <span class="keyword">in</span> copy:</span><br><span class="line">                    copy[r] = Node(r.val,<span class="literal">None</span>,<span class="literal">None</span>)</span><br><span class="line">                copy[cur].random = copy[r]</span><br><span class="line">        <span class="keyword">return</span> copy[head]</span><br></pre></td></tr></table></figure>

<h3 id="141"><a href="#141" class="headerlink" title="141"></a><a name="141">141</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode(object):</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasCycle</span><span class="params">(self, head)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type head: ListNode</span></span><br><span class="line"><span class="string">        :rtype: bool</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        </span><br><span class="line">        slow = head</span><br><span class="line">        fast = head</span><br><span class="line">        <span class="keyword">while</span> fast <span class="keyword">and</span> fast.next <span class="keyword">and</span> fast.next.next:</span><br><span class="line">            slow = slow.next</span><br><span class="line">            fast = fast.next.next</span><br><span class="line">            <span class="keyword">if</span> slow == fast:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h5 id="Try-amp-Exception"><a href="#Try-amp-Exception" class="headerlink" title="Try &amp; Exception"></a>Try &amp; Exception</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasCycle</span><span class="params">(self, head: ListNode)</span> -&gt; bool:</span></span><br><span class="line"></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type head: ListNode</span></span><br><span class="line"><span class="string">        :rtype: bool</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        slow = fast = head</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">while</span> fast:</span><br><span class="line">                slow = slow.next</span><br><span class="line">                fast = fast.next.next</span><br><span class="line">                <span class="keyword">if</span> slow == fast:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">						<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>





<h3 id="142"><a href="#142" class="headerlink" title="142"></a><a name="142">142</a></h3><img src="https://tva1.sinaimg.cn/large/006tNbRwgy1gbkum6l7r7j30zc0qkn5i.jpg" alt="image-20200205004643509" style="zoom:50%;" />

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># class Solution:</span></span><br><span class="line"><span class="comment">#     def detectCycle(self, head: ListNode) -&gt; ListNode:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getIntersect</span><span class="params">(self, head)</span>:</span></span><br><span class="line">        tortoise = head</span><br><span class="line">        hare = head</span><br><span class="line"></span><br><span class="line">        <span class="comment"># A fast pointer will either loop around a cycle and meet the slow</span></span><br><span class="line">        <span class="comment"># pointer or reach the `null` at the end of a non-cyclic list.</span></span><br><span class="line">        <span class="keyword">while</span> hare <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> hare.next <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            tortoise = tortoise.next</span><br><span class="line">            hare = hare.next.next</span><br><span class="line">            <span class="keyword">if</span> tortoise == hare:</span><br><span class="line">                <span class="keyword">return</span> tortoise</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">detectCycle</span><span class="params">(self, head)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> head <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># If there is a cycle, the fast/slow pointers will intersect at some</span></span><br><span class="line">        <span class="comment"># node. Otherwise, there is no cycle, so we cannot find an entrance to</span></span><br><span class="line">        <span class="comment"># a cycle.</span></span><br><span class="line">        intersect = self.getIntersect(head)</span><br><span class="line">        <span class="keyword">if</span> intersect <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># To find the entrance to the cycle, we have two pointers traverse at</span></span><br><span class="line">        <span class="comment"># the same speed -- one from the front of the list, and the other from</span></span><br><span class="line">        <span class="comment"># the point of intersection.</span></span><br><span class="line">        ptr1 = head</span><br><span class="line">        ptr2 = intersect</span><br><span class="line">        <span class="keyword">while</span> ptr1 != ptr2:</span><br><span class="line">            ptr1 = ptr1.next</span><br><span class="line">            ptr2 = ptr2.next</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ptr1</span><br></pre></td></tr></table></figure>



<h3 id="143"><a href="#143" class="headerlink" title="143"></a><a name="143">143</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reorderList</span><span class="params">(self, head: ListNode)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Do not return anything, modify head in-place instead.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span> head</span><br><span class="line">        </span><br><span class="line">        Q = deque()</span><br><span class="line">        cur = head</span><br><span class="line">        count = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> cur:</span><br><span class="line">            <span class="comment"># if count % 2 == 1:</span></span><br><span class="line">            Q.append(cur)</span><br><span class="line">            cur = cur.next</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        dummy = ListNode(<span class="number">0</span>)</span><br><span class="line">        cur = dummy</span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                v = Q.popleft()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                v = Q.pop()</span><br><span class="line">            print(v.val)</span><br><span class="line">            cur.next = v</span><br><span class="line">            cur = cur.next</span><br><span class="line">            <span class="comment"># cur.next = v</span></span><br><span class="line">            <span class="comment"># cur = cur.next</span></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        cur.next = <span class="literal">None</span>     <span class="comment"># CRUCIAL!!! or Cycle LinkedList</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br></pre></td></tr></table></figure>



<h3 id="144"><a href="#144" class="headerlink" title="144"></a><a name="144">144</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span>        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        res = []</span><br><span class="line">        stack = []</span><br><span class="line">        stack.append(root)</span><br><span class="line">        <span class="keyword">while</span> stack:</span><br><span class="line">            v = stack.pop()</span><br><span class="line">            res.append(v.val)</span><br><span class="line">            <span class="comment"># if v.left:</span></span><br><span class="line">            <span class="comment">#     stack.append(v.left)</span></span><br><span class="line">            <span class="comment"># if v.right:</span></span><br><span class="line">            <span class="comment">#     stack.append(v.right)</span></span><br><span class="line">            <span class="keyword">if</span> v.right:</span><br><span class="line">                stack.append(v.right)    </span><br><span class="line">            <span class="keyword">if</span> v.left:</span><br><span class="line">                stack.append(v.left)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># WRONG ! Following is BFS...</span></span><br><span class="line">        <span class="comment"># res = []</span></span><br><span class="line">        <span class="comment"># Q = deque()</span></span><br><span class="line">        <span class="comment"># Q.append(root)</span></span><br><span class="line">        <span class="comment"># while Q:</span></span><br><span class="line">        <span class="comment">#     v = Q.popleft()</span></span><br><span class="line">        <span class="comment">#     res.append(v.val)</span></span><br><span class="line">        <span class="comment">#     if v.left:</span></span><br><span class="line">        <span class="comment">#         Q.append(v.left)</span></span><br><span class="line">        <span class="comment">#     if v.right:</span></span><br><span class="line">        <span class="comment">#         Q.append(v.right)</span></span><br><span class="line">        <span class="comment"># return res</span></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">        <span class="string">''' recursive solution</span></span><br><span class="line"><span class="string">        self.res = []</span></span><br><span class="line"><span class="string">        self.helper(root)</span></span><br><span class="line"><span class="string">        return self.res</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    def helper(self, node):</span></span><br><span class="line"><span class="string">        if not node:</span></span><br><span class="line"><span class="string">            return</span></span><br><span class="line"><span class="string">        self.res.append(node.val)</span></span><br><span class="line"><span class="string">        self.helper(node.left)</span></span><br><span class="line"><span class="string">        self.helper(node.right)</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="comment"># l = []</span></span><br><span class="line">        <span class="comment"># l.append(root.val)</span></span><br><span class="line">        <span class="comment"># l += self.preorderTraversal(root.left)</span></span><br><span class="line">        <span class="comment"># l += self.preorderTraversal(root.right) </span></span><br><span class="line">        <span class="comment"># return l</span></span><br></pre></td></tr></table></figure>



<h3 id="145"><a href="#145" class="headerlink" title="145"></a><a name="145">145</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">postorderTraversal</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> root</span><br><span class="line">        res = []</span><br><span class="line">        S = [root]</span><br><span class="line">        <span class="keyword">while</span> S:</span><br><span class="line">            v = S.pop()</span><br><span class="line">            res.append(v.val)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> v.left:</span><br><span class="line">                S.append(v.left)</span><br><span class="line">            <span class="keyword">if</span> v.right:</span><br><span class="line">                S.append(v.right) </span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> res[::<span class="number">-1</span>] </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#     def postorderTraversal(self, root: TreeNode) -&gt; List[int]:</span></span><br><span class="line"><span class="comment">#         self.result = []</span></span><br><span class="line"><span class="comment">#         self.helper(root)</span></span><br><span class="line"><span class="comment">#         return self.result</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">#     def helper(self, node):</span></span><br><span class="line"><span class="comment">#         if not node:</span></span><br><span class="line"><span class="comment">#             return </span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#         self.helper(node.left)</span></span><br><span class="line"><span class="comment">#         self.helper(node.right)</span></span><br><span class="line"><span class="comment">#         self.result.append(node.val)</span></span><br></pre></td></tr></table></figure>



<h3 id="146"><a href="#146" class="headerlink" title="146"></a><a name="146">146</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LRUCache</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, capacity)</span>:</span></span><br><span class="line">        self.od = collections.OrderedDict()</span><br><span class="line">        self.cap = capacity</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, key)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">not</span> <span class="keyword">in</span> self.od: <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        val = self.od[key]</span><br><span class="line">        <span class="keyword">del</span> self.od[key]       <span class="comment"># 最近用到的在尾端</span></span><br><span class="line">        self.od[key] = val</span><br><span class="line">        <span class="keyword">return</span> val</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put</span><span class="params">(self, key, value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">in</span> self.od:</span><br><span class="line">            <span class="keyword">del</span> self.od[key]</span><br><span class="line">            self.od[key] = value</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># while len(self.od) &gt;= self.cap:</span></span><br><span class="line">            <span class="keyword">if</span> len(self.od) == self.cap:      <span class="comment"># 前面的最舊</span></span><br><span class="line">                toBeRemoved = next(iter(self.od))</span><br><span class="line">                <span class="keyword">del</span> self.od[toBeRemoved]</span><br><span class="line">            self.od[key] = value</span><br></pre></td></tr></table></figure>



<h3 id="161"><a href="#161" class="headerlink" title="161"></a><a name="161">161</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isOneEditDistance</span><span class="params">(self, s: str, t: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        不能使用Counter，因為char之間的順序也要被考慮進來……</span></span><br><span class="line"><span class="string">        以下的case就會 Failed...</span></span><br><span class="line"><span class="string">        "teacher"</span></span><br><span class="line"><span class="string">        "detacher"</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="keyword">if</span> s == t:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        l1, l2 = len(s), len(t)</span><br><span class="line">        <span class="keyword">if</span> l1 &gt; l2: <span class="comment"># force s no longer than t</span></span><br><span class="line">            <span class="keyword">return</span> self.isOneEditDistance(t, s)</span><br><span class="line">        <span class="keyword">if</span> l2 - l1 &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(s)):</span><br><span class="line">            <span class="keyword">if</span> s[i] != t[i]:</span><br><span class="line">                <span class="keyword">if</span> l1 == l2:</span><br><span class="line">                    s = s[:i]+t[i]+s[i+<span class="number">1</span>:]  <span class="comment"># replacement</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    s = s[:i]+t[i]+s[i:]  <span class="comment"># insertion</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> s == t <span class="keyword">or</span> s == t[:<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>



<h3 id="162"><a href="#162" class="headerlink" title="162"></a><a name="162">162</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">myPow</span><span class="params">(self, x: float, n: int)</span> -&gt; float:</span></span><br><span class="line">        <span class="string">''' TLE</span></span><br><span class="line"><span class="string">        res = 1.0</span></span><br><span class="line"><span class="string">        for _ in range(abs(n)):</span></span><br><span class="line"><span class="string">            if n &gt; 0:</span></span><br><span class="line"><span class="string">                res *= x</span></span><br><span class="line"><span class="string">            else:</span></span><br><span class="line"><span class="string">                res /= x</span></span><br><span class="line"><span class="string">        return res</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        </span><br><span class="line">        m = abs(n)</span><br><span class="line">        p, q = <span class="number">1</span>, x</span><br><span class="line">        <span class="keyword">while</span> m &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> (m &amp; <span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">                p *= q</span><br><span class="line">            m //= <span class="number">2</span></span><br><span class="line">            q *= q</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>/p <span class="keyword">if</span> n &lt; <span class="number">0</span> <span class="keyword">else</span> p</span><br></pre></td></tr></table></figure>



<h3 id="173"><a href="#173" class="headerlink" title="173"></a><a name="173">173</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BSTIterator</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, root: TreeNode)</span>:</span></span><br><span class="line">        self.l = []</span><br><span class="line">        self.trvs(root)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">trvs</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        heapq.heappush(self.l, root.val)</span><br><span class="line">        self.trvs(root.left)</span><br><span class="line">        self.trvs(root.right)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span> -&gt; int:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        @return the next smallest number</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> heapq.heappop(self.l)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasNext</span><span class="params">(self)</span> -&gt; bool:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        @return whether we have a next smallest number</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> self.l:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Your BSTIterator object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"># obj = BSTIterator(root)</span></span><br><span class="line"><span class="comment"># param_1 = obj.next()</span></span><br><span class="line"><span class="comment"># param_2 = obj.hasNext()</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BSTIterator</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, root: TreeNode)</span>:</span></span><br><span class="line">        self.l = []</span><br><span class="line">        self.trvs(root)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">trvs</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># heapq.heappush(self.l, root.val)</span></span><br><span class="line">        self.trvs(root.left)</span><br><span class="line">        self.l.append(root.val)</span><br><span class="line">        self.trvs(root.right)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">next</span><span class="params">(self)</span> -&gt; int:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        @return the next smallest number</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># return heapq.heappop(self.l)</span></span><br><span class="line">        <span class="keyword">return</span> self.l.pop(<span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasNext</span><span class="params">(self)</span> -&gt; bool:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        @return whether we have a next smallest number</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> self.l:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Your BSTIterator object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"># obj = BSTIterator(root)</span></span><br><span class="line"><span class="comment"># param_1 = obj.next()</span></span><br><span class="line"><span class="comment"># param_2 = obj.hasNext()</span></span><br></pre></td></tr></table></figure>





<h3 id="199"><a href="#199" class="headerlink" title="199"></a><a name="199">199</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rightSideView</span><span class="params">(self, root: TreeNode)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        </span><br><span class="line">        que = deque([root])</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">while</span> que:</span><br><span class="line">            leng_level = len(que)</span><br><span class="line">            level_l = []</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(leng_level):</span><br><span class="line">                v = que.popleft()</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> v:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                level_l.append(v.val)</span><br><span class="line">                <span class="keyword">if</span> v.left:</span><br><span class="line">                    que.append(v.left)</span><br><span class="line">                <span class="keyword">if</span> v.right:</span><br><span class="line">                    que.append(v.right)</span><br><span class="line">            res.append(level_l)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> [item[<span class="number">-1</span>] <span class="keyword">for</span> item <span class="keyword">in</span> res]</span><br></pre></td></tr></table></figure>



<h3 id="200"><a href="#200" class="headerlink" title="200"></a><a name="200">200</a></h3><h5 id="TLE…"><a href="#TLE…" class="headerlink" title="TLE…"></a>TLE…</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">1 1 1 1 0</span></span><br><span class="line"><span class="string">1 1 0 1 0</span></span><br><span class="line"><span class="string">1 1 0 1 0</span></span><br><span class="line"><span class="string">0 0 0 0 0</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># for </span></span><br><span class="line"><span class="comment">#     for </span></span><br><span class="line"><span class="comment">#         bfs_graph</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numIslands</span><span class="params">(self, grid: List[List[str]])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> grid <span class="keyword">or</span> <span class="keyword">not</span> grid[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># arr = [[0 for j in range(len(grid[0])+1)] for i in range(len(grid)+1)]</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        arr = np.pad(grid, ((<span class="number">1</span>,<span class="number">1</span>), (<span class="number">1</span>,<span class="number">1</span>)))</span><br><span class="line">        print(arr)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># for i in range(1, len(arr)):</span></span><br><span class="line">        <span class="comment">#     for j in range(1, len(arr[0])):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(arr)<span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, len(arr[<span class="number">0</span>])<span class="number">-1</span>):</span><br><span class="line">                <span class="keyword">if</span> arr[i][j] == <span class="string">'1'</span>:</span><br><span class="line">                    self.bfs((arr[i][j], i, j), arr)</span><br><span class="line">                    count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bfs</span><span class="params">(self, item, arr)</span>:</span></span><br><span class="line">        Q = deque()</span><br><span class="line">        Q.append(item)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            val, i, j = Q.popleft()</span><br><span class="line">            <span class="keyword">if</span> val == <span class="string">'1'</span>:</span><br><span class="line">                arr[i][j] = <span class="string">'0'</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">if</span> arr[i][j<span class="number">-1</span>] == <span class="string">'1'</span>:         <span class="comment"># '0' is True...</span></span><br><span class="line">                Q.append((arr[i][j<span class="number">-1</span>], i, j<span class="number">-1</span>))</span><br><span class="line">            <span class="keyword">if</span> arr[i<span class="number">-1</span>][j] == <span class="string">'1'</span>:</span><br><span class="line">                Q.append((arr[i<span class="number">-1</span>][j], i<span class="number">-1</span>, j))</span><br><span class="line">            <span class="keyword">if</span> arr[i][j+<span class="number">1</span>] == <span class="string">'1'</span>:</span><br><span class="line">                Q.append((arr[i][j+<span class="number">1</span>], i, j+<span class="number">1</span>))</span><br><span class="line">            <span class="keyword">if</span> arr[i+<span class="number">1</span>][j] == <span class="string">'1'</span>:</span><br><span class="line">                Q.append((arr[i+<span class="number">1</span>][j], i+<span class="number">1</span>, j))</span><br><span class="line">        </span><br><span class="line"><span class="comment"># should set arr[row][col] = 'x' right after Q.append!!! to Solve TLE</span></span><br></pre></td></tr></table></figure>

<h5 id="Fix-TLE"><a href="#Fix-TLE" class="headerlink" title="Fix TLE:"></a>Fix TLE:</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> Q:</span><br><span class="line">    val, i, j = Q.popleft()</span><br><span class="line">    <span class="keyword">if</span> val == <span class="string">'1'</span>:</span><br><span class="line">        arr[i][j] = <span class="string">'0'</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> arr[i][j<span class="number">-1</span>] == <span class="string">'1'</span>:         <span class="comment"># '0' is True...</span></span><br><span class="line">        Q.append((arr[i][j<span class="number">-1</span>], i, j<span class="number">-1</span>))</span><br><span class="line">        arr[i][j<span class="number">-1</span>] = <span class="string">'x'</span></span><br><span class="line">    <span class="keyword">if</span> arr[i<span class="number">-1</span>][j] == <span class="string">'1'</span>:</span><br><span class="line">        Q.append((arr[i<span class="number">-1</span>][j], i<span class="number">-1</span>, j))</span><br><span class="line">        arr[i<span class="number">-1</span>][j] = <span class="string">'x'</span></span><br><span class="line">    <span class="keyword">if</span> arr[i][j+<span class="number">1</span>] == <span class="string">'1'</span>:</span><br><span class="line">        Q.append((arr[i][j+<span class="number">1</span>], i, j+<span class="number">1</span>))</span><br><span class="line">        arr[i][j+<span class="number">1</span>] = <span class="string">'x'</span></span><br><span class="line">    <span class="keyword">if</span> arr[i+<span class="number">1</span>][j] == <span class="string">'1'</span>:</span><br><span class="line">        Q.append((arr[i+<span class="number">1</span>][j], i+<span class="number">1</span>, j))</span><br><span class="line">        arr[i+<span class="number">1</span>][j] = <span class="string">'x'</span></span><br></pre></td></tr></table></figure>



<h3 id="206"><a href="#206" class="headerlink" title="206"></a><a name="206">206</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverseList</span><span class="params">(self, head: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span> head</span><br><span class="line">        <span class="keyword">return</span> self.recursive(head, <span class="literal">None</span>)</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> self.helper(head)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># None 1 2 3 4 5</span></span><br><span class="line">    <span class="string">" Recursive "</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recursive</span><span class="params">(self, root, prev=None)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> prev</span><br><span class="line">        cur = root</span><br><span class="line">        tmp = cur.next</span><br><span class="line">        cur.next = prev</span><br><span class="line">        prev = cur</span><br><span class="line">        <span class="keyword">return</span> self.recursive(tmp, prev)</span><br><span class="line">        <span class="comment"># return </span></span><br><span class="line">        </span><br><span class="line">    <span class="string">" Iterative "</span>      </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        </span><br><span class="line">        dummy = ListNode(<span class="number">0</span>)</span><br><span class="line">        dummy.next = cur = root</span><br><span class="line">        prev = <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> cur:</span><br><span class="line">            tmp = cur.next</span><br><span class="line">            cur.next = prev</span><br><span class="line">            prev = cur </span><br><span class="line">            cur = tmp</span><br><span class="line">        <span class="keyword">return</span> prev</span><br></pre></td></tr></table></figure>



<h3 id="207-TBP"><a href="#207-TBP" class="headerlink" title="207 TBP"></a><a name="207">207</a> TBP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># exmample: 4, [[1,0],[2,0],[3,1],[3,2]]</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">canFinish</span><span class="params">(self, numCourses: int, prerequisites: List[List[int]])</span> -&gt; bool:</span></span><br><span class="line">        n = numCourses</span><br><span class="line">        G = [[] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        degrees = [<span class="number">0</span>] * n</span><br><span class="line">        <span class="keyword">for</span> j, i <span class="keyword">in</span> prerequisites:</span><br><span class="line">            G[i].append(j)</span><br><span class="line">            degrees[j] += <span class="number">1</span>    </span><br><span class="line">    </span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        0 -&gt; 1 ------&gt; 3</span></span><br><span class="line"><span class="string">          \        /</span></span><br><span class="line"><span class="string">            -&gt; 2 --</span></span><br><span class="line"><span class="string">            idx    0 1 2 3</span></span><br><span class="line"><span class="string">        degrees = [0 1 1 2]</span></span><br><span class="line"><span class="string">        G = [[1,2], [3], [3], []]</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Q = [0]</span></span><br><span class="line"><span class="string">            idx</span></span><br><span class="line"><span class="string">        '''</span> </span><br><span class="line">        Q = deque([])</span><br><span class="line">        [Q.append(idx) <span class="keyword">for</span> idx, degree <span class="keyword">in</span> enumerate(degrees) <span class="keyword">if</span> degree == <span class="number">0</span>]        </span><br><span class="line">        visited = []</span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            v_idx = Q.popleft()    </span><br><span class="line">            <span class="comment"># visited.append[v_idx]</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(G[v_idx])):</span><br><span class="line">                next_v_idx = G[v_idx][j] <span class="comment"># 1, then 2</span></span><br><span class="line">                degrees[next_v_idx] -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> degrees[next_v_idx] == <span class="number">0</span>:</span><br><span class="line">                    Q.append(next_v_idx)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> any(degrees) <span class="comment"># check whether any element in degrees is larger than 0</span></span><br></pre></td></tr></table></figure>



<h3 id="208"><a href="#208" class="headerlink" title="208"></a><a name="208">208</a></h3><p>2/27</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrieNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.children = [<span class="literal">None</span>]*<span class="number">26</span></span><br><span class="line">        self.is_end = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Trie</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Initialize your data structure here.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.root = TrieNode()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insert</span><span class="params">(self, word: str)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Inserts a word into the trie.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        node = self.root</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(word)):</span><br><span class="line">            offset = ord(word[i]) - ord(<span class="string">'a'</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> node.children[offset]:   <span class="comment"># IMPORTANT</span></span><br><span class="line">                node.children[offset] = TrieNode()</span><br><span class="line">            node = node.children[offset]</span><br><span class="line">        node.is_end = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(self, word: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Returns if the word is in the trie.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        node = self.root</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(word)):</span><br><span class="line">            offset = ord(word[i]) - ord(<span class="string">'a'</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> node.children[offset]:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            node = node.children[offset]</span><br><span class="line">        <span class="comment"># return True</span></span><br><span class="line">        <span class="keyword">return</span> node.is_end</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">startsWith</span><span class="params">(self, prefix: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Returns if there is any word in the trie that starts with the given prefix.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># pass</span></span><br><span class="line">        node = self.root</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(prefix)):</span><br><span class="line">            offset = ord(prefix[i]) - ord(<span class="string">'a'</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> node.children[offset]:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            node = node.children[offset]</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Your Trie object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"># obj = Trie()</span></span><br><span class="line"><span class="comment"># obj.insert(word)</span></span><br><span class="line"><span class="comment"># param_2 = obj.search(word)</span></span><br><span class="line"><span class="comment"># param_3 = obj.startsWith(prefix)</span></span><br></pre></td></tr></table></figure>



<p>First time</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrieNode</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.children = &#123;&#125;</span><br><span class="line">        self.isEnd = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Trie</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Initialize your data structure here.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.root = TrieNode()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insert</span><span class="params">(self, word: str)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Inserts a word into the trie.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        node = self.root</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> word:</span><br><span class="line">            <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> node.children:</span><br><span class="line">                node.children[c] = TrieNode()</span><br><span class="line">            node = node.children[c]</span><br><span class="line">        node.isEnd = <span class="literal">True</span></span><br><span class="line">                </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(self, word: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Returns if the word is in the trie.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># should pass in node and word</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(node, i , word)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> i == len(word):</span><br><span class="line">                <span class="keyword">if</span> node.isEnd:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> word[i] <span class="keyword">not</span> <span class="keyword">in</span> node.children:</span><br><span class="line">                <span class="comment"># self.helper(i+1, word)</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> helper(node.children[word[i]], i+<span class="number">1</span>, word)</span><br><span class="line">        <span class="keyword">return</span> helper(self.root, <span class="number">0</span>, word)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">startsWith</span><span class="params">(self, prefix: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Returns if there is any word in the trie that starts with the given prefix.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        node = self.root</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> prefix:</span><br><span class="line">            <span class="keyword">if</span> c <span class="keyword">in</span> node.children:</span><br><span class="line">                node = node.children[c]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Your Trie object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"># obj = Trie()</span></span><br><span class="line"><span class="comment"># obj.insert(word)</span></span><br><span class="line"><span class="comment"># param_2 = obj.search(word)</span></span><br><span class="line"><span class="comment"># param_3 = obj.startsWith(prefix)</span></span><br></pre></td></tr></table></figure>



<h3 id="209"><a href="#209" class="headerlink" title="209"></a><a name="209">209</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minSubArrayLen</span><span class="params">(self, s: int, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">                [2,3,1,2,4,3]</span></span><br><span class="line"><span class="string">        ps =    [0,2,5,6,8,12,15]    # pre_sum</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        curr_idx 0</span></span><br><span class="line"><span class="string">        result = float('inf')</span></span><br><span class="line"><span class="string">        if diff  (8-curr_idx) - 7 &gt;= 0 </span></span><br><span class="line"><span class="string">            result = min(result, 8-curr_idx)</span></span><br><span class="line"><span class="string">            update curr_idx to index of value 8</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        accu = <span class="number">0</span></span><br><span class="line">        ps = [<span class="number">0</span>] * (len(nums)+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(ps)):</span><br><span class="line">            accu += nums[i<span class="number">-1</span>]</span><br><span class="line">            ps[i] = accu</span><br><span class="line">            </span><br><span class="line">        <span class="comment"># ps[-1] = ps[-2] + nums[-1]</span></span><br><span class="line">        print(ps)</span><br><span class="line">        </span><br><span class="line">        curr_idx = <span class="number">0</span></span><br><span class="line">        result = float(<span class="string">'inf'</span>)</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1</span>, len(ps)):</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># SHOULD REPLACE THIS W/ B-SEARCH, to search the residual</span></span><br><span class="line">            <span class="comment"># if ps[k]-ps[curr_idx] - s &gt;= 0:</span></span><br><span class="line">            <span class="keyword">if</span> ps[k]-ps[curr_idx] - s &gt;= <span class="number">0</span>:    </span><br><span class="line">                <span class="keyword">while</span> ps[k]-ps[curr_idx] - s &gt;= <span class="number">0</span>:</span><br><span class="line">                    curr_idx += <span class="number">1</span></span><br><span class="line">                curr_idx -= <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">                result = min(result, k-curr_idx)</span><br><span class="line">                <span class="comment"># curr_idx = k</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> result == float(<span class="string">'inf'</span>):</span><br><span class="line">            result = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>



<h3 id="210"><a href="#210" class="headerlink" title="210"></a><a name="210">210</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findOrder</span><span class="params">(self, numCourses: int, prerequisites: List[List[int]])</span> -&gt; List[int]:</span></span><br><span class="line">        n = numCourses</span><br><span class="line">        G = [[] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        degrees = [<span class="number">0</span>] * n</span><br><span class="line">        <span class="keyword">for</span> j, i <span class="keyword">in</span> prerequisites:</span><br><span class="line">            G[i].append(j)</span><br><span class="line">            degrees[j] += <span class="number">1</span>    </span><br><span class="line">    </span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        0 -&gt; 1 ------&gt; 3</span></span><br><span class="line"><span class="string">          \        /</span></span><br><span class="line"><span class="string">            -&gt; 2 --</span></span><br><span class="line"><span class="string">            idx    0 1 2 3</span></span><br><span class="line"><span class="string">        degrees = [0 1 1 2]</span></span><br><span class="line"><span class="string">        G = [[1,2], [3], [3], []]</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Q = [0]</span></span><br><span class="line"><span class="string">            idx</span></span><br><span class="line"><span class="string">        '''</span> </span><br><span class="line">        Q = deque([])</span><br><span class="line">        [Q.append(idx) <span class="keyword">for</span> idx, degree <span class="keyword">in</span> enumerate(degrees) <span class="keyword">if</span> degree == <span class="number">0</span>]        </span><br><span class="line">        <span class="comment"># visited = []</span></span><br><span class="line">        result = [] <span class="comment"># as a stack</span></span><br><span class="line">        [result.append(idx) <span class="keyword">for</span> idx <span class="keyword">in</span> Q]     <span class="comment"># [0], result = Q.copy()</span></span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            v_idx = Q.popleft()    </span><br><span class="line">            <span class="comment"># visited.append[v_idx]</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(G[v_idx])):</span><br><span class="line">                next_v_idx = G[v_idx][j] <span class="comment"># 1, then 2</span></span><br><span class="line">                degrees[next_v_idx] -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> degrees[next_v_idx] == <span class="number">0</span>:</span><br><span class="line">                    Q.append(next_v_idx)</span><br><span class="line">                    result.append(next_v_idx)</span><br><span class="line">        <span class="keyword">if</span> len(result) != numCourses:</span><br><span class="line">            result = list() </span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>



<h3 id="211"><a href="#211" class="headerlink" title="211"></a><a name="211">211</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WordNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.children = &#123;&#125;</span><br><span class="line">        self.isEnd = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WordDictionary</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.root = WordNode()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addWord</span><span class="params">(self, word)</span>:</span></span><br><span class="line">        node = self.root</span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> word:</span><br><span class="line">            <span class="keyword">if</span> w <span class="keyword">in</span> node.children:</span><br><span class="line">                node = node.children[w]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                node.children[w] = WordNode()</span><br><span class="line">                node = node.children[w]</span><br><span class="line">        node.isEnd = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(self, word: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Returns if the word is in the data structure. A word could contain the dot character '.' to represent any one letter.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(node, i, word)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> i == len(word):</span><br><span class="line">                <span class="keyword">return</span> node.isEnd</span><br><span class="line">            <span class="keyword">if</span> word[i] == <span class="string">'.'</span>:</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> node.children:</span><br><span class="line">                    <span class="keyword">if</span> dfs(node.children[c], i + <span class="number">1</span>, word):</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> word[i] <span class="keyword">not</span> <span class="keyword">in</span> node.children:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> dfs(node.children[word[i]], i + <span class="number">1</span>, word)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> dfs(self.root, <span class="number">0</span>, word)</span><br><span class="line">    <span class="comment"># def search(self, word):</span></span><br><span class="line">    <span class="comment">#     # node = self.root</span></span><br><span class="line">    <span class="comment">#     # que = deque(word)</span></span><br><span class="line">    <span class="comment">#     # while que:</span></span><br><span class="line">    <span class="comment">#     #     c = que.popleft()</span></span><br><span class="line">    <span class="comment">#     #     if c == '.':</span></span><br><span class="line">    <span class="comment">#     #         for key in node.children.keys():</span></span><br><span class="line">    <span class="comment">#     #             self.search(key + ''.join([c for c in que]))</span></span><br><span class="line">    <span class="comment">#     #     node = node.children.get(c, None)</span></span><br><span class="line">    <span class="comment">#     #     if not node:</span></span><br><span class="line">    <span class="comment">#     #         return False</span></span><br><span class="line">    <span class="comment">#     # return node.isEnd</span></span><br><span class="line">    <span class="comment">#     stack = [(self.root,word)]</span></span><br><span class="line">    <span class="comment">#     while stack:</span></span><br><span class="line">    <span class="comment">#         node, w = stack.pop()</span></span><br><span class="line">    <span class="comment">#         if not w:</span></span><br><span class="line">    <span class="comment">#             if node.isEnd:</span></span><br><span class="line">    <span class="comment">#                 return True</span></span><br><span class="line">    <span class="comment">#         elif w[0]=='.':</span></span><br><span class="line">    <span class="comment">#             for n in node.children.values():</span></span><br><span class="line">    <span class="comment">#                 stack.append((n,w[1:]))</span></span><br><span class="line">    <span class="comment">#         else:</span></span><br><span class="line">    <span class="comment">#             if w[0] in node.children:</span></span><br><span class="line">    <span class="comment">#                 n = node.children[w[0]]</span></span><br><span class="line">    <span class="comment">#                 stack.append((n,w[1:]))</span></span><br><span class="line">    <span class="comment">#     return False</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># class TrieNode:</span></span><br><span class="line"><span class="comment"># def __init__(self):</span></span><br><span class="line"><span class="comment">#     self.children = &#123;&#125;</span></span><br><span class="line"><span class="comment">#     self.isEnd = False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># class WordDictionary:</span></span><br><span class="line"><span class="comment">#     def __init__(self):</span></span><br><span class="line"><span class="comment">#         """</span></span><br><span class="line"><span class="comment">#         Initialize your data structure here.</span></span><br><span class="line"><span class="comment">#         """</span></span><br><span class="line"><span class="comment">#         self.root = TrieNode()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     def addWord(self, word: str) -&gt; None:</span></span><br><span class="line"><span class="comment">#         """</span></span><br><span class="line"><span class="comment">#         Adds a word into the data structure.</span></span><br><span class="line"><span class="comment">#         """</span></span><br><span class="line"><span class="comment">#         node = self.root</span></span><br><span class="line"><span class="comment">#         for char in word:</span></span><br><span class="line"><span class="comment">#             if char not in node.children:</span></span><br><span class="line"><span class="comment">#                 node.children[char] = TrieNode()</span></span><br><span class="line"><span class="comment">#             node = node.children[char]</span></span><br><span class="line"><span class="comment">#         node.isEnd = True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     def search(self, word: str) -&gt; bool:</span></span><br><span class="line"><span class="comment">#         """</span></span><br><span class="line"><span class="comment">#         Returns if the word is in the data structure. A word could contain the dot character '.' to represent any one letter.</span></span><br><span class="line"><span class="comment">#         """</span></span><br><span class="line"><span class="comment">#         def dfs(node, i, word):</span></span><br><span class="line"><span class="comment">#             if i == len(word):</span></span><br><span class="line"><span class="comment">#                 return node.isEnd</span></span><br><span class="line"><span class="comment">#             if word[i] == '.':</span></span><br><span class="line"><span class="comment">#                 for c in node.children:</span></span><br><span class="line"><span class="comment">#                     if dfs(node.children[c], i + 1, word):</span></span><br><span class="line"><span class="comment">#                         return True</span></span><br><span class="line"><span class="comment">#                 return False</span></span><br><span class="line"><span class="comment">#             else:</span></span><br><span class="line"><span class="comment">#                 if word[i] not in node.children:</span></span><br><span class="line"><span class="comment">#                     return False</span></span><br><span class="line"><span class="comment">#                 else:</span></span><br><span class="line"><span class="comment">#                     return dfs(node.children[word[i]], i + 1, word)</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#         return dfs(self.root, 0, word)</span></span><br></pre></td></tr></table></figure>



<h3 id="215"><a href="#215" class="headerlink" title="215"></a><a name="215">215</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span><span class="params">(self, nums: List[int], k: int)</span> -&gt; int:</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        l = [<span class="number">-1</span>*num <span class="keyword">for</span> num <span class="keyword">in</span> nums]</span><br><span class="line">        heapq.heapify(l)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(k<span class="number">-1</span>):</span><br><span class="line">            heapq.heappop(l)</span><br><span class="line">        <span class="keyword">return</span> heapq.heappop(l) * <span class="number">-1</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span><span class="params">(self, nums: List[int], k: int)</span> -&gt; int:</span></span><br><span class="line"></span><br><span class="line">        heapq._heapify_max(nums)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(k<span class="number">-1</span>):</span><br><span class="line">            heapq._heappop_max(nums)</span><br><span class="line">        <span class="keyword">return</span> heapq._heappop_max(nums)</span><br></pre></td></tr></table></figure>



<h3 id="231"><a href="#231" class="headerlink" title="231"></a><a name="231">231</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isPowerOfFour</span><span class="params">(self, num: int)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> num:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> num &gt; <span class="number">1</span>:</span><br><span class="line">            num /= <span class="number">4</span></span><br><span class="line">        <span class="keyword">return</span> num == <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h3 id="235"><a href="#235" class="headerlink" title="235"></a><a name="235">235</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lowestCommonAncestor</span><span class="params">(self, root: <span class="string">'TreeNode'</span>, p: <span class="string">'TreeNode'</span>, q: <span class="string">'TreeNode'</span>)</span> -&gt; 'TreeNode':</span></span><br><span class="line">        curr = root</span><br><span class="line">        <span class="keyword">while</span> curr:</span><br><span class="line">            <span class="keyword">if</span> p.val &gt; curr.val <span class="keyword">and</span> q.val &gt; curr.val:</span><br><span class="line">                curr = curr.right</span><br><span class="line">            <span class="keyword">elif</span> p.val &lt; curr.val <span class="keyword">and</span> q.val &lt; curr.val:</span><br><span class="line">                curr = curr.left</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> curr</span><br></pre></td></tr></table></figure>



<h4 id="236"><a href="#236" class="headerlink" title="236"></a><a name="236">236</a></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">        3</span></span><br><span class="line"><span class="string">       / \</span></span><br><span class="line"><span class="string">      5.  1</span></span><br><span class="line"><span class="string">     / \  / \</span></span><br><span class="line"><span class="string">    6   2 0  8</span></span><br><span class="line"><span class="string">       /</span></span><br><span class="line"><span class="string">      3</span></span><br><span class="line"><span class="string">    (root, 6, 3)</span></span><br><span class="line"><span class="string">    (root, 2, 3)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span>        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lowestCommonAncestor</span><span class="params">(self, root: <span class="string">'TreeNode'</span>, p: <span class="string">'TreeNode'</span>, q: <span class="string">'TreeNode'</span>)</span> -&gt; 'TreeNode':</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># print(p.val, q.val)</span></span><br><span class="line">        <span class="comment"># return self.dfs(root, p.val, q.val)</span></span><br><span class="line">        <span class="comment"># return self.dfs(root, p, q)</span></span><br><span class="line">        <span class="keyword">return</span> self.helper(root, p, q)</span><br><span class="line">       <span class="comment">#    1</span></span><br><span class="line">       <span class="comment">#  2  3 </span></span><br><span class="line">       <span class="comment"># N 4    </span></span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root, p, q)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> root.val == p.val <span class="keyword">or</span> root.val == q.val:</span><br><span class="line">            <span class="keyword">return</span> root</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># if not root.left and not root.right:</span></span><br><span class="line">        <span class="comment">#     return None</span></span><br><span class="line">        </span><br><span class="line">        L = self.helper(root.left, p, q)      <span class="comment"># got 7! None</span></span><br><span class="line">        R = self.helper(root.right, p, q)     <span class="comment"># got 4! 2</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> L <span class="keyword">and</span> <span class="keyword">not</span> R:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> L <span class="keyword">and</span> R: </span><br><span class="line">            <span class="keyword">return</span> root</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> L: </span><br><span class="line">            <span class="keyword">return</span> R</span><br><span class="line">        <span class="comment"># elif not R:</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> L</span><br></pre></td></tr></table></figure>



<h3 id="252"><a href="#252" class="headerlink" title="252"></a><a name="252">252</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MORE LIKE [start, end), where [ means close, ( means open</span></span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">canAttendMeetings</span><span class="params">(self, intervals: List[List[int]])</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> intervals:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        heapq.heapify(intervals)</span><br><span class="line">        </span><br><span class="line">        l, h = heapq.heappop(intervals)</span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">while</span> intervals:</span><br><span class="line">            next_ = heapq.heappop(intervals)</span><br><span class="line">            <span class="keyword">if</span> next_[<span class="number">0</span>] &gt;= h:</span><br><span class="line">                <span class="comment"># result.append([l, h]) # NOT USED HERE</span></span><br><span class="line">                l, h = next_[<span class="number">0</span>], next_[<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="comment"># UPDATE h</span></span><br><span class="line">                <span class="comment"># h = max(h, next_[1])   # NOT USED HERE</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="comment"># return result</span></span><br></pre></td></tr></table></figure>



<h3 id="253"><a href="#253" class="headerlink" title="253"></a><a name="253">253</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minMeetingRooms</span><span class="params">(self, intervals: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">import</span> heapq</span><br><span class="line">        intervals = sorted(intervals, key=<span class="keyword">lambda</span> x:x[<span class="number">0</span>]) <span class="comment"># Sort by start value</span></span><br><span class="line">        heap = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> intervals:</span><br><span class="line">            <span class="keyword">if</span> heap <span class="keyword">and</span> heap[<span class="number">0</span>] &lt;= i[<span class="number">0</span>]:</span><br><span class="line">                <span class="comment"># If the new start time is greater than or equal to the exist end time, means the room has been released, replace the previous time with the new ending time</span></span><br><span class="line">                heapq.heapreplace(heap, i[<span class="number">-1</span>])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># The room is still in use, add (push a new end time to min heap) a new room</span></span><br><span class="line">                heapq.heappush(heap, i[<span class="number">-1</span>])</span><br><span class="line">        <span class="keyword">return</span> len(heap)</span><br></pre></td></tr></table></figure>



<h3 id="270"><a href="#270" class="headerlink" title="270"></a><a name="270">270</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">closestValue</span><span class="params">(self, root: TreeNode, target: float)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        que = deque([root])</span><br><span class="line">        min_g = float(<span class="string">'inf'</span>)</span><br><span class="line">        res = que[<span class="number">0</span>].val</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> que:</span><br><span class="line">            v = que.popleft()</span><br><span class="line">            <span class="keyword">if</span> abs(v.val - target) &lt; min_g:</span><br><span class="line">                min_g = abs(v.val - target)</span><br><span class="line">                res = v.val</span><br><span class="line">            <span class="keyword">if</span> v.left:</span><br><span class="line">                que.append(v.left)</span><br><span class="line">            <span class="keyword">if</span> v.right:</span><br><span class="line">                que.append(v.right)</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>

<p>O(N)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class Solution:</span><br><span class="line">    def closestValue(self, root: TreeNode, target: float) -&gt; int:</span><br><span class="line">        closest &#x3D; root.val</span><br><span class="line">        while root:</span><br><span class="line">            closest &#x3D; min(root.val, closest, key &#x3D; lambda x: abs(target - x))</span><br><span class="line">            root &#x3D; root.left if target &lt; root.val else root.right</span><br><span class="line">        return closest</span><br></pre></td></tr></table></figure>

<img src="/Users/joe/Library/Application Support/typora-user-images/image-20200201202254537.png" alt="image-20200201202254537" style="zoom:50%;" />

<ul>
<li>Time complexity : O(<em>H</em>) since here one goes from root down to a leaf.</li>
<li>Space complexity : O(1).</li>
</ul>
<h3 id="285"><a href="#285" class="headerlink" title="285"></a><a name="285">285</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inorderSuccessor</span><span class="params">(self, root: <span class="string">'TreeNode'</span>, p: <span class="string">'TreeNode'</span>)</span> -&gt; 'TreeNode':</span></span><br><span class="line">        <span class="comment"># if not root:</span></span><br><span class="line">        <span class="comment">#     return []</span></span><br><span class="line">        <span class="comment"># self.res = self.inorderSuccessor(root.left, p) </span></span><br><span class="line">        <span class="comment"># print(root.val, self.res)</span></span><br><span class="line">        <span class="comment"># self.res += [root.val]</span></span><br><span class="line">        <span class="comment"># if root.val == p.val:</span></span><br><span class="line">        <span class="comment">#     self.find = True</span></span><br><span class="line">        <span class="comment">#     return []</span></span><br><span class="line">        <span class="comment"># if self.find:</span></span><br><span class="line">        <span class="comment">#     self.ans = root.val</span></span><br><span class="line">        <span class="comment"># self.res = self.inorderSuccessor(root.right, p)</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        succ = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">while</span> root:</span><br><span class="line">            <span class="keyword">if</span> p.val &lt; root.val:</span><br><span class="line">                succ = root</span><br><span class="line">                root = root.left</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                root = root.right</span><br><span class="line">        <span class="keyword">return</span> succ</span><br></pre></td></tr></table></figure>

<h3 id="286"><a href="#286" class="headerlink" title="286"></a><a name="286">286</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import numpy as np</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.INF = <span class="number">2</span>**<span class="number">31</span><span class="number">-1</span> <span class="comment">#float('inf')</span></span><br><span class="line">        self.m, self.n = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wallsAndGates</span><span class="params">(self, rooms: List[List[int]])</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Do not return anything, modify rooms in-place instead.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> rooms <span class="keyword">or</span> <span class="keyword">not</span> rooms[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># arr = np.array(rooms)</span></span><br><span class="line">        <span class="comment"># arr = np.pad(rooms, ((1,1), (1,1)), mode='constant', constant_values=(-1, -1))                 </span></span><br><span class="line">        arr = rooms</span><br><span class="line">        self.m, self.n = len(arr), len(arr[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(arr)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, len(arr[<span class="number">0</span>])):</span><br><span class="line">                <span class="keyword">if</span> arr[i][j] == <span class="number">0</span>:</span><br><span class="line">                    self.bfs((arr[i][j], i, j), arr)</span><br><span class="line">                       </span><br><span class="line">        <span class="keyword">return</span> arr</span><br><span class="line">    </span><br><span class="line">                       </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bfs</span><span class="params">(self, item, arr)</span>:</span></span><br><span class="line">        Q = deque()</span><br><span class="line">        Q.append(item)</span><br><span class="line">        INF = self.INF</span><br><span class="line">        dist = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            num_neighbors = len(Q)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># if val == self.INF:</span></span><br><span class="line">            <span class="comment">#     arr[i][j] = 'x'</span></span><br><span class="line">            dist += <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(num_neighbors):</span><br><span class="line">                val, i, j = Q.popleft()</span><br><span class="line">                <span class="keyword">if</span> j &gt; <span class="number">0</span> <span class="keyword">and</span> (arr[i][j<span class="number">-1</span>] == INF <span class="keyword">or</span> arr[i][j<span class="number">-1</span>] &gt; dist):</span><br><span class="line">                    Q.append((arr[i][j<span class="number">-1</span>], i, j<span class="number">-1</span>))</span><br><span class="line">                    arr[i][j<span class="number">-1</span>] = dist</span><br><span class="line">                <span class="keyword">if</span> i &gt; <span class="number">0</span> <span class="keyword">and</span> (arr[i<span class="number">-1</span>][j] == INF <span class="keyword">or</span> arr[i<span class="number">-1</span>][j] &gt; dist):</span><br><span class="line">                    Q.append((arr[i<span class="number">-1</span>][j], i<span class="number">-1</span>, j))</span><br><span class="line">                    arr[i<span class="number">-1</span>][j] = dist</span><br><span class="line">                <span class="keyword">if</span> j &lt; (self.n<span class="number">-1</span>) <span class="keyword">and</span> (arr[i][j+<span class="number">1</span>] == INF <span class="keyword">or</span> arr[i][j+<span class="number">1</span>] &gt; dist):</span><br><span class="line">                    Q.append((arr[i][j+<span class="number">1</span>], i, j+<span class="number">1</span>))</span><br><span class="line">                    arr[i][j+<span class="number">1</span>] = dist</span><br><span class="line">                <span class="keyword">if</span> i &lt; (self.m<span class="number">-1</span>) <span class="keyword">and</span> (arr[i+<span class="number">1</span>][j] == INF <span class="keyword">or</span> arr[i+<span class="number">1</span>][j] &gt; dist):</span><br><span class="line">                    Q.append((arr[i+<span class="number">1</span>][j], i+<span class="number">1</span>, j))</span><br><span class="line">                    arr[i+<span class="number">1</span>][j] = dist</span><br></pre></td></tr></table></figure>



<h3 id="297"><a href="#297" class="headerlink" title="297"></a><a name="297">297</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode(object):</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Codec</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.d_count = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">serialize</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        <span class="string">"""Encodes a tree to a single string.</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        :type root: TreeNode</span></span><br><span class="line"><span class="string">        :rtype: str</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        pod = []</span><br><span class="line">        <span class="comment"># iod = []</span></span><br><span class="line">        self.preorder(root, pod)</span><br><span class="line">        pod.append(<span class="string">'END'</span>)</span><br><span class="line">        <span class="comment"># self.inorder(root, iod)</span></span><br><span class="line">        encoded = <span class="string">'$'</span>.join(pod)</span><br><span class="line">        <span class="comment"># print(encoded)</span></span><br><span class="line">        <span class="keyword">return</span> encoded</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">preorder</span><span class="params">(self, root, s)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:    </span><br><span class="line">            s.append(<span class="string">'None'</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        s.append(str(root.val)+<span class="string">''</span>)</span><br><span class="line">        self.preorder(root.left, s)</span><br><span class="line">        self.preorder(root.right, s)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inorder</span><span class="params">(self, root, s)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:    </span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        self.inorder(root.left, s)</span><br><span class="line">        s.append(root.val)</span><br><span class="line">        self.inorder(root.right, s)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">deserialize</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        <span class="string">"""Decodes your encoded data to tree.</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        :type data: str</span></span><br><span class="line"><span class="string">        :rtype: TreeNode</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        s = data.split(<span class="string">'$'</span>)[:<span class="number">-1</span>]</span><br><span class="line">        <span class="comment"># print(s)</span></span><br><span class="line">        root = self.build_preorder(s)<span class="comment">#, 0)</span></span><br><span class="line">        </span><br><span class="line">        self.d_count = <span class="number">-1</span></span><br><span class="line">        <span class="keyword">return</span> root</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># def build_preorder(self, s, idx):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build_preorder</span><span class="params">(self, s)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.d_count == len(s):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        elem = s[self.d_count]</span><br><span class="line">        self.d_count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> elem == <span class="string">'None'</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        root = TreeNode(elem)</span><br><span class="line">        root.left = self.build_preorder(s)</span><br><span class="line">        root.right = self.build_preorder(s)</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> root</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="comment"># Your Codec object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"># codec = Codec()</span></span><br><span class="line"><span class="comment"># codec.deserialize(codec.serialize(root))</span></span><br></pre></td></tr></table></figure>



<h3 id="301"><a href="#301" class="headerlink" title="301"></a><a name="301">301</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">removeInvalidParentheses</span><span class="params">(self, s: str)</span> -&gt; List[str]:</span></span><br><span class="line">        ans = []</span><br><span class="line">        lefts_to_remove, rights_to_remove = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        lefts, rights = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">            <span class="keyword">if</span> s[i] == <span class="string">'('</span>:</span><br><span class="line">                lefts += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> s[i] == <span class="string">')'</span>:</span><br><span class="line">                <span class="keyword">if</span> lefts &gt; <span class="number">0</span>:</span><br><span class="line">                    lefts -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    rights_to_remove += <span class="number">1</span> <span class="comment">#if right doesn't have a matching left, it should be removed</span></span><br><span class="line">        lefts_to_remove = lefts <span class="comment">#if we have more lefts than rights, extra lefts should be removed</span></span><br><span class="line">        </span><br><span class="line">        self.backtracking(<span class="number">0</span>, <span class="number">0</span>, s, <span class="number">0</span>, <span class="string">''</span>, ans, lefts_to_remove, rights_to_remove)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ans:</span><br><span class="line">            ans.append(<span class="string">''</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">                    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">backtracking</span><span class="params">(self, lefts, rights, s, ind, cur_str, ans, lefts_to_remove, rights_to_remove)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> ind == len(s):</span><br><span class="line">            <span class="keyword">if</span> lefts == rights <span class="keyword">and</span> lefts_to_remove==<span class="number">0</span> <span class="keyword">and</span> rights_to_remove==<span class="number">0</span> <span class="keyword">and</span> cur_str <span class="keyword">not</span> <span class="keyword">in</span> ans:</span><br><span class="line">                ans.append(cur_str)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> s[ind] == <span class="string">'('</span>:</span><br><span class="line">            <span class="keyword">if</span> lefts_to_remove &gt; <span class="number">0</span>:</span><br><span class="line">                self.backtracking(lefts, rights, s, ind+<span class="number">1</span>, cur_str, ans, lefts_to_remove<span class="number">-1</span>, rights_to_remove)</span><br><span class="line">            self.backtracking(lefts+<span class="number">1</span>, rights, s, ind+<span class="number">1</span>, cur_str+<span class="string">'('</span>, ans, lefts_to_remove, rights_to_remove)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">elif</span> s[ind] == <span class="string">')'</span>:</span><br><span class="line">            <span class="keyword">if</span> (lefts==<span class="number">0</span> <span class="keyword">or</span> lefts&gt;=rights) <span class="keyword">and</span> rights_to_remove &gt; <span class="number">0</span>:</span><br><span class="line">                self.backtracking(lefts, rights, s, ind+<span class="number">1</span>, cur_str, ans, lefts_to_remove, rights_to_remove<span class="number">-1</span>)</span><br><span class="line">            <span class="keyword">if</span> lefts &gt; rights:</span><br><span class="line">                self.backtracking(lefts, rights+<span class="number">1</span>, s, ind+<span class="number">1</span>, cur_str+<span class="string">')'</span>, ans, lefts_to_remove, rights_to_remove)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.backtracking(lefts, rights, s, ind+<span class="number">1</span>, cur_str+s[ind], ans, lefts_to_remove, rights_to_remove)</span><br></pre></td></tr></table></figure>



<h3 id="303"><a href="#303" class="headerlink" title="303"></a><a name="303">303</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nums    =       [-2  0  3 -5  2 -1]          </span></span><br><span class="line"><span class="comment"># pre_sum  =    [0 -2 -2  1 -4 -2 -3]</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NumArray</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, nums: List[int])</span>:</span></span><br><span class="line">        self.pre_sum = [<span class="number">0</span>] + [<span class="number">0</span>] * len(nums)</span><br><span class="line">        accu = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> range(<span class="number">1</span>, len(self.pre_sum)):</span><br><span class="line">            accu += nums[idx<span class="number">-1</span>]</span><br><span class="line">            self.pre_sum[idx] = accu</span><br><span class="line">						<span class="comment"># FOLLOWING IS FASTER THAN PREVIOUS LINE</span></span><br><span class="line">            self.pre_sum[idx] = self.pre_sum[idx<span class="number">-1</span>] + nums[idx<span class="number">-1</span>]</span><br><span class="line">        <span class="comment"># print(self.pre_sum)</span></span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sumRange</span><span class="params">(self, i: int, j: int)</span> -&gt; int:</span></span><br><span class="line">            <span class="keyword">return</span> self.pre_sum[j+<span class="number">1</span>] - self.pre_sum[i]</span><br></pre></td></tr></table></figure>

<p><strong>Complexity analysis</strong></p>
<ul>
<li>Time complexity : O(1)<em>O</em>(1) time per query, O(n)<em>O</em>(<em>n</em>) time pre-computation. Since the cumulative sum is cached, each <em>sumRange</em> query can be calculated in O(1)<em>O</em>(1) time.</li>
<li>Space complexity : O(n)<em>O</em>(<em>n</em>).</li>
</ul>
<h3 id="304"><a href="#304" class="headerlink" title="304"></a><a name="304">304</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">A</span></span><br><span class="line"><span class="string">3 0 1</span></span><br><span class="line"><span class="string">5 6 3</span></span><br><span class="line"><span class="string">1 2 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">presum of A</span></span><br><span class="line"><span class="string">0 0 0 0 </span></span><br><span class="line"><span class="string">0 3 3 4</span></span><br><span class="line"><span class="string">0 8    </span></span><br><span class="line"><span class="string">0 9</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">For A_presum[2][2] = 3+5+6 = 14 or -1+3+8+6 = 14</span></span><br><span class="line"><span class="string">                    A[0][0]         -1*p_A[2-1][2-1]</span></span><br><span class="line"><span class="string">                    A[0][1]         p_A[2][2-1]</span></span><br><span class="line"><span class="string">                    A[1][0]         p_A[2-1][2]</span></span><br><span class="line"><span class="string">                                    nums[2-1][2-1]</span></span><br><span class="line"><span class="string">'''</span>             </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NumMatrix</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, matrix: List[List[int]])</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> matrix <span class="keyword">or</span> <span class="keyword">not</span> matrix[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        m, n = len(matrix)+<span class="number">1</span>, len(matrix[<span class="number">0</span>])+<span class="number">1</span>   <span class="comment"># row and col for pre_sum matrix</span></span><br><span class="line">        pre_sum = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(n)] <span class="keyword">for</span> i <span class="keyword">in</span> range(m)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, m):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">                pre_sum[i][j] =  <span class="number">-1</span>*pre_sum[i<span class="number">-1</span>][j<span class="number">-1</span>] + pre_sum[i][j<span class="number">-1</span>] + pre_sum[i<span class="number">-1</span>][j] + matrix[i<span class="number">-1</span>][j<span class="number">-1</span>]</span><br><span class="line">              </span><br><span class="line">        self.pre_sum  = pre_sum</span><br><span class="line"></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    For the region (r1, c1) (r2, c2)</span></span><br><span class="line"><span class="string">        A[row2+1][col2+1] - A[row2+1][col1] - A[row1][col2+1] + A[row1][col1]</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sumRegion</span><span class="params">(self, row1: int, col1: int, row2: int, col2: int)</span> -&gt; int:</span></span><br><span class="line">        A = self.pre_sum</span><br><span class="line">        ans = A[row2+<span class="number">1</span>][col2+<span class="number">1</span>] - A[row2+<span class="number">1</span>][col1] - A[row1][col2+<span class="number">1</span>] + A[row1][col1]</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="comment"># Your NumMatrix object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"># obj = NumMatrix(matrix)</span></span><br><span class="line"><span class="comment"># param_1 = obj.sumRegion(row1,col1,row2,col2)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Time complexity : O(1)<em>O</em>(1) time per query, O(mn)<em>O</em>(<em>m**n</em>) time pre-computation. The pre-computation in the constructor takes O(mn)<em>O</em>(<em>m**n</em>) time. Each <em>sumRegion</em> query takes O(1)<em>O</em>(1) time.</li>
<li>Space complexity : O(mn)<em>O</em>(<em>m**n</em>). The algorithm uses O(mn)<em>O</em>(<em>m**n</em>) space to store the cumulative region sum.</li>
</ul>
<h3 id="340"><a href="#340" class="headerlink" title="340"></a><a name="340">340</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lengthOfLongestSubstringKDistinct</span><span class="params">(self, s: str, k: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="comment"># &#123;e:[0, 2], c:[1]&#125;   l=0 r=r2 len=3</span></span><br><span class="line">        <span class="comment"># or</span></span><br><span class="line">        <span class="comment"># &#123;e:2, c:1&#125;</span></span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        d = defaultdict(int)   </span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        max_len = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> range(len(s)):</span><br><span class="line">            <span class="keyword">if</span> s[idx] <span class="keyword">not</span> <span class="keyword">in</span> d:</span><br><span class="line">                d[s[idx]] = <span class="number">0</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                d[s[idx]] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> len(d) &gt; k <span class="keyword">and</span> j &lt; idx:</span><br><span class="line">                <span class="keyword">if</span> d[s[j]] &gt; <span class="number">0</span>:</span><br><span class="line">                    d[s[j]] -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">del</span> d[s[j]]</span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line">            max_len = max(max_len, idx - (j<span class="number">-1</span>))        </span><br><span class="line">        <span class="keyword">return</span> max_len</span><br></pre></td></tr></table></figure>



<h3 id="349"><a href="#349" class="headerlink" title="349"></a><a name="349">349</a></h3><h5 id="Naive-–-O-mxn"><a href="#Naive-–-O-mxn" class="headerlink" title="Naive – O(mxn)"></a>Naive – O(mxn)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">intersection</span><span class="params">(self, nums1: List[int], nums2: List[int])</span> -&gt; List[int]:</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># _len = min(len(nums1), len(nums2))</span></span><br><span class="line">        _len = len(nums1)</span><br><span class="line">        <span class="keyword">if</span> len(nums2) &lt; len(nums1):</span><br><span class="line">            _len = len(nums2)       <span class="comment"># CAUTIOUS!!! should be prior to Line8</span></span><br><span class="line">            nums1, nums2 = nums2, nums1</span><br><span class="line">            <span class="comment"># _len = len(nums2)</span></span><br><span class="line">            </span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(_len):</span><br><span class="line">            <span class="comment"># print(i, nums1)</span></span><br><span class="line">            <span class="keyword">if</span> nums1[i] <span class="keyword">in</span> nums2 <span class="keyword">and</span> nums1[i] <span class="keyword">not</span> <span class="keyword">in</span> result:</span><br><span class="line">                result.append(nums1[i])</span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>



<h5 id="turn-list-into-set-‘cause-set-is-implemented-in-hash-thus-O-m-n"><a href="#turn-list-into-set-‘cause-set-is-implemented-in-hash-thus-O-m-n" class="headerlink" title="turn list into set, ‘cause set is implemented in hash, thus O(m+n)"></a>turn list into set, ‘cause set is implemented in hash, thus O(m+n)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">intersection</span><span class="params">(self, nums1: List[int], nums2: List[int])</span> -&gt; List[int]:</span></span><br><span class="line">        </span><br><span class="line">        set1, set2 = set(nums1), set(nums2)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> len(set2)&lt; len(set1):</span><br><span class="line">            set1, set2 = set2, set1</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> set1:</span><br><span class="line">            <span class="keyword">if</span> item <span class="keyword">in</span> set2:</span><br><span class="line">                res.append(item)</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="350"><a href="#350" class="headerlink" title="350"></a><a name="350">350</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">intersect</span><span class="params">(self, nums1: List[int], nums2: List[int])</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="comment"># return set.intersection(set(nums1), set(nums2))</span></span><br><span class="line">        d_a = Counter(nums1)</span><br><span class="line">        <span class="comment"># b = Counter(nums2)</span></span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(nums2)):</span><br><span class="line">            <span class="keyword">if</span> d_a.get(nums2[j], <span class="number">0</span>) != <span class="number">0</span>:</span><br><span class="line">                d_a[nums2[j]] -= <span class="number">1</span></span><br><span class="line">                <span class="comment"># res.append(d_a[nums2[j]])</span></span><br><span class="line">                res.append(nums2[j])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                d_a[nums2[j]] = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>

<h5 id="Two-pointers"><a href="#Two-pointers" class="headerlink" title="Two pointers"></a>Two pointers</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">nums1=sorted(nums1)</span><br><span class="line">nums2=sorted(nums2)</span><br><span class="line"></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">j=<span class="number">0</span></span><br><span class="line">sol=[]</span><br><span class="line"><span class="keyword">while</span> i&lt;len(nums1) <span class="keyword">and</span> j&lt;len(nums2):</span><br><span class="line">	<span class="keyword">if</span>(nums1[i]==nums2[j]):</span><br><span class="line">		sol.append(nums1[i])</span><br><span class="line">		i+=<span class="number">1</span></span><br><span class="line">		j+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">elif</span>(nums1[i]&lt;nums2[j]):</span><br><span class="line">		i+=<span class="number">1</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		j+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> sol</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>Follow Up</strong></p>
<p><strong>Q1:</strong> What if the given array is already sorted? How would you optimize your algorithm?</p>
<p><strong>A: 采用solution 2</strong></p>
<p><strong>Q2:</strong> What if <em>nums1</em>‘s size is small compared to <em>nums2</em>‘s size? Which algorithm is better?</p>
<p>A: 如果nums1相对于nums2非常小，那么把nums1做成哈希表，哈希表占用空间更小</p>
<p><strong>Q3:</strong> What if elements of <em>nums2</em> are stored on disk, and the memory is limited such that you cannot load all elements into the memory at once?</p>
<p><strong>A：</strong></p>
<p>如果只有nums2不能放在内存中，则将nums1做成哈希表，nums2分批加载到内存中处理。(If only nums2 cannot fit in memory, put all elements of nums1 into a HashMap, read chunks of array that fit into the memory, and record the intersections.)</p>
<p>如果nums1和nums2都很大，都不适合储存在内存，那么就用外部排序分别来sort它们。将每2G(举例)读入内存，使用2指针技术，然后从内存中读取更多的2G。重复此操作，直到没有更多数据从磁盘读取。(If both nums1 and nums2 are so huge that neither fit into the memory, sort them using external sort, read (let’s say) 2G of each into memory and then using the 2 pointer technique, then read 2G more from the array that has been exhausted. Repeat this until no more data to read from disk.)</p>
<p><strong>关于外部排序的参考资料：</strong><a href="https://link.zhihu.com/?target=http%3A//faculty.simpson.edu/lydia.sinapova/www/cmsc250/LN250_Weiss/L17-ExternalSortEX2.htm">External Sorting</a></p>
<p>还有一种思路是将这两个字符串存放在分布式系统中（不管是否自设计），然后使用MapReduce技术来解决问题。</p>
</blockquote>
<h3 id="378"><a href="#378" class="headerlink" title="378"></a><a name="378">378</a></h3><h5 id="Sol1-Iterate-all-mxn-2D-array"><a href="#Sol1-Iterate-all-mxn-2D-array" class="headerlink" title="Sol1: Iterate all mxn 2D array"></a>Sol1: Iterate all mxn 2D array</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kthSmallest</span><span class="params">(self, matrix: List[List[int]], k: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> matrix: </span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> matrix[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        m, n = len(matrix), len(matrix[<span class="number">0</span>])</span><br><span class="line">        </span><br><span class="line">        heap_l = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">                heapq.heappush(heap_l, matrix[i][j])    <span class="comment"># mxnxlg(mxn)    </span></span><br><span class="line">                <span class="comment"># heapq.heappush</span></span><br><span class="line">                </span><br><span class="line">        <span class="keyword">for</span> tmp <span class="keyword">in</span> range(k<span class="number">-1</span>):</span><br><span class="line">            heapq.heappop(heap_l)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> heapq.heappop(heap_l)</span><br></pre></td></tr></table></figure>



<h5 id="Sol2-heapq-helps-manage-each-row’s-pointer"><a href="#Sol2-heapq-helps-manage-each-row’s-pointer" class="headerlink" title="Sol2: heapq helps manage each row’s pointer"></a>Sol2: heapq helps manage each row’s pointer</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kthSmallest</span><span class="params">(self, matrix: List[List[int]], k: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> matrix:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> matrix[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        </span><br><span class="line">        m, n = len(matrix), len(matrix[<span class="number">0</span>])</span><br><span class="line">        </span><br><span class="line">        l = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">            heapq.heappush(l, (matrix[i][<span class="number">0</span>], i, <span class="number">0</span>))	<span class="comment"># m x lg(m)</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> range(k<span class="number">-1</span>):</span><br><span class="line">            val, i, j = heapq.heappop(l)    <span class="comment"># k x lg(m)</span></span><br><span class="line">            <span class="keyword">if</span> j &lt; n<span class="number">-1</span>: <span class="comment"># n-2</span></span><br><span class="line">                heapq.heappush(l, (matrix[i][j+<span class="number">1</span>], i, j+<span class="number">1</span>))    <span class="comment"># k x lg(m)</span></span><br><span class="line">        val, i, j = heapq.heappop(l)</span><br><span class="line">        <span class="keyword">return</span> val</span><br></pre></td></tr></table></figure>

<h5 id="Sol3-Binary"><a href="#Sol3-Binary" class="headerlink" title="Sol3: Binary"></a>Sol3: Binary</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="keyword">from</span> bisect <span class="keyword">import</span> bisect</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kthSmallest</span><span class="params">(self, matrix: List[List[int]], k: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> matrix:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> matrix[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        </span><br><span class="line">        m, n = len(matrix), len(matrix[<span class="number">0</span>])</span><br><span class="line">        </span><br><span class="line">        lo, hi = matrix[<span class="number">0</span>][<span class="number">0</span>], matrix[m<span class="number">-1</span>][n<span class="number">-1</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> lo &lt; hi:</span><br><span class="line">            mid = (lo + hi)//<span class="number">2</span></span><br><span class="line">            amount = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(m):</span><br><span class="line">                amount += bisect(matrix[j], mid)</span><br><span class="line">            print(amount)</span><br><span class="line">            <span class="keyword">if</span> amount &lt; k:  <span class="comment"># No EQUALS!!!</span></span><br><span class="line">                lo = mid+<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>: </span><br><span class="line">                hi = mid</span><br><span class="line">            <span class="comment"># amount = bisect()</span></span><br><span class="line">        <span class="keyword">return</span> lo</span><br></pre></td></tr></table></figure>



<h3 id="392"><a href="#392" class="headerlink" title="392"></a><a name="392">392</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isSubsequence</span><span class="params">(self, s, t)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type s: str</span></span><br><span class="line"><span class="string">        :type t: str</span></span><br><span class="line"><span class="string">        :rtype: bool</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        queue = collections.deque(s)</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> t:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> queue: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> c == queue[<span class="number">0</span>]:</span><br><span class="line">                queue.popleft()</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> queue</span><br></pre></td></tr></table></figure>



<h3 id="438"><a href="#438" class="headerlink" title="438"></a><a name="438">438</a></h3><h5 id="TLE…-1"><a href="#TLE…-1" class="headerlink" title="TLE…"></a>TLE…</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findAnagrams</span><span class="params">(self, s: str, p: str)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        p ==&gt; onehot arr</span></span><br><span class="line"><span class="string">        a b c , [1,1,1,0 0 0... 0], len == 26</span></span><br><span class="line"><span class="string">        b a c </span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        trvs string s w/ sliding window</span></span><br><span class="line"><span class="string">        fr idx 0 to idx len(s)-1-len(p) to check</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># result = [-1]   # means p NOT within s</span></span><br><span class="line">        window = len(p)</span><br><span class="line">        d = &#123;&#125;  <span class="comment"># &#123;[1 1 1 0 0 0 ]:</span></span><br><span class="line">                <span class="comment">#     ['abc', 'cba'...]</span></span><br><span class="line">                <span class="comment"># &#125;</span></span><br><span class="line">        onehot_p = self.onehot2encode(p)</span><br><span class="line">        d[tuple(onehot_p)] = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(len(s)-(window<span class="number">-1</span>)):</span><br><span class="line">            pat = s[k:k+window] <span class="comment"># CAUTIOUS! k:k+window!!!</span></span><br><span class="line">            onehot = self.onehot2encode(pat)</span><br><span class="line">            <span class="comment"># use onehot as key </span></span><br><span class="line">            <span class="comment"># if onehot not in d:</span></span><br><span class="line">            <span class="comment">#     # d[onehot_t] = [pat]</span></span><br><span class="line">            <span class="comment">#     d[onehot] = [k]</span></span><br><span class="line">            <span class="keyword">if</span> tuple(onehot) <span class="keyword">in</span> d:</span><br><span class="line">                d[tuple(onehot)].append(k)</span><br><span class="line">        </span><br><span class="line">        ans = d[tuple(onehot_p)]</span><br><span class="line">        <span class="comment"># if not ans: # ans is []</span></span><br><span class="line">        <span class="comment">#     ans = [-1]</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">onehot2encode</span><span class="params">(self, p)</span>:</span>  <span class="comment"># bucket sort</span></span><br><span class="line">        onehot = [<span class="number">0</span>] * <span class="number">26</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(p)):</span><br><span class="line">            onehot[ord(p[i]) - ord(<span class="string">'a'</span>)] += <span class="number">1</span> </span><br><span class="line">        <span class="keyword">return</span> onehot</span><br><span class="line">         <span class="comment"># [1,1,1,0 0 0... 0]</span></span><br></pre></td></tr></table></figure>

<h5 id="Sliding-Window-1"><a href="#Sliding-Window-1" class="headerlink" title="Sliding Window"></a>Sliding Window</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findAnagrams</span><span class="params">(self, s: str, p: str)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        p ==&gt; onehot arr</span></span><br><span class="line"><span class="string">        a b c , [1,1,1,0 0 0... 0], len == 26</span></span><br><span class="line"><span class="string">        b a c </span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        trvs string s w/ sliding window</span></span><br><span class="line"><span class="string">        fr idx 0 to idx len(s)-1-len(p) to check</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        </span><br><span class="line">        window = len(p)</span><br><span class="line">        d = &#123;&#125;  <span class="comment"># &#123;[1 1 1 0 0 0 ]:</span></span><br><span class="line">                <span class="comment">#     ['abc', 'cba'...]</span></span><br><span class="line">                <span class="comment"># &#125;</span></span><br><span class="line">        onehot_p = self.onehot2encode(p)</span><br><span class="line">        </span><br><span class="line">        onehot_s = [<span class="number">0</span>] * <span class="number">26</span></span><br><span class="line">        ans = []</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(len(s)):</span><br><span class="line">            onehot_s[ord(s[k])-ord(<span class="string">'a'</span>)] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> k &gt;= window:</span><br><span class="line">                onehot_s[ord(s[k-window])-ord(<span class="string">'a'</span>)] -= <span class="number">1</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">if</span> onehot_s == onehot_p:</span><br><span class="line">                ans.append(k-window+<span class="number">1</span>)</span><br><span class="line">                       </span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        for k in range(len(s)-(window-1)):</span></span><br><span class="line"><span class="string">            pat = s[k:k+window] # CAUTIOUS! k:k+window!!!</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            DON'T HAVE TO CALC ENCODING OF EACH P</span></span><br><span class="line"><span class="string">            onehot = self.onehot2encode(pat)</span></span><br><span class="line"><span class="string">            # use onehot as key </span></span><br><span class="line"><span class="string">            # if onehot not in d:</span></span><br><span class="line"><span class="string">            #     # d[onehot_t] = [pat]</span></span><br><span class="line"><span class="string">            #     d[onehot] = [k]</span></span><br><span class="line"><span class="string">            if tuple(onehot) in d:</span></span><br><span class="line"><span class="string">                d[tuple(onehot)].append(k)</span></span><br><span class="line"><span class="string">                        </span></span><br><span class="line"><span class="string">        ans = d[tuple(onehot_p)]</span></span><br><span class="line"><span class="string">        # if not ans: # ans is []</span></span><br><span class="line"><span class="string">        #     ans = [-1]</span></span><br><span class="line"><span class="string">        return ans</span></span><br><span class="line"><span class="string">        '''</span> <span class="comment"># TLE</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        lookup = set([]) # to record p already showed up in s </span></span><br><span class="line"><span class="string">        ans = []</span></span><br><span class="line"><span class="string">        for k in range(len(s)-(window-1)):</span></span><br><span class="line"><span class="string">            pat = s[k:k+window]</span></span><br><span class="line"><span class="string">            if pat in lookup:</span></span><br><span class="line"><span class="string">                ans.append(k)</span></span><br><span class="line"><span class="string">            else:</span></span><br><span class="line"><span class="string">                # CALCULATE ENBEDDING</span></span><br><span class="line"><span class="string">                onehot = self.onehot2encode(pat)</span></span><br><span class="line"><span class="string">                if onehot == onehot_p:</span></span><br><span class="line"><span class="string">                    ans.append(k)</span></span><br><span class="line"><span class="string">        return ans</span></span><br><span class="line"><span class="string">        '''</span> <span class="comment"># STILL TLE</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">onehot2encode</span><span class="params">(self, p)</span>:</span>  <span class="comment"># bucket sort</span></span><br><span class="line">        onehot = [<span class="number">0</span>] * <span class="number">26</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(p)):</span><br><span class="line">            onehot[ord(p[i]) - ord(<span class="string">'a'</span>)] += <span class="number">1</span> </span><br><span class="line">        <span class="keyword">return</span> onehot</span><br><span class="line">         <span class="comment"># [1,1,1,0 0 0... 0]</span></span><br></pre></td></tr></table></figure>



<h3 id="523"><a href="#523" class="headerlink" title="523"></a><a name="523">523</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSubarraySum</span><span class="params">(self, nums: List[int], k: int)</span> -&gt; bool:</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        1. loop nums</span></span><br><span class="line"><span class="string">            for start</span></span><br><span class="line"><span class="string">                for end</span></span><br><span class="line"><span class="string">                    for btw start end to check the sum</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">            O(n^3) 3 power of n</span></span><br><span class="line"><span class="string">        2. build a pre_sum , cumulative sum --&gt; cs</span></span><br><span class="line"><span class="string">            [23, 2, 4,  6   7 ]</span></span><br><span class="line"><span class="string">          =&gt;[0, 25, 29, 35, 42]  O(n)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">            for start ()</span></span><br><span class="line"><span class="string">                for end to len(1, cs)</span></span><br><span class="line"><span class="string">                    check </span></span><br><span class="line"><span class="string">                    cs[end] - cs[start] + nums[i]</span></span><br><span class="line"><span class="string">        3. pre_sum </span></span><br><span class="line"><span class="string">            [23, 2, 4,  6   7 ]</span></span><br><span class="line"><span class="string">          =&gt;[0, 23, 25, 29, 35, 42]  O(n)  cs</span></span><br><span class="line"><span class="string">            &#123;</span></span><br><span class="line"><span class="string">                0:0</span></span><br><span class="line"><span class="string">                23:1</span></span><br><span class="line"><span class="string">                25:2</span></span><br><span class="line"><span class="string">            &#125; ==&gt; &#123;cum: i&#125;</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            k = 6</span></span><br><span class="line"><span class="string">            residual = 29 - 6 == &gt; 23 @ cs[1] and check index to know interval &gt; 1,  curr - i &gt; 1 </span></span><br><span class="line"><span class="string">            then return True!</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        </span><br><span class="line">        pre_sum = [<span class="number">0</span>] + [<span class="number">0</span>] * len(nums)</span><br><span class="line">        cum = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">            cum += nums[idx]</span><br><span class="line">            pre_sum[idx+<span class="number">1</span>] = cum </span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>:</span><br><span class="line">            <span class="string">'''</span></span><br><span class="line"><span class="string">            [0 0 0 0 0 0]</span></span><br><span class="line"><span class="string">          [0 0 0 0 0 0 0]</span></span><br><span class="line"><span class="string">            '''</span></span><br><span class="line">            <span class="comment"># d = &#123;0:0&#125;</span></span><br><span class="line">            <span class="keyword">for</span> idx <span class="keyword">in</span> range(len(pre_sum)<span class="number">-2</span>):</span><br><span class="line">                <span class="keyword">if</span> pre_sum[idx] == pre_sum[idx+<span class="number">2</span>]:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            </span><br><span class="line">        <span class="comment"># lookup = &#123;0:0&#125;</span></span><br><span class="line">        lookup = &#123;k:<span class="number">0</span>&#125;</span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">          [23, 2, 4, 6, 7]</span></span><br><span class="line"><span class="string">        [0,23, 25, 29, 35, 42 ]  k==6</span></span><br><span class="line"><span class="string">        lookup &#123;6-23%6:1, 6-25%6:2, &#125;</span></span><br><span class="line"><span class="string">               &#123;0:0, 1:1, 5:2, 1(HIT!):3(X), 1:4(X), &#125;</span></span><br><span class="line"><span class="string">                3-1 &gt; 1 ==&gt; True! </span></span><br><span class="line"><span class="string">                </span></span><br><span class="line"><span class="string">          [23, 2, 6, 4, 7]</span></span><br><span class="line"><span class="string">        [0,23, 25, 31, 35, 42 ]  k==6</span></span><br><span class="line"><span class="string">        lookup &#123;6-23%6:1, 6-25%6:2, &#125;</span></span><br><span class="line"><span class="string">               &#123;0:0, 1:1, 5:2, 5:3(X), 1:4(X), &#125;</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, len(pre_sum)):</span><br><span class="line">            <span class="comment"># pre_sum[j]</span></span><br><span class="line">            <span class="comment"># if pre_sum[j] not in lookup:</span></span><br><span class="line">            <span class="comment">#     lookup[pre_sum[j]] = j</span></span><br><span class="line">            mod = k - pre_sum[j]%k    </span><br><span class="line">            <span class="keyword">if</span> mod <span class="keyword">not</span> <span class="keyword">in</span> lookup:</span><br><span class="line">                lookup[mod] = j</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> j - lookup[mod] &gt; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>



<h3 id="700"><a href="#700" class="headerlink" title="700"></a><a name="700">700</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">searchBST</span><span class="params">(self, root: TreeNode, val: int)</span> -&gt; TreeNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">while</span> root:</span><br><span class="line">            <span class="keyword">if</span> val &lt; root.val:</span><br><span class="line">                root = root.left</span><br><span class="line">            <span class="keyword">elif</span> val &gt; root.val:</span><br><span class="line">                root = root.right</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> root</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>



<h3 id="701"><a href="#701" class="headerlink" title="701"></a><a name="701">701</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">insertIntoBST</span><span class="params">(self, root: TreeNode, val: int)</span> -&gt; TreeNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> root</span><br><span class="line"></span><br><span class="line">        t1 = root</span><br><span class="line">        <span class="keyword">while</span> t1:</span><br><span class="line">            print(t1.val)</span><br><span class="line">            <span class="keyword">if</span> t1.val &gt; val:</span><br><span class="line">                <span class="keyword">if</span> t1.left:</span><br><span class="line">                    t1 = t1.left</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    t1.left = TreeNode(val)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> t1.right:</span><br><span class="line">                    t1 = t1.right</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    t1.right = TreeNode(val)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> root</span><br><span class="line"><span class="comment">#         if not root:</span></span><br><span class="line"><span class="comment">#             return root</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#         # _root = root</span></span><br><span class="line"><span class="comment">#         # prev = None</span></span><br><span class="line"><span class="comment">#         _root = root</span></span><br><span class="line"><span class="comment">#         while root:</span></span><br><span class="line"><span class="comment">#             # prev = root</span></span><br><span class="line"><span class="comment">#             print(root.val)</span></span><br><span class="line"><span class="comment">#             if val &lt; root.val:</span></span><br><span class="line"><span class="comment">#                 if root.left:</span></span><br><span class="line"><span class="comment">#                     root = root.left</span></span><br><span class="line"><span class="comment">#                 else:</span></span><br><span class="line"><span class="comment">#                     root.left = TreeNode(val)</span></span><br><span class="line"><span class="comment">#                     break</span></span><br><span class="line"><span class="comment">#             elif val &gt; root.val:</span></span><br><span class="line"><span class="comment">#                 if root.right:</span></span><br><span class="line"><span class="comment">#                     root = root.right</span></span><br><span class="line"><span class="comment">#                 else:</span></span><br><span class="line"><span class="comment">#                     root.right = TreeNode(val)</span></span><br><span class="line"><span class="comment">#                     break</span></span><br><span class="line"><span class="comment">#             return _root</span></span><br></pre></td></tr></table></figure>



<h3 id="825"><a href="#825" class="headerlink" title="825"></a><a name="825">825</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numFriendRequests</span><span class="params">(self, ages: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type ages: List[int]</span></span><br><span class="line"><span class="string">        :rtype: int</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        cnt = collections.Counter(ages)</span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> age <span class="keyword">in</span> ages:</span><br><span class="line">            cnt[age] -= <span class="number">1</span></span><br><span class="line">            left, right = age // <span class="number">2</span> + <span class="number">8</span>, age</span><br><span class="line">            ans += sum(cnt[age] <span class="keyword">for</span> age <span class="keyword">in</span> range(left, right + <span class="number">1</span>))</span><br><span class="line">            cnt[age] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>



<h3 id="896"><a href="#896" class="headerlink" title="896"></a><a name="896">896</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isMonotonic</span><span class="params">(self, A)</span>:</span></span><br><span class="line">        increasing = decreasing = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(A) - <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> A[i] &gt; A[i+<span class="number">1</span>]:</span><br><span class="line">                increasing = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">if</span> A[i] &lt; A[i+<span class="number">1</span>]:</span><br><span class="line">                decreasing = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> increasing <span class="keyword">or</span> decreasing</span><br></pre></td></tr></table></figure>



<h3 id="907"><a href="#907" class="headerlink" title="907"></a><a name="907">907</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">heights      [2 1 5 6 2 3]</span></span><br><span class="line"><span class="string">dis_l        [0 1 0 0 3 0]</span></span><br><span class="line"><span class="string">dis_r        [0 4 1 0 1 0]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">For idx in range(len(heights)):</span></span><br><span class="line"><span class="string">    (dis_l + 1 + dis_r) * heights[idx]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">res   [0 (1+4+1)*1, (0+1+1)*2, 0, (1+1+1)*2, 0]</span></span><br><span class="line"><span class="string">return max(res)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">largestRectangleArea</span><span class="params">(self, heights: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> heights:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        n = len(heights)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># left[i], right[i] represent how many bars are &gt;= than the current bar</span></span><br><span class="line"></span><br><span class="line">        left = [<span class="number">1</span>] * n</span><br><span class="line">        right = [<span class="number">1</span>] * n</span><br><span class="line">        max_rect = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># calculate left</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</span><br><span class="line">            j = i - <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> j &gt;= <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> heights[j] &gt;= heights[i]:</span><br><span class="line">                    left[i] += left[j]</span><br><span class="line">                    j -= left[j]</span><br><span class="line">                <span class="keyword">else</span>: <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># calculate right</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n - <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            j = i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> j &lt; n:</span><br><span class="line">                <span class="keyword">if</span> heights[j] &gt;= heights[i]:</span><br><span class="line">                    right[i] += right[j]</span><br><span class="line">                    j += right[j]</span><br><span class="line">                <span class="keyword">else</span>: <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</span><br><span class="line">            max_rect = max(max_rect, heights[i] * (left[i] + right[i] - <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> max_rect</span><br></pre></td></tr></table></figure>



<h3 id="953"><a href="#953" class="headerlink" title="953"></a><a name="953">953</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isAlienSorted</span><span class="params">(self, words: List[str], order: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="comment"># 1. build mapping score for each c in order str</span></span><br><span class="line">        <span class="comment"># 2. assign pointer at head of each of the word in words and check the mapping score relationship</span></span><br><span class="line">        <span class="comment"># 3. empty hel'' &lt; hel'l'</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> words <span class="keyword">or</span> <span class="keyword">not</span> order: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        score = &#123;<span class="string">''</span>:<span class="number">0</span>&#125;</span><br><span class="line">        <span class="keyword">for</span> idx <span class="keyword">in</span> range(len(order)):</span><br><span class="line">            score[order[idx]] = idx+<span class="number">1</span></span><br><span class="line">            </span><br><span class="line">        n = len(words)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(words)<span class="number">-1</span>):</span><br><span class="line">            <span class="comment"># compare word by word</span></span><br><span class="line">            a, b = words[i], words[i+<span class="number">1</span>]</span><br><span class="line">            _len = min(len(a), len(b))</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(_len):</span><br><span class="line">                <span class="keyword">if</span> score[a[k]] &lt; score[b[k]]:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">elif</span> score[a[k]] == score[b[k]]:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">if</span> score[a[k]] &gt; score[b[k]]:    <span class="comment"># SERIOUSLY WRONG!!! NOT EACH CHAR, ONLY FIRST CHAR to be compared!!!</span></span><br><span class="line">                    <span class="comment"># print(a[k], b[k])</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                </span><br><span class="line">            <span class="comment"># if len(a) &gt; len(b):   # for [apple, app], but failed when [kuvp, q]</span></span><br><span class="line">                <span class="comment"># return False</span></span><br><span class="line">            <span class="keyword">if</span> len(a) &gt; len(b) <span class="keyword">and</span> a[:_len] == b:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>



<h3 id="958"><a href="#958" class="headerlink" title="958"></a><a name="958">958</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isCompleteTree</span><span class="params">(self, root: TreeNode)</span> -&gt; bool:</span></span><br><span class="line">        have_null = <span class="literal">False</span></span><br><span class="line">        Q = [root]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            cur_node = Q.pop(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> cur_node: </span><br><span class="line">                have_null = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> have_null: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            Q.append(cur_node.left)</span><br><span class="line">            Q.append(cur_node.right)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isCompleteTree</span><span class="params">(self, root: TreeNode)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        res = []</span><br><span class="line">        q = collections.deque([(root, <span class="number">1</span>)])</span><br><span class="line">        <span class="keyword">while</span> q:</span><br><span class="line">            node, pos = q.popleft()</span><br><span class="line">            res.append(pos)</span><br><span class="line">            <span class="keyword">if</span> node.left:</span><br><span class="line">                q.append((node.left, <span class="number">2</span> * pos))</span><br><span class="line">            <span class="keyword">if</span> node.right:</span><br><span class="line">                q.append((node.right, <span class="number">2</span> * pos + <span class="number">1</span>))</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> len(res) == res[<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>



<h3 id="973"><a href="#973" class="headerlink" title="973"></a><a name="973">973</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kClosest</span><span class="params">(self, points: List[List[int]], K: int)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="string">''' N*log(N)</span></span><br><span class="line"><span class="string">        # Q-sort tech</span></span><br><span class="line"><span class="string">        # [dis1, dis2, dis3]</span></span><br><span class="line"><span class="string">        if not points or not K:</span></span><br><span class="line"><span class="string">            return 0</span></span><br><span class="line"><span class="string">        l = []</span></span><br><span class="line"><span class="string">        for xy in points:</span></span><br><span class="line"><span class="string">            heapq.heappush(l, (self.distance(xy), xy[0], xy[1]))  # n*log(n)</span></span><br><span class="line"><span class="string">            # if len(l) &gt; K:</span></span><br><span class="line"><span class="string">            #     heapq._heappop_max(l)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        # map(points, self.distance)</span></span><br><span class="line"><span class="string">        # for point in points:</span></span><br><span class="line"><span class="string">        #     self.distance(point)</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        res = []</span></span><br><span class="line"><span class="string">        for i in range(K):</span></span><br><span class="line"><span class="string">            dis, x, y = heapq.heappop(l)</span></span><br><span class="line"><span class="string">            res.append([x,y])</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">        return res</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        </span><br><span class="line">        <span class="string">'''Following is N*log(K)'''</span></span><br><span class="line">        l = []</span><br><span class="line">        <span class="keyword">for</span> xy <span class="keyword">in</span> points:</span><br><span class="line">            dist = self.distance(xy)</span><br><span class="line">            dist = <span class="number">-1</span>*dist</span><br><span class="line">            <span class="keyword">if</span> len(l) &lt;= K<span class="number">-1</span>:</span><br><span class="line">                heapq.heappush(l, (dist, xy))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># print('---', dist)</span></span><br><span class="line">                <span class="keyword">if</span> dist &gt; l[<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">                    heapq.heappop(l)</span><br><span class="line">                    heapq.heappush(l, (dist, xy))</span><br><span class="line">                    </span><br><span class="line">        res = []</span><br><span class="line">        <span class="comment"># for i in range(len(l)):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(K):</span><br><span class="line">            res.append(heapq.heappop(l)[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">distance</span><span class="params">(self, xy)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> math.sqrt(xy[<span class="number">0</span>]**<span class="number">2</span> + xy[<span class="number">1</span>]**<span class="number">2</span>)<span class="comment">#, xy[0], xy[1]</span></span><br></pre></td></tr></table></figure>

<p>As we can see here, we used heap, but the problem is we still sorted all the element, the time complexity is O(NlogN) .Still we only need the top k smallest element. We don’t need to take of other elements’ order. So if we keep a size of k’s heap, use the heap[0] element as threshhold, interate through the array, only those meet the requirment element get into the heap.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kClosest</span><span class="params">(self, points, K)</span>:</span></span><br><span class="line">    points.sort(key = <span class="keyword">lambda</span> P: P[<span class="number">0</span>]**<span class="number">2</span> + P[<span class="number">1</span>]**<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> points[:K]</span><br></pre></td></tr></table></figure>



<h5 id="Quick-Select"><a href="#Quick-Select" class="headerlink" title="Quick Select"></a>Quick Select</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">kClosest</span><span class="params">(self, points: List[List[int]], K: int)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="comment"># return self.helper_heap_KlgK(points, K)</span></span><br><span class="line">        <span class="keyword">return</span> self.helper_Q_select(points, K)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper_Q_select</span><span class="params">(self, points, K)</span>:</span></span><br><span class="line">        dis = []</span><br><span class="line">        <span class="keyword">for</span> pt <span class="keyword">in</span> points:</span><br><span class="line">            dis.append(self.distance(pt, [<span class="number">0</span>,<span class="number">0</span>]))</span><br><span class="line">        </span><br><span class="line">        self.Q_select(dis, K, points) <span class="comment"># 0, len(dis)-1, K)</span></span><br><span class="line">        <span class="keyword">return</span> points[:K]</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Q_select</span><span class="params">(self, dis, K, points)</span>:</span></span><br><span class="line">        </span><br><span class="line">        l, r = <span class="number">0</span>, len(dis)<span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            meetup = self.partition(dis, l, r, points)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> meetup == K:</span><br><span class="line">                <span class="keyword">return</span> </span><br><span class="line">            <span class="keyword">elif</span> meetup &lt; K:</span><br><span class="line">                l = meetup + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r = meetup - <span class="number">1</span>        </span><br><span class="line">                </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partition</span><span class="params">(self, arr, low, high, points)</span>:</span></span><br><span class="line">        <span class="comment"># def swap(x, y):</span></span><br><span class="line">        <span class="comment">#     x, y = y, x</span></span><br><span class="line">            </span><br><span class="line">        i = low - <span class="number">1</span></span><br><span class="line">        pvt = arr[high]      </span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">              3    0 5 4 1 8 2 2</span></span><br><span class="line"><span class="string">        low              high </span></span><br><span class="line"><span class="string">        X    X X 2 Y Y Y Y </span></span><br><span class="line"><span class="string">               i         4   </span></span><br><span class="line"><span class="string">        # 0 1 2 2</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(low, high):</span><br><span class="line">            <span class="keyword">if</span> arr[j] &lt;= pvt:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">                arr[i], arr[j] = arr[j], arr[i]</span><br><span class="line">                points[i], points[j] = points[j], points[i]</span><br><span class="line">                <span class="comment"># swap(arr[j], arr[i])      # NO USE</span></span><br><span class="line">                <span class="comment"># swap(points[j], points[i])</span></span><br><span class="line">            </span><br><span class="line">        <span class="comment"># swap(arr[i+1], arr[high])</span></span><br><span class="line">        <span class="comment"># swap(points[i+1], points[high])</span></span><br><span class="line">        arr[i+<span class="number">1</span>], arr[high] = arr[high], arr[i+<span class="number">1</span>]</span><br><span class="line">        points[i+<span class="number">1</span>], points[high] = points[high], points[i+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> i+<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partitionX</span><span class="params">(self, arr, l, r, points)</span>:</span> <span class="comment"># 18, 26, 20</span></span><br><span class="line">        pvt = arr[l]</span><br><span class="line">        pvt_point = points[l]</span><br><span class="line">        i = l+<span class="number">1</span></span><br><span class="line">        j = r</span><br><span class="line">                    </span><br><span class="line">        <span class="keyword">while</span> i &lt; j:</span><br><span class="line">            <span class="string">'''</span></span><br><span class="line"><span class="string">               3 2 1 5 0 8 7 4   </span></span><br><span class="line"><span class="string">             pvt i i i</span></span><br><span class="line"><span class="string">                       j, </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">               3 2 1 0</span></span><br><span class="line"><span class="string">             pvt  </span></span><br><span class="line"><span class="string">                     i</span></span><br><span class="line"><span class="string">            '''</span>            </span><br><span class="line">            <span class="keyword">while</span> arr[i] &lt; pvt <span class="keyword">and</span> i &lt; j:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> arr[j] &gt; pvt <span class="keyword">and</span> i &lt; j:</span><br><span class="line">                j -= <span class="number">1</span></span><br><span class="line">            <span class="comment"># if i &lt; j:</span></span><br><span class="line">            <span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">                arr[i], arr[j] = arr[j], arr[i]</span><br><span class="line">                points[i], points[j] = points[j], points[i]</span><br><span class="line">                <span class="comment"># i += 1</span></span><br><span class="line">                <span class="comment"># j -= 1</span></span><br><span class="line">        <span class="comment"># arr[l], arr[i] = arr[i], pvt   # arr[l] WRONG!</span></span><br><span class="line">        <span class="comment"># points[l], points[i] = points[i], pvt_point   # arr[l] WRONG!</span></span><br><span class="line">        <span class="keyword">return</span> j</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper_heap_KlgK</span><span class="params">(self, points, K)</span>:</span>  <span class="comment"># should use max-heap since we pop out unwanted ones   </span></span><br><span class="line">        l = []</span><br><span class="line">        <span class="keyword">for</span> pt <span class="keyword">in</span> points:   <span class="comment"># O(N*lg(K))</span></span><br><span class="line">            <span class="comment"># heapq._heappush_max(l, (self.distance(pt, [0,0]), pt))</span></span><br><span class="line">            heapq.heappush(l, (<span class="number">-1</span>*self.distance(pt, [<span class="number">0</span>,<span class="number">0</span>]), pt))</span><br><span class="line">            <span class="keyword">if</span> len(l) == K+<span class="number">1</span>:</span><br><span class="line">                heapq.heappop(l)</span><br><span class="line">        </span><br><span class="line">        Q = deque()</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(l)):</span><br><span class="line">            _, pt = heapq.heappop(l)</span><br><span class="line">            Q.appendleft(pt)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> Q</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper_heap_NlgN</span><span class="params">(self, points, K)</span>:</span></span><br><span class="line">        </span><br><span class="line">        l = []</span><br><span class="line">        <span class="keyword">for</span> pt <span class="keyword">in</span> points:   <span class="comment"># O(N*lg(N))</span></span><br><span class="line">            <span class="comment"># l.append(self.distance(pt, [0,0]), pt)</span></span><br><span class="line">            heapq.heappush(l, (self.distance(pt, [<span class="number">0</span>,<span class="number">0</span>]), pt))</span><br><span class="line">            </span><br><span class="line">        ans = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(K):</span><br><span class="line">            _, pt = heapq.heappop(l)</span><br><span class="line">            ans.append(pt)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>

<p><strong>Complexity Analysis</strong></p>
<ul>
<li>Quick: Time Complexity: <em>O</em>(<em>N</em>) in <em>average case</em> complexity, where N<em>N</em> is the length of <code>points</code>., worst is O(N^2)</li>
<li>Space Complexity: <em>O</em>(<em>N</em>).</li>
</ul>
<h3 id="1027"><a href="#1027" class="headerlink" title="1027"></a><a name="1027">1027</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">longestArithSeqLength</span><span class="params">(self, A: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> A:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="comment"># [3,6,9,12,13]</span></span><br><span class="line">        <span class="comment"># when i=1, A[i]=6:</span></span><br><span class="line">        <span class="comment"># dp=[&#123;3:2&#125;]</span></span><br><span class="line">        <span class="comment"># when i=2, A[i]=9:</span></span><br><span class="line">        <span class="comment"># dp=[&#123;3:2&#125;, &#123;6:2, 3:3&#125;]</span></span><br><span class="line">        <span class="comment"># when i=2, A[i]=12:</span></span><br><span class="line">        <span class="comment"># dp=[&#123;3:2&#125;, &#123;6:2, 3:3&#125;, &#123;9:2, 6:2, 3:4&#125;, &#123;10:2, 7:2, 4:2, 1:2&#125;]</span></span><br><span class="line">        <span class="comment"># return max([2,3,4,2])</span></span><br><span class="line">    </span><br><span class="line">        dp = [dict() <span class="keyword">for</span> i <span class="keyword">in</span> range(len(A))]</span><br><span class="line">        max_len = <span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(A)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(i):</span><br><span class="line">                dp[i][A[i] - A[j]] = dp[j].get(A[i] - A[j], <span class="number">1</span>) + <span class="number">1</span>   <span class="comment"># min length btw 2 items is 2</span></span><br><span class="line">                max_len = max(max_len, dp[i][A[i] - A[j]])</span><br><span class="line">            <span class="comment"># print(dp[i])</span></span><br><span class="line">        <span class="keyword">return</span> max_len</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">        dp = [dict()]</span><br><span class="line">        ret = <span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(A)):</span><br><span class="line">            dp.append(&#123;&#125;)</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(i):</span><br><span class="line">                dp[i][A[i] - A[j]] = dp[j].get(A[i] - A[j], <span class="number">1</span>) + <span class="number">1</span></span><br><span class="line">                <span class="comment"># ret = max(ret, dp[i][j]);</span></span><br><span class="line">        <span class="comment"># print(dp)</span></span><br><span class="line">        <span class="comment"># print(max([max(i.values()) for i in dp if i.values()]))</span></span><br><span class="line">        ret = max([max(i.values()) <span class="keyword">for</span> i <span class="keyword">in</span> dp <span class="keyword">if</span> i.values()])</span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure>

<p>Time: O(n^2)<br>Space: O(n^2)</p>
<p>ref : <a href="https://leetcode.flowerplayer.com/2019/04/12/leetcode-907-sum-of-subarray-minimums-解题思路分析/" target="_blank" rel="noopener">https://leetcode.flowerplayer.com/2019/04/12/leetcode-907-sum-of-subarray-minimums-%e8%a7%a3%e9%a2%98%e6%80%9d%e8%b7%af%e5%88%86%e6%9e%90/</a></p>
<h3 id="1143-LCS"><a href="#1143-LCS" class="headerlink" title="1143 LCS"></a><a name="1143">1143 LCS</a></h3><h5 id="Brute-Force-2-m-because-of-backtracking-to-generate-all-subsequences"><a href="#Brute-Force-2-m-because-of-backtracking-to-generate-all-subsequences" class="headerlink" title="Brute Force - 2**m because of backtracking to generate all subsequences"></a>Brute Force - 2**m because of backtracking to generate all subsequences</h5><img src="/Users/joe/Library/Application Support/typora-user-images/image-20200203163052247.png" alt="image-20200203163052247" style="zoom:50%;" />

<p>REF: <a href="https://www.itread01.com/content/1546179722.html" target="_blank" rel="noopener">常見最長子串及子序列</a></p>
<h5 id="DP"><a href="#DP" class="headerlink" title="DP"></a>DP</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">s1 = 'abcde'</span></span><br><span class="line"><span class="string">     </span></span><br><span class="line"><span class="string">s2 = 'ace'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">DP</span></span><br><span class="line"><span class="string">    a c e </span></span><br><span class="line"><span class="string">  0 0 0 0 </span></span><br><span class="line"><span class="string">a 0 1 1 1 </span></span><br><span class="line"><span class="string">b 0 1 1 1</span></span><br><span class="line"><span class="string">c 0 1 2 2</span></span><br><span class="line"><span class="string">d 0 1 2 2</span></span><br><span class="line"><span class="string">e 0 1 2 3</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">because s1[2] == s2[0], both are 'c'</span></span><br><span class="line"><span class="string">  DP[3][2] = DP[3-1][2-1] + 1</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">  DP[m][n] = DP[m-1][n] + D[m][n-1] + 1</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">longestCommonSubsequence</span><span class="params">(self, text1: str, text2: str)</span> -&gt; int:</span></span><br><span class="line">        m, n = len(text1), len(text2)</span><br><span class="line">        dp = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(n+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> range(m+<span class="number">1</span>)]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, m+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> text1[i<span class="number">-1</span>] != text2[j<span class="number">-1</span>]:</span><br><span class="line">                    dp[i][j] = max(dp[i<span class="number">-1</span>][j], dp[i][j<span class="number">-1</span>])</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dp[i][j] = dp[i<span class="number">-1</span>][j<span class="number">-1</span>] + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> dp[m][n]</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/01/08/Design-Patterns/2019-01-08-Design%20Patterns%20-%20Mediator/">Design-Patterns/2019-01-08-Design Patterns - Mediator</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-08</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/DesignPattern/">DesignPattern</a></span><div class="content"><h3 id="Mediator-Pattern"><a href="#Mediator-Pattern" class="headerlink" title="Mediator Pattern"></a>Mediator Pattern</h3><p>The mediator allows implitcit interaction btw objects, and therefore decoupling between them, making them independent to each other.</p>
<p>Example: houselord (landlord) vs tenant　，Other example like chatroom</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># landlord INTERFACE</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HouseOwner</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">action</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># tenant IMPL</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HouseRent</span><span class="params">(HouseOwner)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">action</span><span class="params">(self)</span>:</span></span><br><span class="line">    print(<span class="string">"Customer here to rent house"</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># renting/sell IMPL</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HouseSale</span><span class="params">(HouseOwner)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">action</span><span class="params">(self)</span>:</span></span><br><span class="line">    print(<span class="string">"To sell/rent house"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># MEDIATOR</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mediator</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self, content)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MEDIATOR IMPL</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MediatorImpl</span><span class="params">(Mediator)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">    self.owner1 = HouseRent()</span><br><span class="line">    self.owner2 = HouseSale()</span><br><span class="line">    </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self, content)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">"rent"</span> == content:</span><br><span class="line">      self.owner1.action()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"sale"</span> == content:</span><br><span class="line">      self.owner2.action()</span><br><span class="line">      </span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">TESTING</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">mediator = MediatorImpl()</span><br><span class="line"></span><br><span class="line"><span class="comment"># The mediator helps coordiante btw landlord &amp; tenant</span></span><br><span class="line">mediator.handle(<span class="string">"rent"</span>)</span><br><span class="line">mediator.handle(<span class="string">"sale"</span>)</span><br><span class="line"></span><br><span class="line">-----------------------------</span><br><span class="line">Customer here to rent house</span><br><span class="line">To Sell/rent house</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/006tNbRwly1gap722mnbgj30mn06kq3w.jpg" alt="image-20200108153907776"></p>
</div><hr></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By Joe Huang</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>