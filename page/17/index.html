<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="Joe Huang"><meta name="copyright" content="Joe Huang"><title>Awaken Desparado</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-180692466-1', 'auto');
ga('send', 'pageview');</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.2.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Joe Huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">384</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">26</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">66</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Awaken Desparado</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Awaken Desparado</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/20/SQL/2020-02-20-SQL-Create%20Table/">SQL/2020-02-20-SQL-Create Table</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-20</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><p><a href="https://www.codecademy.com/courses/learn-sql/projects/learn_sql_create_table" target="_blank" rel="noopener">https://www.codecademy.com/courses/learn-sql/projects/learn_sql_create_table</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> friends(</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">INTEGER</span>,</span><br><span class="line">  <span class="keyword">name</span> <span class="built_in">TEXT</span>,</span><br><span class="line">  birthday <span class="built_in">DATE</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- alter table friends</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> friends (<span class="keyword">id</span>, <span class="keyword">name</span>, birthday)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">'Jane Doe'</span>, <span class="string">'1990-05-30'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> friends;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> friends (<span class="keyword">id</span>, <span class="keyword">name</span>, birthday)</span><br><span class="line"><span class="keyword">values</span> (<span class="number">2</span>, <span class="string">'Alex'</span>, <span class="string">'1986-06-06'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> friends (<span class="keyword">id</span>, <span class="keyword">name</span>, birthday)</span><br><span class="line"><span class="keyword">values</span> (<span class="number">3</span>, <span class="string">'Tina'</span>, <span class="string">'1984-12-12'</span>);</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> friends;</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> friends</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">name</span> = <span class="string">'Jane Smith'</span></span><br><span class="line"><span class="keyword">where</span> <span class="keyword">id</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> friends;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLe</span> friends</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> email <span class="built_in">TEXT</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> friends</span><br><span class="line"><span class="keyword">set</span> email = <span class="string">'jane@codecademy.com'</span></span><br><span class="line"><span class="keyword">where</span> <span class="keyword">id</span> = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> friends;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> friends</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">id</span>  = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> friends;</span><br><span class="line"><span class="comment">-- alter table friends (name)</span></span><br><span class="line"><span class="comment">-- values (1, )</span></span><br></pre></td></tr></table></figure>



<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc2ud71ragj30oe0vwtbb.jpg" alt="image-20200220141807884" style="zoom:50%;" /></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/20/SQL/2020-02-21-SQL-analyzation,%20Funnel%20&amp;%20Churn%20Rate/">SQL/2020-02-21-SQL-analyzation, Funnel &amp; Churn Rate</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-20</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><p><a href="https://s3.amazonaws.com/codecademy-content/courses/sql-intensive/SQL_diagram_v6.pdf" target="_blank" rel="noopener">https://s3.amazonaws.com/codecademy-content/courses/sql-intensive/SQL_diagram_v6.pdf</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> premium_users.user_id,</span><br><span class="line">  months.months,</span><br><span class="line">  <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> (</span><br><span class="line">      premium_users.purchase_date &lt;= months.months</span><br><span class="line">      )</span><br><span class="line">      <span class="keyword">AND</span></span><br><span class="line">      (</span><br><span class="line">        premium_users.cancel_date &gt;= months.months</span><br><span class="line">        <span class="keyword">OR</span></span><br><span class="line">        premium_users.cancel_date <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line">      )</span><br><span class="line">    <span class="keyword">THEN</span> <span class="string">'active'</span></span><br><span class="line">    <span class="keyword">ELSE</span> <span class="string">'not_active'</span></span><br><span class="line">  <span class="keyword">END</span> <span class="keyword">AS</span> <span class="string">'status'</span></span><br><span class="line"><span class="keyword">FROM</span> premium_users</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> <span class="keyword">months</span>;</span><br></pre></td></tr></table></figure>



<h2 id="Build-a-Funnel-From-a-Single-Table"><a href="#Build-a-Funnel-From-a-Single-Table" class="headerlink" title="Build a Funnel From a Single Table"></a>Build a Funnel From a Single Table</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> survey_responses <span class="keyword">limit</span> <span class="number">15</span>;</span><br><span class="line"><span class="comment">-- with count_of_users as(</span></span><br><span class="line"><span class="comment">--   select user_id, count(*) as nums</span></span><br><span class="line"><span class="comment">--   from survey_responses</span></span><br><span class="line"><span class="comment">--   group by user_id</span></span><br><span class="line"><span class="comment">--   order by count(*) desc</span></span><br><span class="line"><span class="comment">-- )  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select user_id, count(*)</span></span><br><span class="line"><span class="comment">-- from count_of_users</span></span><br><span class="line"><span class="comment">-- where nums = 5;  # SINCE 5 Questions</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> question_text, </span><br><span class="line">   <span class="keyword">count</span>(<span class="keyword">distinct</span> user_id)</span><br><span class="line"><span class="keyword">from</span> survey_responses</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> question_text;</span><br></pre></td></tr></table></figure>



<hr>
<p><em>If we divide the number of people completing each step by the number of people completing the previous step:</em></p>
<table>
<thead>
<tr>
<th>Question</th>
<th>Percent Completed this Question</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>100%</td>
</tr>
<tr>
<td>2</td>
<td>95%</td>
</tr>
<tr>
<td>3</td>
<td>82%</td>
</tr>
<tr>
<td>4</td>
<td>95%</td>
</tr>
<tr>
<td>5</td>
<td>74%</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>We see that Questio<em>ns 2 and 4 have high completion rates, but Questions 3 and 5 have lower rates.</em></p>
<p><em>This suggests that age and household income are more sensitive questions that people might be reluctant to answer!</em></p>
<hr>
<h2 id="Compare-Funnels-for-A-B-Tests"><a href="#Compare-Funnels-for-A-B-Tests" class="headerlink" title="Compare Funnels for A/B Tests"></a>Compare Funnels for A/B Tests</h2><p>They’ve set up an A/B test where:</p>
<ul>
<li>50% of users view the original <code>control</code> version of the pop-ups</li>
<li>50% of users view the new <code>variant</code> version of the pop-ups</li>
</ul>
<p>Eventually, we’ll want to answer the question:</p>
<p><em>How is the funnel different between the two groups?</em></p>
<p>We will be using a table called <code>onboarding_modals</code> with the following columns:</p>
<ul>
<li><code>user_id</code> - the user identifier</li>
<li><code>modal_text</code> - the modal step</li>
<li><code>user_action</code> - the user response (Close Modal or Continue)</li>
<li><code>ab_group</code> - the version (control or variant)</li>
</ul>
<p><strong>2.</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 2</span></span><br><span class="line"><span class="comment">-- select modal_text, </span></span><br><span class="line"><span class="comment">--   count(distinct user_id)</span></span><br><span class="line"><span class="comment">-- from onboarding_modals </span></span><br><span class="line"><span class="comment">-- group by modal_text</span></span><br><span class="line"><span class="comment">-- order by modal_text asc;</span></span><br></pre></td></tr></table></figure>



<p><strong>3.</strong></p>
<p>Delete your previous code.</p>
<p>The previous query combined both the control and variant groups.</p>
<p>We can use a <code>CASE</code> statement within our <code>COUNT()</code> aggregate so that we only count <code>user_id</code>s whose <code>ab_group</code> is equal to ‘control’:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> modal_text,</span><br><span class="line">  <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> ab_group = <span class="string">'control'</span> <span class="keyword">THEN</span> user_id</span><br><span class="line">    <span class="keyword">END</span>) <span class="keyword">AS</span> <span class="string">'control_clicks'</span></span><br><span class="line"><span class="keyword">FROM</span> onboarding_modals</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>Paste this code into the code editor and see what happens.</p>
<p><strong>4.</strong></p>
<p>Add an additional column to your previous query that counts the number of clicks from the variant group and alias it as ‘variant_clicks’.</p>
<p>Hint</p>
<p>Your third column should be:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">COUNT(DISTINCT CASE</span><br><span class="line">  WHEN ab_group = 'variant' THEN user_id</span><br><span class="line">  <span class="keyword">END</span>) <span class="keyword">AS</span> <span class="string">'variant_clicks'</span></span><br></pre></td></tr></table></figure>

<p>Don’t forget that columns need to be separated by a comma!</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> modal_text,</span><br><span class="line">  <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> ab_group = <span class="string">'control'</span> <span class="keyword">THEN</span> user_id</span><br><span class="line">    <span class="keyword">END</span>) <span class="keyword">AS</span> <span class="string">'control_clicks'</span>,</span><br><span class="line">  <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> ab_group = <span class="string">'variant'</span> <span class="keyword">THEN</span> user_id</span><br><span class="line">    <span class="keyword">END</span>) <span class="keyword">AS</span> <span class="string">'variant_clicks'</span></span><br><span class="line"><span class="keyword">FROM</span> onboarding_modals</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>The result should have three columns:</p>
<ul>
<li><code>modal_text</code></li>
<li><code>control_clicks</code></li>
<li><code>variant_clicks</code></li>
</ul>
<p>Now you can see the differences between the control and variant side by side!</p>
<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc3vrr5bsrj30pk07ijsa.jpg" alt="image-20200221115221429" style="zoom:50%;" />



<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc3vvqh9g9j30fs0nkaba.jpg" alt="image-20200221115615095"></p>
<h2 id="Build-a-Funnel-from-Multiple-Tables"><a href="#Build-a-Funnel-from-Multiple-Tables" class="headerlink" title="Build a Funnel from Multiple Tables"></a>Build a Funnel from Multiple Tables</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- with bc as (</span></span><br><span class="line"><span class="comment">--   select *</span></span><br><span class="line"><span class="comment">--   from browse as b</span></span><br><span class="line"><span class="comment">--   left join checkout as c</span></span><br><span class="line"><span class="comment">--   on b.user_id = c.user_id</span></span><br><span class="line"><span class="comment">--   where c.user_id is not null</span></span><br><span class="line"><span class="comment">--   -- limit 50</span></span><br><span class="line"><span class="comment">-- )</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- -- select * from bc limit 15;</span></span><br><span class="line"><span class="comment">-- select * </span></span><br><span class="line"><span class="comment">-- from bc</span></span><br><span class="line"><span class="comment">-- left join purchase as p</span></span><br><span class="line"><span class="comment">-- on bc.user_id = p.user_id</span></span><br><span class="line"><span class="comment">-- limit 50;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- BETTER SOLUTION ●○●○●</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> b.browse_date, b.user_id, </span><br><span class="line">  c.user_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> <span class="string">'is_checkout'</span>,</span><br><span class="line">  p.user_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> <span class="string">'is_purchase'</span></span><br><span class="line"><span class="keyword">from</span> browse <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> checkout <span class="keyword">as</span> c</span><br><span class="line">  <span class="keyword">on</span> b.user_id = c.user_id</span><br><span class="line"><span class="keyword">left</span> <span class="keyword">join</span> purchase <span class="keyword">as</span> p</span><br><span class="line">  <span class="keyword">on</span> p.user_id = b.user_id</span><br><span class="line"><span class="keyword">limit</span> <span class="number">50</span>;</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> funnels <span class="keyword">AS</span> (</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> b.browse_date,</span><br><span class="line">     b.user_id,</span><br><span class="line">     c.user_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> <span class="string">'is_checkout'</span>,</span><br><span class="line">     p.user_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> <span class="string">'is_purchase'</span></span><br><span class="line">  <span class="keyword">FROM</span> browse <span class="keyword">AS</span> <span class="string">'b'</span></span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> checkout <span class="keyword">AS</span> <span class="string">'c'</span></span><br><span class="line">    <span class="keyword">ON</span> c.user_id = b.user_id</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> purchase <span class="keyword">AS</span> <span class="string">'p'</span></span><br><span class="line">    <span class="keyword">ON</span> p.user_id = c.user_id)</span><br><span class="line"><span class="comment">-- SELECT ______</span></span><br><span class="line"><span class="comment">-- _____________;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select * from funnels limit 15;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">as</span> <span class="string">'num_browse'</span>, <span class="keyword">sum</span>(is_checkout) <span class="keyword">as</span> <span class="string">'num_checkout'</span>, <span class="keyword">sum</span>(is_purchase) <span class="keyword">as</span> <span class="string">'num_purchase'</span>,</span><br><span class="line"><span class="number">1.0</span> * <span class="keyword">SUM</span>(is_checkout) / <span class="keyword">COUNT</span>(user_id) <span class="keyword">as</span> <span class="string">'checkout %'</span>, </span><br><span class="line"><span class="number">1.0</span> * <span class="keyword">SUM</span>(is_purchase) / <span class="keyword">SUM</span>(is_checkout) <span class="keyword">as</span> <span class="string">'purchase %'</span></span><br><span class="line"><span class="keyword">from</span> funnels;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc41t7u4ngj30ug038dg7.jpg" alt="image-20200221152122704" style="zoom:50%;" />





<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> funnels <span class="keyword">AS</span> (</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> b.browse_date,</span><br><span class="line">     b.user_id,</span><br><span class="line">     c.user_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> <span class="string">'is_checkout'</span>,</span><br><span class="line">     p.user_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">AS</span> <span class="string">'is_purchase'</span></span><br><span class="line">  <span class="keyword">FROM</span> browse <span class="keyword">AS</span> <span class="string">'b'</span></span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> checkout <span class="keyword">AS</span> <span class="string">'c'</span></span><br><span class="line">    <span class="keyword">ON</span> c.user_id = b.user_id</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> purchase <span class="keyword">AS</span> <span class="string">'p'</span></span><br><span class="line">    <span class="keyword">ON</span> p.user_id = c.user_id)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">SELECT</span> browse_date, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> <span class="string">'num_browse'</span>,</span><br><span class="line">   <span class="keyword">SUM</span>(is_checkout) <span class="keyword">AS</span> <span class="string">'num_checkout'</span>,</span><br><span class="line">   <span class="keyword">SUM</span>(is_purchase) <span class="keyword">AS</span> <span class="string">'num_purchase'</span>,</span><br><span class="line">   <span class="number">1.0</span> * <span class="keyword">SUM</span>(is_checkout) / <span class="keyword">COUNT</span>(user_id) <span class="keyword">AS</span> <span class="string">'browse_to_checkout'</span>,</span><br><span class="line">   <span class="number">1.0</span> * <span class="keyword">SUM</span>(is_purchase) / <span class="keyword">SUM</span>(is_checkout) <span class="keyword">AS</span> <span class="string">'checkout_to_purchase'</span></span><br><span class="line"><span class="keyword">FROM</span> funnels</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> browse_date;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc45hn77ibj312006i3zs.jpg" alt="image-20200221172848148" style="zoom:50%;" />



<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc45jto9t8j30gq0p0gml.jpg" alt="image-20200221173038606" style="zoom: 50%;" />





<h2 id="Usage-Funnels-with-Warby-Parker"><a href="#Usage-Funnels-with-Warby-Parker" class="headerlink" title="Usage Funnels with Warby Parker"></a>Usage Funnels with Warby Parker</h2><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4715qtfhj31qw0caq6d.jpg" alt="image-20200221182158177" style="zoom:67%;" />

<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4724wgkoj31rc09c0uz.jpg" alt="image-20200221182256478" style="zoom:67%;" /><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc473tav67j31qq0ayaeb.jpg" alt="image-20200221182442175"></p>
<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc473xoshtj31rc09c0uz.jpg" alt="image-20200221182256478" style="zoom:67%;" /><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc473tav67j31qq0ayaeb.jpg" alt="image-20200221182442175"></p>
<h2 id="Churn-Rate"><a href="#Churn-Rate" class="headerlink" title="Churn Rate"></a>Churn Rate</h2><h3 id="Single-Month-I"><a href="#Single-Month-I" class="headerlink" title="Single Month I"></a>Single Month I</h3><p>Remember from the previous exercise that churn rate is:</p>
<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc48q5lr2bj307d03ajra.jpg" alt="Churn" style="zoom: 67%;" />

<p>For the numerator, we only want the portion of the customers who cancelled during December:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="number">1.0</span> * </span><br><span class="line">(</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*)</span><br><span class="line">  <span class="keyword">FROM</span> subscriptions</span><br><span class="line">  <span class="keyword">WHERE</span> subscription_start &lt; <span class="string">'2017-01-01'</span></span><br><span class="line">  <span class="keyword">AND</span> (</span><br><span class="line">    subscription_end</span><br><span class="line">    <span class="keyword">BETWEEN</span> <span class="string">'2017-01-01'</span></span><br><span class="line">    <span class="keyword">AND</span> <span class="string">'2017-01-31'</span></span><br><span class="line">  )</span><br><span class="line">) / (</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) </span><br><span class="line">  <span class="keyword">FROM</span> subscriptions </span><br><span class="line">  <span class="keyword">WHERE</span> subscription_start &lt; <span class="string">'2017-01-01'</span></span><br><span class="line">  <span class="keyword">AND</span> (</span><br><span class="line">    (subscription_end &gt;= <span class="string">'2017-01-01'</span>)</span><br><span class="line">    <span class="keyword">OR</span> (subscription_end <span class="keyword">IS</span> <span class="literal">NULL</span>)</span><br><span class="line">  )</span><br><span class="line">) </span><br><span class="line"><span class="keyword">AS</span> <span class="keyword">result</span>;</span><br></pre></td></tr></table></figure>





<h3 id="Single-Month-II"><a href="#Single-Month-II" class="headerlink" title="Single Month II"></a>Single Month II</h3><p>The previous method worked, but you may have noticed we selected the same group of customers twice for the same month and repeated a number of conditional statements.</p>
<p>Companies typically look at churn data over a period of many months. We need to modify the calculation a bit to make it easier to mold into a multi-month result. This is done by making use of <code>WITH</code> and <code>CASE</code>.</p>
<p>To start, use <code>WITH</code> to create the group of customers that are active going into December:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">WITH</span> enrollments <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> subscriptions</span><br><span class="line"><span class="keyword">WHERE</span> subscription_start &lt; <span class="string">'2017-01-01'</span></span><br><span class="line"><span class="keyword">AND</span> (</span><br><span class="line">  (subscription_end &gt;= <span class="string">'2017-01-01'</span>)</span><br><span class="line">  <span class="keyword">OR</span> (subscription_end <span class="keyword">IS</span> <span class="literal">NULL</span>)</span><br><span class="line">)),</span><br><span class="line"><span class="keyword">status</span> <span class="keyword">AS</span> </span><br><span class="line">(<span class="keyword">SELECT</span></span><br><span class="line">  <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> (subscription_end &gt; <span class="string">'2017-01-31'</span>)</span><br><span class="line">      <span class="keyword">OR</span> (subscription_end <span class="keyword">IS</span> <span class="literal">NULL</span>) <span class="keyword">THEN</span> <span class="number">0</span></span><br><span class="line">      <span class="keyword">ELSE</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">as</span> is_canceled,</span><br><span class="line">   <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> subscription_start &lt; <span class="string">'2017-01-01'</span></span><br><span class="line">      <span class="keyword">AND</span> (</span><br><span class="line">        (subscription_end &gt;= <span class="string">'2017-01-01'</span>)</span><br><span class="line">        <span class="keyword">OR</span> (subscription_end <span class="keyword">IS</span> <span class="literal">NULL</span>)</span><br><span class="line">      ) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line">  <span class="keyword">END</span> <span class="keyword">as</span> is_active</span><br><span class="line">  <span class="keyword">FROM</span> enrollments</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1.0</span> * <span class="keyword">SUM</span>(is_canceled) / <span class="keyword">SUM</span>(is_active)</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">status</span>;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc49fnhr1dj30py0kkjt3.jpg" alt="image-20200221194509437" style="zoom:50%;" />



<h3 id="Multiple-Month-Create-Months-Temporary-Table"><a href="#Multiple-Month-Create-Months-Temporary-Table" class="headerlink" title="Multiple Month: Create Months Temporary Table"></a>Multiple Month: Create Months Temporary Table</h3><p>Our single month calculation is now in a form that we can extend to a multiple month result. But first, we need months!</p>
<p>Some SQL table schemes will contain a prebuilt table of months. Ours doesn’t, so we’ll need to build it using <code>UNION</code>. We’ll need the first and last day of each month.</p>
<p>Our churn calculation uses the first day as a cutoff for subscribers and the last day as a cutoff for cancellations.</p>
<p>This table can be created like:</p>
<p><strong>1.</strong></p>
<p>We will be using the months as a temporary table (using <code>WITH</code>) in the churn calculation.</p>
<p>Create the <code>months</code> temporary table using <code>WITH</code> and <code>SELECT</code> everything from it so that you can see the structure.</p>
<p>We need a table for January, February, and March of 2017.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> <span class="keyword">months</span> <span class="keyword">AS</span></span><br><span class="line">  (</span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">    <span class="string">'2017-01-01'</span> <span class="keyword">AS</span> first_day,</span><br><span class="line">    <span class="string">'2017-01-31'</span> <span class="keyword">AS</span> <span class="keyword">last_day</span></span><br><span class="line">    <span class="keyword">UNION</span></span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">    <span class="string">'2017-02-01'</span> <span class="keyword">AS</span> first_day,</span><br><span class="line">    <span class="string">'2017-02-28'</span> <span class="keyword">AS</span> <span class="keyword">last_day</span></span><br><span class="line">    <span class="keyword">UNION</span></span><br><span class="line">    <span class="keyword">SELECT</span></span><br><span class="line">    <span class="string">'2017-03-01'</span> <span class="keyword">AS</span> first_day,</span><br><span class="line">    <span class="string">'2017-03-31'</span> <span class="keyword">AS</span> <span class="keyword">last_day</span></span><br><span class="line">  )</span><br><span class="line">  </span><br><span class="line"><span class="keyword">select</span> *</span><br><span class="line"><span class="keyword">from</span> <span class="keyword">months</span>;</span><br></pre></td></tr></table></figure>



<h3 id="Multiple-Month-Cross-Join-Months-and-Users"><a href="#Multiple-Month-Cross-Join-Months-and-Users" class="headerlink" title="Multiple Month: Cross Join Months and Users"></a>Multiple Month: Cross Join Months and Users</h3><p>Now that we have a table of months, we will join it to the subscriptions table. This will result in a table containing every combination of month and subscription.</p>
<p>Ultimately, this table will be used to determine the status of each subscription in each month.</p>
<p>Instructions</p>
<p><strong>1.</strong></p>
<p>The workspace contains the <code>months</code> temporary table from the previous exercise.</p>
<p>Create a <code>cross_join</code> temporary table that is a <code>CROSS JOIN</code> of <code>subscriptions</code> and <code>months</code>.</p>
<p>We’ve added:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> cross_join</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>

<p>at the bottom of this exercise so you can visualize the temporary table you create.</p>
<p>It should <code>SELECT</code> all the columns from the temporary table.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> <span class="keyword">months</span> <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span></span><br><span class="line">  <span class="string">'2017-01-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">  <span class="string">'2017-01-31'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="string">'2017-02-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">  <span class="string">'2017-02-28'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="string">'2017-03-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">  <span class="string">'2017-03-31'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line">),</span><br><span class="line"><span class="comment">-- Add temporary cross_join definition here</span></span><br><span class="line">cross_join <span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line">  <span class="keyword">select</span> *</span><br><span class="line">  <span class="keyword">from</span> subscriptions </span><br><span class="line">  <span class="keyword">cross</span> <span class="keyword">join</span> <span class="keyword">months</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> cross_join</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>



<h4 id="Query-Results-cross-join"><a href="#Query-Results-cross-join" class="headerlink" title="Query Results - cross_join"></a>Query Results - cross_join</h4><table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">subscription_start</th>
<th align="center">subscription_end</th>
<th align="center">first_day</th>
<th align="center">last_day</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">2017-03-18</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">2017-03-18</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">2017-03-18</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2017-03-05</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2017-03-05</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2017-03-05</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">2016-12-21</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">2016-12-21</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">2016-12-21</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2017-03-26</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2017-03-26</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2017-03-26</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">2017-03-14</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">2017-03-14</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">2017-03-14</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2016-12-02</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2016-12-02</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2016-12-02</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2017-03-22</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2017-03-22</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2017-03-22</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2017-03-06</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2017-03-06</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2017-03-06</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">2016-12-22</td>
<td align="center">2017-03-31</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">2016-12-22</td>
<td align="center">2017-03-31</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">2016-12-22</td>
<td align="center">2017-03-31</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2017-02-22</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2017-02-22</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2017-02-22</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">2017-03-02</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">2017-03-02</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">2017-03-02</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">12</td>
<td align="center">2016-12-14</td>
<td align="center">2017-03-29</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">12</td>
<td align="center">2016-12-14</td>
<td align="center">2017-03-29</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">12</td>
<td align="center">2016-12-14</td>
<td align="center">2017-03-29</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">13</td>
<td align="center">2016-12-16</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">13</td>
<td align="center">2016-12-16</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">13</td>
<td align="center">2016-12-16</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">14</td>
<td align="center">2017-03-03</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">14</td>
<td align="center">2017-03-03</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">14</td>
<td align="center">2017-03-03</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">15</td>
<td align="center">2016-12-10</td>
<td align="center">2017-01-16</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">15</td>
<td align="center">2016-12-10</td>
<td align="center">2017-01-16</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">15</td>
<td align="center">2016-12-10</td>
<td align="center">2017-01-16</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">16</td>
<td align="center">2016-12-12</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">16</td>
<td align="center">2016-12-12</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">16</td>
<td align="center">2016-12-12</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">17</td>
<td align="center">2017-01-05</td>
<td align="center">2017-02-07</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">17</td>
<td align="center">2017-01-05</td>
<td align="center">2017-02-07</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">17</td>
<td align="center">2017-01-05</td>
<td align="center">2017-02-07</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">18</td>
<td align="center">2017-02-14</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">18</td>
<td align="center">2017-02-14</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">18</td>
<td align="center">2017-02-14</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">19</td>
<td align="center">2016-12-17</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">19</td>
<td align="center">2016-12-17</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">19</td>
<td align="center">2016-12-17</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">20</td>
<td align="center">2017-01-20</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">20</td>
<td align="center">2017-01-20</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">20</td>
<td align="center">2017-01-20</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">21</td>
<td align="center">2017-03-01</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">21</td>
<td align="center">2017-03-01</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">21</td>
<td align="center">2017-03-01</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">22</td>
<td align="center">2017-01-26</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">22</td>
<td align="center">2017-01-26</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">22</td>
<td align="center">2017-01-26</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">23</td>
<td align="center">2016-12-19</td>
<td align="center">2017-01-25</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">23</td>
<td align="center">2016-12-19</td>
<td align="center">2017-01-25</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">23</td>
<td align="center">2016-12-19</td>
<td align="center">2017-01-25</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">24</td>
<td align="center">2017-01-31</td>
<td align="center">2017-03-26</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">24</td>
<td align="center">2017-01-31</td>
<td align="center">2017-03-26</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">24</td>
<td align="center">2017-01-31</td>
<td align="center">2017-03-26</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">25</td>
<td align="center">2016-12-18</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">25</td>
<td align="center">2016-12-18</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">25</td>
<td align="center">2016-12-18</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">26</td>
<td align="center">2017-02-25</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">26</td>
<td align="center">2017-02-25</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">26</td>
<td align="center">2017-02-25</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">27</td>
<td align="center">2017-01-15</td>
<td align="center">2017-03-31</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">27</td>
<td align="center">2017-01-15</td>
<td align="center">2017-03-31</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">27</td>
<td align="center">2017-01-15</td>
<td align="center">2017-03-31</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">28</td>
<td align="center">2016-12-20</td>
<td align="center">2017-01-28</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">28</td>
<td align="center">2016-12-20</td>
<td align="center">2017-01-28</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">28</td>
<td align="center">2016-12-20</td>
<td align="center">2017-01-28</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">29</td>
<td align="center">2017-01-25</td>
<td align="center">2017-02-25</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">29</td>
<td align="center">2017-01-25</td>
<td align="center">2017-02-25</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">29</td>
<td align="center">2017-01-25</td>
<td align="center">2017-02-25</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">30</td>
<td align="center">2017-01-11</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">30</td>
<td align="center">2017-01-11</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">30</td>
<td align="center">2017-01-11</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">31</td>
<td align="center">2016-12-13</td>
<td align="center">2017-01-16</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">31</td>
<td align="center">2016-12-13</td>
<td align="center">2017-01-16</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">31</td>
<td align="center">2016-12-13</td>
<td align="center">2017-01-16</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">32</td>
<td align="center">2016-12-11</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">32</td>
<td align="center">2016-12-11</td>
<td align="center"></td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">32</td>
<td align="center">2016-12-11</td>
<td align="center"></td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">33</td>
<td align="center">2016-12-21</td>
<td align="center">2017-02-12</td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
<tr>
<td align="center">33</td>
<td align="center">2016-12-21</td>
<td align="center">2017-02-12</td>
<td align="center">2017-02-01</td>
<td align="center">2017-02-28</td>
</tr>
<tr>
<td align="center">33</td>
<td align="center">2016-12-21</td>
<td align="center">2017-02-12</td>
<td align="center">2017-03-01</td>
<td align="center">2017-03-31</td>
</tr>
<tr>
<td align="center">34</td>
<td align="center">2017-03-19</td>
<td align="center"></td>
<td align="center">2017-01-01</td>
<td align="center">2017-01-31</td>
</tr>
</tbody></table>
<h3 id="Multiple-Month-Determine-Active-Cancellation-Status"><a href="#Multiple-Month-Determine-Active-Cancellation-Status" class="headerlink" title="Multiple Month: Determine Active/Cancellation Status"></a>Multiple Month: Determine Active/Cancellation Status</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> <span class="keyword">months</span> <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span></span><br><span class="line">  <span class="string">'2017-01-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">  <span class="string">'2017-01-31'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="string">'2017-02-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">  <span class="string">'2017-02-28'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="string">'2017-03-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">  <span class="string">'2017-03-31'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line">),</span><br><span class="line">cross_join <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> subscriptions</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> <span class="keyword">months</span>),</span><br><span class="line"><span class="keyword">status</span> <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span> <span class="keyword">id</span>, first_day <span class="keyword">as</span> <span class="keyword">month</span>,</span><br><span class="line"><span class="keyword">CASE</span></span><br><span class="line">  <span class="keyword">WHEN</span> (subscription_start &lt; first_day)</span><br><span class="line">    <span class="keyword">AND</span> (</span><br><span class="line">      subscription_end &gt; first_day</span><br><span class="line">      <span class="keyword">OR</span> subscription_end <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line">    ) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">END</span> <span class="keyword">as</span> is_active,</span><br><span class="line"><span class="comment">-- add is_canceled here</span></span><br><span class="line"><span class="keyword">CASE</span> </span><br><span class="line">  <span class="keyword">WHEN</span> (subscription_end <span class="keyword">BETWEEN</span> first_day <span class="keyword">AND</span> <span class="keyword">last_day</span>) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">  <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line"> <span class="keyword">END</span> <span class="keyword">AS</span> is_canceled</span><br><span class="line"><span class="keyword">FROM</span> cross_join)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">status</span></span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">100</span>;</span><br></pre></td></tr></table></figure>

<h4 id=""><a href="#" class="headerlink" title=""></a></h4><h4 id="Query-Results-status"><a href="#Query-Results-status" class="headerlink" title="Query Results - status"></a>Query Results - status</h4><table>
<thead>
<tr>
<th align="center">id</th>
<th align="center">month</th>
<th align="center">is_active</th>
<th align="center">is_canceled</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">2017-03-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2017-03-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">2017-01-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">2017-02-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">2017-03-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">2017-03-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">2017-03-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2017-01-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2017-02-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">2017-03-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2017-03-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">2017-03-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">2017-01-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">2017-02-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">2017-03-01</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2017-02-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">2017-03-01</td>
<td align="center">1</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">2017-01-01</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody></table>
<h3 id="Multiple-Month-Sum-Active-and-Canceled-Users"><a href="#Multiple-Month-Sum-Active-and-Canceled-Users" class="headerlink" title="Multiple Month: Sum Active and Canceled Users"></a>Multiple Month: Sum Active and Canceled Users</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- add status_aggregate here</span></span><br><span class="line">status_aggregate AS</span><br><span class="line">(</span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">month</span>, <span class="keyword">sum</span>(is_active), <span class="keyword">sum</span>(is_canceled)</span><br><span class="line">  <span class="keyword">FROM</span> <span class="keyword">status</span></span><br><span class="line">  <span class="keyword">Group</span> <span class="keyword">by</span> <span class="keyword">month</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> status_aggregate;</span><br></pre></td></tr></table></figure>

<h4 id="Query-Results-status-aggregate"><a href="#Query-Results-status-aggregate" class="headerlink" title="Query Results - status_aggregate"></a>Query Results - status_aggregate</h4><table>
<thead>
<tr>
<th align="center">month</th>
<th align="center">sum(is_active)</th>
<th align="center">sum(is_canceled)</th>
</tr>
</thead>
<tbody><tr>
<td align="center">2017-01-01</td>
<td align="center">276</td>
<td align="center">35</td>
</tr>
<tr>
<td align="center">2017-02-01</td>
<td align="center">506</td>
<td align="center">63</td>
</tr>
<tr>
<td align="center">2017-03-01</td>
<td align="center">667</td>
<td align="center">158</td>
</tr>
</tbody></table>
<h3 id="Multiple-Month-Churn-Rate-Calculation"><a href="#Multiple-Month-Churn-Rate-Calculation" class="headerlink" title="Multiple Month: Churn Rate Calculation"></a>Multiple Month: Churn Rate Calculation</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">month</span>, <span class="number">1.0</span> * a.canceled / a.active <span class="keyword">as</span> churn_rate</span><br><span class="line"><span class="keyword">from</span> status_aggregate <span class="keyword">as</span> a;</span><br></pre></td></tr></table></figure>

<h4 id="Query-Results-churn-rate"><a href="#Query-Results-churn-rate" class="headerlink" title="Query Results - churn_rate"></a>Query Results - churn_rate</h4><table>
<thead>
<tr>
<th align="center">month</th>
<th align="center">churn_rate</th>
</tr>
</thead>
<tbody><tr>
<td align="center">2017-01-01</td>
<td align="center">0.126811594202899</td>
</tr>
<tr>
<td align="center">2017-02-01</td>
<td align="center">0.124505928853755</td>
</tr>
<tr>
<td align="center">2017-03-01</td>
<td align="center">0.23688155922039</td>
</tr>
</tbody></table>
<p><em>In this lesson you learned:</em></p>
<ul>
<li><em>The churn rate is a percent of subscribers at the beginning of a period that cancel within that period. “Monthly churn” is a typical metric and what was used in the examples.</em></li>
<li><em>How to calculate this metric using SQL for a single month. This used <code>COUNT()</code> and conditions to determine the number of subscribers that were active and how many canceled.</em></li>
<li><em>A more complex method to track the subscriber churn rate over many months.</em></li>
</ul>
<p><em>Instructions</em></p>
<p><em>The complete churn calculation is provided here for you to experiment with.</em></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/20/SQL/2020-02-21-SQL-analyzation/">SQL/2020-02-21-SQL-analyzation</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-20</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><h1 id="Analyze-Data-with-SQL"><a href="#Analyze-Data-with-SQL" class="headerlink" title="Analyze Data with SQL"></a>Analyze Data with SQL</h1><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><p>The UX Research team wants to see a distribution of watch durations. They want the result to contain:</p>
<ul>
<li><code>duration</code>, which is the watch event duration, rounded to the closest minute</li>
<li><code>count</code>, the number of watch events falling into this “bucket”</li>
</ul>
<p>Your result should look like:</p>
<table>
<thead>
<tr>
<th>duration</th>
<th>count</th>
</tr>
</thead>
<tbody><tr>
<td>1.0</td>
<td>9</td>
</tr>
<tr>
<td>2.0</td>
<td>21</td>
</tr>
<tr>
<td>3.0</td>
<td>19</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>Use <code>COUNT()</code>, <code>GROUP BY</code>, and <code>ORDER BY</code> to create this result and order this data by increasing <code>duration</code>.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">round</span>(watch_duration_in_minutes, <span class="number">0</span>) </span><br><span class="line"><span class="keyword">from</span> watch_history </span><br><span class="line"><span class="keyword">limit</span> <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">  <span class="keyword">ROUND</span>(watch_duration_in_minutes, <span class="number">0</span>) <span class="keyword">as</span> <span class="keyword">duration</span>,</span><br><span class="line">  <span class="keyword">COUNT</span>(*) <span class="keyword">as</span> <span class="keyword">count</span></span><br><span class="line"><span class="keyword">FROM</span> watch_history</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">duration</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">duration</span> <span class="keyword">ASC</span> <span class="keyword">limit</span> <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">round</span>(watch_duration_in_minutes, <span class="number">0</span>) <span class="keyword">as</span> <span class="keyword">duration</span>, </span><br><span class="line"><span class="keyword">count</span>(*) <span class="keyword">as</span> <span class="keyword">count</span></span><br><span class="line"><span class="keyword">from</span> watch_history</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">duration</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">duration</span> <span class="keyword">asc</span> <span class="keyword">limit</span> <span class="number">20</span>;</span><br><span class="line"><span class="comment">-- order by count(*) asc limit 20;</span></span><br></pre></td></tr></table></figure>



<h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><p>Find all the users that have successfully made a payment to Codeflix and find their total amount paid.</p>
<p>Sort them by their total payments (from high to low).</p>
<p>Use <code>SUM()</code>, <code>WHERE</code>, <code>GROUP BY</code>, and <code>ORDER BY</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> user_id, <span class="keyword">SUM</span>(amount)</span><br><span class="line"><span class="keyword">FROM</span> payments</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">status</span> = <span class="string">'paid'</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> user_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">SUM</span>(amount) <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> user_id, <span class="keyword">SUM</span>(amount) <span class="keyword">AS</span> <span class="string">'total'</span></span><br><span class="line"><span class="keyword">FROM</span> payments</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">status</span> = <span class="string">'paid'</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span> <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>



<p>The <code>watch_history</code> table has the following columns:</p>
<ul>
<li><code>id</code></li>
<li><code>user_id</code></li>
<li><code>watch_date</code></li>
<li><code>watch_duration_in_minutes</code></li>
</ul>
<p>Click <a href="https://s3.amazonaws.com/codecademy-content/courses/learn-sql-aggregates-code-challenge/user-payments-history.png" target="_blank" rel="noopener">here</a> for the table diagram.</p>
<p>Instructions</p>
<p>Generate a table of user ids and total watch duration for users who watched more than 400 minutes of content.</p>
<p>Use <code>SUM()</code>, <code>GROUP BY</code>, and <code>HAVING</code> to achieve this.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> user_id, <span class="keyword">SUM</span>(watch_duration_in_minutes) </span><br><span class="line"><span class="keyword">from</span> watch_history </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> user_id</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">SUM</span>(watch_duration_in_minutes) &gt; <span class="number">400</span>;</span><br></pre></td></tr></table></figure>



<h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><p>Which days in this period did Codeflix collect the most money?</p>
<p>Your result should have two columns, <code>pay_date</code> and total <code>amount</code>, sorted by the latter descending.</p>
<p>This should only include successful payments (<code>status = &#39;paid&#39;</code>).</p>
<p>Use <code>SUM()</code>, <code>GROUP BY</code>, and <code>ORDER BY</code>.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> pay_date, <span class="keyword">sum</span>(amount)</span><br><span class="line"><span class="keyword">from</span> payments</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">status</span> = <span class="string">'paid'</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> pay_date</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">sum</span>(amount) <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>





<h1 id="The-Metropolitan-Museum-of-Art"><a href="#The-Metropolitan-Museum-of-Art" class="headerlink" title="The Metropolitan Museum of Art"></a>The Metropolitan Museum of Art</h1><p>First, let’s find the “lowest” year:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT MIN(date)</span><br><span class="line">FROM met;</span><br></pre></td></tr></table></figure>

<p>The result is 1600-1700.</p>
<p>Now, let’s try this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT date, title, medium</span><br><span class="line">FROM met</span><br><span class="line">WHERE date LIKE &#39;%1600%&#39;;</span><br></pre></td></tr></table></figure>

<p>Woah! <a href="https://www.metmuseum.org/art/collection/search/507" target="_blank" rel="noopener">Betty Lamp</a>, <a href="https://www.metmuseum.org/art/collection/search/1194" target="_blank" rel="noopener">Candlestick</a>, and <a href="https://www.metmuseum.org/art/collection/search/1458" target="_blank" rel="noopener">Casement Window</a> are among the oldest pieces in the collection.</p>
<p><strong>7.</strong></p>
<p>Lastly, let’s look at some bling!</p>
<p>Count the number of pieces where the <code>medium</code> contains ‘gold’ or ‘silver’.</p>
<p>And sort in descending order.</p>
<p>Hint</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ★★★ 7 </span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">medium</span>, <span class="keyword">count</span>(*)</span><br><span class="line"><span class="keyword">from</span> met</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">medium</span> <span class="keyword">like</span> <span class="string">'%gold%'</span> <span class="keyword">or</span> <span class="string">'%silver%'</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">medium</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">count</span>(*) <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">-- 可以做得再更往大分類去，要用到 CASE!如這裡</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">CASE</span></span><br><span class="line">    <span class="keyword">WHEN</span> <span class="keyword">medium</span> <span class="keyword">like</span> <span class="string">'%gold%'</span> <span class="keyword">THEN</span> <span class="string">'GOLD'</span></span><br><span class="line">    <span class="keyword">WHEN</span> <span class="keyword">medium</span> <span class="keyword">like</span> <span class="string">'%silver%'</span> <span class="keyword">THEN</span> <span class="string">'SILVER'</span></span><br><span class="line">    <span class="keyword">ELSE</span> <span class="literal">NULL</span></span><br><span class="line">  <span class="keyword">END</span> <span class="keyword">AS</span> <span class="string">'Bling'</span>, </span><br><span class="line">  <span class="keyword">count</span>(*)</span><br><span class="line"><span class="keyword">from</span> met</span><br><span class="line"><span class="comment">-- where medium like '%gold%' or '%silver%'</span></span><br><span class="line"><span class="comment">-- group by medium</span></span><br><span class="line"><span class="keyword">where</span> Bling <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> Bling</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">count</span>(*) <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>



<h1 id="Hacker-News"><a href="#Hacker-News" class="headerlink" title="Hacker News"></a>Hacker News</h1><h3 id="Which-sites-feed-Hacker-News"><a href="#Which-sites-feed-Hacker-News" class="headerlink" title="Which sites feed Hacker News?"></a>Which sites feed Hacker News?</h3><p><strong>6.</strong></p>
<p>Hacker News stories are essentially links that take users to other websites.</p>
<p><em>Which of these sites feed Hacker News the most</em>:</p>
<p><em><a href="https://www.github.com/" target="_blank" rel="noopener">GitHub</a>, <a href="https://www.medium.com/" target="_blank" rel="noopener">Medium</a>, or <a href="https://www.nytimes.com/" target="_blank" rel="noopener">New York Times</a>?</em></p>
<p>First, we want to categorize each story based on their source.</p>
<p>We can do this using a <code>CASE</code> statement:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT CASE</span><br><span class="line">   WHEN url LIKE &#39;%github.com%&#39; THEN &#39;GitHub&#39;</span><br><span class="line">   -- WHEN statement here</span><br><span class="line">   -- WHEN statement here</span><br><span class="line">   -- ELSE statement here</span><br><span class="line">  END AS &#39;Source&#39;</span><br><span class="line">FROM hacker_news;</span><br></pre></td></tr></table></figure>

<p>Fill in the other <code>WHEN</code> statements and the <code>ELSE</code> statement.</p>
<p>Stuck? Get a hint</p>
<p><strong>7.</strong></p>
<p>Next, build on the previous query:</p>
<p>Add a column for the number of stories from each URL using <code>COUNT()</code>.</p>
<p>Also, <code>GROUP BY</code> the <code>CASE</code> statement.</p>
<p>Remember that you can refer to a column in <code>GROUP BY</code> using a number.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 6, 7</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CASE</span></span><br><span class="line">  <span class="keyword">WHEN</span> <span class="keyword">url</span> <span class="keyword">LIKE</span> <span class="string">'%github%'</span> <span class="keyword">THEN</span> <span class="string">'GitHub'</span></span><br><span class="line">  <span class="keyword">WHEN</span> <span class="keyword">url</span> <span class="keyword">LIKE</span> <span class="string">'%medium.com%'</span> <span class="keyword">THEN</span> <span class="string">'Medium'</span></span><br><span class="line">  <span class="keyword">WHEN</span> <span class="keyword">url</span> <span class="keyword">LIKE</span> <span class="string">'%nytimes.com%'</span> <span class="keyword">THEN</span> <span class="string">'New York Times'</span></span><br><span class="line">  <span class="keyword">ELSE</span> <span class="string">'Other'</span></span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span> three_urls, <span class="keyword">count</span>(*)</span><br><span class="line"><span class="keyword">from</span> hacker_news </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> three_urls</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">count</span>(*);</span><br></pre></td></tr></table></figure>



<h3 id="What’s-the-best-time-to-post-a-story"><a href="#What’s-the-best-time-to-post-a-story" class="headerlink" title="What’s the best time to post a story?"></a>What’s the best time to post a story?</h3><p><strong>8.</strong></p>
<p>Every submitter wants their story to get a high score so that the story makes it to the front page, but…</p>
<p><em>What’s the best time of the day to post a story on Hacker News?</em></p>
<p>Before we get started, let’s run this query and take a look at the <code>timestamp</code> column:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT timestamp</span><br><span class="line">FROM hacker_news</span><br><span class="line">LIMIT 10;</span><br></pre></td></tr></table></figure>

<p>Notice that the values are formatted like:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2018-05-08T12:30:00Z</span><br></pre></td></tr></table></figure>

<p>If you ignore the <code>T</code> and <code>Z</code>, the format is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YYYY-MM-DD HH:MM:SS</span><br></pre></td></tr></table></figure>

<p>Stuck? Get a hint</p>
<p><strong>9.</strong></p>
<p>SQLite comes with a <code>strftime()</code> function - a very powerful function that allows you to return a formatted date.</p>
<p>It takes two arguments:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strftime(format, column)</span><br></pre></td></tr></table></figure>

<p>Let’s test this function out:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT timestamp,</span><br><span class="line">   strftime(&#39;%H&#39;, timestamp)</span><br><span class="line">FROM hacker_news</span><br><span class="line">GROUP BY 1</span><br><span class="line">LIMIT 20;</span><br></pre></td></tr></table></figure>

<p>What do you think this does? Open the hint if you’d like to learn more.</p>
<p>Stuck? Get a hint</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 8, 9</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">timestamp</span></span><br><span class="line"><span class="keyword">from</span> hacker_news</span><br><span class="line"><span class="keyword">limit</span> <span class="number">15</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">timestamp</span>,</span><br><span class="line">  strftime(<span class="string">'%H'</span>, <span class="built_in">timestamp</span>)</span><br><span class="line"><span class="keyword">from</span> hacker_news</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span></span><br><span class="line"><span class="comment">-- order by </span></span><br><span class="line"><span class="keyword">limit</span> <span class="number">15</span>;</span><br><span class="line"><span class="comment">-- This returns the hour, HH, of the timestamp column!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- For strftime(__, timestamp):</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- %Y returns the year (YYYY)</span></span><br><span class="line"><span class="comment">-- %m returns the month (01-12)</span></span><br><span class="line"><span class="comment">-- %d returns the day of the month (1-31)</span></span><br><span class="line"><span class="comment">-- %H returns 24-hour clock (00-23)</span></span><br><span class="line"><span class="comment">-- %M returns the minute (00-59)</span></span><br><span class="line"><span class="comment">-- %S returns the seconds (00-59)</span></span><br><span class="line"><span class="comment">-- if timestamp format is YYYY-MM-DD HH:MM:SS.</span></span><br></pre></td></tr></table></figure>



<p><strong>10.</strong></p>
<p>Okay, now we understand how <code>strftime()</code> works. Let’s write a query that returns three columns:</p>
<ol>
<li>The hours of the <code>timestamp</code></li>
<li>The <em>average</em> <code>score</code> for each hour</li>
<li>The <em>count</em> of stories for each hour</li>
</ol>
<p>Stuck? Get a hint</p>
<p><strong>11.</strong></p>
<p>Let’s edit a few things in the previous query:</p>
<ul>
<li>Round the average <code>score</code>s (<code>ROUND()</code>).</li>
<li>Rename the columns to make it more readable (<code>AS</code>).</li>
<li>Add a <code>WHERE</code> clause to filter out the <code>NULL</code> values in <code>timestamp</code>.</li>
</ul>
<p>Take a look at the result again:</p>
<p>What are the best hours to post a story on Hacker News?</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 10 ●○●○● </span></span><br><span class="line"><span class="keyword">select</span> strftime(<span class="string">'%H'</span>, <span class="built_in">timestamp</span>), <span class="keyword">avg</span>(score) ,<span class="keyword">count</span>(*)</span><br><span class="line"><span class="keyword">from</span> hacker_news</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- limit 15;</span></span><br><span class="line"><span class="comment">-- having sum(score)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 11</span></span><br><span class="line"><span class="keyword">select</span> strftime(<span class="string">'%H'</span>, <span class="built_in">timestamp</span>) <span class="keyword">AS</span> <span class="keyword">Hour</span>, <span class="keyword">round</span>(<span class="keyword">avg</span>(score), <span class="number">2</span>) <span class="keyword">AS</span> <span class="string">'Average Score'</span>,<span class="keyword">count</span>(*) <span class="keyword">AS</span> <span class="string">'# of Stories'</span></span><br><span class="line"><span class="keyword">from</span> hacker_news</span><br><span class="line"><span class="keyword">where</span> <span class="built_in">timestamp</span> <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>  <span class="comment">-- 注意！！　這裡不能寫１，而要用本來的column名</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="number">1</span> </span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>



<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc5jrvpb7ij30fi0bq3yv.jpg" alt="image-20200222222825218" style="zoom:50%;" />

<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc5k2mxbs4j31520hitmq.jpg" alt="image-20200222223832094" style="zoom:67%;" />



<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc5ka80insj31b00caqf3.jpg" alt="image-20200222224606164" style="zoom:67%;" /></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/18/SQL/2020-02-18-SQL-Cases/">SQL/2020-02-18-SQL-Cases</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-18</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><p><a href="https://www.codecademy.com/practice/projects/world-populations-sql-practice-ii" target="_blank" rel="noopener">https://www.codecademy.com/practice/projects/world-populations-sql-practice-ii</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- How many entries in the database are from Africa?</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">count</span>(*) </span><br><span class="line"><span class="keyword">FROM</span> countries <span class="keyword">where</span> continent = <span class="string">'Africa'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- What was the total population of Oceania in 2005?</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sum</span>(population)</span><br><span class="line"><span class="keyword">from</span> population_years <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> countries</span><br><span class="line"><span class="keyword">on</span> tb1.country_id = countries.id</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">year</span> = <span class="number">2005</span> <span class="keyword">and</span> continent = <span class="string">'Oceania'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- What is the average population of countries in South America in 2003?</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(population)</span><br><span class="line"><span class="keyword">from</span> population_years <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> countries</span><br><span class="line"><span class="keyword">on</span> tb1.country_id = countries.id</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">year</span> = <span class="number">2003</span> <span class="keyword">and</span> continent = <span class="string">'South America'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- What country had the smallest population in 2007?</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">min</span>(population)</span><br><span class="line"><span class="keyword">from</span> population_years <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> countries</span><br><span class="line"><span class="keyword">on</span> tb1.country_id = countries.id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- What is the average population of Poland during the time period covered by this dataset?</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(population)</span><br><span class="line"><span class="keyword">from</span> population_years <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> countries </span><br><span class="line"><span class="keyword">on</span> tb1.country_id = countries.id</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">name</span> = <span class="string">'Poland'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- How many countries have the word "The" in their name?</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*)</span><br><span class="line"><span class="keyword">from</span> countries</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%The%'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- What was the total population of each continent in 2010?</span></span><br><span class="line"><span class="keyword">select</span> continent, <span class="keyword">sum</span>(tb1.population)</span><br><span class="line"><span class="keyword">from</span> population_years <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> countries</span><br><span class="line"><span class="keyword">on</span> tb1.country_id = countries.id</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">year</span> = <span class="number">2010</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">by</span> continent;</span><br></pre></td></tr></table></figure>











<h1 id="Trends-in-Startups"><a href="#Trends-in-Startups" class="headerlink" title="Trends in Startups"></a>Trends in Startups</h1><p>Howdy! It’s your first day as a <a href="https://techcrunch.com/" target="_blank" rel="noopener">TechCrunch</a> reporter. Your first task is to write an article on the rising trends in the startup world.</p>
<p>To get you started with your research, your boss emailed you a <strong>project.sqlite</strong> file that contains a table called <code>startups</code>. It is a portfolio of some of the biggest names in the industry.</p>
<p>Write queries with aggregate functions to retrieve some interesting insights about these companies.</p>
<p>What are you waiting for? Let’s get started!</p>
<p>If you get stuck during this project or would like to see an experienced developer work through it, click “<strong>Get Help</strong>“ to see a <strong>project walkthrough video</strong>.</p>
<p>Tasks</p>
<p>14/14Complete</p>
<p>Mark the tasks as complete by checking them off</p>
<h3 id="Write-the-following-queries"><a href="#Write-the-following-queries" class="headerlink" title="Write the following queries:"></a>Write the following queries:</h3><p><strong>1.</strong></p>
<p>Getting started, take a look at the <code>startups</code> table:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM startups;</span><br></pre></td></tr></table></figure>

<p>How many columns are there?</p>
<p>Stuck? Get a hint</p>
<p><strong>2.</strong></p>
<p>Calculate the total number of companies in the table.</p>
<p>Stuck? Get a hint</p>
<p><strong>3.</strong></p>
<p>We want to know the total value of all companies in this table.</p>
<p>Calculate this by getting the <code>SUM()</code> of the <code>valuation</code> column.</p>
<p>Stuck? Get a hint</p>
<p><strong>4.</strong></p>
<p>What is the highest amount raised by a startup?</p>
<p>Return the maximum amount of money <code>raised</code>.</p>
<p>Stuck? Get a hint</p>
<p><strong>5.</strong></p>
<p>Edit the query so that it returns the maximum amount of money <code>raised</code>, during ‘Seed’ stage.</p>
<p>Stuck? Get a hint</p>
<p><strong>6.</strong></p>
<p>In what year was the oldest company on the list founded?</p>
<p>Stuck? Get a hint</p>
<h3 id="Let’s-find-out-the-valuations-among-different-sectors"><a href="#Let’s-find-out-the-valuations-among-different-sectors" class="headerlink" title="Let’s find out the valuations among different sectors:"></a>Let’s find out the valuations among different sectors:</h3><p><strong>7.</strong></p>
<p>Return the average <code>valuation</code>.</p>
<p>Stuck? Get a hint</p>
<p><strong>8.</strong></p>
<p>Return the average <code>valuation</code>, in each <code>category</code>.</p>
<p>Stuck? Get a hint</p>
<p><strong>9.</strong></p>
<p>Return the average <code>valuation</code>, in each <code>category</code>.</p>
<p>Round the averages to two decimal places.</p>
<p>Stuck? Get a hint</p>
<p><strong>10.</strong></p>
<p>Return the average <code>valuation</code>, in each <code>category</code>.</p>
<p>Round the averages to two decimal places.</p>
<p>Lastly, order the list from highest averages to lowest.</p>
<p>Stuck? Get a hint</p>
<h3 id="What-are-the-most-competitive-markets"><a href="#What-are-the-most-competitive-markets" class="headerlink" title="What are the most competitive markets?"></a>What are the most competitive markets?</h3><p><strong>11.</strong></p>
<p>First, return the name of each <code>category</code> with the total number of companies that belong to it.</p>
<p>Stuck? Get a hint</p>
<p><strong>12.</strong></p>
<p>Next, filter the result to only include categories that have more than three companies in them.</p>
<p>What are the most competitive markets?</p>
<p>Stuck? Get a hint</p>
<h3 id="Let’s-see-if-there’s-a-difference-in-startups-sizes-among-different-locations"><a href="#Let’s-see-if-there’s-a-difference-in-startups-sizes-among-different-locations" class="headerlink" title="Let’s see if there’s a difference in startups sizes among different locations:"></a>Let’s see if there’s a difference in startups sizes among different locations:</h3><p><strong>13.</strong></p>
<p>What is the average size of a startup in each <code>location</code>?</p>
<p>Stuck? Get a hint</p>
<p><strong>14.</strong></p>
<p>What is the average size of a startup in each <code>location</code>, with average sizes above 500?</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- name	location	category	employees	raised	valuation	founded	stage	ceo	info</span></span><br><span class="line"><span class="comment">-- Pied Piper	Silicon Valley	Cloud Computing	6	5000000	50000000	2014	A	Richard Hendricks	A Middle-Out Compression Solution</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select * from startups;</span></span><br><span class="line"><span class="comment">-- select count(*)  from startups;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select sum(valuation)  from startups;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select max(raised)  from startups;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- -- 5</span></span><br><span class="line"><span class="comment">-- select max(raised)  </span></span><br><span class="line"><span class="comment">-- from startups</span></span><br><span class="line"><span class="comment">-- where stage = 'Seed';</span></span><br><span class="line"><span class="comment">-- -- 6</span></span><br><span class="line"><span class="comment">-- select min(founded) </span></span><br><span class="line"><span class="comment">-- from startups;</span></span><br><span class="line"><span class="comment">-- -- 7</span></span><br><span class="line"><span class="comment">-- select avg(valuation) </span></span><br><span class="line"><span class="comment">-- from startups;</span></span><br><span class="line"><span class="comment">-- -- 8</span></span><br><span class="line"><span class="comment">-- select category, avg(valuation) </span></span><br><span class="line"><span class="comment">-- from startups</span></span><br><span class="line"><span class="comment">-- group by category;</span></span><br><span class="line"><span class="comment">-- -- 9</span></span><br><span class="line"><span class="comment">-- select category, round(avg(valuation), 2)</span></span><br><span class="line"><span class="comment">-- from startups</span></span><br><span class="line"><span class="comment">-- group by category;</span></span><br><span class="line"><span class="comment">-- -- 10</span></span><br><span class="line"><span class="comment">-- select category, round(avg(valuation), 2)</span></span><br><span class="line"><span class="comment">-- from startups</span></span><br><span class="line"><span class="comment">-- group by category</span></span><br><span class="line"><span class="comment">-- order by 2 desc;</span></span><br><span class="line"><span class="comment">-- -- 11</span></span><br><span class="line"><span class="comment">-- -- select category, count(company)</span></span><br><span class="line"><span class="comment">-- select category, count(*)</span></span><br><span class="line"><span class="comment">-- from startups</span></span><br><span class="line"><span class="comment">-- group by category;</span></span><br><span class="line"><span class="comment">-- -- 12</span></span><br><span class="line"><span class="comment">-- -- -- select category, count(company)</span></span><br><span class="line"><span class="comment">-- select category, count(*)</span></span><br><span class="line"><span class="comment">-- from startups</span></span><br><span class="line"><span class="comment">-- group by category</span></span><br><span class="line"><span class="comment">-- having count(*) &gt; 3</span></span><br><span class="line"><span class="comment">-- order by 2 desc;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select * from startups;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 13</span></span><br><span class="line"><span class="comment">-- select location, avg(valuation)</span></span><br><span class="line"><span class="keyword">select</span> location, <span class="keyword">avg</span>(employees)</span><br><span class="line"><span class="keyword">from</span> startups</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> location</span><br><span class="line"><span class="keyword">having</span> <span class="keyword">avg</span>(employees) &gt; <span class="number">500</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- having avg(*)</span></span><br></pre></td></tr></table></figure>



</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/11/LC/2020-02-10-LC%20High-G/">LC/2020-02-10-LC High-G</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/LC/">LC</a></span><div class="content"><h2 id="Recursion-Ⅱ"><a href="#Recursion-Ⅱ" class="headerlink" title="Recursion Ⅱ"></a>Recursion Ⅱ</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#904">904 Fruit Into Basket</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#51">51 N-Queens</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#52">52 N-Queens Ⅱ</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Process"><a href="#Process" class="headerlink" title="Process"></a>Process</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#929">929 Unique Email Address</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td>[Odd Even Jump]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Licese Key Formatting]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#904">904 Fruit Into Baskets</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="Arrays-and-Strings"><a href="#Arrays-and-Strings" class="headerlink" title="Arrays and Strings"></a>Arrays and Strings</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#3">3 Longest Substring Without Repeating Characters</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#11">11 Container with Most Water</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#15">15 3Sum</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#31">31 Next Permutation</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td>待review</td>
</tr>
<tr>
<td><a href="#43">43 Multiply Strings</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#48">48 Rotate Image</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td>[Jump Game]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#66">66 Plus One</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td>[Minumum Window Substring]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Read N Characters Given]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Longest Substring with At ]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Missing Ranges]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Nezxt Closet Time]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Expressive Wods]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Find And Replace in String]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Maximize Distance to ]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#20">20 Valid Parentheses</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#23">23 Merge K Sorted Lists</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#42">42 Trapping Rain Water</a></td>
<td></td>
<td>當時感覺來了DP一次就對</td>
<td>2 ptrs</td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#215">215 Kth Largest Element in an Array</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Linked-List"><a href="#Linked-List" class="headerlink" title="Linked List"></a>Linked List</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>Coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#2">2 Add Two Numbers</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#19">19 Remove Nth Node From End of List</a></td>
<td></td>
<td>讓快的先走，開始rm時候要小心就是</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#21">21 Merge Two Sorted Lists</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#138">138 Copy List with Random Pointer</a></td>
<td></td>
<td>bottom up recursive 解時記得要先把做出來的node 加到visited, 不然random會一直叫下去不停</td>
<td>待試iterative</td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Trees-amp-Graphs"><a href="#Trees-amp-Graphs" class="headerlink" title="Trees &amp; Graphs"></a>Trees &amp; Graphs</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>Coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>[Binary Tree Maximum Path Sum]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong><a href="#127">127 Word Ladder</a></strong></td>
<td></td>
<td>用了双向BFS， 目前仍是TLE</td>
<td>待嘗試動態建圖</td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#200">200 Number of Islands</a></td>
<td></td>
<td>BFS 是最好的解，就熟它吧</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td>[Course Schedule Ⅱ]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#222">222 Count Complete Tree Nodes</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#543">543 Diameter of Binary Tree</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#951">951 Flip Equivalent Binary Trees</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Recursion"><a href="#Recursion" class="headerlink" title="Recursion"></a>Recursion</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#17">17 Letter Combination of a Phone Number</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#79">79 Word Search</a></td>
<td></td>
<td>TLE…</td>
<td>Solve by not deepcopying board</td>
<td>v</td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#212">212 Word Search</a></td>
<td></td>
<td>TLE with Also. from <a name="79">79</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="Sorting-and-Searching"><a href="#Sorting-and-Searching" class="headerlink" title="Sorting and Searching"></a>Sorting and Searching</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#34">34 Find First and Last Position of Element in Sorted Array</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#56">56 Merge Intervals</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#242">242 Valid Anagram</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#852">852 Peak Index in a Mountain Array</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
</tbody></table>
<h2 id="DP"><a href="#DP" class="headerlink" title="DP"></a>DP</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>Longest Palindromic Subse</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="#53">53 Maximum Subarray</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="Design"><a href="#Design" class="headerlink" title="Design"></a>Design</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>Coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#146">146 LRU Cache</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#155">155 Min Stack</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="2"><a href="#2" class="headerlink" title="2"></a><a name="2">2</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">2 4  3 </span></span><br><span class="line"><span class="string">5 6  4 </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">7 10 </span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addTwoNumbers</span><span class="params">(self, l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        carry = <span class="number">0</span></span><br><span class="line">        dummy = cur = ListNode(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># loop = 0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> l1 <span class="keyword">or</span> l2:</span><br><span class="line">            <span class="comment"># total = l1.val + l2.val + carry</span></span><br><span class="line">            m, n = l1.val <span class="keyword">if</span> l1 <span class="keyword">else</span> <span class="number">0</span>, l2.val <span class="keyword">if</span> l2 <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">            total = m + n + carry</span><br><span class="line">            carry, digit = total//<span class="number">10</span>, total%<span class="number">10</span></span><br><span class="line">            cur.next = ListNode(digit)</span><br><span class="line">            cur = cur.next</span><br><span class="line">            l1, l2 = l1.next <span class="keyword">if</span> l1 <span class="keyword">else</span> <span class="literal">None</span>, l2.next <span class="keyword">if</span> l2 <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">            </span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        while l1 and l2:</span></span><br><span class="line"><span class="string">            total = l1.val + l2.val + carry</span></span><br><span class="line"><span class="string">            carry, digit = total//10, total%10  # 2 5 -&gt; 0 7, 4 6 =&gt; 1 0</span></span><br><span class="line"><span class="string">            # result = total * (10**loop) + result    # 10**1, 700    700   7*100 + 107</span></span><br><span class="line"><span class="string">            cur.next = ListNode(digit)</span></span><br><span class="line"><span class="string">            cur = cur.next</span></span><br><span class="line"><span class="string">            l1, l2 = l1.next, l2.next</span></span><br><span class="line"><span class="string">            # loop += 1</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        rem = l1 if l1 else l2</span></span><br><span class="line"><span class="string">        while rem:</span></span><br><span class="line"><span class="string">            total = rem.val + carry</span></span><br><span class="line"><span class="string">            carry, digit = total//10, total%10</span></span><br><span class="line"><span class="string">            cur.next = ListNode(digit)</span></span><br><span class="line"><span class="string">            cur = cur.next</span></span><br><span class="line"><span class="string">            # result = total * (10**loop) + result</span></span><br><span class="line"><span class="string">            rem = rem.next</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="keyword">if</span> carry:</span><br><span class="line">            cur.next = ListNode(carry)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br></pre></td></tr></table></figure>



<h3 id="3"><a href="#3" class="headerlink" title="3"></a><a name="3">3</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">　 a　b　c　a　b　c　b　b　</span></span><br><span class="line"><span class="string">             i     j</span></span><br><span class="line"><span class="string">-1 0 </span></span><br><span class="line"><span class="string">&#123;a:0, b:1, c:2&#125;  --&gt; &#123;a:3, b:1, c:2&#125; max_len = max(j - i, max_len)</span></span><br><span class="line"><span class="string">                 --&gt; &#123;a:3, b:4, c:5&#125; max_len = max(j - i, max_len)</span></span><br><span class="line"><span class="string">                 --&gt; &#123;a:3, b:4, c:5&#125; max_len = max(j - i, max_len)</span></span><br><span class="line"><span class="string">                 </span></span><br><span class="line"><span class="string">　 a　b　c　a　b　c　b　b　c a d</span></span><br><span class="line"><span class="string">                   i j  --&gt; &#123;a:3, b:7, c:5&#125; max_len = max(j - i, max_len)</span></span><br><span class="line"><span class="string">                   we can del d[a]  del[c] </span></span><br><span class="line"><span class="string">                   BUT,</span></span><br><span class="line"><span class="string">                 --&gt; i = max(i, d[a])</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">     a b c a b c b b  a </span></span><br><span class="line"><span class="string">             j   i </span></span><br><span class="line"><span class="string">i   0    2  </span></span><br><span class="line"><span class="string">j   0</span></span><br><span class="line"><span class="string">od  &#123;a&#125;  &#123;a b c&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    j       i       od                                                  dis</span></span><br><span class="line"><span class="string">    0       0       &#123;a:0&#125;                                                   1  </span></span><br><span class="line"><span class="string">    0       1       &#123;a:0 b:1&#125;                                                  2</span></span><br><span class="line"><span class="string">    0       2       &#123;a:0 b:1 c:2&#125;                                                     3</span></span><br><span class="line"><span class="string">    0       3       &#123;a:0 b:1 c:2&#125;    ==&gt;      while j 1   i 3   &#123;b:1 c:2 a:3&#125;          3</span></span><br><span class="line"><span class="string">    1       4       &#123;b:1 c:2 a:3&#125;     =&gt;      while j 2   i 4   &#123;c a b&#125;           3</span></span><br><span class="line"><span class="string">    2       5       &#123;&#125;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(self, s: str)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        od = OrderedDict()  <span class="comment"># position od</span></span><br><span class="line">        j = <span class="number">-1</span></span><br><span class="line">        g_max = cur_max = <span class="number">0</span></span><br><span class="line">        rec = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">            sym = s[i]</span><br><span class="line">            <span class="keyword">if</span> sym <span class="keyword">not</span> <span class="keyword">in</span> od:</span><br><span class="line">                od[sym] = i</span><br><span class="line">            <span class="keyword">else</span>:                           <span class="comment"># a b c b </span></span><br><span class="line">                <span class="comment"># while sym in od_pos:</span></span><br><span class="line">                    <span class="comment"># del od_pos[sym]</span></span><br><span class="line">                j = max(od[sym], j)</span><br><span class="line">                od[sym] = i     <span class="comment"># a 0</span></span><br><span class="line">                <span class="comment"># sym = od[j]</span></span><br><span class="line">                </span><br><span class="line">            cur_max = i - j</span><br><span class="line">            <span class="keyword">if</span> cur_max &gt; g_max:</span><br><span class="line">                g_max = cur_max</span><br><span class="line">                rec.append((i, j))</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> g_max</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># i = -1</span></span><br><span class="line">        <span class="comment"># max_len = 0</span></span><br><span class="line">        <span class="comment"># lkup = &#123;&#125;</span></span><br><span class="line">        <span class="comment"># for j in range(len(s)):</span></span><br><span class="line">        <span class="comment">#     if s[j] not in lkup:</span></span><br><span class="line">        <span class="comment">#         lkup[s[j]] = j</span></span><br><span class="line">        <span class="comment">#     else:</span></span><br><span class="line">        <span class="comment">#         i = max(lkup[s[j]], i)   # e.g. i at 7, doesn't go back to (6, c)</span></span><br><span class="line">        <span class="comment">#                                 # move i before update lkup[s[i]]</span></span><br><span class="line">        <span class="comment">#         lkup[s[j]] = j  # &#123;a:3, b:1, c:2&#125;</span></span><br><span class="line">        <span class="comment">#     max_len = max(max_len, j - i)   # 2 - (-1) = 3</span></span><br><span class="line">        <span class="comment"># return max_len</span></span><br><span class="line">                </span><br><span class="line">            <span class="comment"># if s[j] in lkup:</span></span><br><span class="line">            <span class="comment">#     max_len = max(max_len, j - i)</span></span><br><span class="line">            <span class="comment"># lkup[s[j]] = i</span></span><br></pre></td></tr></table></figure>



<h3 id="11"><a href="#11" class="headerlink" title="11"></a><a name="11">11</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">=== Mis-Understanding ===</span></span><br><span class="line"><span class="string">            [1,8,6,2,5,4,8,3,7]</span></span><br><span class="line"><span class="string">l_larger =  [0 0 1 1 2 1 5 1 2]</span></span><br><span class="line"><span class="string">r_larger =  [1 5 4 1 2 1 0 1 0]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">width[i] = l_larger[i] + r_larger[i]</span></span><br><span class="line"><span class="string">water = height[i] * width[i]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">=== Again-Understanding ==&gt; Still Wrong ! ===</span></span><br><span class="line"><span class="string">            [1,8,6,2, 5, 4, 8, 3, 7]</span></span><br><span class="line"><span class="string">l_dis =     [0 0 1 2  3  4  5  6  7]</span></span><br><span class="line"><span class="string">r_dis =     [8 5 6 5  4  3  0  1  0]</span></span><br><span class="line"><span class="string">ans      =. [8 0 6 10 12 12 40 21 49]</span></span><br><span class="line"><span class="string">width[i] = l_larger[i] + r_larger[i]</span></span><br><span class="line"><span class="string">water = height[i] * width[i]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxArea</span><span class="params">(self, height: List[int])</span> -&gt; int:</span></span><br><span class="line">        l, r = <span class="number">0</span>, len(height)<span class="number">-1</span></span><br><span class="line">        </span><br><span class="line">        g_area = area = <span class="number">0</span></span><br><span class="line">        rec = []</span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            h = min(height[l], height[r])    </span><br><span class="line">            area = h * (r-l)</span><br><span class="line">            <span class="keyword">if</span> height[l] &lt;= height[r]:</span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">            <span class="keyword">if</span> area &gt; g_area:</span><br><span class="line">                g_area = area</span><br><span class="line">                rec.append((l, r))</span><br><span class="line">                print(l, r)</span><br><span class="line">        <span class="keyword">return</span> g_area</span><br><span class="line">        </span><br><span class="line">        n = len(height)</span><br><span class="line">        l, r  = <span class="number">0</span>, len(height)<span class="number">-1</span></span><br><span class="line">        g_max = cur_area = <span class="number">0</span> </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            cur_area = (r - l) * min(height[l], height[r])</span><br><span class="line">            g_max = max(g_max, cur_area)</span><br><span class="line">            <span class="keyword">if</span> height[l] &lt;= height[r]:</span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> g_max</span><br></pre></td></tr></table></figure>



<h3 id="15"><a href="#15" class="headerlink" title="15"></a><a name="15">15</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># i, l, r</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">threeSum</span><span class="params">(self, nums: List[int])</span> -&gt; List[List[int]]:</span></span><br><span class="line">        nums.sort()</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)<span class="number">-2</span>):</span><br><span class="line">            l, r = i+<span class="number">1</span>, len(nums)<span class="number">-1</span></span><br><span class="line">            <span class="keyword">if</span> nums[i] <span class="keyword">and</span> nums[i] + nums[r<span class="number">-1</span>] + nums[r] &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> nums[r] &lt; <span class="number">0</span> <span class="keyword">and</span> nums[i] + nums[i+<span class="number">1</span>] + nums[r] &lt; <span class="number">0</span>:      <span class="comment"># nums[i] still has chance to overbeat l &amp; r</span></span><br><span class="line">                <span class="keyword">continue</span>    </span><br><span class="line">            <span class="keyword">if</span> i &gt; <span class="number">0</span> <span class="keyword">and</span> nums[i] == nums[i<span class="number">-1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            total = nums[i] + nums[l] + nums[r]</span><br><span class="line">            <span class="keyword">if</span> total == <span class="number">0</span>:</span><br><span class="line">                res.append([i, l, r])</span><br><span class="line">                <span class="comment"># while l&lt;r and nums[l] == nums[l+1]:</span></span><br><span class="line">                <span class="keyword">while</span> l+<span class="number">1</span>&lt;r <span class="keyword">and</span> nums[l] == nums[l+<span class="number">1</span>]:    </span><br><span class="line">                    l += <span class="number">1</span></span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">                <span class="comment"># while l&lt;rnums[r] == nums[r-1]:</span></span><br><span class="line">                <span class="keyword">while</span> r<span class="number">-1</span>&gt;l <span class="keyword">and</span> l&lt;rnums[r] == nums[r<span class="number">-1</span>]:</span><br><span class="line">                    r -= <span class="number">1</span></span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> total &lt; <span class="number">0</span>:</span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        nums.sort()</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)<span class="number">-2</span>):  <span class="comment"># i, l, r</span></span><br><span class="line">            l, r = i + <span class="number">1</span>, len(nums) - <span class="number">1</span></span><br><span class="line">            total = nums[i] + nums[l] + nums[r] <span class="comment"># prune here</span></span><br><span class="line">            <span class="comment"># if nums[i] &gt; 0:     # left most</span></span><br><span class="line">            <span class="comment">#     return res      </span></span><br><span class="line">            <span class="comment"># if nums[r] &lt; 0:     # right most</span></span><br><span class="line">            <span class="comment">#     return res</span></span><br><span class="line">            <span class="keyword">if</span> nums[i] &gt; <span class="number">0</span> <span class="keyword">and</span> nums[i] + nums[l] + nums[r] &gt; <span class="number">0</span>: <span class="comment"># r can be small</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> nums[r] &lt; <span class="number">0</span> <span class="keyword">and</span> nums[i] + nums[r<span class="number">-1</span>] + nums[r] &lt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> i &gt; <span class="number">0</span> <span class="keyword">and</span> nums[i] == nums[i<span class="number">-1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">while</span> l &lt; r:            <span class="comment"># -99 8 10 99</span></span><br><span class="line">                total = nums[i] + nums[l] + nums[r]</span><br><span class="line">                <span class="keyword">if</span> total == <span class="number">0</span>: </span><br><span class="line">                    res.append([nums[i], nums[l], nums[r]])</span><br><span class="line">                    <span class="string">''' The following "whiles" are CRUCIAL...'''</span></span><br><span class="line">                    <span class="comment"># -4 -1 -1 0 1 2 </span></span><br><span class="line">                    <span class="comment">#        idx</span></span><br><span class="line">                    <span class="comment">#     i   1  </span></span><br><span class="line">                    <span class="comment">#     l   2</span></span><br><span class="line">                    <span class="comment">#     r   5</span></span><br><span class="line">                    <span class="string">''' #[-2 -1 0 1 2 3] failed for [-1 0 1] 'cause l &amp; r overlapped '''</span></span><br><span class="line">                    <span class="keyword">while</span> l &lt; r <span class="keyword">and</span> nums[l+<span class="number">1</span>] == nums[l]:  </span><br><span class="line">                        l += <span class="number">1</span></span><br><span class="line">                    <span class="comment"># l += 1</span></span><br><span class="line">                    <span class="keyword">while</span> r &gt; l <span class="keyword">and</span> nums[r<span class="number">-1</span>] == nums[r]:</span><br><span class="line">                        r -= <span class="number">1</span></span><br><span class="line">                    <span class="comment"># r -= 1</span></span><br><span class="line">                    <span class="comment">#'''                    </span></span><br><span class="line">                    l, r = l + <span class="number">1</span>, r - <span class="number">1</span>   <span class="comment">#''' l+1 should before while of r '''</span></span><br><span class="line">                <span class="keyword">elif</span> total &lt; <span class="number">0</span>:</span><br><span class="line">                    l += <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    r -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="17"><a href="#17" class="headerlink" title="17"></a><a name="17">17</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2 3 4</span></span><br><span class="line"><span class="comment"># a d g</span></span><br><span class="line"><span class="comment"># b e h</span></span><br><span class="line"><span class="comment"># c f i</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">letterCombinations</span><span class="params">(self, digits: str)</span> -&gt; List[str]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> digits:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        self.d = &#123;<span class="string">'1'</span>:<span class="string">''</span>, <span class="string">'2'</span>:<span class="string">'abc'</span>, <span class="string">'3'</span>:<span class="string">'def'</span>, <span class="string">'4'</span>:<span class="string">'ghi'</span>, <span class="string">'5'</span>:<span class="string">'jkl'</span>, <span class="string">'6'</span>:<span class="string">'mno'</span>, <span class="string">'7'</span>:<span class="string">'pqrs'</span>, <span class="string">'8'</span>:<span class="string">'tuv'</span>, <span class="string">'9'</span>:<span class="string">'wxyz'</span>&#125;</span><br><span class="line">        self.result = []</span><br><span class="line">        self.helper(digits, <span class="string">''</span>, <span class="number">0</span>)        <span class="comment"># THIS IS ALREADY OK!</span></span><br><span class="line">        <span class="comment"># print(self.result)    </span></span><br><span class="line">        <span class="keyword">return</span> self.result</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, digits, item, level)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> level == len(digits):</span><br><span class="line">            <span class="comment"># self.result.append(item.copy())   # String has no attribute copy</span></span><br><span class="line">            self.result.append(item)    <span class="comment"># just call permutation here! Another backtracking for PERMUTATION</span></span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">        cur_digit = digits[level]   <span class="comment"># 2         3        </span></span><br><span class="line">        cur_candidates = self.d[cur_digit]          <span class="comment"># abc,      def</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(cur_candidates)):</span><br><span class="line">            item += cur_candidates[i]     <span class="comment"># def   </span></span><br><span class="line">            self.helper(digits, item, level+<span class="number">1</span>)</span><br><span class="line">            item = item[:<span class="number">-1</span>]    <span class="comment"># pop()</span></span><br></pre></td></tr></table></figure>



<h3 id="19"><a href="#19" class="headerlink" title="19"></a><a name="19">19</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> &gt; <span class="number">2</span> &gt; <span class="number">3</span> &gt; <span class="number">4</span> &gt; <span class="number">5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">removeNthFromEnd</span><span class="params">(self, head: ListNode, n: int)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        dummy = cur = later = ListNode(<span class="number">0</span>)</span><br><span class="line">        dummy.next = head</span><br><span class="line">        </span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> count &lt; n <span class="keyword">and</span> cur:</span><br><span class="line">            cur = cur.next</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">if</span> n &lt; count:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        0 1 2 3 4 5 </span></span><br><span class="line"><span class="string">              l   c</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        0  1</span></span><br><span class="line"><span class="string">        l  c</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        <span class="keyword">while</span> cur.next:</span><br><span class="line">            cur = cur.next</span><br><span class="line">            later = later.next</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> later.next:</span><br><span class="line">            <span class="string">''' remove later.next '''</span></span><br><span class="line">            <span class="comment"># later.next.next = None</span></span><br><span class="line">            later.next = later.next.next</span><br><span class="line">            <span class="comment"># later.next = None</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br></pre></td></tr></table></figure>



<h3 id="20"><a href="#20" class="headerlink" title="20"></a><a name="20">20</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValid</span><span class="params">(self, s: str)</span> -&gt; bool:</span></span><br><span class="line">        d = &#123;<span class="string">'('</span>: <span class="string">')'</span>, <span class="string">'['</span>:<span class="string">']'</span>, <span class="string">'&#123;'</span>:<span class="string">'&#125;'</span>&#125;</span><br><span class="line">        </span><br><span class="line">        S = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">            <span class="keyword">if</span> c == <span class="string">'('</span> <span class="keyword">or</span> c == <span class="string">'['</span> <span class="keyword">or</span> c ==<span class="string">'&#123;'</span>:</span><br><span class="line">                S.append(c)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> S:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    elem = S.pop()</span><br><span class="line">                    <span class="keyword">if</span> d[elem] != c:</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> S</span><br></pre></td></tr></table></figure>





<h3 id="21"><a href="#21" class="headerlink" title="21"></a><a name="21">21</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">    1 2 4 </span></span><br><span class="line"><span class="string">    i</span></span><br><span class="line"><span class="string">    1 3 4 </span></span><br><span class="line"><span class="string">cur -&gt; smaller one</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mergeTwoLists</span><span class="params">(self, l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="comment"># return l2 if not l1</span></span><br><span class="line">        <span class="comment"># return l1 if not l2</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1: <span class="keyword">return</span> l2</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l2: <span class="keyword">return</span> l1</span><br><span class="line">        dummy = cur = ListNode(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># dummy.next = </span></span><br><span class="line">        self.helper2(cur, l1, l2)</span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper2</span><span class="params">(self, root, l1, l2)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1:</span><br><span class="line">            root.next = l2</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l2:</span><br><span class="line">            root.next = l1</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> l1.val &lt;= l2.val:</span><br><span class="line">            root.next = l1</span><br><span class="line">            l1 = l1.next        </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            root.next = l2</span><br><span class="line">            l2 = l2.next</span><br><span class="line">            </span><br><span class="line">        root = root.next</span><br><span class="line">        self.helper2(root, l1, l2)</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mergeTwoLists_alsoOK</span><span class="params">(self, l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1:</span><br><span class="line">            <span class="keyword">return</span> l2</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l2:</span><br><span class="line">            <span class="keyword">return</span> l1</span><br><span class="line">        dummy = ListNode(<span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># self.helper(l1, l2)   # Iterative</span></span><br><span class="line">        self.recursive(dummy, l1, l2)</span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    Input: 1-&gt;2-&gt;4, 1-&gt;3-&gt;4</span></span><br><span class="line"><span class="string">    Output: 1-&gt;1-&gt;2-&gt;3-&gt;4-&gt;4</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="string">''' recursive '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recursive</span><span class="params">(self, root, l1, l2)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l2:</span><br><span class="line">            root.next = l1</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1:</span><br><span class="line">            root.next = l2</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> l1.val &lt;= l2.val:</span><br><span class="line">            root.next = l1</span><br><span class="line">            l1 = l1.next</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            root.next = l2</span><br><span class="line">            l2 = l2.next</span><br><span class="line">        <span class="comment"># root = root.next</span></span><br><span class="line">        </span><br><span class="line">        self.recursive(root.next, l1, l2)</span><br><span class="line">    </span><br><span class="line">    <span class="string">''' Iterative '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, l1, l2)</span>:</span></span><br><span class="line">        </span><br><span class="line">        head = cur = ListNode(<span class="number">0</span>) <span class="comment">#l1 if l1.val &lt;= l2.val else l2</span></span><br><span class="line">        prev = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">while</span> l1 <span class="keyword">and</span> l2:</span><br><span class="line">            <span class="keyword">if</span> l1.val &lt;= l2.val:</span><br><span class="line">                cur.next = l1</span><br><span class="line">                l1 = l1.next</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur.next = l2</span><br><span class="line">                l2 = l2.next</span><br><span class="line">            cur = cur.next</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l2 <span class="keyword">and</span> <span class="keyword">not</span> l1:</span><br><span class="line">            cur.next = <span class="literal">None</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l2:</span><br><span class="line">            cur.next = l1</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cur.next = l2</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> head.next</span><br></pre></td></tr></table></figure>



<h3 id="23"><a href="#23" class="headerlink" title="23"></a><a name="23">23</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.next = None</span></span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mergeKLists</span><span class="params">(self, lists: List[ListNode])</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="comment"># val, index </span></span><br><span class="line">        <span class="comment"># 1, 0</span></span><br><span class="line">        <span class="comment"># 1, 1</span></span><br><span class="line">        <span class="comment"># 2, 2</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> lists:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># if not lists[0]:</span></span><br><span class="line">        <span class="comment">#     return None</span></span><br><span class="line">        </span><br><span class="line">        l = []  <span class="comment"># for heapq</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(lists)):</span><br><span class="line">            <span class="keyword">if</span> lists[i]:                <span class="comment"># CAUTION! for [[],[1]]</span></span><br><span class="line">                val, idx = lists[i].val, i</span><br><span class="line">                heapq.heappush(l, (val, idx))</span><br><span class="line">            <span class="comment"># lists[idx] = lists[idx].next  # CAUTION! 別跟31行重覆了</span></span><br><span class="line">        </span><br><span class="line">        root = curr = ListNode(<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> l:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            val, idx = heapq.heappop(l)</span><br><span class="line">            <span class="comment"># print(val, idx)</span></span><br><span class="line">            <span class="comment"># for update heapq</span></span><br><span class="line">            lists[idx] = lists[idx].next</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> lists[idx] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                heapq.heappush(l, (lists[idx].val, idx))</span><br><span class="line">                </span><br><span class="line">            <span class="comment"># for Result</span></span><br><span class="line">            curr.next = ListNode(val)</span><br><span class="line">            curr = curr.next</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> root.next</span><br></pre></td></tr></table></figure>



<h3 id="31"><a href="#31" class="headerlink" title="31"></a><a name="31">31</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">1 2 4  8  3  7 6  5   ==&gt;   </span></span><br><span class="line"><span class="string">          pvt r</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3 5 7 4  6 9 8 7 6 5</span></span><br><span class="line"><span class="keyword">from</span> bisect <span class="keyword">import</span> bisect_right</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">nextPermutation</span><span class="params">(self, nums: List[int])</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> len(nums) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        r = len(nums)<span class="number">-1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> r &gt; <span class="number">0</span> <span class="keyword">and</span> nums[r] &lt;= nums[r<span class="number">-1</span>]:</span><br><span class="line">            r -= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">0</span>:   <span class="comment"># 5 4 3 2 1</span></span><br><span class="line">            <span class="comment"># nums = nums[::-1]     # not in-place</span></span><br><span class="line">            nums.reverse()</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">#              # 1 2 3 4 5</span></span><br><span class="line">        <span class="keyword">if</span> r == len(nums) - <span class="number">1</span>:</span><br><span class="line">            <span class="comment"># nums[1:].reverse()  # DOESN'T WORK!!!</span></span><br><span class="line">            nums[<span class="number">-1</span>], nums[<span class="number">-2</span>] = nums[<span class="number">-2</span>], nums[<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># if r == nums[]</span></span><br><span class="line">        pvt = r</span><br><span class="line">        <span class="comment"># idx = bisect_right(nums[pvt:], nums[ref]) + r # WRONG!!!   # at 5</span></span><br><span class="line">        r2 = len(nums)<span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> r2 &gt; r <span class="keyword">and</span> nums[r2] &lt;= nums[r<span class="number">-1</span>]:</span><br><span class="line">            r2 -= <span class="number">1</span></span><br><span class="line">        nums[r<span class="number">-1</span>], nums[r2] = nums[r2], nums[r<span class="number">-1</span>]</span><br><span class="line">        nums[pvt:] = nums[pvt:][::<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>



<h3 id="34"><a href="#34" class="headerlink" title="34"></a><a name="34">34</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bisect <span class="keyword">import</span> * <span class="comment"># bisect_left() bisect_right()</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">searchRange</span><span class="params">(self, nums: List[int], target: int)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> [<span class="number">-1</span>, <span class="number">-1</span>]</span><br><span class="line">        </span><br><span class="line">        l = bisect_left(nums, target)</span><br><span class="line">        r = bisect_right(nums, target)</span><br><span class="line">        <span class="keyword">if</span> l == r:</span><br><span class="line">            <span class="keyword">return</span> [<span class="number">-1</span>, <span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">return</span> [l, r<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>



<h3 id="42"><a href="#42" class="headerlink" title="42"></a><a name="42">42</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">trap</span><span class="params">(self, height: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> self.two_ptr(height)</span><br><span class="line">        <span class="comment"># height = [0,1,0,2,1,0,1,3,2,1,2,1]</span></span><br><span class="line">        <span class="comment"># l_max =  [0 0 1 1 2 2 2 2 3 3 3 3]</span></span><br><span class="line">        <span class="comment"># r_max =  [3 3 3 3 3 3 3 2 2 2 1 0]</span></span><br><span class="line">        <span class="comment"># min_nbr = min(l_max[i], r_max[i])</span></span><br><span class="line">        <span class="comment"># water[i] = height[i] &lt; min_nbr ? (min_nbr-height[i]) * 1:0</span></span><br><span class="line">        <span class="comment"># return sum(water)</span></span><br><span class="line">        <span class="keyword">return</span> self.two_ptr(height)</span><br><span class="line">        <span class="keyword">return</span> self.dp_sol(height)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">two_ptr</span><span class="params">(self, height)</span>:</span></span><br><span class="line">        l, r = <span class="number">0</span>, len(height)<span class="number">-1</span></span><br><span class="line">        l_max, r_max = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            <span class="comment"># if height[l] &lt; height[r]:     # This should behind updates of l and r, or FAILED in VALLEY as [2 0 2]</span></span><br><span class="line">            <span class="comment">#     l += 1</span></span><br><span class="line">            <span class="comment"># else:</span></span><br><span class="line">            <span class="comment">#     r -= 1</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">if</span> height[l] &gt;= l_max:</span><br><span class="line">                l_max = height[l]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur = max(min(l_max, r_max) * <span class="number">1</span> - height[l], <span class="number">0</span>)</span><br><span class="line">                count += cur</span><br><span class="line">                <span class="comment"># l += 1</span></span><br><span class="line">            <span class="keyword">if</span> height[r] &gt;= r_max:</span><br><span class="line">                r_max = height[r]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cur = max(min(l_max, r_max) * <span class="number">1</span> - height[r], <span class="number">0</span>)</span><br><span class="line">                count += cur</span><br><span class="line">                <span class="comment"># r -= 1</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">if</span> height[l] &lt; height[r]:</span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dp_sol</span><span class="params">(self, height)</span>:</span></span><br><span class="line">        n = len(height)</span><br><span class="line">        l_max = [<span class="number">0</span>] * n</span><br><span class="line">        cur_max = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            l_max[i] = cur_max</span><br><span class="line">            cur_max = max(height[i], cur_max)</span><br><span class="line">            </span><br><span class="line">        r_max = [<span class="number">0</span>] * n</span><br><span class="line">        cur_max = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> reversed(range(n)):</span><br><span class="line">            r_max[j] = cur_max</span><br><span class="line">            cur_max = max(height[j], cur_max)</span><br><span class="line">            </span><br><span class="line">        </span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(n):</span><br><span class="line">            min_nbr = min(l_max[k], r_max[k])</span><br><span class="line">            res += (min_nbr-height[k])*<span class="number">1</span> <span class="keyword">if</span> height[k] &lt; min_nbr <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h3 id="43"><a href="#43" class="headerlink" title="43"></a><a name="43">43</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">multiply</span><span class="params">(self, num1: str, num2: str)</span> -&gt; str:</span></span><br><span class="line">        a = self.string2num(num1)</span><br><span class="line">        b = self.string2num(num2)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> str(a*b)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">string2num</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        ret = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(n)):</span><br><span class="line">            digit = ord(n[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">            ret = <span class="number">10</span>*ret + digit</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ret</span><br></pre></td></tr></table></figure>



<h3 id="48"><a href="#48" class="headerlink" title="48"></a><a name="48">48</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">1 2 4  8  3  7 6  5   ==&gt;   </span></span><br><span class="line"><span class="string">          pvt r</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3 5 7 4  6 9 8 7 6 5</span></span><br><span class="line"><span class="keyword">from</span> bisect <span class="keyword">import</span> bisect_right</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">nextPermutation</span><span class="params">(self, nums: List[int])</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> len(nums) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        r = len(nums)<span class="number">-1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> r &gt; <span class="number">0</span> <span class="keyword">and</span> nums[r] &lt;= nums[r<span class="number">-1</span>]:</span><br><span class="line">            r -= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">0</span>:   <span class="comment"># 5 4 3 2 1</span></span><br><span class="line">            <span class="comment"># nums = nums[::-1]     # not in-place</span></span><br><span class="line">            nums.reverse()</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">#              # 1 2 3 4 5</span></span><br><span class="line">        <span class="keyword">if</span> r == len(nums) - <span class="number">1</span>:</span><br><span class="line">            <span class="comment"># nums[1:].reverse()  # DOESN'T WORK!!!</span></span><br><span class="line">            nums[<span class="number">-1</span>], nums[<span class="number">-2</span>] = nums[<span class="number">-2</span>], nums[<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># if r == nums[]</span></span><br><span class="line">        pvt = r</span><br><span class="line">        <span class="comment"># idx = bisect_right(nums[pvt:], nums[ref]) + r # WRONG!!!   # at 5</span></span><br><span class="line">        r2 = len(nums)<span class="number">-1</span></span><br><span class="line">        <span class="keyword">while</span> r2 &gt; r <span class="keyword">and</span> nums[r2] &lt;= nums[r<span class="number">-1</span>]:</span><br><span class="line">            r2 -= <span class="number">1</span></span><br><span class="line">        nums[r<span class="number">-1</span>], nums[r2] = nums[r2], nums[r<span class="number">-1</span>]</span><br><span class="line">        nums[pvt:] = nums[pvt:][::<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>



<h3 id="51"><a href="#51" class="headerlink" title="51"></a><a name="51">51</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">solveNQueens</span><span class="params">(self, n: int)</span> -&gt; List[List[str]]:</span></span><br><span class="line">        self.result = []</span><br><span class="line">        mark = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(n)] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        location = [[<span class="string">'.'</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(n)] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        self.gen(n, <span class="number">0</span>, mark, location)</span><br><span class="line">        <span class="keyword">return</span> self.result</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen</span><span class="params">(self, n, k, mark, location)</span>:</span>  <span class="comment"># k == level</span></span><br><span class="line">        <span class="keyword">if</span> k == n:</span><br><span class="line">            self.result.append([<span class="string">''</span>.join(row) <span class="keyword">for</span> row <span class="keyword">in</span> location])</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(n):  <span class="comment"># row</span></span><br><span class="line">            <span class="comment"># print(k, j)</span></span><br><span class="line">            <span class="keyword">if</span> mark[k][j] == <span class="number">0</span>:</span><br><span class="line">                <span class="comment"># row_data += </span></span><br><span class="line">                tmp_mark = deepcopy(mark)</span><br><span class="line">                location[k][j] = <span class="string">'Q'</span></span><br><span class="line">                mark = self.put_down_the_queen(n, k, j, mark)</span><br><span class="line">                self.gen(n, k+<span class="number">1</span>, mark, location)</span><br><span class="line">                mark = deepcopy(tmp_mark)</span><br><span class="line">                location[k][j] = <span class="string">'.'</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put_down_the_queen</span><span class="params">(self, n, r, c, mark)</span>:</span></span><br><span class="line">        dr = [ <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>,  <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>]</span><br><span class="line">        dc = [<span class="number">-1</span>, <span class="number">1</span>,  <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">-1</span>,  <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(dc)):</span><br><span class="line">                new_r = r + i * dr[j]</span><br><span class="line">                new_c = c + i * dc[j]</span><br><span class="line">                <span class="keyword">if</span> new_c &gt;=<span class="number">0</span> <span class="keyword">and</span> new_r &gt;=<span class="number">0</span> <span class="keyword">and</span> new_c &lt; n <span class="keyword">and</span> new_r &lt; n:</span><br><span class="line">                    mark[new_r][new_c] = <span class="number">1</span>    </span><br><span class="line">        <span class="keyword">return</span> mark</span><br></pre></td></tr></table></figure>



<h3 id="52"><a href="#52" class="headerlink" title="52"></a><a name="52">52</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">totalNQueens</span><span class="params">(self, n: int)</span> -&gt; int:</span></span><br><span class="line">        attack_range = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(n)] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        board = [[<span class="string">'.'</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(n)] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        self.result = []</span><br><span class="line">        self.helper(<span class="number">0</span>, n, attack_range, board)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> len(self.result)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, row, n, attack_range, board)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> row == n:</span><br><span class="line">            self.result.append(deepcopy(board))</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">if</span> attack_range[row][col] == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">                </span><br><span class="line">            tmp_attack = deepcopy(attack_range)</span><br><span class="line">            attack_range = self.put_down_queen(n, row, col, attack_range)</span><br><span class="line">            board[row][col] = <span class="string">'Q'</span></span><br><span class="line">            </span><br><span class="line">            self.helper(row+<span class="number">1</span>, n, attack_range, board)</span><br><span class="line">            attack_range = deepcopy(tmp_attack)</span><br><span class="line">            board[row][col] = <span class="string">'.'</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put_down_queen</span><span class="params">(self, n, row, col, attack_range)</span>:</span></span><br><span class="line">        <span class="comment"># update attack_range</span></span><br><span class="line">        drow = [<span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>,  <span class="number">0</span>, <span class="number">1</span>,  <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>]</span><br><span class="line">        dcol = [<span class="number">0</span>,  <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>,  <span class="number">1</span>, <span class="number">-1</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(len(drow)):</span><br><span class="line">            <span class="keyword">for</span> dis <span class="keyword">in</span> range(n):</span><br><span class="line">                new_row = row + dis*drow[k]</span><br><span class="line">                new_col = col + dis*dcol[k]</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> new_row &gt;= <span class="number">0</span> <span class="keyword">and</span> new_row &lt; n <span class="keyword">and</span> new_col &gt;= <span class="number">0</span> <span class="keyword">and</span> new_col &lt; n:</span><br><span class="line">                    attack_range[new_row][new_col] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> attack_range</span><br></pre></td></tr></table></figure>



<h3 id="53"><a href="#53" class="headerlink" title="53"></a><a name="53">53</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxSubArray</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> len(nums) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> nums[<span class="number">0</span>]</span><br><span class="line">        </span><br><span class="line">        dp = [<span class="number">0</span>] + [<span class="number">0</span>] * len(nums)</span><br><span class="line">        <span class="string">'''</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">            -2              1       -3 4 -1 2</span></span><br><span class="line"><span class="string"> uptome      0              0    </span></span><br><span class="line"><span class="string">       max(0, 0+-2)     max(0, 1)</span></span><br><span class="line"><span class="string">        '''</span></span><br><span class="line">        dp[<span class="number">1</span>] = max(dp[<span class="number">0</span>]+nums[<span class="number">0</span>], nums[<span class="number">0</span>]) </span><br><span class="line">        dp[<span class="number">2</span>] = max(dp[<span class="number">1</span>]+nums[<span class="number">1</span>], nums[<span class="number">1</span>])</span><br><span class="line">        g = float(<span class="string">'-inf'</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, len(dp)):</span><br><span class="line">            dp[j] = max(dp[j<span class="number">-1</span>] + nums[j<span class="number">-1</span>], nums[j<span class="number">-1</span>]) </span><br><span class="line">            g = max(g, dp[j])</span><br><span class="line">        <span class="comment"># return dp[-1]</span></span><br><span class="line">        <span class="keyword">return</span> g</span><br></pre></td></tr></table></figure>



<h3 id="56"><a href="#56" class="headerlink" title="56"></a><a name="56">56</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">merge</span><span class="params">(self, intervals: List[List[int]])</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="keyword">return</span> self.helper(intervals)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, intervals)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> intervals:</span><br><span class="line">            <span class="keyword">return</span> intervals</span><br><span class="line">        result = []</span><br><span class="line">        intervals_s = sorted(intervals, key=<span class="keyword">lambda</span> x: x[<span class="number">0</span>])</span><br><span class="line">        prev_start, prev_end = intervals_s[<span class="number">0</span>][<span class="number">0</span>], intervals_s[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(intervals)):</span><br><span class="line">            <span class="comment"># cur_end_time </span></span><br><span class="line">            <span class="keyword">if</span> intervals_s[i][<span class="number">0</span>] &lt;= prev_end:</span><br><span class="line">                prev_end = max(prev_end, intervals_s[i][<span class="number">1</span>])</span><br><span class="line">                <span class="comment"># result.append([prev_start, intervals_s[i][1]])</span></span><br><span class="line">            <span class="keyword">else</span>:   <span class="comment"># not able to merge</span></span><br><span class="line">                result.append([prev_start, prev_end])</span><br><span class="line">                prev_start = intervals_s[i][<span class="number">0</span>]</span><br><span class="line">                prev_end = intervals_s[i][<span class="number">1</span>]</span><br><span class="line">        result.append([prev_start, prev_end])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>



<h3 id="66"><a href="#66" class="headerlink" title="66"></a><a name="66">66</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">plusOne</span><span class="params">(self, digits: List[int])</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="comment"># l = digits[:len(digits)-1] + [digits[-1]+1]</span></span><br><span class="line">        <span class="comment"># s = ''.join([str(num) for num in l])</span></span><br><span class="line">        <span class="comment"># res = []</span></span><br><span class="line">        <span class="comment"># res += [c for c in s]</span></span><br><span class="line">        <span class="comment"># return res</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> digits:</span><br><span class="line">            <span class="keyword">return</span> digits</span><br><span class="line">        </span><br><span class="line">        s, t = <span class="string">''</span>.join([str(dg) <span class="keyword">for</span> dg <span class="keyword">in</span> digits]), <span class="string">'1'</span></span><br><span class="line">        s = s[::<span class="number">-1</span>]</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        carry = <span class="number">0</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">while</span> i &lt; len(s):</span><br><span class="line">            num = ord(s[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">            m = <span class="number">0</span></span><br><span class="line">            <span class="keyword">if</span> i &lt; len(t):</span><br><span class="line">                m = ord(t[i]) - ord(<span class="string">'0'</span>)</span><br><span class="line">            total = carry + num + m</span><br><span class="line">            carry, digit = total//<span class="number">10</span>, total%<span class="number">10</span></span><br><span class="line">            result.append(digit)</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> carry:</span><br><span class="line">            result.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> result[::<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>



<h3 id="79"><a href="#79" class="headerlink" title="79"></a><a name="79">79</a></h3><h5 id="TLE…"><a href="#TLE…" class="headerlink" title="TLE…"></a>TLE…</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="comment"># from collections import deque</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">exist</span><span class="params">(self, board: List[List[str]], word: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> board <span class="keyword">or</span> <span class="keyword">not</span> board[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        </span><br><span class="line">        ans = <span class="literal">False</span></span><br><span class="line">        visited = [[<span class="literal">False</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>]))]<span class="keyword">for</span> i <span class="keyword">in</span> range(len(board))]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(board)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>])):</span><br><span class="line">                <span class="keyword">if</span> board[i][j] == word[<span class="number">0</span>]:</span><br><span class="line">                    ans = self.helper(board, i, j, word, <span class="literal">False</span>, deepcopy(visited)) <span class="keyword">or</span> ans  </span><br><span class="line">                    <span class="keyword">if</span> ans:</span><br><span class="line">                        <span class="keyword">return</span> ans</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">    </span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    First version failed AT:</span></span><br><span class="line"><span class="string">    [["C","A","A"],</span></span><br><span class="line"><span class="string">     ["A","A","A"],</span></span><br><span class="line"><span class="string">     ["B","C","D"]]</span></span><br><span class="line"><span class="string">    "AAB"</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, board, row, col, item, ans, visited)</span>:</span></span><br><span class="line">        <span class="comment"># if not item:</span></span><br><span class="line">        <span class="comment">#     return True</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span> board[row][col] == item[<span class="number">0</span>]:</span><br><span class="line">            visited[row][col] = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> len(item) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                item = item[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> row &lt; len(board)<span class="number">-1</span>:</span><br><span class="line">            <span class="comment"># print(row, col)</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row+<span class="number">1</span>][col]:</span><br><span class="line">                ans = self.helper(board, row+<span class="number">1</span>, col, item, ans, deepcopy(visited)) <span class="keyword">or</span> ans</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> row &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row<span class="number">-1</span>][col]:</span><br><span class="line">                ans = self.helper(board, row<span class="number">-1</span>, col, item, ans, deepcopy(visited)) <span class="keyword">or</span> ans</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> col &lt; len(board[<span class="number">0</span>])<span class="number">-1</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row][col+<span class="number">1</span>]:</span><br><span class="line">                ans = self.helper(board, row, col+<span class="number">1</span>, item, ans, deepcopy(visited)) <span class="keyword">or</span> ans</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> col &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row][col<span class="number">-1</span>]:</span><br><span class="line">                ans = self.helper(board, row, col<span class="number">-1</span>, item, ans, deepcopy(visited)) <span class="keyword">or</span> ans</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>



<h5 id="Solved-TLE-by-not-deepcopy-board-but-merely-modifying-element-at-row-col"><a href="#Solved-TLE-by-not-deepcopy-board-but-merely-modifying-element-at-row-col" class="headerlink" title="Solved TLE: by not deepcopy board but merely modifying element at (row, col)"></a>Solved TLE: by not deepcopy board but merely modifying element at (row, col)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="comment"># from collections import deque</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">exist</span><span class="params">(self, board: List[List[str]], word: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> board <span class="keyword">or</span> <span class="keyword">not</span> board[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        </span><br><span class="line">        ans = <span class="literal">False</span></span><br><span class="line">        <span class="comment"># visited = [[False for j in range(len(board[0]))]for i in range(len(board))]</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(board)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>])):</span><br><span class="line">                <span class="keyword">if</span> board[i][j] == word[<span class="number">0</span>]:</span><br><span class="line">                    visited = [[<span class="literal">False</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>]))]<span class="keyword">for</span> i <span class="keyword">in</span> range(len(board))]</span><br><span class="line">                    ans = self.helper(board, i, j, word, <span class="literal">False</span>, visited) <span class="keyword">or</span> ans  </span><br><span class="line">                    <span class="keyword">if</span> ans:</span><br><span class="line">                        <span class="keyword">return</span> ans</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">    </span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    First version failed AT:</span></span><br><span class="line"><span class="string">    [["C","A","A"],</span></span><br><span class="line"><span class="string">     ["A","A","A"],</span></span><br><span class="line"><span class="string">     ["B","C","D"]]</span></span><br><span class="line"><span class="string">    "AAB"</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, board, row, col, item, ans, visited)</span>:</span></span><br><span class="line">        <span class="comment"># if not item:</span></span><br><span class="line">        <span class="comment">#     return True</span></span><br><span class="line">        <span class="keyword">if</span> visited[row][col] == <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> board[row][col] == item[<span class="number">0</span>]:</span><br><span class="line">            visited[row][col] = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> len(item) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                item = item[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> row &lt; len(board)<span class="number">-1</span>:</span><br><span class="line">            <span class="comment"># print(row, col)</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row+<span class="number">1</span>][col]:</span><br><span class="line">                tmp = visited[row+<span class="number">1</span>][col]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row+1, col, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row+<span class="number">1</span>, col, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row+<span class="number">1</span>][col] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> row &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row<span class="number">-1</span>][col]:</span><br><span class="line">                tmp = visited[row<span class="number">-1</span>][col]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row-1, col, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row<span class="number">-1</span>, col, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row<span class="number">-1</span>][col] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> col &lt; len(board[<span class="number">0</span>])<span class="number">-1</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row][col+<span class="number">1</span>]:</span><br><span class="line">                tmp = visited[row][col+<span class="number">1</span>]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row, col+1, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row, col+<span class="number">1</span>, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row][col+<span class="number">1</span>] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> col &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row][col<span class="number">-1</span>]:</span><br><span class="line">                tmp = visited[row][col<span class="number">-1</span>]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row, col-1, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row, col<span class="number">-1</span>, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row][col<span class="number">-1</span>] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>





<h3 id="138"><a href="#138" class="headerlink" title="138"></a><a name="138">138</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string"># Definition for a Node.</span></span><br><span class="line"><span class="string">class Node:</span></span><br><span class="line"><span class="string">    def __init__(self, x: int, next: 'Node' = None, random: 'Node' = None):</span></span><br><span class="line"><span class="string">        self.val = int(x)</span></span><br><span class="line"><span class="string">        self.next = next</span></span><br><span class="line"><span class="string">        self.random = random</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">copyRandomList</span><span class="params">(self, head: <span class="string">'Node'</span>)</span> -&gt; 'Node':</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span> head</span><br><span class="line">        visited = dict()</span><br><span class="line">        <span class="keyword">return</span> self.helper2(head, visited)</span><br><span class="line">        </span><br><span class="line">    <span class="string">''' Build from Bottom Up '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper2</span><span class="params">(self, root, visited)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> root <span class="keyword">in</span> visited:</span><br><span class="line">            <span class="keyword">return</span> visited[root]</span><br><span class="line">        </span><br><span class="line">        copy = Node(root.val)</span><br><span class="line">        visited[root] = copy            <span class="comment"># This Line EARLIER than recursive call is CRUCIAL </span></span><br><span class="line">        N_ptr = self.helper2(root.next, visited)</span><br><span class="line">        R_ptr = self.helper2(root.random, visited)</span><br><span class="line">        </span><br><span class="line">        copy.next = N_ptr</span><br><span class="line">        copy.random = R_ptr</span><br><span class="line">        <span class="comment"># visited[root] = copy</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> copy</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="comment">#     def helper(self, root, visited):</span></span><br><span class="line"><span class="comment">#         if not root:</span></span><br><span class="line"><span class="comment">#             return None</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#         # for 1st node</span></span><br><span class="line"><span class="comment">#         # if root not in visited:</span></span><br><span class="line"><span class="comment">#         copy = Node(root.val)</span></span><br><span class="line"><span class="comment">#         visited[root] = copy</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#         # if root.next:</span></span><br><span class="line"><span class="comment">#         copy_next = Node(root.next.val)</span></span><br><span class="line"><span class="comment">#         node.next = copy_next</span></span><br><span class="line"><span class="comment">#         visited[root.next] = copy_next</span></span><br><span class="line"><span class="comment">#         # if root.random:</span></span><br><span class="line"><span class="comment">#         copy_random = Node(root.random.val)</span></span><br><span class="line"><span class="comment">#         node.random = copy_random</span></span><br><span class="line"><span class="comment">#         visited[root.random] = copy_random</span></span><br><span class="line">          </span><br><span class="line">            </span><br><span class="line"><span class="comment">#         N_ptr = self.helper(root.next)#, visited)</span></span><br><span class="line"><span class="comment">#         R_ptr = self.helper(root.random)#, visited)</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">copyRandomList_copy</span><span class="params">(self, head: <span class="string">'Node'</span>)</span> -&gt; 'Node':</span></span><br><span class="line">        queue = []</span><br><span class="line">        copy = &#123;&#125;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        queue.append(head)</span><br><span class="line">        copy[head] = Node(head.val,<span class="literal">None</span>,<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">while</span> queue:</span><br><span class="line">            cur = queue.pop(<span class="number">0</span>)</span><br><span class="line">            n,r = cur.next,cur.random</span><br><span class="line">            <span class="keyword">if</span> n:</span><br><span class="line">                <span class="keyword">if</span> n <span class="keyword">not</span> <span class="keyword">in</span> copy:</span><br><span class="line">                    copy[n] = Node(n.val,<span class="literal">None</span>,<span class="literal">None</span>)</span><br><span class="line">                queue.append(n)</span><br><span class="line">                copy[cur].next = copy[n]</span><br><span class="line">            <span class="keyword">if</span> r:</span><br><span class="line">                <span class="keyword">if</span> r <span class="keyword">not</span> <span class="keyword">in</span> copy:</span><br><span class="line">                    copy[r] = Node(r.val,<span class="literal">None</span>,<span class="literal">None</span>)</span><br><span class="line">                copy[cur].random = copy[r]</span><br><span class="line">        <span class="keyword">return</span> copy[head]</span><br></pre></td></tr></table></figure>



<h3 id="146"><a href="#146" class="headerlink" title="146"></a><a name="146">146</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LRUCache</span><span class="params">(object)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, capacity)</span>:</span></span><br><span class="line">        <span class="comment"># self.od = collections.OrderedDict()</span></span><br><span class="line">        <span class="comment"># self.hash = &#123;&#125;</span></span><br><span class="line">        <span class="comment"># self.que = deque()</span></span><br><span class="line">        self.od = OrderedDict()</span><br><span class="line">        self.capacity = capacity</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, key)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">not</span> <span class="keyword">in</span> self.od:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res = self.od[key]</span><br><span class="line">            <span class="keyword">del</span> self.od[key]</span><br><span class="line">            self.od[key] = res</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">        1 1 </span></span><br><span class="line"><span class="string">        2 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    cms 3 3  ==&gt; del 1 1    del odr_dict[next(iter(odr_dict))]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        2 2</span></span><br><span class="line"><span class="string">        3 3</span></span><br><span class="line"><span class="string">    cms 2 2  ==&gt; del d[2]</span></span><br><span class="line"><span class="string">                 self.d[2] = value</span></span><br><span class="line"><span class="string">    '''</span>    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put</span><span class="params">(self, key, value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">not</span> <span class="keyword">in</span> self.od:</span><br><span class="line">            <span class="keyword">if</span> self.capacity == len(self.od):</span><br><span class="line">                <span class="keyword">del</span> self.od[next(iter(self.od))]</span><br><span class="line">            self.od[key] = value</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">del</span> self.od[key]</span><br><span class="line">            self.od[key] = value</span><br></pre></td></tr></table></figure>



<h3 id="155"><a href="#155" class="headerlink" title="155"></a><a name="155">155</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinStack</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        initialize your data structure here.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        self.stack = []</span><br><span class="line">        self.cur_min = float(<span class="string">"inf"</span>)</span><br><span class="line">        <span class="comment"># self.min_idx = -1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push</span><span class="params">(self, x: int)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="keyword">if</span> x &lt; self.cur_min:</span><br><span class="line">            self.cur_min = x</span><br><span class="line">        self.stack += [(x, self.cur_min)]</span><br><span class="line">        <span class="comment"># self.min_idx = </span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">pop</span><span class="params">(self)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="comment"># self.stack.pop(-1)[0] if self.stack else None</span></span><br><span class="line">        v = self.stack.pop(<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">if</span> self.stack:</span><br><span class="line">            <span class="comment"># if self.stack[-1][1] &lt; self.cur_min:</span></span><br><span class="line">            self.cur_min = self.stack[<span class="number">-1</span>][<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.cur_min = float(<span class="string">"inf"</span>)    </span><br><span class="line">        <span class="keyword">return</span> v[<span class="number">0</span>]</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">top</span><span class="params">(self)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> self.stack[<span class="number">-1</span>][<span class="number">0</span>] <span class="keyword">if</span> self.stack <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getMin</span><span class="params">(self)</span> -&gt; int:</span></span><br><span class="line">        <span class="comment"># return min(self.stack)</span></span><br><span class="line">        <span class="comment"># return self.stack[-1][1] if self.stack else self.cur_min</span></span><br><span class="line">        <span class="keyword">return</span> self.cur_min</span><br></pre></td></tr></table></figure>



<h3 id="200"><a href="#200" class="headerlink" title="200"></a><a name="200">200</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">1 1 1 1 0</span></span><br><span class="line"><span class="string">1 1 0 1 0</span></span><br><span class="line"><span class="string">1 1 0 1 0</span></span><br><span class="line"><span class="string">0 0 0 0 0</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># for </span></span><br><span class="line"><span class="comment">#     for </span></span><br><span class="line"><span class="comment">#         bfs_graph</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numIslands</span><span class="params">(self, grid: List[List[str]])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> grid <span class="keyword">or</span> <span class="keyword">not</span> grid[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># arr = [[0 for j in range(len(grid[0])+1)] for i in range(len(grid)+1)]</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        arr = np.pad(grid, ((<span class="number">1</span>,<span class="number">1</span>), (<span class="number">1</span>,<span class="number">1</span>)))</span><br><span class="line">        print(arr)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># for i in range(1, len(arr)):</span></span><br><span class="line">        <span class="comment">#     for j in range(1, len(arr[0])):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(arr)<span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, len(arr[<span class="number">0</span>])<span class="number">-1</span>):</span><br><span class="line">                <span class="keyword">if</span> arr[i][j] == <span class="string">'1'</span>:</span><br><span class="line">                    self.bfs((arr[i][j], i, j), arr)</span><br><span class="line">                    count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bfs</span><span class="params">(self, item, arr)</span>:</span></span><br><span class="line">        Q = deque()</span><br><span class="line">        Q.append(item)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            val, i, j = Q.popleft()</span><br><span class="line">            <span class="keyword">if</span> val == <span class="string">'1'</span>:</span><br><span class="line">                arr[i][j] = <span class="string">'0'</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">if</span> arr[i][j<span class="number">-1</span>] == <span class="string">'1'</span>:         <span class="comment"># '0' is True...</span></span><br><span class="line">                Q.append((arr[i][j<span class="number">-1</span>], i, j<span class="number">-1</span>))</span><br><span class="line">                arr[i][j<span class="number">-1</span>] = <span class="string">'x'</span></span><br><span class="line">            <span class="keyword">if</span> arr[i<span class="number">-1</span>][j] == <span class="string">'1'</span>:</span><br><span class="line">                Q.append((arr[i<span class="number">-1</span>][j], i<span class="number">-1</span>, j))</span><br><span class="line">                arr[i<span class="number">-1</span>][j] = <span class="string">'x'</span></span><br><span class="line">            <span class="keyword">if</span> arr[i][j+<span class="number">1</span>] == <span class="string">'1'</span>:</span><br><span class="line">                Q.append((arr[i][j+<span class="number">1</span>], i, j+<span class="number">1</span>))</span><br><span class="line">                arr[i][j+<span class="number">1</span>] = <span class="string">'x'</span></span><br><span class="line">            <span class="keyword">if</span> arr[i+<span class="number">1</span>][j] == <span class="string">'1'</span>:</span><br><span class="line">                Q.append((arr[i+<span class="number">1</span>][j], i+<span class="number">1</span>, j))</span><br><span class="line">                arr[i+<span class="number">1</span>][j] = <span class="string">'x'</span></span><br></pre></td></tr></table></figure>



<h3 id="215"><a href="#215" class="headerlink" title="215"></a><a name="215">215</a></h3><p><strong>Complexity Analysis</strong></p>
<ul>
<li>Heap<ul>
<li>Time complexity : \mathcal{O}(N \log k)O(<em>N</em>log<em>k</em>).</li>
<li>Space complexity : \mathcal{O}(k)O(<em>k</em>) to store the heap elements.</li>
</ul>
</li>
<li>QuickSelect<ul>
<li>Time complexity : \mathcal{O}(N)O(<em>N</em>) in the average case, \mathcal{O}(N^2)O(<em>N</em>2) in the worst case.</li>
<li>Space complexity : \mathcal{O}(1)O(1).</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">def partition(l, r, arr)</span></span><br><span class="line"><span class="string">    3 5 2 1 5 6 4   k=2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    pvt 3 l 2 r 4</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    fn to set 3 at idx2</span></span><br><span class="line"><span class="string">    while l&lt;r:</span></span><br><span class="line"><span class="string">        while arr[i] 5 &lt; 3: wrong</span></span><br><span class="line"><span class="string">            l ++</span></span><br><span class="line"><span class="string">        l 2</span></span><br><span class="line"><span class="string">        while arr[j]  &gt; 3: till 1 idx -4 == idx 3</span></span><br><span class="line"><span class="string">            r -- </span></span><br><span class="line"><span class="string">        r 3</span></span><br><span class="line"><span class="string">        swap(arr[l], arr[r])</span></span><br><span class="line"><span class="string">      3 1 2 5 5 6 4 </span></span><br><span class="line"><span class="string">          l</span></span><br><span class="line"><span class="string">          r</span></span><br><span class="line"><span class="string">      2 1 3 5 5 6 4   </span></span><br><span class="line"><span class="string">        return l</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">2 1 3 5 5 6 4   </span></span><br><span class="line"><span class="string">1 2 3 4 5 6  2nd large means idx 4 == 6 - 2 </span></span><br><span class="line"><span class="string">K largest means K_idx = len(arr) - K small</span></span><br><span class="line"><span class="string">while l &lt; r</span></span><br><span class="line"><span class="string">    idx = partition()    </span></span><br><span class="line"><span class="string">    K_idx = len(arr) - K</span></span><br><span class="line"><span class="string">    if K_idx &lt; idx:</span></span><br><span class="line"><span class="string">        r = idx - 1</span></span><br><span class="line"><span class="string">    elif k_idx &gt; idx:</span></span><br><span class="line"><span class="string">        l = idx +1</span></span><br><span class="line"><span class="string">    else:</span></span><br><span class="line"><span class="string">        break</span></span><br><span class="line"><span class="string">return arr[K_idx]</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span><span class="params">(self, nums: List[int], k: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.helper(nums, <span class="number">0</span>, len(nums)<span class="number">-1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, nums, i, j)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= j:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        i, j = <span class="number">0</span>, len(nums)<span class="number">-1</span></span><br><span class="line">        <span class="comment"># 1 2 3 4 5 6</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># k = 2 ==&gt; idx 4.  6-2</span></span><br><span class="line">        k_idx = len(nums) - k</span><br><span class="line">        <span class="keyword">while</span> i &lt; j:</span><br><span class="line">            pvt_idx = self.partition(i, j, nums)</span><br><span class="line">            <span class="keyword">if</span> k_idx &lt; pvt_idx:</span><br><span class="line">                j = pvt_idx - <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> k_idx &gt; pvt_idx:</span><br><span class="line">                i = pvt_idx + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> nums[k_idx]</span><br><span class="line">            </span><br><span class="line">    <span class="comment"># 3 2 5 4 1 6</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">partition</span><span class="params">(self, l, r, arr)</span>:</span></span><br><span class="line">        pvt = arr[l]</span><br><span class="line">        ll = l+<span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> ll &lt; r:    </span><br><span class="line">            <span class="keyword">while</span> arr[ll] &lt; pvt <span class="keyword">and</span> ll &lt; r:</span><br><span class="line">                ll += <span class="number">1</span></span><br><span class="line">            <span class="keyword">while</span> arr[r] &gt; pvt <span class="keyword">and</span> ll &lt; r:</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">            arr[ll], arr[r] = arr[r], arr[ll]</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> ll</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## <span class="doctag">TODO:</span> k largest ==&gt; len(nums) - k + 1 small</span></span><br><span class="line"><span class="comment"># 1 2 3 4 5 6</span></span><br><span class="line"><span class="comment"># k  = 2 ==&gt; 5</span></span><br><span class="line"><span class="comment"># ks = 5 ==&gt; 6-2+1</span></span><br><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span><span class="params">(self, nums: List[int], k: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="comment"># l = nums</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        heapq.heapify(nums) <span class="comment">#O(N)</span></span><br><span class="line">        ks = len(nums) - k + <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(ks<span class="number">-1</span>):</span><br><span class="line">            heapq.heappop(nums) <span class="comment"># ks * O(lgN)</span></span><br><span class="line">        <span class="keyword">return</span> heapq.heappop(nums)</span><br></pre></td></tr></table></figure>



<h3 id="222"><a href="#222" class="headerlink" title="222"></a><a name="222">222</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">    1               i0</span></span><br><span class="line"><span class="string">   / \</span></span><br><span class="line"><span class="string">  2   3    h 1      2^i children</span></span><br><span class="line"><span class="string"> / \  /</span></span><br><span class="line"><span class="string">4  5 6     h 2</span></span><br><span class="line"><span class="string">1 count level by dfs, at each level, we should get </span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">countNodes</span><span class="params">(self, root: TreeNode)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.helper_recur(root)</span><br><span class="line">        <span class="keyword">return</span> self.helper_iter(root)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper_recur</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            count = <span class="number">0</span></span><br><span class="line">            <span class="keyword">return</span> count</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            count = <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        L = self.helper_recur(root.left)</span><br><span class="line">        R = self.helper_recur(root.right)</span><br><span class="line">        <span class="keyword">return</span> count + L + R</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper_iter</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        Q = deque()</span><br><span class="line">        Q.append(root)</span><br><span class="line">        <span class="comment"># level = 0   # expect get 2**level children</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        height = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> Q:       </span><br><span class="line">            level_Q = deque()</span><br><span class="line">            len_q = len(Q)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len_q):</span><br><span class="line">                node = Q.popleft()  <span class="comment"># 1 </span></span><br><span class="line">                <span class="keyword">if</span> node.left:</span><br><span class="line">                    level_Q.append(node.left)</span><br><span class="line">                <span class="keyword">if</span> node.right:</span><br><span class="line">                    level_Q.append(node.right)</span><br><span class="line">            height += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> len(level_Q) != <span class="number">2</span>**height:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            Q = level_Q.copy()</span><br><span class="line">        </span><br><span class="line">        ans = <span class="number">2</span>**(height)<span class="number">-1</span> + len(level_Q)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>

<ul>
<li>Time complexity : \mathcal{O}(N)O(<em>N</em>).</li>
<li>Space complexity : \mathcal{O}(d) = \mathcal{O}(\log N)O(<em>d</em>)=O(log<em>N</em>) to keep the recursion stack, where d is a tree depth.</li>
</ul>
<h3 id="242"><a href="#242" class="headerlink" title="242"></a><a name="242">242</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isAnagram</span><span class="params">(self, s: str, t: str)</span> -&gt; bool:</span></span><br><span class="line">        cs = Counter(s)</span><br><span class="line">        ct = Counter(t)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> cs == ct</span><br></pre></td></tr></table></figure>

<p><strong>Complexity analysis</strong></p>
<ul>
<li>Time complexity : O(n)<em>O</em>(<em>n</em>). Time complexity is O(n)<em>O</em>(<em>n</em>) because accessing the counter table is a constant time operation.</li>
<li>Space complexity : O(1)<em>O</em>(1). Although we do use extra space, the space complexity is O(1)<em>O</em>(1) because the table’s size stays constant no matter how large n<em>n</em> is.</li>
</ul>
<h3 id="253"><a href="#253" class="headerlink" title="253"></a><a name="253">253</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minMeetingRooms</span><span class="params">(self, intervals: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        intervals = sorted(intervals, key=<span class="keyword">lambda</span> x: x[<span class="number">0</span>])   <span class="comment"># sort according to start </span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> intervals:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="comment"># 2nd start == 1st end , no need one more room</span></span><br><span class="line">        <span class="comment"># end = [intervals[0][1]]</span></span><br><span class="line">        end = []        <span class="comment"># shouldn't or two 5 for case [[1,5],[8,9],[8,9]] after first looping</span></span><br><span class="line">        <span class="keyword">for</span> interval <span class="keyword">in</span> intervals:</span><br><span class="line">            <span class="comment"># cur_earliest_end = end[0]       # 9</span></span><br><span class="line">            <span class="keyword">if</span>  <span class="keyword">not</span> end <span class="keyword">or</span> interval[<span class="number">0</span>] &lt; end[<span class="number">0</span>]:<span class="comment">#cur_earliest_end:</span></span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                heapq.heappop(end)</span><br><span class="line">            heapq.heappush(end, interval[<span class="number">1</span>])    </span><br><span class="line">        <span class="keyword">return</span> count</span><br></pre></td></tr></table></figure>

<ul>
<li>Time Complexity: O(N\log N)<em>O</em>(<em>N</em>log<em>N</em>).<ul>
<li>There are two major portions that take up time here. One is <code>sorting</code> of the array that takes O(N\log N)<em>O</em>(<em>N</em>log<em>N</em>) considering that the array consists of N<em>N</em> elements.</li>
<li>Then we have the <code>min-heap</code>. In the worst case, all N<em>N</em> meetings will collide with each other. In any case we have N<em>N</em> add operations on the heap. In the worst case we will have N<em>N</em> extract-min operations as well. Overall complexity being (NlogN)(<em>N<strong>l</strong>o<strong>g</strong>N</em>) since extract-min operation on a heap takes O(\log N)<em>O</em>(log<em>N</em>).</li>
</ul>
</li>
<li>Space Complexity: O(N)<em>O</em>(<em>N</em>) because we construct the <code>min-heap</code> and that can contain N<em>N</em> elements in the worst case as described above in the time complexity section. Hence, the space complexity is O(N)<em>O</em>(<em>N</em>).</li>
</ul>
<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbyhxbi09fj31dy0u0qan.jpg" alt="img" style="zoom:50%;" />



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public class Solution &#123;</span><br><span class="line">    public int minMeetingRooms(Interval[] intervals) &#123;</span><br><span class="line">        int[] starts = new int[intervals.length];</span><br><span class="line">        int[] ends = new int[intervals.length];</span><br><span class="line">        <span class="keyword">for</span>(int i=<span class="number">0</span>; i&lt;intervals.length; i++) &#123;</span><br><span class="line">            starts[i] = intervals[i].start;</span><br><span class="line">            ends[i] = intervals[i].end;</span><br><span class="line">        &#125;</span><br><span class="line">        Arrays.sort(starts);</span><br><span class="line">        Arrays.sort(ends);</span><br><span class="line">        int rooms = <span class="number">0</span>;</span><br><span class="line">        int endsItr = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(int i=<span class="number">0</span>; i&lt;starts.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(starts[i]&lt;ends[endsItr])</span><br><span class="line">                rooms++;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                endsItr++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rooms;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="543"><a href="#543" class="headerlink" title="543"></a><a name="543">543</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">diameterOfBinaryTree</span><span class="params">(self, root: TreeNode)</span> -&gt; int:</span></span><br><span class="line">        self.g_max = <span class="number">0</span></span><br><span class="line">        self.helper(root)</span><br><span class="line">        <span class="keyword">return</span> self.g_max</span><br><span class="line">    <span class="comment"># return height and calculate dia at root</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        <span class="comment"># if not root:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># L_diameter = self.helper(root.left)</span></span><br><span class="line">        <span class="comment"># R_diameter = self.helper(root.right)</span></span><br><span class="line">        </span><br><span class="line">        L_height = self.height(root.left)</span><br><span class="line">        R_height = self.height(root.right)</span><br><span class="line">        <span class="comment"># diameter = L_height + R_height + 1</span></span><br><span class="line">        diameter = L_height + R_height</span><br><span class="line">        <span class="comment"># self.g_max = max(self.g_max, diameter)</span></span><br><span class="line">        </span><br><span class="line">        L = self.helper(root.left)</span><br><span class="line">        R = self.helper(root.right)</span><br><span class="line">        self.g_max = max(self.g_max, diameter, L, R)</span><br><span class="line">        <span class="comment"># return 1 + max(L_height, R_height)        </span></span><br><span class="line">        <span class="keyword">return</span> diameter</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">height</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        L = self.height(root.left)  </span><br><span class="line">        R = self.height(root.right)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> + max(L, R)</span><br></pre></td></tr></table></figure>



<h3 id="852"><a href="#852" class="headerlink" title="852"></a><a name="852">852</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">peakIndexInMountainArray</span><span class="params">(self, A: List[int])</span> -&gt; int:</span></span><br><span class="line">        l, r = <span class="number">0</span>, len(A)<span class="number">-1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            mid = l + (r-l)//<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> mid &gt; <span class="number">0</span> <span class="keyword">and</span> mid &lt; len(A)<span class="number">-1</span> <span class="keyword">and</span> A[mid<span class="number">-1</span>] &lt; A[mid] <span class="keyword">and</span> A[mid] &gt; A[mid+<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">return</span> mid</span><br><span class="line">            <span class="keyword">if</span> A[mid] &lt; A[mid+<span class="number">1</span>]:</span><br><span class="line">                l = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r = mid - <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> l</span><br></pre></td></tr></table></figure>

<h5 id="Better"><a href="#Better" class="headerlink" title="Better"></a>Better</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">peakIndexInMountainArray</span><span class="params">(self, A: List[int])</span> -&gt; int:</span></span><br><span class="line">        l, r = <span class="number">0</span>, len(A)<span class="number">-1</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            mid = l + (r-l)//<span class="number">2</span></span><br><span class="line">            <span class="comment"># if mid &gt; 0 and mid &lt; len(A)-1 and A[mid-1] &lt; A[mid] and A[mid] &gt; A[mid+1]:</span></span><br><span class="line">            <span class="comment">#     return mid</span></span><br><span class="line">            <span class="keyword">if</span> A[mid] &lt; A[mid+<span class="number">1</span>]:</span><br><span class="line">                l = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># r = mid - 1</span></span><br><span class="line">                r = mid</span><br><span class="line">        <span class="keyword">return</span> l</span><br></pre></td></tr></table></figure>



<h3 id="904"><a href="#904" class="headerlink" title="904"></a><a name="904">904</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Lonest subarray with k charaters!!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    1 2 3 2 2 1 1 1 1 1 1 </span></span><br><span class="line"><span class="string">　　j　　　　i　　　         open ( ]close</span></span><br><span class="line"><span class="string">                          </span></span><br><span class="line"><span class="string">j   i   od                                      amount</span></span><br><span class="line"><span class="string">-1  0   &#123;1:0&#125;                                   1</span></span><br><span class="line"><span class="string">-1  1   &#123;1:0, 2:1 &#125;                             2</span></span><br><span class="line"><span class="string"> 0  2   &#123;1:0  2:1  3:2&#125;  ==&gt; &#123;2:1  3:2&#125;         2</span></span><br><span class="line"><span class="string"> 0  3   &#123;2:3  3:2     &#125;                         3</span></span><br><span class="line"><span class="string"> 0  4   &#123;2:4  3:2     &#125;                         4              record g_max</span></span><br><span class="line"><span class="string"> 2  5   &#123;2:4  3:2  1:5&#125;  ==&gt; &#123;3:2  1:5&#125;         3              </span></span><br><span class="line"><span class="string">同時維護　OrderedDict 跟指針難</span></span><br><span class="line"><span class="string">                          </span></span><br><span class="line"><span class="string">j   i   od                                      amount</span></span><br><span class="line"><span class="string">-1  0   &#123;1:0&#125;                                   1</span></span><br><span class="line"><span class="string">-1  1   &#123;1:0, 2:1&#125;                              2</span></span><br><span class="line"><span class="string"> 0  2   &#123;1:0  2:1  3:2&#125;  ==&gt; same               2</span></span><br><span class="line"><span class="string"> 0  3   &#123;1:0  2:3  3:2&#125;                         3</span></span><br><span class="line"><span class="string"> 0  4   &#123;1:0  2:4  3:2&#125;                         4              record g_max</span></span><br><span class="line"><span class="string"> 2  5   &#123;1:5  2:4  3:2&#125;  ==&gt; same               3              </span></span><br><span class="line"><span class="string">X                          </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">j   i   od                                             amount</span></span><br><span class="line"><span class="string"> 0  0   &#123;1:1&#125;                                           1</span></span><br><span class="line"><span class="string"> 0  1   &#123;1:1  2:1&#125;                                      2</span></span><br><span class="line"><span class="string"> 0  2   &#123;1:1  2:1  3:1&#125;  ==&gt; 1 2 &#123;1:0  2:1  3:1&#125;          2     i-j+1</span></span><br><span class="line"><span class="string"> 1  3   &#123;1:0  2:2  3:1&#125;                                 3</span></span><br><span class="line"><span class="string"> 1  4   &#123;1:0  2:3  3:1&#125;                                 4              record g_max</span></span><br><span class="line"><span class="string"> 1  5   &#123;1:1  2:4  3:1&#125;  ==&gt; 2 5 &#123;1:1  2:3  3:1&#125;             3                               </span></span><br><span class="line"><span class="string">                         ==&gt; 3 5 &#123;1:1  2:3  3:0&#125;             3</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">totalFruit</span><span class="params">(self, tree: List[int])</span> -&gt; int:</span></span><br><span class="line">        od = OrderedDict()</span><br><span class="line">        j = <span class="number">0</span>              </span><br><span class="line">        g_max = cur_amount = <span class="number">0</span></span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(tree)):</span><br><span class="line">            val = tree[i]</span><br><span class="line">            <span class="keyword">if</span> val <span class="keyword">not</span> <span class="keyword">in</span> od:</span><br><span class="line">                od[val] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                od[val] += <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># if len(od) &gt;= 2:</span></span><br><span class="line">            <span class="keyword">while</span> len(od) &gt; <span class="number">2</span>:</span><br><span class="line">                od[tree[j]] -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> od[tree[j]] == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">del</span> od[tree[j]]</span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line">                </span><br><span class="line">            cur_amount = i - j + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> cur_amount &gt; g_max:</span><br><span class="line">                g_max = cur_amount</span><br><span class="line">                res.append([j, i])</span><br><span class="line">        <span class="comment"># print(res)</span></span><br><span class="line">        <span class="keyword">return</span> g_max</span><br></pre></td></tr></table></figure>



<h3 id="929"><a href="#929" class="headerlink" title="929"></a><a name="929">929</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numUniqueEmails</span><span class="params">(self, emails: List[str])</span> -&gt; int:</span></span><br><span class="line">        names = set()</span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> mail <span class="keyword">in</span> emails:</span><br><span class="line">            local_name, domain_name = mail.split(<span class="string">'@'</span>)</span><br><span class="line">            local_first = local_name.split(<span class="string">'+'</span>)[<span class="number">0</span>]</span><br><span class="line">            name = <span class="string">''</span>.join(local_first.split(<span class="string">'.'</span>))</span><br><span class="line">            item = (name, domain_name)</span><br><span class="line">            print(item)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> names:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">                names.add(item)</span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># def valid_mail(self, email):</span></span><br></pre></td></tr></table></figure>



<h3 id="951"><a href="#951" class="headerlink" title="951"></a><a name="951">951</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">flipEquiv</span><span class="params">(self, root1: TreeNode, root2: TreeNode)</span> -&gt; bool:</span></span><br><span class="line">        <span class="comment"># if not root1 and not root2:</span></span><br><span class="line">        <span class="comment">#     return True</span></span><br><span class="line">        <span class="comment"># if not root1 or not root2:</span></span><br><span class="line">        <span class="comment">#     return False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.helper(root1, root2)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, l, r)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l <span class="keyword">and</span> <span class="keyword">not</span> r:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l <span class="keyword">or</span> <span class="keyword">not</span> r:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> l.val != r.val:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">             </span><br><span class="line">        <span class="comment"># ll, lr = l.left, l.right</span></span><br><span class="line">        <span class="comment"># rl, rr = r.left, r.right</span></span><br><span class="line">        <span class="keyword">return</span>  self.helper(l.left, r.left) <span class="keyword">and</span> self.helper(l.right, r.right) <span class="keyword">or</span> \</span><br><span class="line">                self.helper(l.left, r.right) <span class="keyword">and</span> self.helper(l.right, r.left)</span><br></pre></td></tr></table></figure>

</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/16/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><span class="page-number current">17</span><a class="page-number" href="/page/18/">18</a><span class="space">&hellip;</span><a class="page-number" href="/page/77/">77</a><a class="extend next" rel="next" href="/page/18/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2023 By Joe Huang</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>