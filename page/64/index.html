<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="Joe Huang"><meta name="copyright" content="Joe Huang"><title>Awaken Desparado</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-180692466-1', 'auto');
ga('send', 'pageview');</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.2.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Joe Huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">399</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">26</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">70</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Awaken Desparado</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Awaken Desparado</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2019/06/09/Algo.%20Ult./seminar_4&amp;5/">Algo. Ult./seminar_4&amp;5</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-06-09</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/AlgoUlt/">AlgoUlt.</a></span><div class="content"><p>思考何時用雙指針</p>
<h1 id="Seminar-4"><a href="#Seminar-4" class="headerlink" title="Seminar 4"></a>Seminar 4</h1><h2 id="1849-Grumpy-Bookstore-Owner"><a href="#1849-Grumpy-Bookstore-Owner" class="headerlink" title="1849. Grumpy Bookstore Owner"></a>1849. Grumpy Bookstore Owner</h2><ol>
<li><p>枚舉脾氣變好的開始日期，再計算所有好脾氣的顧客</p>
</li>
<li><p>用一個滑窗來處理當前sliding window內的情況</p>
<ul>
<li><input disabled="" type="checkbox"> <p>​    A. 紀錄sliding window 內customers 的個數</p>
</li>
<li><input disabled="" type="checkbox"> <p>​    B. 紀錄sliding window 內好評customers 的個數 </p>
</li>
<li><input checked="" disabled="" type="checkbox"> <p>​    C. <strong>紀錄sliding window 內差評customers 的個數. V</strong>    </p>
</li>
</ul>
<p>​            答案怎麼打擂台？！</p>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataType</span>:</span></span><br><span class="line">    GOOD = <span class="number">0</span></span><br><span class="line">    BAD = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    @param customers: the number of customers</span></span><br><span class="line"><span class="string">    @param grumpy: the owner's temper every day</span></span><br><span class="line"><span class="string">    @param X: X days</span></span><br><span class="line"><span class="string">    @return: calc the max satisfied customers</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxSatisfied</span><span class="params">(self, customers, grumpy, X)</span>:</span></span><br><span class="line">        <span class="comment"># write your code here</span></span><br><span class="line">        <span class="comment"># 1. sliding window 紀錄區間內差評人數的個數</span></span><br><span class="line">        <span class="comment"># 2. 找所有天中原本就是好評人的個數</span></span><br><span class="line">        <span class="comment"># 3. 原本好評+區間內最好差評人數 = 答案</span></span><br><span class="line">        n = len(customers)</span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            </span><br><span class="line">        left = <span class="number">0</span></span><br><span class="line">        right = X - <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        now_sum = <span class="number">0</span> <span class="comment"># 當前區間的差評人數</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(X):</span><br><span class="line">            <span class="keyword">if</span> grumpy[i] == DataType.BAD:</span><br><span class="line">                now_sum += customers[i]</span><br><span class="line">        </span><br><span class="line">        maximum_bad_number = now_sum</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> right + <span class="number">1</span> &lt; n:</span><br><span class="line">            right += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> grumpy[right] == DataType.BAD:</span><br><span class="line">                now_sum += customers[right]</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">if</span> grumpy[left] == DataType.BAD:</span><br><span class="line">                now_sum -= customers[left]</span><br><span class="line">            </span><br><span class="line">            left += <span class="number">1</span></span><br><span class="line">            maximum_bad_number = max(maximum_bad_number, now_sum)</span><br><span class="line">            </span><br><span class="line">        satisfied_number = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">if</span> grumpy[i] == DataType.GOOD:</span><br><span class="line">                satisfied_number += customers[i]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> satisfied_number + maximum_bad_number</span><br></pre></td></tr></table></figure>





<h2 id="1850-撿蘋果"><a href="#1850-撿蘋果" class="headerlink" title="1850. 撿蘋果"></a>1850. 撿蘋果</h2><ul>
<li>目的：枚舉兩個區間</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gflt4ayfi1j30ys0gc44n.jpg" alt="image-20200609100156524"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gflt8o6v50j30zm0huwlh.jpg" alt="image-20200609100606181"></p>
<p>當已知隔板，可知左邊最大、右邊最大是多少，ref: penbox</p>
<h2 id="1375-Substring-With-At-Least-K-Distinct-CharactersFollow"><a href="#1375-Substring-With-At-Least-K-Distinct-CharactersFollow" class="headerlink" title="1375. Substring With At Least K Distinct CharactersFollow"></a>1375. Substring With At Least K Distinct CharactersFollow</h2><ul>
<li>Description</li>
<li>Leaderboard</li>
<li>Note</li>
<li>Discuss</li>
<li>Solution</li>
<li></li>
<li>My Submissions</li>
<li>Open IDE</li>
</ul>
<h3 id="雙指針的變式-–-計數型雙指針"><a href="#雙指針的變式-–-計數型雙指針" class="headerlink" title="雙指針的變式 – 計數型雙指針"></a>雙指針的變式 – 計數型雙指針</h3><h4 id="雙指針的類型："><a href="#雙指針的類型：" class="headerlink" title="雙指針的類型："></a>雙指針的類型：</h4><h5 id="同向雙指針"><a href="#同向雙指針" class="headerlink" title="同向雙指針"></a>同向雙指針</h5><ul>
<li>sliding window</li>
</ul>
<h5 id="相向雙指針"><a href="#相向雙指針" class="headerlink" title="相向雙指針"></a>相向雙指針</h5><ul>
<li>Two sum 類型問題</li>
</ul>
<h5 id="背向雙指針"><a href="#背向雙指針" class="headerlink" title="背向雙指針"></a>背向雙指針</h5><ul>
<li>最長回文子串</li>
</ul>
<h5 id="計數型雙指針"><a href="#計數型雙指針" class="headerlink" title="計數型雙指針"></a>計數型雙指針</h5><ul>
<li>通過雙指針解決計數問題</li>
<li>問法：滿足某條件的….有多少個</li>
</ul>
<h5 id="模擬型雙指針"><a href="#模擬型雙指針" class="headerlink" title="模擬型雙指針"></a>模擬型雙指針</h5><ul>
<li>通過雙</li>
</ul>
<ul>
<li>判斷是否為「好串」</li>
<li>判斷以區間為前綴是否滿足條件</li>
</ul>
<h2 id="1219-加熱器"><a href="#1219-加熱器" class="headerlink" title="1219. 加熱器"></a>1219. 加熱器</h2><ol>
<li>二分：對每個房屋的位置在加熱器數組中用二分，找到最后一个比你小的加热器一個半徑　nlogn</li>
</ol>
<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h389upjud9j20og0ik0uh.jpg" alt="image-20200609105609685" style="zoom:67%;" />



<ol start="2">
<li><p>优化一：直接雙指針貪心</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gflv0ebmj9j30vy0agdis.jpg" alt="image-20200609110723097"></p>
</li>
</ol>
<ol start="3">
<li>优化二：二分「加热器的半径」+ 双指针，有機會更好想</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gflv4llibmj30pe0b2ju2.jpg" alt="image-20200609111124815"></p>
<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h389uthm90j20ti0ugwgy.jpg" alt="image-20200609111225705" style="zoom:67%;" />

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gflv922yz9j30q60oqaiw.jpg" alt="image-20200609111539663"></p>
<h2 id="1879-twoSumVII"><a href="#1879-twoSumVII" class="headerlink" title="1879.twoSumVII"></a>1879.twoSumVII</h2><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gflvki9wvxj30le09wtb1.jpg" alt="image-20200609112642341"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gflvt4k12kj30qi0ooqb6.jpg" alt="image-20200609113454765"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gflvu9fq9vj30u40fmq9m.jpg" alt="image-20200609113602841"></p>
<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h389uxyvzjj20p403s74g.jpg" alt="image-20200609113733945" style="zoom:67%;" />





<h1 id="Seminar-5"><a href="#Seminar-5" class="headerlink" title="Seminar 5"></a>Seminar 5</h1><h2 id="677-大島的數量"><a href="#677-大島的數量" class="headerlink" title="677.大島的數量"></a>677.大島的數量</h2><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo3ph93a1j30he0buq5n.jpg" alt="image-20200611093923800"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo3zcfmkkj30u00ub165.jpg" alt="image-20200611094851670"></p>
<h2 id="598-僵屍矩陣"><a href="#598-僵屍矩陣" class="headerlink" title="598.僵屍矩陣"></a>598.僵屍矩陣</h2><ul>
<li>爛橘子感染</li>
<li>程序員的病毒</li>
<li>「感染的起點」，從僵屍開始 BFS</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo4692l8uj30r80ruwli.jpg" alt="image-20200611095527541"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo49emrm0j30t40vcamu.jpg" alt="image-20200611095832430"></p>
<h4 id="加now-day"><a href="#加now-day" class="headerlink" title="加now_day"></a>加now_day</h4><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo4idhzguj30ti0v2wpg.jpg" alt="image-20200611100705633"></p>
<h4 id="也可以内嵌算human-number"><a href="#也可以内嵌算human-number" class="headerlink" title="也可以内嵌算human number"></a>也可以内嵌算human number</h4><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo4m9fqsjj30x20qo7br.jpg" alt="image-20200611101052102"></p>
<h2 id="573-郵局的建立II"><a href="#573-郵局的建立II" class="headerlink" title="573.郵局的建立II"></a>573.郵局的建立II</h2><p>visited 非共享的，</p>
<p>每次的</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo4ttxr3rj30qk10utix.jpg" alt="image-20200611101757179"></p>
<p>但這樣會是 O(n^4)的</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo4zjyz5bj30ta0su4co.jpg" alt="image-20200611102340291"></p>
<p><strong>１１４line这样写的话，可能一个房子被经过多次</strong></p>
<p>so, better as following</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo54r3786j30ug0k0jz5.jpg" alt="image-20200611102837431"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo57o772oj30vk0qwtht.jpg" alt="image-20200611103125603"></p>
<p>倒過來！從房子找空地！</p>
<h4 id="該怎麼從房子數來BFS"><a href="#該怎麼從房子數來BFS" class="headerlink" title="該怎麼從房子數來BFS?"></a>該怎麼從房子數來BFS?</h4><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo5nhua62j30pu0l4436.jpg" alt="image-20200611104641237"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo5p6k3e0j30sm0vuaqb.jpg" alt="image-20200611104818468"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo5ttq9oqj30u00w07f1.jpg" alt="image-20200611105245274"></p>
<h2 id="616-課程安排"><a href="#616-課程安排" class="headerlink" title="616.課程安排"></a>616.課程安排</h2><ul>
<li><p>拓展較少，一般都就裸題</p>
</li>
<li><p>預處理所有課程的入度，將所有入度為０的點入隊，並逐漸出隊，並將出隊相連的節點的入度減１</p>
</li>
<li><p>若一節點入度變為０，則將其入隊</p>
</li>
<li><p>BFS 結束後，ans序列長度若與課程總數相等，則是一個拓撲序</p>
</li>
<li><p>否則不存在拓撲序</p>
</li>
</ul>
<h4 id="BAD-O-VE-or-O-n-m"><a href="#BAD-O-VE-or-O-n-m" class="headerlink" title="BAD, O(VE) or O(n*m)"></a>BAD, O(VE) or O(n*m)</h4><p>一般要求 O(V+E) or O(n+m)</p>
<p>所以</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo65sexw1j30mk0modme.jpg" alt="image-20200611110413633"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo68h2646j30fe01edg7.jpg" alt="image-20200611110653860"></p>
<h4 id="Better↓，O-V-E-or-O-n-m"><a href="#Better↓，O-V-E-or-O-n-m" class="headerlink" title="Better↓，O(V+E) or O(n+m)"></a>Better↓，O(V+E) or O(n+m)</h4><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo67rdcv6j30sm0vcn53.jpg" alt="image-20200611110609155"></p>
<h2 id="434-島個數II"><a href="#434-島個數II" class="headerlink" title="434.島個數II"></a>434.島個數II</h2><h3 id="BFS"><a href="#BFS" class="headerlink" title="BFS"></a>BFS</h3><ul>
<li>O(n^2) * len(queue)</li>
</ul>
<h3 id="並查集"><a href="#並查集" class="headerlink" title="並查集"></a>並查集</h3><ul>
<li></li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo6gomjm4j31nk0k4zsl.jpg" alt="image-20200611111435222"></p>
<h4 id=""><a href="#" class="headerlink" title=""></a><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo6mwtnb3j31nk0quan3.jpg" alt="image-20200611112039152"></h4><p>這寫法不具壓縮</p>
<h4 id="壓縮路徑"><a href="#壓縮路徑" class="headerlink" title="壓縮路徑"></a>壓縮路徑</h4><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo6nqyrutj31d20iwqbd.jpg" alt="image-20200611112128985"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo6qtvn7wj30gw0iwada.jpg" alt="image-20200611112428660"></p>
<p>「之後找就都是O(1)的操作了」，是個均攤O(1)的操作</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo6u94fakj30n20dcalx.jpg" alt="image-20200611112740580"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo6vft814j30vf0u0n8i.jpg" alt="image-20200611112850990"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo6x56v7qj30re0qa0zj.jpg" alt="image-20200611113032781"></p>
<p>把s改為is_ialand</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo6xlfmyvj30u00yu13v.jpg" alt="image-20200611113056937"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo72y8ny8j30pw0voqbt.jpg" alt="image-20200611113609070"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfo75oajyfj30u00vgn6j.jpg" alt="image-20200611113842739"></p>
<h1 id="雙指針的其它實現討論"><a href="#雙指針的其它實現討論" class="headerlink" title="雙指針的其它實現討論"></a>雙指針的其它實現討論</h1><h3 id="Grumpy-bookstore"><a href="#Grumpy-bookstore" class="headerlink" title="Grumpy bookstore"></a>Grumpy bookstore</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfpqsr818cj30x60ien3w.jpg" alt="image-20200612194355441"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfpqvauwoej30aw0323z6.jpg" alt="image-20200612194622939"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfpqzk8vfnj30uo0g6dl4.jpg" alt="image-20200612195027886"></p>
<h1 id="BFS-Discussion"><a href="#BFS-Discussion" class="headerlink" title="BFS Discussion"></a>BFS Discussion</h1><h3 id="1828-湖面逃跑-★★★"><a href="#1828-湖面逃跑-★★★" class="headerlink" title="1828.湖面逃跑 ★★★"></a>1828.湖面逃跑 ★★★</h3><p>from Akuna Capital</p>
<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfprwqg1euj30gs0gmakw.jpg" alt="image-20200612202220431" style="zoom:50%;" />

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfps0o2al5j30i407a407.jpg" alt="image-20200612202608173"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfps9p40caj30lk0ca0wk.jpg" alt="image-20200612203448516"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfpsbhalxsj30da04kab2.jpg" alt="image-20200612203632013"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfpsojt083j30gq0baq6i.jpg" alt="image-20200612204903384"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfpskkym5vj30t20duaey.jpg" alt="image-20200612204516486"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfpsla2e9oj30gu02c3z9.jpg" alt="image-20200612204556569"></p>
<h3 id="1070-Merge-Account-★★★"><a href="#1070-Merge-Account-★★★" class="headerlink" title="1070.Merge Account ★★★"></a>1070.Merge Account ★★★</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfptxvu73bj30cq0bwq6x.jpg" alt="image-20200612213238736"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfpucl36woj30dq08a416.jpg" alt="image-20200612214646335"></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/06/07/Web/2019-06-07-Requests'%20secret:%20pool_connections%20and%20pool_maxsize/">Web/2019-06-07-Requests' secret: pool_connections and pool_maxsize</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-06-07</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Web/">Web</a></span><div class="content"><p>from: <a href="https://www.cnblogs.com/pengyusong/p/5802929.html" target="_blank" rel="noopener">https://www.cnblogs.com/pengyusong/p/5802929.html</a></p>
<p>and <a href="https://laike9m.com/blog/requests-secret-pool_connections-and-pool_maxsize,89/" target="_blank" rel="noopener">https://laike9m.com/blog/requests-secret-pool_connections-and-pool_maxsize,89/</a></p>
<h1 id="Requests’-secret-pool-connections-and-pool-maxsize"><a href="#Requests’-secret-pool-connections-and-pool-maxsize" class="headerlink" title="Requests’ secret: pool_connections and pool_maxsize"></a><strong>Requests’ secret: pool_connections and pool_maxsize</strong></h1><p><a href="http://docs.python-requests.org/en/latest/" target="_blank" rel="noopener">Requests</a> 是一个python开发者众所周知的第三方库。因其简单的API和高性能，大多数人倾向于使用requests而不是urllib2作为访问http的标准库。然而很多使用requests库的人可能不知道内部原因，今天我就来解释以下俩个概念: <code>pool_connections</code> 和<code>pool_maxsize</code>.</p>
<p>从 <code>Session 开始</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">s.get(<span class="string">'https://www.google.com'</span>)</span><br></pre></td></tr></table></figure>

<p>这很简单，你可能知道requests’ <code>Session</code> 持有cookie. 但你知道 <code>Session</code> 有一个 <a href="http://docs.python-requests.org/en/latest/api/#requests.Session.mount" target="_blank" rel="noopener"><code>mount</code></a> 方法吗?</p>
<blockquote>
<p><code>mount(prefix, adapter)</code><br>Registers a connection adapter to a prefix.<br>Adapters are sorted in descending order by key length.</p>
</blockquote>
<p>不知道？很好，实际上你已经使用了这个方法当你初始化一个session对象时:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Session</span><span class="params">(SessionRedirectMixin)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        ...</span><br><span class="line">        <span class="comment"># Default connection adapters.</span></span><br><span class="line">        self.adapters = OrderedDict()</span><br><span class="line">        self.mount(<span class="string">'https://'</span>, HTTPAdapter())</span><br><span class="line">        self.mount(<span class="string">'http://'</span>, HTTPAdapter())</span><br></pre></td></tr></table></figure>

<p>现在，到了有趣的部分。如果你阅读过 Ian Cordasco’s 文章 <a href="http://www.coglib.com/~icordasc/blog/2014/12/retries-in-requests.html" target="_blank" rel="noopener">Retries in Requests</a>, 你应该知道 <code>HTTPAdapter</code> 可以提供重试功能. 但一个 <code>HTTPAdapter</code> 真实是什么? Quoted from <a href="http://docs.python-requests.org/en/latest/api/#requests.adapters.HTTPAdapter" target="_blank" rel="noopener">doc</a>:</p>
<blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">requests</span>.<span class="title">adapters</span>.<span class="title">HTTPAdapter</span><span class="params">(pool_connections=<span class="number">10</span>, pool_maxsize=<span class="number">10</span>, max_retries=<span class="number">0</span>, pool_block=False)</span></span></span><br></pre></td></tr></table></figure>

<p>The built-in HTTP Adapter for urllib3.</p>
<p>Provides a general-case interface for Requests sessions to contact HTTP and HTTPS urls by implementing the Transport Adapter interface. This class will usually be created by the Session class under the covers.</p>
<p>Parameters:</p>
<ul>
<li><code>pool_connections</code> – The number of urllib3 connection pools to cache.</li>
<li><code>pool_maxsize</code> – The maximum number of connections to save in the pool.</li>
<li><code>max_retries(int)</code> – The maximum number of retries each connection should attempt. Note, this applies only to failed DNS lookups, socket connections and connection timeouts, never to requests where data has made it to the server. By default, Requests does not retry failed connections. If you need granular control over the conditions under which we retry a request, import urllib3’s Retry class and pass that instead.</li>
<li><code>pool_block</code> – Whether the connection pool should block for connections. Usage:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; <span class="keyword">import</span> requests</span><br><span class="line">&gt;&gt; s = requests.Session()</span><br><span class="line">&gt;&gt; a = requests.adapters.HTTPAdapter(max_retries=<span class="number">3</span>)</span><br><span class="line">&gt;&gt; s.mount(<span class="string">'http://'</span>, a)</span><br></pre></td></tr></table></figure>
</blockquote>
<p>如果上面的文档使你迷惑，这里是我的解释: HTTP Adapter 所做的就是：根据不同的目标url，对每个不同的请求提供不同的配置，还记得上面的代码吗？</p>
<p>　　　　what HTTP Adapter does is simply <strong>providing different configurations for different requests according to target url</strong>. Remember the code above?</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">self.mount(<span class="string">'https://'</span>, HTTPAdapter())</span><br><span class="line">self.mount(<span class="string">'http://'</span>, HTTPAdapter())</span><br></pre></td></tr></table></figure>

<p>它创建了俩个 <code>HTTPAdapter</code> 对象使用默认的参数：<code>pool_connections=10, pool_maxsize=10, max_retries=0, pool_block=False</code>, 并且挂载到 <code>https://</code> 和 <code>http:// 相对路径</code>, 意思是第一个配置在你访问 <code>http://xxx 会使用到， 第二个会在你访问 ``https://xxx</code>. 尽管上面俩个配置是相同的，请求http和https仍然是隔离的。我们会在下面看到说明。</p>
<p>就像我说的，这篇文章的目的主要是解释 <code>pool_connections</code> and <code>pool_maxsize</code>.</p>
<p>首先，让我们看看 <code>pool_connections</code>. 昨天我在stackoverflow提出了一个问题：<a href="http://stackoverflow.com/questions/34837026/whats-the-meaning-of-pool-connections-in-requests-adapters-httpadapter" target="_blank" rel="noopener">question</a> ，因为我不确定我是否理解正确，这个问题的回答消除了我的不确定性。HTTP，众所周知，是基于TCP协议，一个HTTP连接也是一个TCP连接，它是由一个五元组唯一标识:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&lt;protocol&gt;, &lt;src addr&gt;, &lt;src port&gt;, &lt;dest addr&gt;, &lt;dest port&gt;)</span><br></pre></td></tr></table></figure>

<p>就是说，你针对 <code>www.example.com 建立了一个HTTP/TCP连接</code>, 假设服务器支持 <code>Keep-Alive</code>, 下一次你发送请求到 <code>www.example.com/a</code> or <code>www.example.com/b</code>, 你可以使用相同的连接，因为五元组没有改变. 实际上, <a href="http://docs.python-requests.org/en/latest/user/advanced/#keep-alive" target="_blank" rel="noopener">requests’ Session 自动会帮你处理</a> 并且重用连接，只要它能.</p>
<p>这个问题是，什么决定了你是否可以重用老的连接？是的，就是 <code>pool_connections</code>!</p>
<blockquote>
<p>pool_connections – The number of urllib3 connection pools to cache.</p>
</blockquote>
<p>我知道，我知道，我也不想引入很多术语, 这是最后一个，我发誓. 简单的理解它， 一个host对应的一个连接池：<strong>one connection pool corresponds to one host</strong>, 嗯，就是这个意思.</p>
<p>这是一个例子，无关的行已被忽略:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">s = requests.Session()</span><br><span class="line">s.mount(<span class="string">'https://'</span>, HTTPAdapter(pool_connections=1))</span><br><span class="line">s.get(<span class="string">'https://www.baidu.com'</span>)</span><br><span class="line">s.get(<span class="string">'https://www.zhihu.com'</span>)</span><br><span class="line">s.get(<span class="string">'https://www.baidu.com'</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">""</span><span class="string">"output</span></span><br><span class="line"><span class="string">INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): www.baidu.com</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET / HTTP/1.1<span class="string">" 200 None</span></span><br><span class="line"><span class="string">INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): www.zhihu.com</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET / HTTP/1.1<span class="string">" 200 2621</span></span><br><span class="line"><span class="string">INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): www.baidu.com</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET / HTTP/1.1<span class="string">" 200 None</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br></pre></td></tr></table></figure>

<p><code>HTTPAdapter(pool_connections=1)</code> 被映射到 <code>https://</code>, 他意思是在同一时间仅有一个连接池. 在调用 <code>s.get(&#39;https://www.baidu.com&#39;)</code>, 缓存的连接池是 <code>connectionpool(&#39;https://www.baidu.com&#39;)</code>. 现在 <code>s.get(&#39;https://www.zhihu.com&#39;)</code> 来了，这个session发现他不能使用缓存的连接，因为他不是相同的host(one connection pool corresponds to one host, remember?). 因此session不得不创建一个新的连接池. 因为 <code>pool_connections=1</code>, session不能在同一时间持有俩个连接池, 因此他丢弃了旧的连接池： <code>connectionpool(&#39;https://www.baidu.com&#39;)</code> 并且保存了新的：<code>connectionpool(&#39;https://www.zhihu.com&#39;)</code>. 下一次get同样如此Next <code>get</code> is the same. 这就是我们看见三个 <code>Starting new HTTPS connection</code> 日志行的原因</p>
<p>如果我们设置 <code>pool_connections</code> 为 2:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">s = requests.Session()</span><br><span class="line">s.mount(<span class="string">'https://'</span>, HTTPAdapter(pool_connections=2))</span><br><span class="line">s.get(<span class="string">'https://www.baidu.com'</span>)</span><br><span class="line">s.get(<span class="string">'https://www.zhihu.com'</span>)</span><br><span class="line">s.get(<span class="string">'https://www.baidu.com'</span>)</span><br><span class="line"><span class="string">""</span><span class="string">"output</span></span><br><span class="line"><span class="string">INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): www.baidu.com</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET / HTTP/1.1<span class="string">" 200 None</span></span><br><span class="line"><span class="string">INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): www.zhihu.com</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET / HTTP/1.1<span class="string">" 200 2623</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET / HTTP/1.1<span class="string">" 200 None</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br></pre></td></tr></table></figure>

<p>很好，现在我们可以创建连接俩次了并且保持连接活跃</p>
<p>最后, <code>pool_maxsize</code>.</p>
<p>首先, 仅当你在多线程环境下使用session，你才应该关心 <code>pool_maxsize</code> , 例如，从多个线程使用同一个session发出并发请求.</p>
<p>实际上，<code>pool_maxsize</code> 是一个用来初始化urllib3’s <code>HTTPConnectionPool的参数</code>, 它才是真正含义上的连接池. <code>HTTPConnectionPool</code> 是一个容器，针对于特定的host保存连接的集合, 且 <code>pool_maxsize</code> 是这个集合的最大值. 如果你运行你的代码在同一个线程，它是不可能针对多个主机创建多个连接的，因为 requests library 是阻塞的, 因此HTTP请求总是一个接着一个发送.</p>
<p>如果使用多线程就会不一样.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">def thread_get(url):</span><br><span class="line">    s.get(url)</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">s.mount(<span class="string">'https://'</span>, HTTPAdapter(pool_connections=1, pool_maxsize=2))</span><br><span class="line">t1 = Thread(target=thread_get, args=(<span class="string">'https://www.zhihu.com'</span>,))</span><br><span class="line">t2 = Thread(target=thread_get, args=(<span class="string">'https://www.zhihu.com/question/36612174'</span>,))</span><br><span class="line">t1.start();t2.start()</span><br><span class="line">t1.join();t2.join()</span><br><span class="line">t3 = Thread(target=thread_get, args=(<span class="string">'https://www.zhihu.com/question/39420364'</span>,))</span><br><span class="line">t4 = Thread(target=thread_get, args=(<span class="string">'https://www.zhihu.com/question/21362402'</span>,))</span><br><span class="line">t3.start();t4.start()</span><br><span class="line"><span class="string">""</span><span class="string">"output</span></span><br><span class="line"><span class="string">INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): www.zhihu.com</span></span><br><span class="line"><span class="string">INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (2): www.zhihu.com</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET /question/36612174 HTTP/1.1<span class="string">" 200 21906</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET / HTTP/1.1<span class="string">" 200 2606</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET /question/21362402 HTTP/1.1<span class="string">" 200 57556</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET /question/39420364 HTTP/1.1<span class="string">" 200 28739</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br></pre></td></tr></table></figure>

<p>看见了吗? 它为相同的host建立了俩个连接： <code>www.zhihu.com</code>, 就像我说的, 这个仅发生在多线程环境下. 在这个例子中，我们创建了一个连接池，使用了参数 <code>pool_maxsize=2</code>, 发现同一时间不会超过俩个连接，因此这是足够的，我们看到<code>t3</code> 和 <code>t4</code> 没有创建新的连接，他们重用了就的连接.</p>
<p>如果没有足够的大小呢?</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">s = requests.Session()</span><br><span class="line">s.mount(<span class="string">'https://'</span>, HTTPAdapter(pool_connections=1, pool_maxsize=1))</span><br><span class="line">t1 = Thread(target=thread_get, args=(<span class="string">'https://www.zhihu.com'</span>,))</span><br><span class="line">t2 = Thread(target=thread_get, args=(<span class="string">'https://www.zhihu.com/question/36612174'</span>,))</span><br><span class="line">t1.start()</span><br><span class="line">t2.start()</span><br><span class="line">t1.join();t2.join()</span><br><span class="line">t3 = Thread(target=thread_get, args=(<span class="string">'https://www.zhihu.com/question/39420364'</span>,))</span><br><span class="line">t4 = Thread(target=thread_get, args=(<span class="string">'https://www.zhihu.com/question/21362402'</span>,))</span><br><span class="line">t3.start();t4.start()</span><br><span class="line">t3.join();t4.join()</span><br><span class="line"><span class="string">""</span><span class="string">"output</span></span><br><span class="line"><span class="string">INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): www.zhihu.com</span></span><br><span class="line"><span class="string">INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (2): www.zhihu.com</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET /question/36612174 HTTP/1.1<span class="string">" 200 21906</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET / HTTP/1.1<span class="string">" 200 2606</span></span><br><span class="line"><span class="string">WARNING:requests.packages.urllib3.connectionpool:Connection pool is full, discarding connection: www.zhihu.com</span></span><br><span class="line"><span class="string">INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (3): www.zhihu.com</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET /question/39420364 HTTP/1.1<span class="string">" 200 28739</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET /question/21362402 HTTP/1.1<span class="string">" 200 57556</span></span><br><span class="line"><span class="string">WARNING:requests.packages.urllib3.connectionpool:Connection pool is full, discarding connection: www.zhihu.com</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br></pre></td></tr></table></figure>

<p>现在, <code>pool_maxsize=1</code>，会打印警告日志如下，就像下面的:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connection pool is full, discarding connection: www.zhihu.com</span><br></pre></td></tr></table></figure>

<p>可以注意到仅有一个连接被保存在连接池中, 为t3或者t4创建一个新的连接. 很明显这是不够的. 这就是为什么在 urllib3’s 文档中说明如下:</p>
<blockquote>
<p>如果你计划在连接池环境下使用一个连接池, 你应该设置连接池最大数量为一个比较高的值，例如和线程的数量相同.</p>
</blockquote>
<p>最后, <code>HTTPAdapter</code> 实例映射到不同的前缀是相互独立的.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">s = requests.Session()</span><br><span class="line">s.mount(<span class="string">'https://'</span>, HTTPAdapter(pool_connections=1, pool_maxsize=2))</span><br><span class="line">s.mount(<span class="string">'https://baidu.com'</span>, HTTPAdapter(pool_connections=1, pool_maxsize=1))</span><br><span class="line">t1 = Thread(target=thread_get, args=(<span class="string">'https://www.zhihu.com'</span>,))</span><br><span class="line">t2 =Thread(target=thread_get, args=(<span class="string">'https://www.zhihu.com/question/36612174'</span>,))</span><br><span class="line">t1.start();t2.start()</span><br><span class="line">t1.join();t2.join()</span><br><span class="line">t3 = Thread(target=thread_get, args=(<span class="string">'https://www.zhihu.com/question/39420364'</span>,))</span><br><span class="line">t4 = Thread(target=thread_get, args=(<span class="string">'https://www.zhihu.com/question/21362402'</span>,))</span><br><span class="line">t3.start();t4.start()</span><br><span class="line">t3.join();t4.join()</span><br><span class="line"><span class="string">""</span><span class="string">"output</span></span><br><span class="line"><span class="string">INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (1): www.zhihu.com</span></span><br><span class="line"><span class="string">INFO:requests.packages.urllib3.connectionpool:Starting new HTTPS connection (2): www.zhihu.com</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET /question/36612174 HTTP/1.1<span class="string">" 200 21906</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET / HTTP/1.1<span class="string">" 200 2623</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET /question/39420364 HTTP/1.1<span class="string">" 200 28739</span></span><br><span class="line"><span class="string">DEBUG:requests.packages.urllib3.connectionpool:"</span>GET /question/21362402 HTTP/1.1<span class="string">" 200 57669</span></span><br><span class="line"><span class="string">"</span><span class="string">""</span></span><br></pre></td></tr></table></figure>

<p>上面的代码很容易，不需要再次解释了.</p>
<p>就这样了，希望这篇文章帮助你更好的理解requests库. 顺便说一下，我创建了一个gist <a href="https://gist.github.com/laike9m/ead19c65a416c7022c00" target="_blank" rel="noopener">here</a> 这里包含这篇文章的测试代码. 随便下载并尝试吧</p>
<h2 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h2><ol>
<li><p>For https, requests uses urllib3’s <a href="http://urllib3.readthedocs.org/en/latest/pools.html#urllib3.connectionpool.HTTPSConnectionPool" target="_blank" rel="noopener">HTTPSConnectionPool</a>, but it’s pretty much the same as HTTPConnectionPool so I didn’t differeniate them in this article.</p>
</li>
<li><p><code>Session</code>‘s <code>mount</code> method ensures the longest prefix gets matched first. Its implementation is pretty interesting so I posted it here.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mount</span><span class="params">(self, prefix, adapter)</span>:</span></span><br><span class="line">    <span class="string">"""Registers a connection adapter to a prefix.</span></span><br><span class="line"><span class="string">    Adapters are sorted in descending order by key length."""</span></span><br><span class="line">    self.adapters[prefix] = adapter</span><br><span class="line">    keys_to_move = [k <span class="keyword">for</span> k <span class="keyword">in</span> self.adapters <span class="keyword">if</span> len(k) &lt; len(prefix)]</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> keys_to_move:</span><br><span class="line">        self.adapters[key] = self.adapters.pop(key)</span><br></pre></td></tr></table></figure>

<p>Note that <code>self.adapters</code> is an <code>OrderedDict</code>.</p>
</li>
</ol>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/30/Algo.%20Ult./seminar_2%20&amp;%203/">Algo. Ult./seminar_2 &amp; 3</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-30</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/AlgoUlt/">AlgoUlt.</a></span><div class="content"><h2 id="645-識別名人"><a href="#645-識別名人" class="headerlink" title="645. 識別名人"></a>645. 識別名人</h2><ul>
<li><p>其他人他都不認識的，他就是名人</p>
</li>
<li><p>最多只會有一個名人，或「不存在」，不會有兩個名人</p>
</li>
<li><p>降低兩兩比較的時間！Trick! ==&gt; </p>
</li>
<li><p>as 892 Alien Dictionary, as 1836 Reaching Point</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">The knows API is already defined for you.</span></span><br><span class="line"><span class="string">@param a, person a</span></span><br><span class="line"><span class="string">@param b, person b</span></span><br><span class="line"><span class="string">@return a boolean, whether a knows b</span></span><br><span class="line"><span class="string">you can call Celebrity.knows(a, b)</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="comment"># @param &#123;int&#125; n a party with n people</span></span><br><span class="line">    <span class="comment"># @return &#123;int&#125; the celebrity's label or -1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findCelebrity</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        <span class="comment"># return self.bf_NxN(n)</span></span><br><span class="line">        <span class="keyword">return</span> self.O_N(n)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">O_N</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        <span class="comment"># 候選人＝ 0 </span></span><br><span class="line">        <span class="comment"># for 循環遍歷其他的人 (1~n-1): i</span></span><br><span class="line">        <span class="comment">#     if i 認識候選人：</span></span><br><span class="line">        <span class="comment">#         i　不可能是名人</span></span><br><span class="line">        <span class="comment">#     if i 不認識至選人：</span></span><br><span class="line">        <span class="comment">#         候選人不可能是名人</span></span><br><span class="line">        <span class="comment">#         i　可能是名人</span></span><br><span class="line">        <span class="comment">#         ==&gt; 讓 i 成為最後的候選人</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># for 所有人判斷該候選人是否是名人</span></span><br><span class="line">        cand = <span class="number">0</span>    <span class="comment"># candidate</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">            <span class="comment"># if Celebrity.knows(i, cand):</span></span><br><span class="line">            <span class="comment">#     cand = cand</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> Celebrity.knows(i, cand):</span><br><span class="line">                cand = i</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">if</span> i == cand:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> Celebrity.knows(cand, i) <span class="keyword">or</span> <span class="keyword">not</span> Celebrity.knows(i, cand):</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        <span class="keyword">return</span> cand    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bf_NxN</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        <span class="comment"># Write your code here</span></span><br><span class="line">        <span class="comment"># for  所有人</span></span><br><span class="line">        <span class="comment">#   判斷這個人是否是名人 ==&gt; for其他所有人看是否其他人認識ｉ、ｉ是否認識其他人 </span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            is_celebrity = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">                <span class="keyword">if</span> i == j:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                    </span><br><span class="line">                <span class="keyword">if</span> Celebrity.knows(i, j) <span class="keyword">or</span> <span class="keyword">not</span> Celebrity.knows(j, i):</span><br><span class="line">                    is_celebrity = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">if</span> is_celebrity:</span><br><span class="line">                <span class="keyword">return</span> i</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br></pre></td></tr></table></figure>



<h2 id="654-稀疏矩陣乘法"><a href="#654-稀疏矩陣乘法" class="headerlink" title="654. 稀疏矩陣乘法"></a>654. 稀疏矩陣乘法</h2><ul>
<li>將兩個Matrix 相乘，</li>
</ul>
<ol>
<li><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfdpp1hf9gj30qa0c4q4t.jpg" alt="image-20200602095856594" style="zoom:50%;" />

<p>As Merge 2 sorted array, 雙指針讓兩條的值相等時再相乘</p>
<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h389txzrjaj212u0dyta5.jpg" alt="image-20200602100301997" style="zoom:67%;" />



</li>
</ol>
<p>   Further:</p>
<ul>
<li><p>現在有兩個向量，非常稀疏，其中假設非0個數為n, 如何 O(n) 時間得到這兩個向量的乘積？</p>
<ul>
<li><p>如果是用arr存的話，再怎樣也要O(N)</p>
</li>
<li><p><strong>(Index, val)</strong>; LinkedList存才行  Arraylist<Node> or LinkedList<Node></p>
<ul>
<li>Two pointer method!</li>
</ul>
</li>
</ul>
</li>
<li><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfdqlv9hfrj308g08gt9m.jpg" alt="image-20200602103032402" style="zoom:50%;" />
</li>
<li><p>　給過來的要是Node才有意義，如果是Array的話就沒意義了</p>
</li>
</ul>
<ol start="2">
<li>PUSH method</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    @param A: a sparse matrix</span></span><br><span class="line"><span class="string">    @param B: a sparse matrix</span></span><br><span class="line"><span class="string">    @return: the result of A * B</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">multiply</span><span class="params">(self, A, B)</span>:</span></span><br><span class="line">        <span class="comment"># write your code here</span></span><br><span class="line">        <span class="comment"># return self.BF(A, B)</span></span><br><span class="line">        <span class="keyword">return</span> self.two_pointers(A, B)  <span class="comment"># optimization 1</span></span><br><span class="line">        <span class="keyword">return</span> self.push_model(A, B)    <span class="comment"># optimization 2</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment"># PUSH model: 通過原料加到結果裡面</span></span><br><span class="line">    <span class="comment"># 不是對於每個C裡的每個值拿A、B裡的每一個東西，而是看A裡面的每個值會對C裡的</span></span><br><span class="line">    <span class="comment"># 哪些值產生影響</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">push_model</span><span class="params">(self, A, B)</span>:</span></span><br><span class="line">        n = len(A)</span><br><span class="line">        m = len(A[<span class="number">0</span>])</span><br><span class="line">        k = len(B[<span class="number">0</span>])</span><br><span class="line">        </span><br><span class="line">        C = [[<span class="number">0</span>] * k <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 如果A中非0元素為常數級別 ==&gt; O(N^2)</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(m):</span><br><span class="line">                <span class="string">""" 以下兩行為PUSH model的優化 """</span></span><br><span class="line">                <span class="keyword">if</span> A[i][j] == <span class="number">0</span>:    <span class="comment"># 但B裡面還是沒有優化到</span></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">for</span> t <span class="keyword">in</span> range(k):</span><br><span class="line">                    C[i][t] += A[i][j] * B[j][t]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> C        </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">two_pointers_new</span><span class="params">(self, A, B)</span>:</span></span><br><span class="line">        n = len(A)</span><br><span class="line">        m = len(A[<span class="number">0</span>])</span><br><span class="line">        k = len(B[<span class="number">0</span>])</span><br><span class="line">        </span><br><span class="line">        row_vec = []</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">two_pointers</span><span class="params">(self, A, B)</span>:</span></span><br><span class="line">        n = len(A)</span><br><span class="line">        m = len(A[<span class="number">0</span>])</span><br><span class="line">        k = len(B[<span class="number">0</span>])</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 假設 n, m, k 是相同數量級</span></span><br><span class="line">        <span class="comment"># O(n^2)</span></span><br><span class="line">        row_vector = [</span><br><span class="line">            [</span><br><span class="line">                (j, A[i][j])</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> range(m)</span><br><span class="line">                <span class="keyword">if</span> A[i][j] != <span class="number">0</span></span><br><span class="line">            ]    </span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(n)</span><br><span class="line">        ]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># O(n^2)</span></span><br><span class="line">        col_vector = [</span><br><span class="line">            [</span><br><span class="line">                (i, B[i][j])</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> range(m)</span><br><span class="line">                <span class="keyword">if</span> B[i][j] != <span class="number">0</span></span><br><span class="line">            ]    </span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(k)</span><br><span class="line">        ]</span><br><span class="line">        <span class="comment"># Java C++ 只能Hashmap套ArrayList</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># O(n^2 * O(self.multi()))</span></span><br><span class="line">        C = [</span><br><span class="line">                [</span><br><span class="line">                    self.multi(row, col)</span><br><span class="line">                    <span class="keyword">for</span> col <span class="keyword">in</span> col_vector</span><br><span class="line">                ]</span><br><span class="line">                <span class="keyword">for</span> row <span class="keyword">in</span> row_vector</span><br><span class="line">            ]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># C = [[0] * k for i in range(n)]</span></span><br><span class="line">        <span class="keyword">return</span> C</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># row = [(0,1), (2,3), (3,5)]</span></span><br><span class="line">        <span class="comment"># col = [(1,2), (3,5)]</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment"># O(len(row) + len(col)) ==&gt;  行向量與列向量中非0元素的個數</span></span><br><span class="line">    <span class="comment"># ==&gt; 假設非0元素個數是常數級  ==&gt;  O(1), 如 1000x1000，但只有10、20個有值</span></span><br><span class="line">    <span class="comment"># As Merge Two sorted array</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    A = [</span></span><br><span class="line"><span class="string">            [1,0,0],</span></span><br><span class="line"><span class="string">            [-1,0,3]</span></span><br><span class="line"><span class="string">        ]</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    B = [</span></span><br><span class="line"><span class="string">            [7,0,0]</span></span><br><span class="line"><span class="string">            [0,0,0]</span></span><br><span class="line"><span class="string">            [0,0,1]</span></span><br><span class="line"><span class="string">        ]</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    mapping_A:</span></span><br><span class="line"><span class="string">        0: [0]</span></span><br><span class="line"><span class="string">        1: [0,2]</span></span><br><span class="line"><span class="string">            　↑</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    mapping_B:</span></span><br><span class="line"><span class="string">        0:[0]</span></span><br><span class="line"><span class="string">        1:[]</span></span><br><span class="line"><span class="string">        2:[2]</span></span><br><span class="line"><span class="string">        　 ↑</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">multi</span><span class="params">(self, row, col)</span>:</span></span><br><span class="line">        <span class="comment"># 雙指針</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        ans = <span class="number">0</span> <span class="comment"># 向量相乘後的結果</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; len(row) <span class="keyword">and</span> j &lt; len(col):</span><br><span class="line">            index1, val1 = row[i]</span><br><span class="line">            index2, val2 = col[j]</span><br><span class="line">            <span class="keyword">if</span> index1 &lt; index2:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> index1 &gt; index2:</span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ans += val1 * val2</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">                </span><br><span class="line">    <span class="comment"># PULL model</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">BF</span><span class="params">(self, A, B)</span>:</span></span><br><span class="line">        m, n, k = len(A), len(A[<span class="number">0</span>]), len(B[<span class="number">0</span>])</span><br><span class="line">        C = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(k)] <span class="keyword">for</span> _ <span class="keyword">in</span> range(m)]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(m):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(k):</span><br><span class="line">                <span class="keyword">for</span> t <span class="keyword">in</span> range(n):</span><br><span class="line">                    C[i][j] += A[i][t] * B[t][j]</span><br><span class="line">        <span class="keyword">return</span> C</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">BF_old</span><span class="params">(self, A, B)</span>:</span></span><br><span class="line">        n = len(A)</span><br><span class="line">        m = len(A[<span class="number">0</span>])</span><br><span class="line">        k = len(B[<span class="number">0</span>])</span><br><span class="line">        </span><br><span class="line">        C = [[<span class="number">0</span>]*k <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(k):</span><br><span class="line">                <span class="comment"># C[i][j] = A[i][t] * B[t][j]</span></span><br><span class="line">                <span class="keyword">for</span> t <span class="keyword">in</span> range(m):</span><br><span class="line">                    C[i][j] += A[i][t] * B[t][j]</span><br><span class="line">        <span class="keyword">return</span> C</span><br></pre></td></tr></table></figure>



<h2 id="140-快速冪"><a href="#140-快速冪" class="headerlink" title="140. 快速冪"></a>140. 快速冪</h2><ul>
<li>求 a**n%b</li>
<li>其中 n非常大 (n &lt;= 10**9)</li>
<li>如何獲得logn的複雜度？</li>
<li>思想：a*^1000 &lt;== (a^500)^2</li>
<li>a ^ 10000000000 &lt;== a ^ 5000000000 &lt;== </li>
<li>問題規模: n -&gt; n/2 -&gt; n/4 -&gt; n/8 -&gt; n/16</li>
<li>討論平方關係：<ul>
<li>x^(n/2) * x(^n/2): O(N)，只是divide &amp; conquer，但每個還是重複算了</li>
<li>x^(n/2) ** 2: O(logN)   思想不同上面的！是真正的切半</li>
</ul>
</li>
<li>related to 949 fibII、65</li>
</ul>
<h2 id="Freq"><a href="#Freq" class="headerlink" title="Freq:"></a>Freq:</h2><p>—————– 很常見 </p>
<ol>
<li>BFS</li>
<li>模擬(interger -&gt; roman OA)、隱式圖老題 (數獨、word ladder (X)，word break Ⅱ 必須要最優化, dfs暴力指數級，dp(O(N)))、K largest … (Amazon)</li>
</ol>
<p>—————– 比較常見</p>
<ol start="3">
<li><p>DFS、二叉樹、基礎DP(背包、序列型dp、坐標型dp、雙序列型dp(LCS)、常見的問題(LIS、LPS))、二分答案、前缀和</p>
</li>
<li><p>LRU、LFU、雙指針 (Sliding Window), LInkedList (老題、快慢、環、相交點)、Copy Linked List with random pointer、掃描線、單調棧</p>
</li>
</ol>
<p>—————– 基本不怎麼出現</p>
<ol start="5">
<li>二分搜索、數據結構(heap, quick select)、比較難的DP(區間DP、概率DP、狀態壓縮DP (TSP)), Union find, sort, trie (quantcast(OA)), segment tree，紅黑樹(G)，dfs非遞歸實現 (樹的非遞歸遍歷)、矩陣快速冪</li>
<li>Floyd, dij, spfa</li>
</ol>
<p>Graph ==&gt; BFS, DFS, targan(Amazon), Union find, dij, Floyd (最小生成樹)</p>
<ul>
<li>Find Critical connection (Amazon!) V</li>
</ul>
<p>A onsite: Stone Game</p>
<p>Word Ladder 2</p>
<h1 id="Seminar-3"><a href="#Seminar-3" class="headerlink" title="Seminar 3"></a>Seminar 3</h1><ul>
<li></li>
</ul>
<h2 id="1310-數組除了自身的乘積"><a href="#1310-數組除了自身的乘積" class="headerlink" title="1310. 數組除了自身的乘積"></a>1310. 數組除了自身的乘積</h2><ol>
<li>左往右，前綴積: prefix[i] = nums[0] * … * nums[i]</li>
<li>右往左，後綴積: suffix[i] = nums[i] * … * nums[n-1</li>
<li>遍歷所有位置 outpus[i] = prefix[i-1] * suffix[i+1]</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    @param nums: an array of integers</span></span><br><span class="line"><span class="string">    @return: the product of all the elements of nums except nums[i].</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">productExceptSelf</span><span class="params">(self, nums)</span>:</span></span><br><span class="line">        <span class="comment"># write your code here</span></span><br><span class="line">        <span class="comment"># return self.O_N(nums)</span></span><br><span class="line">        <span class="keyword">return</span> self.O_1(nums)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">O_1</span><span class="params">(self, nums)</span>:</span></span><br><span class="line">        <span class="comment"># 從前往後掃，把當前的前綴積放到output中</span></span><br><span class="line">        <span class="comment"># 從後往前掃，把當前的後綴積乘上output[i]</span></span><br><span class="line">        n = len(nums)</span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">            </span><br><span class="line">        output = [<span class="number">1</span>] * n</span><br><span class="line"></span><br><span class="line">        prefix = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            output[i] = prefix</span><br><span class="line">            prefix *= nums[i]</span><br><span class="line">        </span><br><span class="line">        suffix = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            output[i] *= suffix</span><br><span class="line">            suffix *= nums[i]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">O_N</span><span class="params">(self, nums)</span>:</span></span><br><span class="line">        <span class="comment"># 1. 左往右，前綴積: prefix[i] = nums[0] * ... * nums[i]</span></span><br><span class="line">        <span class="comment"># 2. 右往左，後綴積: suffix[i] = nums[i] * ... * nums[n-1</span></span><br><span class="line">        <span class="comment"># 3. 遍歷所有位置 outpus[i] = prefix[i-1] * suffix[i+1]</span></span><br><span class="line">        n = len(nums)</span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">            </span><br><span class="line">        output = [<span class="number">0</span>] * n</span><br><span class="line">        prefix = [<span class="number">0</span>] * n</span><br><span class="line">        suffix = [<span class="number">0</span>] * n</span><br><span class="line">        </span><br><span class="line">        prefix[<span class="number">0</span>] = nums[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">            prefix[i] = prefix[i<span class="number">-1</span>] * nums[i]</span><br><span class="line">        </span><br><span class="line">        suffix[n<span class="number">-1</span>] = nums[n<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            suffix[i] = suffix[i+<span class="number">1</span>] * nums[i]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">                output[i] = suffix[i+<span class="number">1</span>]</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> i == n - <span class="number">1</span>:</span><br><span class="line">                output[i] = prefix[i<span class="number">-1</span>]</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            output[i] = prefix[i<span class="number">-1</span>] * suffix[i+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure>



<h2 id="1844-子數組和為K-II"><a href="#1844-子數組和為K-II" class="headerlink" title="1844. 子數組和為K II"></a>1844. 子數組和為K II</h2><ul>
<li>為何不能用雙指針？<ul>
<li>因為有負數的。。。太慘。。</li>
</ul>
</li>
<li>基础版：838子数组和为K</li>
<li>Follow up: 1507.和至少為K的最短長度</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfg232v0fqj30wg0eqadb.jpg" alt="image-20200604103838917"></p>
<h2 id="1507-和至少为K的最短长度"><a href="#1507-和至少为K的最短长度" class="headerlink" title="1507. 和至少为K的最短长度"></a>1507. 和至少为K的最短长度</h2><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfg2ia573fj30y80jcn3e.jpg" alt="image-20200604105311696"></p>
<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfg2oc4xwbj30im0ictc7.jpg" alt="image-20200604105910757" style="zoom:67%;" />



<h2 id="391-數飛機"><a href="#391-數飛機" class="headerlink" title="391. 數飛機"></a>391. 數飛機</h2><ul>
<li>差分前綴和</li>
<li>根據原數組獲得差分數組 ==&gt; 求前綴和</li>
<li>什麼是差分數組？</li>
</ul>
<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h389u16dguj20i20iqab9.jpg" alt="image-20200604112647832" style="zoom:67%;" />



<h2 id="194-寻找单词"><a href="#194-寻找单词" class="headerlink" title="194. 寻找单词"></a>194. 寻找单词</h2><ol>
<li>BF 雙指針</li>
</ol>
<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h389ua1evpj208y036q2v.jpg" alt="image-20200604113217218" style="zoom:67%;" />

<ol start="2">
<li><p>大暴力 2^N 空間</p>
</li>
<li><p>hashmap 存所有字母出現的位置</p>
<ul>
<li>o:[2,4,9,15]</li>
<li>index = 5</li>
<li>去找下一個o<ul>
<li>二分</li>
</ul>
</li>
<li>aaaaaaaaaaa<ul>
<li>a: [1,2,3,4,5,6,7,8,9,10]</li>
<li>index = 4</li>
</ul>
</li>
<li>O(m x logN x k)</li>
</ul>
</li>
<li><p>當前字符串的後一個任意字符的位置 ★待學習　</p>
</li>
</ol>
<h4 id="Sol"><a href="#Sol" class="headerlink" title="Sol"></a>Sol</h4><h5 id="O-N-2-的預處理，太慢"><a href="#O-N-2-的預處理，太慢" class="headerlink" title="O(N^2) 的預處理，太慢"></a>O(N^2) 的預處理，太慢</h5><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfppb5ahcjj30ry0dcaf6.jpg" alt="image-20200612185220046"></p>
<h5 id="O-N-預處理-by-後往前遞推！"><a href="#O-N-預處理-by-後往前遞推！" class="headerlink" title="O(N) 預處理 by 後往前遞推！"></a>O(N) 預處理 by 後往前遞推！</h5><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfpq0quxeuj30ia0kc7be.jpg" alt="image-20200612191700269"></p>
<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfppn80qp6j308c03wgmj.jpg" alt="image-20200612190400078" style="zoom: 67%;" />

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfppol54aej30c600m74i.jpg" alt="image-20200612190519367"></p>
<h2 id="946-233-Matrix"><a href="#946-233-Matrix" class="headerlink" title="946. 233 Matrix"></a>946. 233 Matrix</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">MOD = <span class="number">10000007</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Matrix</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, n, m)</span>:</span></span><br><span class="line">        self.mat = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(m)] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        self.n = n</span><br><span class="line">        self.m = m</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># A * B ==&gt; A.__mul__(B)    n*m (x) m*k</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__mul__</span><span class="params">(self, matrix)</span>:</span></span><br><span class="line">        k = len(matrix.mat[<span class="number">0</span>])</span><br><span class="line">        tmp = Matrix(self.n, k) <span class="comment"># <span class="doctag">TODO:</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    @param X: a list of integers</span></span><br><span class="line"><span class="string">    @param m: an integer</span></span><br><span class="line"><span class="string">    @return: return an integer</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">calcTheValueOfAnm</span><span class="params">(self, X, m)</span>:</span></span><br><span class="line">        <span class="comment"># write your code here</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> X <span class="keyword">and</span> m == <span class="number">0</span>:    <span class="comment"># 特判</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="comment"># return self.O_NxM_MLE(X, m)</span></span><br><span class="line">        <span class="comment"># return self.O_N_TLE(X, m)</span></span><br><span class="line">        <span class="comment"># return self.O_lgN(X, m)   # TODO ... not OK now</span></span><br><span class="line">        <span class="keyword">return</span> self.sol(X, m)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sol</span><span class="params">(self, X, m)</span>:</span></span><br><span class="line">        <span class="comment"># write your code here</span></span><br><span class="line">        n = len(X)</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">0</span> <span class="keyword">and</span> m == <span class="number">0</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span>(m == <span class="number">0</span>):</span><br><span class="line">            <span class="keyword">return</span> X[n - <span class="number">1</span>]</span><br><span class="line">        self.n, self.mod = n + <span class="number">2</span>, <span class="number">10000007</span></span><br><span class="line">        A = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(n + <span class="number">2</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> range(n + <span class="number">2</span>)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n + <span class="number">1</span>):</span><br><span class="line">            A[i][<span class="number">0</span>] = <span class="number">10</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n + <span class="number">2</span>):</span><br><span class="line">            A[i][n + <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, i + <span class="number">1</span>):</span><br><span class="line">                A[i][j] = <span class="number">1</span></span><br><span class="line">        tmp = self.power(A, m);</span><br><span class="line">        ans = tmp[n][<span class="number">0</span>] * <span class="number">23</span> + tmp[n][n + <span class="number">1</span>] * <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">            ans += tmp[n][i] * X[i - <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> ans % <span class="number">10000007</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mul</span><span class="params">(self, A, B)</span>:</span></span><br><span class="line">        tmp = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(self.n)] <span class="keyword">for</span> i <span class="keyword">in</span> range(self.n)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.n):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(self.n):</span><br><span class="line">                <span class="keyword">if</span> (A[i][k] == <span class="number">0</span>):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> range(self.n):</span><br><span class="line">                    tmp[i][j] = (tmp[i][j] + A[i][k] * B[k][j]) % self.mod</span><br><span class="line">        <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">power</span><span class="params">(self, A, a)</span>:</span></span><br><span class="line">        B = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(self.n)] <span class="keyword">for</span> i <span class="keyword">in</span> range(self.n)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.n):</span><br><span class="line">            B[i][i] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> a &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> (a % <span class="number">2</span> == <span class="number">1</span>):</span><br><span class="line">                B = self.mul(B, A)</span><br><span class="line">            A = self.mul(A, A)</span><br><span class="line">            a //= <span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> B</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">O_lgN_tmpl</span><span class="params">(self, X, m)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span>    <span class="comment"># <span class="doctag">TODO:</span></span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    23      10*A[0][0]+3        10*A[0][1]+3        10*A[0][2]+3</span></span><br><span class="line"><span class="string">    a1      a1+↑</span></span><br><span class="line"><span class="string">    a2      a2+↑</span></span><br><span class="line"><span class="string">    a3      a3+↑</span></span><br><span class="line"><span class="string">    a4      a4+↑</span></span><br><span class="line"><span class="string">    """</span>    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">O_lgN</span><span class="params">(self, X, m)</span>:</span>  <span class="comment"># FastPow, Buggy... for m, n and DIM</span></span><br><span class="line">        n = len(X)</span><br><span class="line">        col = [<span class="number">0</span>] * (n+<span class="number">2</span>)</span><br><span class="line">        col[<span class="number">0</span>] = <span class="number">23</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n+<span class="number">2</span><span class="number">-1</span>): <span class="comment">#  23</span></span><br><span class="line">            <span class="comment"># print(col)</span></span><br><span class="line">            col[i] = X[i<span class="number">-1</span>]       <span class="comment">#  a1</span></span><br><span class="line">                                  <span class="comment">#  a2</span></span><br><span class="line">                                  <span class="comment">#  a3</span></span><br><span class="line">                                  <span class="comment">#  3</span></span><br><span class="line">        col[<span class="number">-1</span>] = <span class="number">3</span></span><br><span class="line">        print(<span class="string">"col: &#123;&#125;"</span>.format(col))</span><br><span class="line">        <span class="comment"># T : (n+2) x (m+2)</span></span><br><span class="line">        <span class="string">"""""</span></span><br><span class="line"><span class="string">        doc WRONG!!! ↓  n should be equal to len(vec)</span></span><br><span class="line"><span class="string">        [   </span></span><br><span class="line"><span class="string">            [10, 0, 0, 0, 1],</span></span><br><span class="line"><span class="string">            [10, 1, 0, 0, 1],</span></span><br><span class="line"><span class="string">            [10, 1, 1, 0, 1],</span></span><br><span class="line"><span class="string">        ]</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">            CORRECT　↓  for [0,0,3], 2</span></span><br><span class="line"><span class="string">        [   </span></span><br><span class="line"><span class="string">            [10, 0, 0, 0, 1],</span></span><br><span class="line"><span class="string">            [10, 1, 0, 0, 1],</span></span><br><span class="line"><span class="string">            [10, 1, 1, 0, 1],</span></span><br><span class="line"><span class="string">            [10, 1, 1, 1, 1],</span></span><br><span class="line"><span class="string">            [10, 1, 1, 1, 1],            </span></span><br><span class="line"><span class="string">        ]            </span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="comment"># T = [[0] * (m+2) for _ in range(n+2)]   # WRONG!!!</span></span><br><span class="line">        T = [[<span class="number">0</span>] * (n+<span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> range(n+<span class="number">2</span>)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n+<span class="number">2</span>):</span><br><span class="line">            T[i][<span class="number">0</span>] = <span class="number">10</span></span><br><span class="line">            T[i][<span class="number">-1</span>] = <span class="number">1</span></span><br><span class="line">        <span class="comment"># print("T: \n&#123;&#125;".format(T))</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n+<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, n+<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">if</span> i &gt;= j:</span><br><span class="line">                    T[i][j] = <span class="number">1</span></span><br><span class="line">        print(<span class="string">"T OK: \n&#123;&#125;"</span>.format(T))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(m):</span><br><span class="line">            col = self.transform(T, col)</span><br><span class="line">            col[<span class="number">-1</span>] = <span class="number">3</span></span><br><span class="line">            print(col)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> col[<span class="number">-2</span>]</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">transform</span><span class="params">(self, A, vec)</span>:</span>    <span class="comment"># diff frome general __mul__ 'cause of DIM issue, so better use class template...</span></span><br><span class="line">        n, m = len(A), len(A[<span class="number">0</span>])</span><br><span class="line">        print(n, m, len(vec))</span><br><span class="line">        k = <span class="number">1</span></span><br><span class="line">        C = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(n+<span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(m):</span><br><span class="line">                C[i] += A[i][j] * vec[j]</span><br><span class="line">        <span class="keyword">return</span> C</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># def mul(self, A, B):</span></span><br><span class="line">    <span class="comment">#     n, m, k = len(A), len(A[0]), len(B[0])</span></span><br><span class="line">    <span class="comment">#     print(n, m, len(B), k)</span></span><br><span class="line">    <span class="comment">#     C = [[0 for _ in range(k)] for _ in range(n)]</span></span><br><span class="line">    <span class="comment">#     for i in range(n):</span></span><br><span class="line">    <span class="comment">#         for t in range(k):</span></span><br><span class="line">    <span class="comment">#             for j in range(m):</span></span><br><span class="line">    <span class="comment">#                 C[i][t] = A[i][j] * B[j][t]</span></span><br><span class="line">    <span class="comment">#     return C</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">O_N_TLE</span><span class="params">(self, X, m)</span>:</span></span><br><span class="line">        n = len(X)</span><br><span class="line">        <span class="comment"># T = [[0] * (m+1) for _ in range(n+1)]</span></span><br><span class="line">        col = [<span class="number">0</span>] * (n+<span class="number">1</span>)</span><br><span class="line">        col[<span class="number">0</span>] = <span class="number">23</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># for j in range(1, m+1):</span></span><br><span class="line">        <span class="comment">#     T[0][j] = 10*T[0][j-1] +  3</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">            col[i] = X[i<span class="number">-1</span>]</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, m+<span class="number">1</span>):</span><br><span class="line">            <span class="comment"># print(T)</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n+<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">                    col[i] = <span class="number">10</span> * col[i] + <span class="number">3</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    col[i] = col[i] + col[i<span class="number">-1</span>]</span><br><span class="line">            </span><br><span class="line">        <span class="comment"># print(T)</span></span><br><span class="line">        <span class="keyword">return</span> col[n] % MOD</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">O_NxM_MLE</span><span class="params">(self, X, m)</span>:</span></span><br><span class="line">        n = len(X)</span><br><span class="line">        T = [[<span class="number">0</span>] * (m+<span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> range(n+<span class="number">1</span>)]</span><br><span class="line">        T[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">23</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, m+<span class="number">1</span>):</span><br><span class="line">            T[<span class="number">0</span>][j] = <span class="number">10</span>*T[<span class="number">0</span>][j<span class="number">-1</span>] +  <span class="number">3</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">            T[i][<span class="number">0</span>] = X[i<span class="number">-1</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># print(T)</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, m+<span class="number">1</span>):</span><br><span class="line">                T[i][j] = T[i<span class="number">-1</span>][j] + T[j][i<span class="number">-1</span>]</span><br><span class="line">        <span class="comment"># print(T)</span></span><br><span class="line">        <span class="keyword">return</span> T[n][m] % MOD</span><br></pre></td></tr></table></figure>



<h2 id="前綴和的定義和實現"><a href="#前綴和的定義和實現" class="headerlink" title="前綴和的定義和實現"></a>前綴和的定義和實現</h2><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfnnqe58rzj30qg0cg77y.jpg" alt="image-20200611002631135"></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h389u5ddsrj20l00dymy4.jpg" alt="image-20200611002923263"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfnnwnq0x7j30ue0eg79y.jpg" alt="image-20200611003241851"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfnny2cwesj30ts0cmzmq.jpg" alt="image-20200611003404254"></p>
<h4 id="2D"><a href="#2D" class="headerlink" title="2D"></a>2D</h4><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfpably4w2j30ue0em44a.jpg" alt="image-20200612101348111"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfpaj7hx6oj30tu0emqde.jpg" alt="image-20200612102108325"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfpajm0uz8j30tu0dw0xw.jpg" alt="image-20200612102132182"></p>
<h4 id="動規V-S-前綴和"><a href="#動規V-S-前綴和" class="headerlink" title="動規V.S.前綴和"></a>動規V.S.前綴和</h4><ul>
<li><p>前綴和是一種特殊的動規</p>
</li>
<li><p>e.g.</p>
<ul>
<li><p>打劫房屋</p>
</li>
<li><p>不同路徑2D DP, 也是一種前綴和、DP、</p>
</li>
<li><p>爬樓梯</p>
<ul>
<li>dp = dp[i-1] + dp[i-2]</li>
</ul>
</li>
<li><p>股票</p>
<ul>
<li><p>DP思維: dp[i] profit</p>
<ul>
<li>dp[i] = max(dp[i-1], a[i] - min_cost)</li>
</ul>
</li>
<li><p>前綴思想：</p>
<ul>
<li><p>前綴最小值</p>
<p>Min_price, max_profit</p>
</li>
</ul>
</li>
<li><p>思維路徑：</p>
<ul>
<li>先想簡單的方法試起<ol>
<li>前綴<ol>
<li>前綴最小、最大</li>
<li>前綴和</li>
</ol>
</li>
<li>雙指針</li>
</ol>
</li>
<li>再想進階的辦法<ol>
<li>動規</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
<li><p>簡單法做起</p>
</li>
</ul>
</li>
</ul>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/23/Algo.%20Ult./seminar_1/">Algo. Ult./seminar_1</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-23</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/AlgoUlt/">AlgoUlt.</a></span><div class="content"><h2 id="暴力-1835-1827-停在原地的方案數"><a href="#暴力-1835-1827-停在原地的方案數" class="headerlink" title="暴力: 1835, 1827 停在原地的方案數"></a>暴力: 1835, 1827 停在原地的方案數</h2><h2 id="1835-停在原地的方案數-I"><a href="#1835-停在原地的方案數-I" class="headerlink" title="1835 停在原地的方案數 I"></a>1835 停在原地的方案數 I</h2><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gf5m5otwomj31ee0sekgd.jpg" alt="image-20200526095155742"></p>
<p>![image-20200526095237745](<a href="https://tva1.sinaimg.cn/large/007S8ZIlgy1gf5m6bmw5ij31em0sgh7a.jpg" target="_blank" rel="noopener">https://tva1.sinaimg.cn/large/007S8ZIlgy1gf5m6bmw5ij31em0sgh7a.jpg</a></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gf5m6p6z2kj31eg0nekao.jpg" alt="image-20200526095300143"></p>
<ul>
<li><p>DFS: 指數級, O(3^steps)</p>
</li>
<li><p>DP: O(position*step); O(step^2), </p>
<ul>
<li><pre><code>dp[pos][steps]
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#96;&#96;&#96;python</span><br><span class="line">        # write your code here</span><br><span class="line">        return self.dp_MLE(steps, arrLen)</span><br><span class="line">        return self.dp(steps, arrLen)</span><br><span class="line">    # def dfs(self, steps, arrLen):</span><br><span class="line">    </span><br><span class="line">    def dp_MLE(self, steps, arrLen):</span><br><span class="line">        n &#x3D; arrLen</span><br><span class="line">        dp &#x3D; [[0 for _ in range(n)] for _ in range(steps+1)]</span><br><span class="line">        dp[0][0] &#x3D; 1</span><br><span class="line">        M &#x3D; 10**9 + 7</span><br><span class="line">        </span><br><span class="line">        # for k in range(1, steps&#x2F;&#x2F;2+1):</span><br><span class="line">        #     for i in range(n):</span><br><span class="line">        for k in range(1, steps+1):</span><br><span class="line">            for i in range(0, n):</span><br><span class="line">                if i &#x3D;&#x3D; 0:</span><br><span class="line">                    dp[k][i] &#x3D; dp[k-1][i] + dp[k-1][i+1]</span><br><span class="line">                elif i &#x3D;&#x3D; n-1:</span><br><span class="line">                    dp[k][i] &#x3D; dp[k-1][i-1] + dp[k-1][i]</span><br><span class="line">                else:</span><br><span class="line">                    dp[k][i] &#x3D; dp[k-1][i-1] + dp[k-1][i] + dp[k-1][i+1]</span><br><span class="line">        </span><br><span class="line">            dp[k][i] %&#x3D; M</span><br><span class="line">        return dp[steps][0]        </span><br><span class="line">        </span><br><span class="line">    def dp(self, steps, arrLen):</span><br><span class="line">        # VIDEO:</span><br><span class="line">        #     https:&#x2F;&#x2F;youtu.be&#x2F;WiYfBPmhRDk?t&#x3D;895</span><br><span class="line">        </span><br><span class="line">        # dp[i][j] means @ i-th round, at j-th pos</span><br><span class="line">        # max steps &#x3D;&#x3D; 500, means</span><br><span class="line">        # dp[250][250] &#x3D; 1</span><br><span class="line">        # dp[251][249] &#x3D; dp[250][248, 249, 250]</span><br><span class="line">        # dp[252][248] &#x3D; dp[251][247, 248, 259]</span><br><span class="line">        </span><br><span class="line">        n &#x3D; arrLen</span><br><span class="line">        </span><br><span class="line">        dp &#x3D; [[0 for _ in range(steps&#x2F;&#x2F;2 + 2)] for _ in range(steps+1)]</span><br><span class="line">        dp[0][0] &#x3D; 1</span><br><span class="line">        M &#x3D; 10**9 + 7</span><br><span class="line">        </span><br><span class="line">        # for k in range(1, steps&#x2F;&#x2F;2+1):</span><br><span class="line">        #     for i in range(n):</span><br><span class="line">        for k in range(1, steps+1):</span><br><span class="line">            for i in range(0, steps&#x2F;&#x2F;2+1):</span><br><span class="line">                if i &#x3D;&#x3D; 0:</span><br><span class="line">                    dp[k][i] &#x3D; dp[k-1][i] + dp[k-1][i+1]</span><br><span class="line">                elif i &#x3D;&#x3D; n-1:</span><br><span class="line">                    dp[k][i] &#x3D; dp[k-1][i-1] + dp[k-1][i]</span><br><span class="line">                else:</span><br><span class="line">                    dp[k][i] &#x3D; dp[k-1][i-1] + dp[k-1][i] + dp[k-1][i+1]</span><br><span class="line">        </span><br><span class="line">            dp[k][i] %&#x3D; M</span><br><span class="line">        return dp[steps][0]</span><br></pre></td></tr></table></figure>


</code></pre></li>
</ul>
</li>
</ul>
<h2 id="156-合併區間"><a href="#156-合併區間" class="headerlink" title="156 合併區間"></a>156 合併區間</h2><p>只是個引子?! </p>
<ul>
<li>排序、priority queue、掃描線 skyline</li>
<li>一般start排序，只有会议室是用end排序</li>
</ul>
<h2 id="1879-兩數之和"><a href="#1879-兩數之和" class="headerlink" title="1879 兩數之和"></a>1879 兩數之和</h2><h2 id="1563-目的地的最短路徑"><a href="#1563-目的地的最短路徑" class="headerlink" title="1563 目的地的最短路徑"></a>1563 目的地的最短路徑</h2><ul>
<li>BFS: <ol>
<li>最短路徑</li>
<li>分層遍歷</li>
<li>拓樸排序 (有前置要求的遍歷)</li>
</ol>
</li>
</ul>
<ul>
<li>BFS or DFS ?!<ul>
<li>DFS: 遞歸、棧、可能 stack overflow</li>
<li>BFS: Queue</li>
</ul>
</li>
</ul>
<ul>
<li>DFS:<ol>
<li>所有方案</li>
</ol>
</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gf5nq3o73mj31gs0t67g0.jpg" alt="image-20200526104615664"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gf5ntvcuuoj31gw0r6n7l.jpg" alt="image-20200526104952612"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MapType</span>:</span></span><br><span class="line">    ROAD = <span class="number">0</span></span><br><span class="line">    WALL = <span class="number">1</span></span><br><span class="line">    DESTINATION = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">DIRECTIONS = [[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">-1</span>], [<span class="number">1</span>, <span class="number">0</span>], [<span class="number">-1</span>, <span class="number">0</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># (x, y) ==&gt; x*i + y In Other languages</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    @param targetMap: </span></span><br><span class="line"><span class="string">    @return: nothing</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">shortestPath</span><span class="params">(self, targetMap)</span>:</span></span><br><span class="line">        <span class="comment"># Write your code here</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> targetMap: <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        </span><br><span class="line">        Q = deque()</span><br><span class="line">        visited = set()</span><br><span class="line">        Q.append((<span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        visited.add((<span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        step = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(Q)):</span><br><span class="line">                x, y = Q.popleft()</span><br><span class="line">                <span class="comment"># visited.add(next_x, next_y) # ?! V.S. Line39</span></span><br><span class="line">                <span class="comment"># [0,0]</span></span><br><span class="line">                <span class="comment"># [0,1], [1,0]</span></span><br><span class="line">                <span class="comment"># [0,2], [1,1], [2,0], [1,1]，[1,1]會被重覆放，就不是一個 O(N)了，所以必須放在下面</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> targetMap[x][y] == MapType.DESTINATION:</span><br><span class="line">                    <span class="keyword">return</span> step</span><br><span class="line">                        </span><br><span class="line">                <span class="keyword">for</span> direction <span class="keyword">in</span> DIRECTIONS:</span><br><span class="line">                    next_x = x + direction[<span class="number">0</span>]</span><br><span class="line">                    next_y = y + direction[<span class="number">1</span>]</span><br><span class="line">                    <span class="keyword">if</span> self.is_valid(next_x, next_y, targetMap, visited):</span><br><span class="line">                        Q.append((next_x, next_y))</span><br><span class="line">                        visited.add((next_x, next_y))</span><br><span class="line">            </span><br><span class="line">            step += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_valid</span><span class="params">(self, x, y, targetMap, visited)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> x &lt; <span class="number">0</span> <span class="keyword">or</span> y &lt; <span class="number">0</span> <span class="keyword">or</span> x &gt;= len(targetMap) <span class="keyword">or</span> y &gt;= len(targetMap[<span class="number">0</span>]):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> (x, y) <span class="keyword">in</span> visited:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> targetMap[x][y] == MapType.WALL:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gf5ocag5joj31260aateb.jpg" alt="image-20200526110735910"></p>
<h2 id="1833-pen-box-—-56-兩數之和-151-Stock-III"><a href="#1833-pen-box-—-56-兩數之和-151-Stock-III" class="headerlink" title="1833 pen box  — 56 兩數之和 + 151 Stock III"></a>1833 pen box  — 56 兩數之和 + 151 Stock III</h2><ul>
<li>两個不重疊的區間問題，用隔板思考, 同Stock iii</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    @param boxes: number of pens for each box</span></span><br><span class="line"><span class="string">    @param target: the target number</span></span><br><span class="line"><span class="string">    @return: the minimum boxes</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment"># # write your code here</span></span><br><span class="line">    <span class="comment"># # 找有效區間: 2 pointer</span></span><br><span class="line">    <span class="comment"># # 找最短有效后間: 打擂台 min_len = sys.maxsize; min_len = min(min_len, now_len)</span></span><br><span class="line">    <span class="comment"># # 枚舉隔板位置, 左半部分最短有效區間 + 右半部分最短有效區間</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># # O(N)</span></span><br><span class="line">    <span class="comment"># min_left[i]: [0:i] 前i個元素組成的list最短有效區間長度</span></span><br><span class="line">    <span class="comment"># min_right[i]: [i:n-1]第i個元素之後的list最短有效區間長度</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># # O(N) ↑結合上面那個 O(N)</span></span><br><span class="line">    <span class="comment"># min_len = sys.maxsize</span></span><br><span class="line">    <span class="comment"># for 隔板位置 in range(n):</span></span><br><span class="line">    <span class="comment">#     min_len = min(min_len, min_left[隔板位置] + min_right[隔板位置+1])</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment"># i = t+1, 相較於 i=t，最短的有效區間長度變小了，代表目前這個點一定在有效區間中</span></span><br><span class="line">    <span class="comment"># min_left[t+1] = min(min_left[t], 右針在t+1的有效區間的長度)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 一步一步移右指針</span></span><br><span class="line">    <span class="comment">#     如果區間和 &gt; target:</span></span><br><span class="line">    <span class="comment">#         左指針右移</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment">#     if now_sum != target:</span></span><br><span class="line">    <span class="comment">#         left_min[right] = 之前的最短有效區間的長度</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment">#     if now_sum == target:</span></span><br><span class="line">    <span class="comment">#         打擂台</span></span><br><span class="line">    <span class="comment">#         left_min[right] = min(之前的最短有效區間長度，當前區間長度)</span></span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minimumBoxes</span><span class="params">(self, boxes, target)</span>:</span> <span class="comment"># 前提：都正數</span></span><br><span class="line">        n = len(boxes)</span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        left_min = self.get_minimum_valid_length(boxes, target)</span><br><span class="line">        <span class="comment"># [1,2,3,4,5,6], target=5</span></span><br><span class="line">        <span class="comment"># left_min = [M,M,2,2,1]</span></span><br><span class="line">        </span><br><span class="line">        boxes = boxes[::<span class="number">-1</span>] <span class="comment"># 外面進來的 boxes 並沒有被改掉，不用擔心, 要注意會發生變化的時候或不會發生的時候</span></span><br><span class="line">        right_min = self.get_minimum_valid_length(boxes, target)</span><br><span class="line">        right_min = right_min[::<span class="number">-1</span>]</span><br><span class="line">        <span class="comment"># [6,5,4,3,2,1], target=5</span></span><br><span class="line">        <span class="comment"># right_min = [M,1,1,1,1,1,M]</span></span><br><span class="line">        <span class="comment"># [1,1,1,1,1,M]</span></span><br><span class="line">        </span><br><span class="line">        ans = sys.maxsize</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">            ans = min(ans, left_min[i]+right_min[i+<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">if</span> ans == sys.maxsize:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_minimum_valid_length</span><span class="params">(self, boxes, target)</span>:</span></span><br><span class="line">        <span class="comment"># 當前區間和</span></span><br><span class="line">        now_sum = <span class="number">0</span></span><br><span class="line">        n = len(boxes)</span><br><span class="line">        left_min = [sys.maxsize] * n</span><br><span class="line">        </span><br><span class="line">        left = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> right <span class="keyword">in</span> range(n):</span><br><span class="line">            now_sum += boxes[right]</span><br><span class="line">            <span class="keyword">while</span> now_sum &gt; target:</span><br><span class="line">                now_sum -= boxes[left]</span><br><span class="line">                left += <span class="number">1</span></span><br><span class="line">                </span><br><span class="line">            <span class="string">"""!!! 防OOR """</span> </span><br><span class="line">            <span class="keyword">if</span> right == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> now_sum == target:</span><br><span class="line">                    left_min[right] = <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> now_sum != target:</span><br><span class="line">                left_min[right] = left_min[right - <span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> now_sum == target:</span><br><span class="line">                left_min[right] = min(left_min[right - <span class="number">1</span>], right - left + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> left_min</span><br></pre></td></tr></table></figure>









<h1 id="數據範圍思考"><a href="#數據範圍思考" class="headerlink" title="數據範圍思考"></a>數據範圍思考</h1><ul>
<li>如何接水</li>
</ul>
<blockquote>
<h5 id="单选题-一般评测机1s能运算多少次"><a href="#单选题-一般评测机1s能运算多少次" class="headerlink" title="[单选题]一般评测机1s能运算多少次"></a>[单选题]一般评测机1s能运算多少次</h5><p>A.10^4-10^631.43% 选择</p>
<p>B.10^7-10^942.86% 选择</p>
<p>C.10^10-10^1225.71% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是B</p>
<p><strong>正确答案:</strong>B</p>
<p><strong>解析:</strong></p>
<p>我们一般认为如果最终的运算次数达到10^7-10^9就可能会超时，但是达到更大的如10^10-10^12次的计算次数时就可能会超时。比如n=10^3时，时间复杂度为O(n^2）复杂度的算法就一定不会超时，但是时间复杂度为O(N^3)复杂度的算法就大概率会超时。</p>
</blockquote>
<blockquote>
<h5 id="单选题-如果一个数组长为10-5，那么以下哪种算法一定会超时？"><a href="#单选题-如果一个数组长为10-5，那么以下哪种算法一定会超时？" class="headerlink" title="[单选题]如果一个数组长为10^5，那么以下哪种算法一定会超时？"></a>[单选题]如果一个数组长为10^5，那么以下哪种算法一定会超时？</h5><p>A.双指针0.00% 选择    N</p>
<p>B.前缀和2.33% 选择    N</p>
<p>C.一维dp13.95% 选择    N</p>
<p>D.枚举数组中的所有子区间进行O(1)判断79.07% 选择    N^2 &gt; 10^9 必超時</p>
<p>E.在数组中二分查找n次4.65% 选择    NlogN</p>
<p>F.这都是些啥算法qaq0.00% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是D</p>
<p><strong>正确答案:</strong>D</p>
<p><strong>解析:</strong></p>
<p>数组中的子区间个数为O(N^2)级别，因此，即使判断的时间复杂度为O(1), 总时间复杂度仍然是O(N^2). 而10^10以上级别的时间对于评测机来说需要运行的时间非常长，一定会超出时间限制。</p>
</blockquote>
<h2 id="Analyzation"><a href="#Analyzation" class="headerlink" title="Analyzation"></a>Analyzation</h2><ul>
<li>n = 10^4 、 10^5<ul>
<li>O(n) ==&gt; 雙指針？前綴和？遍歷？DP?</li>
<li>O(nlogn) ==&gt; 排序？二分？</li>
</ul>
</li>
<li>n = 10^3<ul>
<li>O(n^2) ==&gt; 二維數組？雙重循環？二維dp?</li>
</ul>
</li>
<li>n = 10^2<ul>
<li>O(n^3) ==&gt; 三重循環？e.g. Stone game 區間DP</li>
</ul>
</li>
<li>n = 10<ul>
<li>O(2^n), O(n!) ==&gt; dfs暴力？    2^n ~= 10^3, 10^6</li>
</ul>
</li>
<li>n = 10^9<ul>
<li>別打算開數組存或 O(n) 複雜度</li>
</ul>
</li>
</ul>
<h2 id="159-尋找旋轉排序數中的最小值-無重複值"><a href="#159-尋找旋轉排序數中的最小值-無重複值" class="headerlink" title="159. 尋找旋轉排序數中的最小值 - 無重複值"></a>159. 尋找旋轉排序數中的最小值 - 無重複值</h2><h2 id="183-木材加工"><a href="#183-木材加工" class="headerlink" title="183. 木材加工"></a>183. 木材加工</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    @param L: Given n pieces of wood with length L[i]</span></span><br><span class="line"><span class="string">    @param k: An integer</span></span><br><span class="line"><span class="string">    @return: The maximum length of the small pieces</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">woodCut</span><span class="params">(self, L, k)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> L: </span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="comment"># start, end = max(L), sum(L)</span></span><br><span class="line">        start, end = <span class="number">1</span>, max(L)</span><br><span class="line">        <span class="keyword">while</span> start+<span class="number">1</span> &lt; end:</span><br><span class="line">            mid = start + (end - start)//<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> self.get_pieces(L, mid) &lt; k:</span><br><span class="line">                end = mid</span><br><span class="line">            <span class="keyword">else</span>:   <span class="comment"># 表示可以切出k段，就加長再試試</span></span><br><span class="line">                start = mid</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> self.get_pieces(L, end) &gt;= k:</span><br><span class="line">            <span class="keyword">return</span> end</span><br><span class="line">        <span class="keyword">if</span> self.get_pieces(L, start) &gt;= k:</span><br><span class="line">            <span class="keyword">return</span> start</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_pieces</span><span class="params">(self, L, length)</span>:</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(L)):</span><br><span class="line">            count += L[i]//length</span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">            </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="comment">#     if not L:</span></span><br><span class="line">    <span class="comment">#         return 0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#     start, end = 1, max(L)</span></span><br><span class="line">    <span class="comment">#     while start + 1 &lt; end:</span></span><br><span class="line">    <span class="comment">#         mid = (start + end) // 2</span></span><br><span class="line">    <span class="comment">#         if self.get_pieces(L, mid) &gt;= k:</span></span><br><span class="line">    <span class="comment">#             start = mid</span></span><br><span class="line">    <span class="comment">#         else:</span></span><br><span class="line">    <span class="comment">#             end = mid</span></span><br><span class="line">                </span><br><span class="line">    <span class="comment">#     if self.get_pieces(L, end) &gt;= k:</span></span><br><span class="line">    <span class="comment">#         return end</span></span><br><span class="line">    <span class="comment">#     if self.get_pieces(L, start) &gt;= k:</span></span><br><span class="line">    <span class="comment">#         return start</span></span><br><span class="line">            </span><br><span class="line">    <span class="comment">#     return 0</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment"># def get_pieces(self, L, length):</span></span><br><span class="line">    <span class="comment">#     pieces = 0</span></span><br><span class="line">    <span class="comment">#     for l in L:</span></span><br><span class="line">    <span class="comment">#         pieces += l // length</span></span><br><span class="line">    <span class="comment">#     return pieces</span></span><br></pre></td></tr></table></figure>



<h2 id="62-搜索旋转排序数组"><a href="#62-搜索旋转排序数组" class="headerlink" title="62. 搜索旋转排序数组"></a>62. 搜索旋转排序数组</h2><h2 id="437-書籍複印"><a href="#437-書籍複印" class="headerlink" title="437. 書籍複印"></a>437. 書籍複印</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    @param pages: an array of integers</span></span><br><span class="line"><span class="string">    @param k: An integer</span></span><br><span class="line"><span class="string">    @return: an integer</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">copyBooks</span><span class="params">(self, pages, k)</span>:</span></span><br><span class="line">        <span class="comment"># return self.copyBooks_old(pages, k)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> pages:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="comment"># 使用九章算法强化班中讲过的基于答案值域的二分法。 答案的范围在 max(pages)~sum(pages) 之间，每次二分到一个时间 time_limit 的时候，用贪心法从左到右扫描一下 pages，看看需要多少个人来完成抄袭。 如果这个值 &lt;= k，那么意味着大家花的时间可能可以再少一些，如果 &gt; k 则意味着人数不够，需要降低工作量。</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># mins</span></span><br><span class="line">        start, end = max(pages), sum(pages)</span><br><span class="line">        <span class="keyword">while</span> start + <span class="number">1</span> &lt; end:</span><br><span class="line">            mid = start + (end - start)//<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> self.get_min_required_people(pages, mid) &lt;= k:</span><br><span class="line">                <span class="comment"># 人手夠的情況，時間可以再短一點</span></span><br><span class="line">                end = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 人手不夠的情況，時間給得再多一點</span></span><br><span class="line">                start = mid</span><br><span class="line">                </span><br><span class="line">        <span class="comment"># print(start, end)</span></span><br><span class="line">        <span class="keyword">if</span> self.get_min_required_people(pages, start) &lt;= k:</span><br><span class="line">            <span class="keyword">return</span> start</span><br><span class="line">        <span class="comment"># if self.get_min_required_people(pages, end) &lt;= k:</span></span><br><span class="line">        <span class="keyword">return</span> end</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_min_required_people</span><span class="params">(self, pages, time_limit)</span>:</span></span><br><span class="line">        people = <span class="number">1</span></span><br><span class="line">        time = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(pages)):</span><br><span class="line">            time += pages[i]</span><br><span class="line">            <span class="keyword">if</span> time &gt; time_limit:</span><br><span class="line">                <span class="comment"># print(pages[i])</span></span><br><span class="line">                people += <span class="number">1</span></span><br><span class="line">                time = pages[i] <span class="comment"># CRITICAL!!!</span></span><br><span class="line">                </span><br><span class="line">        <span class="comment"># print(people)</span></span><br><span class="line">        <span class="keyword">return</span> people</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">copyBooks_old</span><span class="params">(self, pages, k)</span>:</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> pages:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            </span><br><span class="line">        start, end = max(pages), sum(pages)</span><br><span class="line">        <span class="keyword">while</span> start + <span class="number">1</span> &lt; end:</span><br><span class="line">            print(start, end)</span><br><span class="line">            mid = (start + end) // <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> self.get_least_people(pages, mid) &lt;= k:</span><br><span class="line">                end = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                start = mid</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> self.get_least_people(pages, start) &lt;= k:</span><br><span class="line">            <span class="keyword">return</span> start</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> end</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_least_people</span><span class="params">(self, pages, time_limit)</span>:</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        time_cost = <span class="number">0</span> </span><br><span class="line">        <span class="keyword">for</span> page <span class="keyword">in</span> pages:</span><br><span class="line">            <span class="keyword">if</span> time_cost + page &gt; time_limit:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">                time_cost = <span class="number">0</span></span><br><span class="line">            time_cost += page</span><br><span class="line">        print(count+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> count + <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h2 id="949-Fibo-II"><a href="#949-Fibo-II" class="headerlink" title="949. Fibo II"></a>949. Fibo II</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># import numpy as np </span></span><br><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line">MOD = <span class="number">10000</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Matrix</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, n, m)</span>:</span></span><br><span class="line">        self.mat = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(m)] <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        self.n = n</span><br><span class="line">        self.m = m </span><br><span class="line"></span><br><span class="line">    <span class="comment"># A * B  ==&gt; A.__mul__(B)  n*m (x) m*k </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__mul__</span><span class="params">(self, matrix)</span>:</span></span><br><span class="line">        k = len(matrix.mat[<span class="number">0</span>])</span><br><span class="line">        tmp = Matrix(self.n, k)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(k):</span><br><span class="line">                <span class="keyword">for</span> t <span class="keyword">in</span> range(self.n):</span><br><span class="line">                    tmp.mat[i][j] += self.mat[i][t] * matrix.mat[t][j]</span><br><span class="line">                    tmp.mat[i][j] %= MOD </span><br><span class="line">        <span class="keyword">return</span> tmp</span><br><span class="line">        </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    @param n: an integer</span></span><br><span class="line"><span class="string">    @return: return an int</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lastFourDigitsOfFn</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        <span class="comment"># write your code here</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">0</span>: </span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="comment"># return self.O_N(n)</span></span><br><span class="line">        <span class="comment"># return self.O_logN(n)</span></span><br><span class="line">        <span class="keyword">return</span> self.O_logN_tmpl(n)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">power</span><span class="params">(self, A, k)</span>:</span>	<span class="comment"># FAST POW</span></span><br><span class="line">        n = len(A.mat)</span><br><span class="line">        ans = Matrix(n, n)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            ans.mat[i][i] = <span class="number">1</span> </span><br><span class="line">        <span class="keyword">while</span> k &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> k %  <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                ans = A * ans </span><br><span class="line">            A = A * A</span><br><span class="line">            k //= <span class="number">2</span> </span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans    </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">O_logN_tmpl</span><span class="params">(self, n)</span>:</span>    </span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">            </span><br><span class="line">        A = Matrix(<span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line">        A.mat = [[<span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">0</span>]]</span><br><span class="line">        A = self.power(A, n<span class="number">-1</span>)</span><br><span class="line">        </span><br><span class="line">        x = Matrix(<span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">        x.mat = [[<span class="number">1</span>], [<span class="number">0</span>]]</span><br><span class="line">        </span><br><span class="line">        ans = A * x</span><br><span class="line">        <span class="keyword">return</span> ans.mat[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">            </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">O_logN</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        # T = np.array([</span></span><br><span class="line"><span class="string">        #         [1, 1], </span></span><br><span class="line"><span class="string">        #         [1, 0]</span></span><br><span class="line"><span class="string">        #     ])</span></span><br><span class="line"><span class="string">        # X = T.copy()</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        # for i in range(n):</span></span><br><span class="line"><span class="string">        #     X = np.dot(T, X)</span></span><br><span class="line"><span class="string">        # for i in range(1, n):     # Should do this D&amp;C</span></span><br><span class="line"><span class="string">            # X = dot2x2(T, X)</span></span><br><span class="line"><span class="string">        # return X[0][1]%10000</span></span><br><span class="line"><span class="string">        # https://www.youtube.com/watch?v=PJT0oqZqixU        </span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dot2x2</span><span class="params">(A, B)</span>:</span></span><br><span class="line">            <span class="comment"># m, n, k = len(A), len(A[0]), len(B[0])</span></span><br><span class="line">            C = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">2</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">2</span>)]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">                <span class="keyword">for</span> t <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">2</span>):</span><br><span class="line">                        C[i][t] += A[i][j] * B[j][t] % <span class="number">10000</span></span><br><span class="line">            <span class="comment"># C[0][0] = A[0][0] * B[0][0] + A[0][1] * B[1][0]</span></span><br><span class="line">            <span class="comment"># C[0][1] = A[0][0] * B[0][1] + A[0][1] * B[1][1]</span></span><br><span class="line">            <span class="comment"># C[1][0] = A[1][0] * B[0][0] + A[1][1] * B[1][0]</span></span><br><span class="line">            <span class="comment"># C[1][1] = A[1][0] * B[0][1] + A[1][1] * B[1][1]</span></span><br><span class="line">            <span class="keyword">return</span> C</span><br><span class="line">            </span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(T, n)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> T</span><br><span class="line">            X = helper(T, n//<span class="number">2</span>)</span><br><span class="line">            tmp = dot2x2(X, X)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> n % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                Y = [[<span class="number">1</span>, <span class="number">1</span>], </span><br><span class="line">                     [<span class="number">1</span>, <span class="number">0</span>]]</span><br><span class="line">                <span class="keyword">return</span> dot2x2(tmp, Y)</span><br><span class="line">            <span class="keyword">return</span> tmp</span><br><span class="line">            </span><br><span class="line">        T = [[<span class="number">1</span>, <span class="number">1</span>], </span><br><span class="line">             [<span class="number">1</span>, <span class="number">0</span>]]</span><br><span class="line">        RES = helper(T, n)</span><br><span class="line">        <span class="comment"># print(RES)</span></span><br><span class="line">        <span class="keyword">return</span> RES[<span class="number">0</span>][<span class="number">1</span>] % <span class="number">10000</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">O_N</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> n &lt;= <span class="number">1</span>: </span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">            </span><br><span class="line">        f0 = <span class="number">0</span></span><br><span class="line">        f1 = <span class="number">1</span></span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, n+<span class="number">1</span>):</span><br><span class="line">            ans = f0 + f1</span><br><span class="line">            f0 = f1</span><br><span class="line">            f1 = ans</span><br><span class="line">        <span class="keyword">return</span> ans % <span class="number">10000</span></span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/23/OOD/2019-05-23-OOD%20for%20Real%20Life%20Object/">OOD/2019-05-23-OOD for Real Life Object</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-23</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/OOD/">OOD</a></span><div class="content"><h1 id="Real-Obj-OOD"><a href="#Real-Obj-OOD" class="headerlink" title="Real Obj OOD"></a>Real Obj OOD</h1><ul>
<li>Vending Machine</li>
<li>Jukebox 點菜機</li>
<li>CD Player</li>
<li>Coffee maker</li>
<li>Kindle</li>
<li><strong><em>ATM</em></strong></li>
</ul>
<ul>
<li><p>Input / Output</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">	CoffeeBean --&gt; CoffeeMaker --&gt; Coffee</span><br></pre></td></tr></table></figure>
</li>
<li><p>Design Pattern - 大多數實物類都可用到</p>
<ul>
<li>Strategy pattern</li>
<li>Decorate pattern</li>
<li>Factory pattern</li>
</ul>
</li>
</ul>
<h1 id="Design-a-Vending-Machine"><a href="#Design-a-Vending-Machine" class="headerlink" title="Design a Vending Machine"></a>Design a Vending Machine</h1><h2 id="Clarify"><a href="#Clarify" class="headerlink" title="Clarify"></a>Clarify</h2><ul>
<li><p>What: </p>
<ul>
<li><p>Input ? Output ? &amp; 該如何提問這兩者?</p>
</li>
<li><p>External request?! ==&gt; 包含 <strong>($, item)</strong> 這樣先後順序沒有能體現</p>
</li>
<li><p>不需要提廠家、重量、顏色這些的只是加了private attribute等等的 getter，這些並不是影響設計的流程，只是「通用屬性的點」，浪費了時間; 大小是否有限制？–&gt; 也不是要注意的點</p>
</li>
<li><p>Input: </p>
<ul>
<li>Payment<ul>
<li>不同<strong><em>種類</em></strong>的錢？！<ul>
<li>紙/硬幣<ul>
<li>找零</li>
</ul>
</li>
<li>CreditCard/ApplePay..</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">	Payment --&gt; VendingMachine --&gt; Item</span><br></pre></td></tr></table></figure>

<ul>
<li>Item<ul>
<li>What to do when an item <strong><em>sold out</em></strong>?<ul>
<li>refill sue case ==&gt; <strong>ItemSoldOutException</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>假設：</p>
<ul>
<li>Vending Machine 大小沒限制</li>
<li>只賣三種產品；Coke, Sprite, Mountain Dew</li>
<li>目前只可coins，不考慮payments所以沒有 Strategy Design </li>
</ul>
</li>
</ul>
</li>
<li><p>How: </p>
<ul>
<li>how to select item ? </li>
<li>假設：<ul>
<li>輸入一個input，代表一種item: A1 -&gt; Coke</li>
</ul>
</li>
<li>Refill</li>
</ul>
</li>
<li><p>Who: N/A</p>
</li>
</ul>
<h2 id="Core-Object"><a href="#Core-Object" class="headerlink" title="Core Object"></a>Core Object</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br></pre></td></tr></table></figure>



<h3 id="Use-Cases"><a href="#Use-Cases" class="headerlink" title="Use Cases"></a>Use Cases</h3><table>
<thead>
<tr>
<th align="center">Use Cases</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Select Item</td>
</tr>
<tr>
<td align="center">Insert Coin</td>
</tr>
<tr>
<td align="center">Execute Transaction</td>
</tr>
<tr>
<td align="center">Cancel Transaction</td>
</tr>
<tr>
<td align="center">Refill Items</td>
</tr>
</tbody></table>
<h3 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h3><h4 id="Use-case-Select-item"><a href="#Use-case-Select-item" class="headerlink" title="Use case: Select item"></a>Use case: Select item</h4><p>​    - Vending machine taks an external input, show the price of that item</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- List&lt;item&gt; items</span><br><span class="line">		- Map&lt;String, item&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>問題: </p>
<ul>
<li><p>itemIdentifiers 的問題：</p>
<ul>
<li><p>item 沒有價格，再加上去 屬性吧</p>
</li>
<li><p>Item 不存在的話？如E2, 加Exception</p>
</li>
<li><p>sold out?</p>
</li>
<li><p>☆★☆★☆ ItemIdentifier是個靜態，item是動態的，如果客人把 Coke destroy，那我們的機器就被影響了！！動態的物品被買走後，別人對item做的變動我們不能保證，所以不能這樣做</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class ItemInfo</span><br></pre></td></tr></table></figure>

<p>應該是要對到一個靜態的 <strong><em>ItemInfo</em></strong></p>
<p>並用ItemInfo映射到 List<Item></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- List&lt;item&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br></pre></td></tr></table></figure>

<p>​                        修改價錢時，直接對應到所有的Item上去了！</p>
<ul>
<li>現在是先選，再投幣</li>
</ul>
<h4 id="Use-Case-Execute-Transaction"><a href="#Use-Case-Execute-Transaction" class="headerlink" title="Use Case: Execute Transaction"></a>Use Case: Execute Transaction</h4><ul>
<li>Get current selected item</li>
<li>Cpr the item price and inserted coins</li>
<li>If not enough money, throw an exeption</li>
<li>Else, return the item purchased</li>
<li>Refund if any</li>
</ul>
<ol>
<li>&amp; 2. Cur selection &amp; inserted coins</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">		- ItemInfo currentSelection</span><br><span class="line">		- List &lt;Coin&gt; currentCoins</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin&#123;</span><br><span class="line">		&lt;&lt;enumeration&gt;&gt;</span><br><span class="line">		PENNY(1)</span><br><span class="line">		NICKLE(5)</span><br><span class="line">		DIME(10)</span><br><span class="line">		QUARTER(25)</span><br><span class="line">	&#125;</span><br><span class="line">	Coin: +Float value</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class	NotEnoughMoneyException</span><br></pre></td></tr></table></figure>





<p>SelectItems 已經把東西選好了，所以executeTransaction可以執行，而不用再有input，前面做了可以顯示，不綁定在executeTransaction裡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">		- ItemInfo currentSelection</span><br><span class="line">		- List &lt;Coin&gt; currentCoins</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br><span class="line">	VendingMachine: + void insertCoins(List&lt;Coin&gt; coins)</span><br><span class="line">	VendingMachine: + Item executeTransaction()</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; refund()</span><br></pre></td></tr></table></figure>

<p>找零 + 東西出來</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">		- ItemInfo currentSelection</span><br><span class="line">		- List &lt;Coin&gt; currentCoins</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br><span class="line">	VendingMachine: + void insertCoins(List&lt;Coin&gt; coins)</span><br><span class="line">	VendingMachine: + Pair&lt;Item, List&lt;Coin&gt;&gt; executeTransaction()</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; refund()</span><br></pre></td></tr></table></figure>



<h4 id="Use-Case-Cancel-Selection-amp-Refill"><a href="#Use-Case-Cancel-Selection-amp-Refill" class="headerlink" title="Use Case: Cancel Selection &amp; Refill"></a>Use Case: Cancel Selection &amp; Refill</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">		- ItemInfo currentSelection</span><br><span class="line">		- List &lt;Coin&gt; currentCoins</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br><span class="line">	VendingMachine: + void insertCoins(List&lt;Coin&gt; coins)</span><br><span class="line">	VendingMachine: + Pair&lt;Item, List&lt;Coin&gt;&gt; executeTransaction()</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; cancelTransaction()	</span><br><span class="line">	VendingMachine: + void refillItems(List&lt;Item&gt; items)	</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; refund()</span><br></pre></td></tr></table></figure>



<h4 id="Use-Case-Final-View"><a href="#Use-Case-Final-View" class="headerlink" title="Use Case: Final View"></a>Use Case: Final View</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">		- ItemInfo currentSelection</span><br><span class="line">		- List &lt;Coin&gt; currentCoins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; stock</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br><span class="line">	VendingMachine: + void insertCoins(List&lt;Coin&gt; coins)</span><br><span class="line">	VendingMachine: + Pair&lt;Item, List&lt;Coin&gt;&gt; executeTransaction()</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; cancelTransaction()	</span><br><span class="line">	VendingMachine: + void refillItems(List&lt;Item&gt; items)	</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; refund()</span><br></pre></td></tr></table></figure>



<h4 id="GOOD-PRACTICE-for-NESTED-ITEMs"><a href="#GOOD-PRACTICE-for-NESTED-ITEMs" class="headerlink" title="GOOD PRACTICE for NESTED ITEMs"></a>GOOD PRACTICE for NESTED ITEMs</h4><p>For example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">stock = <span class="keyword">new</span> HashMap&lt;ItemInfo, List&lt;Item&gt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">refillItem</span><span class="params">(List&lt;Item&gt; items)</span></span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (Item item: items)&#123;</span><br><span class="line">    ItemInfo info = item.getInfo();</span><br><span class="line">    List&lt;Item&gt; itemsInStock = stock.get(info);</span><br><span class="line">    itemsInSotck.add(item);</span><br><span class="line">    stock.put(info, itemsInStock);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>當遇到Nested-Structure時，可以用一個類去代替　↓</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stock</span></span>&#123;&#125;</span><br><span class="line">	<span class="keyword">private</span> HashMap&lt;ItemInfo, List&lt;Item&gt;&gt; stock;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Item item)</span></span>&#123;</span><br><span class="line">    ItemInfo info = item.getInfo();</span><br><span class="line">    List&lt;Item&gt; itemsInStock = stock.get(info);</span><br><span class="line">    itemsInStock.add(item);</span><br><span class="line">    stock.put(info, itemsInStock);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stock = <span class="keyword">new</span> Stock();</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">refillItem</span><span class="params">(List&lt;Item&gt; items)</span></span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (Item item: items)&#123;</span><br><span class="line">    stock.add(item);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">		- ItemInfo currentSelection</span><br><span class="line">		- List &lt;Coin&gt; currentCoins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; stock</span><br><span class="line">	&#125;</span><br><span class="line">  class Coin&#123;</span><br><span class="line">    &lt;&lt;enumeration&gt;&gt;</span><br><span class="line">    PENNY(1)</span><br><span class="line">    NICKLE(5)</span><br><span class="line">    DIME(10)</span><br><span class="line">    QUARTER(25)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  class Stock&#123;</span><br><span class="line">  	- Map&lt;ItemInfo, List&lt;Item&gt;&gt; stock</span><br><span class="line">  &#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- String name</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item&#123;</span><br><span class="line">		# ItemInfo info</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  class NotEnoughMoneyException</span><br><span class="line">  class NotEnoughItemException</span><br><span class="line">  </span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line"></span><br><span class="line">	Coin: +Float value</span><br><span class="line">	Stock: + int getQuantity(Iteminfo info)</span><br><span class="line">	Stock: void add(Item t)</span><br><span class="line">	Stock: deduct(Iteminfo info)</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br><span class="line">	VendingMachine: + void insertCoins(List&lt;Coin&gt; coins)</span><br><span class="line">	VendingMachine: + Pair&lt;Item, List&lt;Coin&gt;&gt; executeTransaction()</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; cancelTransaction()	</span><br><span class="line">	VendingMachine: + void refillItems(List&lt;Item&gt; items)	</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; refund()</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Stock&#123;</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; stock</span><br><span class="line">	&#125;</span><br><span class="line">	Stock: + int getQuantity(Iteminfo info)</span><br><span class="line">	Stock: void add(Item t)</span><br><span class="line">	Stock: deduct(Iteminfo info)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Item&#123;</span><br><span class="line">		# ItemInfo info	&#x3D;&#x3D;&gt; should be protected for modification</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/63/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/63/">63</a><span class="page-number current">64</span><a class="page-number" href="/page/65/">65</a><span class="space">&hellip;</span><a class="page-number" href="/page/80/">80</a><a class="extend next" rel="next" href="/page/65/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2023 By Joe Huang</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>