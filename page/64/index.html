<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="Joe Huang"><meta name="copyright" content="Joe Huang"><title>Awaken Desparado</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-180692466-1', 'auto');
ga('send', 'pageview');</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.2.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Joe Huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">395</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">26</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">69</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Awaken Desparado</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Awaken Desparado</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/23/OOD/2019-05-23-OOD%20for%20Real%20Life%20Object/">OOD/2019-05-23-OOD for Real Life Object</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-23</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/OOD/">OOD</a></span><div class="content"><h1 id="Real-Obj-OOD"><a href="#Real-Obj-OOD" class="headerlink" title="Real Obj OOD"></a>Real Obj OOD</h1><ul>
<li>Vending Machine</li>
<li>Jukebox 點菜機</li>
<li>CD Player</li>
<li>Coffee maker</li>
<li>Kindle</li>
<li><strong><em>ATM</em></strong></li>
</ul>
<ul>
<li><p>Input / Output</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">	CoffeeBean --&gt; CoffeeMaker --&gt; Coffee</span><br></pre></td></tr></table></figure>
</li>
<li><p>Design Pattern - 大多數實物類都可用到</p>
<ul>
<li>Strategy pattern</li>
<li>Decorate pattern</li>
<li>Factory pattern</li>
</ul>
</li>
</ul>
<h1 id="Design-a-Vending-Machine"><a href="#Design-a-Vending-Machine" class="headerlink" title="Design a Vending Machine"></a>Design a Vending Machine</h1><h2 id="Clarify"><a href="#Clarify" class="headerlink" title="Clarify"></a>Clarify</h2><ul>
<li><p>What: </p>
<ul>
<li><p>Input ? Output ? &amp; 該如何提問這兩者?</p>
</li>
<li><p>External request?! ==&gt; 包含 <strong>($, item)</strong> 這樣先後順序沒有能體現</p>
</li>
<li><p>不需要提廠家、重量、顏色這些的只是加了private attribute等等的 getter，這些並不是影響設計的流程，只是「通用屬性的點」，浪費了時間; 大小是否有限制？–&gt; 也不是要注意的點</p>
</li>
<li><p>Input: </p>
<ul>
<li>Payment<ul>
<li>不同<strong><em>種類</em></strong>的錢？！<ul>
<li>紙/硬幣<ul>
<li>找零</li>
</ul>
</li>
<li>CreditCard/ApplePay..</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">	Payment --&gt; VendingMachine --&gt; Item</span><br></pre></td></tr></table></figure>

<ul>
<li>Item<ul>
<li>What to do when an item <strong><em>sold out</em></strong>?<ul>
<li>refill sue case ==&gt; <strong>ItemSoldOutException</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>假設：</p>
<ul>
<li>Vending Machine 大小沒限制</li>
<li>只賣三種產品；Coke, Sprite, Mountain Dew</li>
<li>目前只可coins，不考慮payments所以沒有 Strategy Design </li>
</ul>
</li>
</ul>
</li>
<li><p>How: </p>
<ul>
<li>how to select item ? </li>
<li>假設：<ul>
<li>輸入一個input，代表一種item: A1 -&gt; Coke</li>
</ul>
</li>
<li>Refill</li>
</ul>
</li>
<li><p>Who: N/A</p>
</li>
</ul>
<h2 id="Core-Object"><a href="#Core-Object" class="headerlink" title="Core Object"></a>Core Object</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br></pre></td></tr></table></figure>



<h3 id="Use-Cases"><a href="#Use-Cases" class="headerlink" title="Use Cases"></a>Use Cases</h3><table>
<thead>
<tr>
<th align="center">Use Cases</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Select Item</td>
</tr>
<tr>
<td align="center">Insert Coin</td>
</tr>
<tr>
<td align="center">Execute Transaction</td>
</tr>
<tr>
<td align="center">Cancel Transaction</td>
</tr>
<tr>
<td align="center">Refill Items</td>
</tr>
</tbody></table>
<h3 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h3><h4 id="Use-case-Select-item"><a href="#Use-case-Select-item" class="headerlink" title="Use case: Select item"></a>Use case: Select item</h4><p>​    - Vending machine taks an external input, show the price of that item</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- List&lt;item&gt; items</span><br><span class="line">		- Map&lt;String, item&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>問題: </p>
<ul>
<li><p>itemIdentifiers 的問題：</p>
<ul>
<li><p>item 沒有價格，再加上去 屬性吧</p>
</li>
<li><p>Item 不存在的話？如E2, 加Exception</p>
</li>
<li><p>sold out?</p>
</li>
<li><p>☆★☆★☆ ItemIdentifier是個靜態，item是動態的，如果客人把 Coke destroy，那我們的機器就被影響了！！動態的物品被買走後，別人對item做的變動我們不能保證，所以不能這樣做</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class ItemInfo</span><br></pre></td></tr></table></figure>

<p>應該是要對到一個靜態的 <strong><em>ItemInfo</em></strong></p>
<p>並用ItemInfo映射到 List<Item></p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- List&lt;item&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br></pre></td></tr></table></figure>

<p>​                        修改價錢時，直接對應到所有的Item上去了！</p>
<ul>
<li>現在是先選，再投幣</li>
</ul>
<h4 id="Use-Case-Execute-Transaction"><a href="#Use-Case-Execute-Transaction" class="headerlink" title="Use Case: Execute Transaction"></a>Use Case: Execute Transaction</h4><ul>
<li>Get current selected item</li>
<li>Cpr the item price and inserted coins</li>
<li>If not enough money, throw an exeption</li>
<li>Else, return the item purchased</li>
<li>Refund if any</li>
</ul>
<ol>
<li>&amp; 2. Cur selection &amp; inserted coins</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">		- ItemInfo currentSelection</span><br><span class="line">		- List &lt;Coin&gt; currentCoins</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin&#123;</span><br><span class="line">		&lt;&lt;enumeration&gt;&gt;</span><br><span class="line">		PENNY(1)</span><br><span class="line">		NICKLE(5)</span><br><span class="line">		DIME(10)</span><br><span class="line">		QUARTER(25)</span><br><span class="line">	&#125;</span><br><span class="line">	Coin: +Float value</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class	NotEnoughMoneyException</span><br></pre></td></tr></table></figure>





<p>SelectItems 已經把東西選好了，所以executeTransaction可以執行，而不用再有input，前面做了可以顯示，不綁定在executeTransaction裡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">		- ItemInfo currentSelection</span><br><span class="line">		- List &lt;Coin&gt; currentCoins</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br><span class="line">	VendingMachine: + void insertCoins(List&lt;Coin&gt; coins)</span><br><span class="line">	VendingMachine: + Item executeTransaction()</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; refund()</span><br></pre></td></tr></table></figure>

<p>找零 + 東西出來</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">		- ItemInfo currentSelection</span><br><span class="line">		- List &lt;Coin&gt; currentCoins</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br><span class="line">	VendingMachine: + void insertCoins(List&lt;Coin&gt; coins)</span><br><span class="line">	VendingMachine: + Pair&lt;Item, List&lt;Coin&gt;&gt; executeTransaction()</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; refund()</span><br></pre></td></tr></table></figure>



<h4 id="Use-Case-Cancel-Selection-amp-Refill"><a href="#Use-Case-Cancel-Selection-amp-Refill" class="headerlink" title="Use Case: Cancel Selection &amp; Refill"></a>Use Case: Cancel Selection &amp; Refill</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">		- ItemInfo currentSelection</span><br><span class="line">		- List &lt;Coin&gt; currentCoins</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br><span class="line">	VendingMachine: + void insertCoins(List&lt;Coin&gt; coins)</span><br><span class="line">	VendingMachine: + Pair&lt;Item, List&lt;Coin&gt;&gt; executeTransaction()</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; cancelTransaction()	</span><br><span class="line">	VendingMachine: + void refillItems(List&lt;Item&gt; items)	</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; refund()</span><br></pre></td></tr></table></figure>



<h4 id="Use-Case-Final-View"><a href="#Use-Case-Final-View" class="headerlink" title="Use Case: Final View"></a>Use Case: Final View</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">		- ItemInfo currentSelection</span><br><span class="line">		- List &lt;Coin&gt; currentCoins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; stock</span><br><span class="line">	&#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line">	</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br><span class="line">	VendingMachine: + void insertCoins(List&lt;Coin&gt; coins)</span><br><span class="line">	VendingMachine: + Pair&lt;Item, List&lt;Coin&gt;&gt; executeTransaction()</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; cancelTransaction()	</span><br><span class="line">	VendingMachine: + void refillItems(List&lt;Item&gt; items)	</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; refund()</span><br></pre></td></tr></table></figure>



<h4 id="GOOD-PRACTICE-for-NESTED-ITEMs"><a href="#GOOD-PRACTICE-for-NESTED-ITEMs" class="headerlink" title="GOOD PRACTICE for NESTED ITEMs"></a>GOOD PRACTICE for NESTED ITEMs</h4><p>For example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">stock = <span class="keyword">new</span> HashMap&lt;ItemInfo, List&lt;Item&gt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">refillItem</span><span class="params">(List&lt;Item&gt; items)</span></span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (Item item: items)&#123;</span><br><span class="line">    ItemInfo info = item.getInfo();</span><br><span class="line">    List&lt;Item&gt; itemsInStock = stock.get(info);</span><br><span class="line">    itemsInSotck.add(item);</span><br><span class="line">    stock.put(info, itemsInStock);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>當遇到Nested-Structure時，可以用一個類去代替　↓</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stock</span></span>&#123;&#125;</span><br><span class="line">	<span class="keyword">private</span> HashMap&lt;ItemInfo, List&lt;Item&gt;&gt; stock;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Item item)</span></span>&#123;</span><br><span class="line">    ItemInfo info = item.getInfo();</span><br><span class="line">    List&lt;Item&gt; itemsInStock = stock.get(info);</span><br><span class="line">    itemsInStock.add(item);</span><br><span class="line">    stock.put(info, itemsInStock);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stock = <span class="keyword">new</span> Stock();</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">refillItem</span><span class="params">(List&lt;Item&gt; items)</span></span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (Item item: items)&#123;</span><br><span class="line">    stock.add(item);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Coin</span><br><span class="line">	class VendingMachine&#123;</span><br><span class="line">		- List&lt;Coin&gt; coins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; items</span><br><span class="line">		- Map&lt;String, ItemInfo&gt; itemIdentifiers &#x3D;&gt; &quot;A1 to Coke&quot;</span><br><span class="line">		- ItemInfo currentSelection</span><br><span class="line">		- List &lt;Coin&gt; currentCoins</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; stock</span><br><span class="line">	&#125;</span><br><span class="line">  class Coin&#123;</span><br><span class="line">    &lt;&lt;enumeration&gt;&gt;</span><br><span class="line">    PENNY(1)</span><br><span class="line">    NICKLE(5)</span><br><span class="line">    DIME(10)</span><br><span class="line">    QUARTER(25)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  class Stock&#123;</span><br><span class="line">  	- Map&lt;ItemInfo, List&lt;Item&gt;&gt; stock</span><br><span class="line">  &#125;</span><br><span class="line">	class ItemInfo&#123;</span><br><span class="line">		- String name</span><br><span class="line">		- float price</span><br><span class="line">		+ float getPrice()</span><br><span class="line">	&#125;</span><br><span class="line">	class Item&#123;</span><br><span class="line">		# ItemInfo info</span><br><span class="line">	&#125;</span><br><span class="line">	class Item</span><br><span class="line">	class Sprite</span><br><span class="line">  class Coke</span><br><span class="line">  class MountainDew</span><br><span class="line">  class NotEnoughMoneyException</span><br><span class="line">  class NotEnoughItemException</span><br><span class="line">  </span><br><span class="line">  Item &lt;|-- Sprite</span><br><span class="line">  Item &lt;|-- Coke</span><br><span class="line">  Item &lt;|-- MountainDew</span><br><span class="line"></span><br><span class="line">	Coin: +Float value</span><br><span class="line">	Stock: + int getQuantity(Iteminfo info)</span><br><span class="line">	Stock: void add(Item t)</span><br><span class="line">	Stock: deduct(Iteminfo info)</span><br><span class="line">	VendingMachine: + float selectItem(String selection)</span><br><span class="line">	VendingMachine: + void insertCoins(List&lt;Coin&gt; coins)</span><br><span class="line">	VendingMachine: + Pair&lt;Item, List&lt;Coin&gt;&gt; executeTransaction()</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; cancelTransaction()	</span><br><span class="line">	VendingMachine: + void refillItems(List&lt;Item&gt; items)	</span><br><span class="line">	VendingMachine: + List&lt;Coin&gt; refund()</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Stock&#123;</span><br><span class="line">		- Map&lt;ItemInfo, List&lt;Item&gt;&gt; stock</span><br><span class="line">	&#125;</span><br><span class="line">	Stock: + int getQuantity(Iteminfo info)</span><br><span class="line">	Stock: void add(Item t)</span><br><span class="line">	Stock: deduct(Iteminfo info)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Item&#123;</span><br><span class="line">		# ItemInfo info	&#x3D;&#x3D;&gt; should be protected for modification</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/23/Plot/mermaid_notes/">Plot/mermaid_notes</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-23</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Markdown/">Markdown</a></span><div class="content"><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">    Start --&gt; Stop</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">    Start --&gt; Stop</span><br></pre></td></tr></table></figure>





<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A[方形] --&gt;B(圆角)</span><br><span class="line">    B --&gt; C&#123;条件a&#125;</span><br><span class="line">    C --&gt;|a&#x3D;1| D[结果1]</span><br><span class="line">    C --&gt;|a&#x3D;2| E[结果2]</span><br><span class="line">    F[横向流程图]</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">graph TB</span><br><span class="line">    Start(开始) --&gt; Open[打开冰箱门]</span><br><span class="line">    Open --&gt; Put[把大象放进去]</span><br><span class="line">    Put[把大象放进去] --&gt; IsFit&#123;&quot;冰箱小不小？&quot;&#125;</span><br><span class="line">    </span><br><span class="line">    IsFit --&gt;|不小| Close[把冰箱门关上]</span><br><span class="line">    Close --&gt; End(结束)</span><br><span class="line">        </span><br><span class="line">    IsFit --&gt;|小| Change[换个大冰箱]</span><br><span class="line">    Change --&gt; Open</span><br></pre></td></tr></table></figure>



<p>ref: <a href="https://jingyan.baidu.com/article/48b558e3035d9a7f38c09aeb.html" target="_blank" rel="noopener">https://jingyan.baidu.com/article/48b558e3035d9a7f38c09aeb.html</a></p>
<p>live: <a href="https://mermaid-js.github.io/mermaid-live-editor/" target="_blank" rel="noopener">https://mermaid-js.github.io/mermaid-live-editor/</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/18/OOD/2019-05-18-OOD%20for%20Reservation%20System/">OOD/2019-05-18-OOD for Reservation System</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-18</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/OOD/">OOD</a></span><div class="content"><h1 id="Reservation-System"><a href="#Reservation-System" class="headerlink" title="Reservation System"></a>Reservation System</h1><p>管理員提供服務　＋　預訂</p>
<p>餐廳！如何預定？！</p>
<h1 id="Restaurant-Reservation"><a href="#Restaurant-Reservation" class="headerlink" title="Restaurant Reservation"></a>Restaurant Reservation</h1><h2 id="Clarify"><a href="#Clarify" class="headerlink" title="Clarify"></a>Clarify</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">	Party --&gt; Restaurant --&gt; Table</span><br></pre></td></tr></table></figure>

<p>管理進來的 Party/Table</p>
<ul>
<li>What : <ul>
<li>Restaurant<ul>
<li>吧台<ul>
<li>怎麼分一個Party</li>
</ul>
</li>
<li>固定Table</li>
<li>包間</li>
<li>大小、收費？！</li>
</ul>
</li>
<li>Party</li>
<li>Table</li>
<li>針對本題：<ul>
<li>大堂，所有桌子都一樣</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>How ：<ul>
<li>能否送外賣？</li>
<li>能否預定某張桌子？</li>
<li>每個Order 需要區分是內用還是外帶？</li>
<li>針對本題：<ul>
<li>無外賣、都內用 dine-in無Dine-out</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>Who:<ul>
<li>List<Guest></li>
<li>Party – 日上size，不需要去紀錄Guest，淡化Guest的概念</li>
<li>思考一：<ul>
<li>一組人進餐廳，帶位人帶位，waiter、客人點菜、廚師做菜、waiter 上菜，客人買單。</li>
<li><strong><em>不同角色的流程，很複雜</em></strong>　比較像菜廳的遊戲，費時，易有小bug</li>
</ul>
</li>
<li>思考二：<ul>
<li>以餐廳為主體<ul>
<li>客人進餐廳，餐廳返回一個Table</li>
<li>客人點菜，餐廳返回一桌菜</li>
<li>客人付帳，餐廳清空Table</li>
<li>對於這個餐廳的Use Case，每個Use Case自對應input/output</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Core-Object"><a href="#Core-Object" class="headerlink" title="Core Object"></a>Core Object</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">Party --&gt; Restaurant --&gt; Table --&gt; Order --&gt; Meal</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Party</span><br><span class="line">	class Restaurant &#123;</span><br><span class="line">		- List&lt;Table&gt; tables</span><br><span class="line">		- List &lt;Meal&gt; menu</span><br><span class="line">	&#125;</span><br><span class="line">	class Order &#123;</span><br><span class="line">		- List&lt;Meal&gt; meal</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Cases"><a href="#Cases" class="headerlink" title="Cases"></a>Cases</h2><ul>
<li>Party<ul>
<li>make order?! X 主體最要用餐廳</li>
</ul>
</li>
<li>Restaurant: <ul>
<li>Find table</li>
<li>Take Order – 等效以restaurant 去想Party 的MakeOrder</li>
<li>Checkout</li>
</ul>
</li>
</ul>
<ul>
<li>Management 類常見 Use Case<ul>
<li>Reserve: 暫不考慮</li>
<li>Serve: Find table, take order</li>
<li>Checkout: checkout</li>
</ul>
</li>
</ul>
<h2 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h2><table>
<thead>
<tr>
<th align="center">Use Cases</th>
</tr>
</thead>
<tbody><tr>
<td align="center">find table</td>
</tr>
<tr>
<td align="center">Take Order</td>
</tr>
<tr>
<td align="center">Checkout</td>
</tr>
</tbody></table>
<h3 id="Use-Case-SEARCH-Find-Table"><a href="#Use-Case-SEARCH-Find-Table" class="headerlink" title="Use Case: SEARCH - Find Table"></a>Use Case: SEARCH - Find Table</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Party</span><br><span class="line">	class Restaurant&#123;</span><br><span class="line">		- List&lt;Table&gt; tables</span><br><span class="line">		- List&lt;Meal&gt; menu</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Table</span><br><span class="line">	class Order&#123;</span><br><span class="line">		- List&lt;Meal&gt; meals</span><br><span class="line">	&#125;</span><br><span class="line">	class Meal</span><br><span class="line">	</span><br><span class="line">	Restaurant: +Table findTable()</span><br><span class="line">	Table: - Boolean available</span><br><span class="line">	Table: + boolean isAvailable()</span><br><span class="line">	Table: + void changeStatus()</span><br></pre></td></tr></table></figure>

<ul>
<li><p>changeStatus 並不是個好的名字！！因為別人要去查之前的狀態，比較好的是↓</p>
</li>
<li><p>變成有兩個一個叫 MarkAvaible, 一個叫 MarkUnavailable. 是更好的</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Party</span><br><span class="line">	class Restaurant&#123;</span><br><span class="line">		- List&lt;Table&gt; tables</span><br><span class="line">		- List&lt;Meal&gt; menu</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Table</span><br><span class="line">	class Order&#123;</span><br><span class="line">		- List&lt;Meal&gt; meals</span><br><span class="line">	&#125;</span><br><span class="line">	class Meal</span><br><span class="line">	</span><br><span class="line">	Restaurant: +Table findTable()</span><br><span class="line">	Table: - Boolean available</span><br><span class="line">	Table: + boolean isAvailable()</span><br><span class="line">	Table: + void markUnavailable()</span><br></pre></td></tr></table></figure>



<h3 id="Use-Case-SELECT-Take-Order"><a href="#Use-Case-SELECT-Take-Order" class="headerlink" title="Use Case: SELECT - Take Order"></a>Use Case: SELECT - Take Order</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Party</span><br><span class="line">	class Restaurant&#123;</span><br><span class="line">		- List&lt;Table&gt; tables</span><br><span class="line">		- List&lt;Meal&gt; menu</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Table</span><br><span class="line">	class Order&#123;</span><br><span class="line">		- List&lt;Meal&gt; meals</span><br><span class="line">	&#125;</span><br><span class="line">	class Meal</span><br><span class="line">	</span><br><span class="line">	Restaurant: +Table findTable()</span><br><span class="line">  Restaurant: +Table takeOrder(Order o)</span><br><span class="line">	Table: - Boolean available</span><br><span class="line">	Table: + boolean isAvailable()</span><br><span class="line">	Table: + void markUnavailable()</span><br></pre></td></tr></table></figure>

<ul>
<li><p>takeOrder 放在Restaurant　或放 Table都OK…</p>
</li>
<li><p>OOD考慮的人物愈多，愈複雜，所以用主題：這個restaurant就好</p>
</li>
</ul>
<h3 id="Use-Case-CANCEL-Checkout"><a href="#Use-Case-CANCEL-Checkout" class="headerlink" title="Use Case: CANCEL - Checkout"></a>Use Case: CANCEL - Checkout</h3><ul>
<li>把桌子設回去可用</li>
<li>結帳</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Party</span><br><span class="line">	class Restaurant&#123;</span><br><span class="line">		- List&lt;Table&gt; tables</span><br><span class="line">		- List&lt;Meal&gt; menu</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Table</span><br><span class="line">	class Order&#123;</span><br><span class="line">		- List&lt;Meal&gt; meals</span><br><span class="line">		- Table t</span><br><span class="line">		- Party p</span><br><span class="line">	&#125;</span><br><span class="line">	class Meal&#123;</span><br><span class="line">		- Float price</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	Restaurant: +Table findTable()</span><br><span class="line">  Restaurant: +Table takeOrder(Order o)</span><br><span class="line">  Restaurant: +void checkout(Order o)</span><br><span class="line">	Table: - Boolean available</span><br><span class="line">	Table: + boolean isAvailable()</span><br><span class="line">	Table: + void markUnavailable()</span><br><span class="line">	Table: + void markAvailable()	</span><br><span class="line">	Order: + float getPrice()</span><br><span class="line">	Meal: + float getPrice()</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Order要知道是幾號桌去作mark</p>
</li>
<li><p>能不能在Table 加 Order?</p>
<ul>
<li>不好！如同往Spot或Vehicle加Ticket，靜態加動態不好！</li>
</ul>
</li>
<li><p>Order 可加Party嗎？</p>
<ul>
<li>好！就是個Ticket!</li>
</ul>
</li>
<li><p>可以解決拼桌的問題嗎？目前可以嗎？</p>
<ul>
<li>無法</li>
<li>拼桌是看Table是不是Available? 當我們調 findTable後，還能不能再坐人要看Table、Party大小，都不知道</li>
<li>多個Party用一張桌子</li>
<li>一個Party用多張</li>
<li>Available vs Unavailable<ul>
<li>做法一、在restaurant 加map</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Party &#123;</span><br><span class="line">		int capacity</span><br><span class="line">	&#125;</span><br><span class="line">	class Restaurant&#123;</span><br><span class="line">		- List&lt;Table&gt; tables</span><br><span class="line">		- List&lt;Meal&gt; menu</span><br><span class="line">		- Map&lt;Table, List&lt;Order&gt;&gt; orders</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Table &#123;</span><br><span class="line">		- Boolean available</span><br><span class="line">		- int capacity</span><br><span class="line">	&#125;</span><br><span class="line">	class Order&#123;</span><br><span class="line">		- List&lt;Meal&gt; meals</span><br><span class="line">		- Table t</span><br><span class="line">		- Party p</span><br><span class="line">	&#125;</span><br><span class="line">	class Meal&#123;</span><br><span class="line">		- Float price</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	Party: + int getCapacigty()</span><br><span class="line">	Restaurant: +Table findTable()</span><br><span class="line">  Restaurant: +Table takeOrder(Order o)</span><br><span class="line">  Restaurant: +void checkout(Order o)</span><br><span class="line">	Table: + boolean isAvailable()</span><br><span class="line">	Table: + void markUnavailable()</span><br><span class="line">	Table: + void markAvailable()</span><br><span class="line">	Table: + int getCapacity()</span><br><span class="line">	Order: + float getPrice()</span><br><span class="line">	Meal: + float getPrice()</span><br></pre></td></tr></table></figure>

<p>​                               或做法二更好、也可以在 Table加 capacity &amp; cur_capacity 用 cur_capacity来看還能不能塞人。如果 cur_capacity到0了，就設為unavaialable；每次有人坐進來就控制個variable</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Party &#123;</span><br><span class="line">		int capacity</span><br><span class="line">	&#125;</span><br><span class="line">	class Restaurant&#123;</span><br><span class="line">		- List&lt;Table&gt; tables</span><br><span class="line">		- List&lt;Meal&gt; menu</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Table &#123;</span><br><span class="line">		- Boolean available</span><br><span class="line">		- int capacity</span><br><span class="line">		- int cur_capacity</span><br><span class="line">	&#125;</span><br><span class="line">	class Order&#123;</span><br><span class="line">		- List&lt;Meal&gt; meals</span><br><span class="line">		- Table t</span><br><span class="line">		- Party p</span><br><span class="line">	&#125;</span><br><span class="line">	class Meal&#123;</span><br><span class="line">		- Float price</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	Party: + int getCapacigty()</span><br><span class="line">	Restaurant: +Table findTable()</span><br><span class="line">  Restaurant: +Table takeOrder(Order o)</span><br><span class="line">  Restaurant: +void checkout(Order o)</span><br><span class="line">	Table: + boolean isAvailable()</span><br><span class="line">	Table: + void markUnavailable()</span><br><span class="line">	Table: + void markAvailable()</span><br><span class="line">  Table: + int getCapacity()</span><br><span class="line">	Order: + float getPrice()</span><br><span class="line">	Meal: + float getPrice()</span><br></pre></td></tr></table></figure>

<ul>
<li><ul>
<li>最方便來想，就是把所有都放在 restaurant主來 來完成。</li>
<li>如果是一群人多桌的話，就是還要再Order裡把 Table t 改為 List<Table></li>
</ul>
</li>
</ul>
<h1 id="Reservation"><a href="#Reservation" class="headerlink" title="Reservation?!!"></a>Reservation?!!</h1><ul>
<li><p>Restaurant、Hotel、Flight/Bus/Train</p>
</li>
<li><p>基於管理類作提升</p>
</li>
<li><p>What?</p>
<ul>
<li>考慮預定的東西</li>
<li>Table</li>
<li>時間段 + Table</li>
<li>機票/機艙/座位號</li>
</ul>
</li>
<li><p>Use Case</p>
<ul>
<li><p>Search</p>
</li>
<li><p>Select</p>
</li>
<li><p>Cancel</p>
</li>
<li><p><strong>Search criteria</strong> -&gt; Search() -&gt; <strong>List<Result></strong> -&gt; Select() -&gt; <strong>Receipt</strong></p>
<ul>
<li>Search criteria<ul>
<li>Make a reservation<ul>
<li>Party 大小</li>
<li>日期</li>
<li>時間</li>
</ul>
</li>
<li>人數：無拼桌，每張桌子大戚相同，不會有超過桌子大小的人數</li>
<li>日期：是否允許預定多日後？ - Ok</li>
<li>時間：是否所有時間都允許預定？不行就要加Exception  - 24/7<ul>
<li>時間段是比起始時間好做</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Design: FindTableForReservation(Timeslot t)</p>
</li>
<li><p>Timeslot: Date &amp; Time</p>
</li>
<li><p>List<Result></p>
<ul>
<li>當選的時間段可以或不行時，系統該給出什麼反饋？<ul>
<li>做法一：<ul>
<li>7:30可選，還給附近的時間讓你選</li>
<li>Result == Timeslot</li>
<li>-Design: List<Timeslot> findTableForReservation(Timeslot t)</li>
<li>Possible Challenge: 討論如何獲得這個List，像是給出前後還有它的這個List</li>
</ul>
</li>
<li>做了二：<ul>
<li>可預定: 直接進入Confirm階段</li>
<li>不能預定 ：Throw exception/ Show message</li>
<li>-Design: Pair&lt;Table, Timeslot&gt; findTableForReservation(Time slot), or throws NoTableForReservationException</li>
<li>-Design: void confirmReservation(Pair&lt;Table, Timeslot&gt; reservation)</li>
<li>為何可以跳過 List<Result>這個步驟？因為Table是一樣的，用戶不會知道是幾號桌</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Party &#123;</span><br><span class="line">		int capacity</span><br><span class="line">	&#125;</span><br><span class="line">	class Restaurant&#123;</span><br><span class="line">		- List&lt;Table&gt; tables</span><br><span class="line">		- List&lt;Meal&gt; menu</span><br><span class="line">		- Map&lt;Table, List&lt;Order&gt;&gt; orders		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Table &#123;</span><br><span class="line">		- Boolean available</span><br><span class="line">		- int capacity</span><br><span class="line">		- int cur_capacity</span><br><span class="line">	&#125;</span><br><span class="line">	class Order&#123;</span><br><span class="line">		- List&lt;Meal&gt; meals</span><br><span class="line">		- Table t</span><br><span class="line">		- Party p</span><br><span class="line">	&#125;</span><br><span class="line">	class Meal&#123;</span><br><span class="line">		- Float price</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	Party: + int getCapacigty()</span><br><span class="line">	Restaurant: +Table findTable()</span><br><span class="line">  Restaurant: +Table takeOrder(Order o)</span><br><span class="line">  Restaurant: +void checkout(Order o)</span><br><span class="line">  Restaurant: +Reservation findTableForReservation(Timeslot t)</span><br><span class="line">  Restaurant: +void confirmReservation(Reservation r)</span><br><span class="line">	Table: + boolean isAvailable()</span><br><span class="line">	Table: + void markUnavailable()</span><br><span class="line">	Table: + void markAvailable()</span><br><span class="line">  Table: + int getCapacity()</span><br><span class="line">	Order: + float getPrice()</span><br><span class="line">	Meal: + float getPrice()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Restaurant: +Reservation findTableForReservation(Timeslot t) //SEARCH<br>Restaurant: +void confirmReservation(Reservation r)  //SELECT    </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Reservation &#123;</span><br><span class="line">		- Table table</span><br><span class="line">		- Timeslot timeslot</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class NoTableException</span><br><span class="line">  class NoTableForReservationException</span><br></pre></td></tr></table></figure>

<ul>
<li><p>怎麼判斷哪張Table被預定／是否能被預定呢？</p>
<ul>
<li>How to know if a table if open for reservation for a time slot?</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">　　　　４　　　　　　２　　　　　　　　１</span><br><span class="line">if (Timeslot-MAX_DINETIME &gt; CURRENT_TIME)｛</span><br><span class="line">　　　　　　　　　　　　　　　　　　４　　　　　　　２</span><br><span class="line">	if no reservation durint Timeslot-MAX_DINETIME to Timeslot+MAX_DINETIME</span><br><span class="line">		return True;</span><br><span class="line">	else</span><br><span class="line">		return False;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">	return table.isAvailable()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>講解：如果要預約的間是四點，尤其一桌可吃的最長是兩小時，我們就看前後兩小時有沒有人預定，要2點到6點之間都沒人預定，4點這個timeslot才能被預定；三點或五點有人預定，這桌子都不可被預定</li>
<li>如果當前時間已經這時間內了，就看是否有人在用在三點已有人預定</li>
<li>PS: 這頁還是怪怪的，要是現在是 2:30，有人預約三點，但你只看現在沒人在用餐，這樣不對吧？！！。。</li>
<li>另種方法：用時間段預約如 9:30 ~ 11:00，就不用設計 MAX_DINE_TIME</li>
</ul>
</li>
<li><p>如何知道對於一張Table <em>Any reservation durint Timeslot-MAX_DINETIME to Timeslot+MAX_DINETIME?</em></p>
<ul>
<li><p>Solution1: 每張Table 按時間排序保留一個 List, 對於每個進來的query的Timeslot都檢查是否有符合上述區間的timeslot已經被預定了</p>
<ul>
<li>例：[2, 7, 9], 那麼4點就可預定，因為他可用到六點；而8無法被預定（因為6點到10點有沒有人預定，發現了7、９都有人，所以8點無法） <ul>
<li>Walkin有什麼影響？要查是否預定</li>
</ul>
</li>
</ul>
</li>
<li><p>Solution2: 保存一個Centralzed的Map, 有被confirm過的time splot就插入這個Map, Map&lt;Timeslot, Set<Table>&gt;</p>
<ul>
<li><p>當Query一個新的timesplot時，檢查這個區間內已經被預管過的Table,</p>
<p>排除之後剩下的就是可選的桌子，隨意選一張即可</p>
</li>
<li><p>例如 (2, &lt;1,3,5&gt;), (3, &lt;4.,6&gt;)，當要查４點時，就是看2-4點，還有4-6還被預定過的求交集，剩下的就是可用的桌子</p>
</li>
</ul>
</li>
<li><p>Sol1, vs Sol2, </p>
<ul>
<li>sol1, 不好清空所有Reservation</li>
<li>Sol2. 如果Timesplot分很細，會有很多的key，就要找很多個去看這「兩個小時裡是否有空位」</li>
</ul>
</li>
</ul>
</li>
<li><p>多線程設計：要找到critical data, 這題就是”Table”，有好多Thread都要去訪問它看是不是available</p>
</li>
</ul>
<p>​    </p>
<ul>
<li>Sol1:  UML，去看這張桌子的revervation list</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Party &#123;</span><br><span class="line">		int capacity</span><br><span class="line">	&#125;</span><br><span class="line">	class Restaurant&#123;</span><br><span class="line">		- List&lt;Table&gt; tables</span><br><span class="line">		- List&lt;Meal&gt; menu</span><br><span class="line">		- Map&lt;Table, List&lt;Order&gt;&gt; orders		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Table &#123;</span><br><span class="line">		- Boolean available</span><br><span class="line">		- int capacity</span><br><span class="line">		- int cur_capacity</span><br><span class="line">		- List&lt;Timeslot&gt; reservations</span><br><span class="line">	&#125;</span><br><span class="line">	class Order&#123;</span><br><span class="line">		- List&lt;Meal&gt; meals</span><br><span class="line">		- Table t</span><br><span class="line">		- Party p</span><br><span class="line">	&#125;</span><br><span class="line">	class Meal&#123;</span><br><span class="line">		- Float price</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	Party: + int getCapacigty()</span><br><span class="line">	Restaurant: +Table findTable()</span><br><span class="line">  Restaurant: +Table takeOrder(Order o)</span><br><span class="line">  Restaurant: +void checkout(Order o)</span><br><span class="line">  Restaurant: +Reservation findTableForReservation(Timeslot t)</span><br><span class="line">  Restaurant: +void confirmReservation(Reservation r)</span><br><span class="line">	Table: + boolean isAvailable()</span><br><span class="line">	Table: + void markUnavailable()</span><br><span class="line">	Table: + void markAvailable()</span><br><span class="line">  Table: + int getCapacity()</span><br><span class="line">	Order: + float getPrice()</span><br><span class="line">	Meal: + float getPrice()</span><br></pre></td></tr></table></figure>



<ul>
<li>Sol2:  UML，中心化 reservation在Restaurant</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Party &#123;</span><br><span class="line">		int capacity</span><br><span class="line">	&#125;</span><br><span class="line">	class Restaurant&#123;</span><br><span class="line">		- List&lt;Table&gt; tables</span><br><span class="line">		- List&lt;Meal&gt; menu</span><br><span class="line">		- Map&lt;Table, List&lt;Order&gt;&gt; orders		</span><br><span class="line">		- Map&lt;Table, List&lt;Timeslot&gt;&gt; reservation</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Table &#123;</span><br><span class="line">		- Boolean available</span><br><span class="line">		- int capacity</span><br><span class="line">		- int cur_capacity</span><br><span class="line">	&#125;</span><br><span class="line">	class Order&#123;</span><br><span class="line">		- List&lt;Meal&gt; meals</span><br><span class="line">		- Table t</span><br><span class="line">		- Party p</span><br><span class="line">	&#125;</span><br><span class="line">	class Meal&#123;</span><br><span class="line">		- Float price</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	Party: + int getCapacigty()</span><br><span class="line">	Restaurant: +Table findTable()</span><br><span class="line">  Restaurant: +Table takeOrder(Order o)</span><br><span class="line">  Restaurant: +void checkout(Order o)</span><br><span class="line">  Restaurant: +Reservation findTableForReservation(Timeslot t)</span><br><span class="line">  Restaurant: +void confirmReservation(Reservation r)</span><br><span class="line">	Table: + boolean isAvailable()</span><br><span class="line">	Table: + void markUnavailable()</span><br><span class="line">	Table: + void markAvailable()</span><br><span class="line">  Table: + int getCapacity()</span><br><span class="line">	Order: + float getPrice()</span><br><span class="line">	Meal: + float getPrice()</span><br></pre></td></tr></table></figure>



<h3 id="Use-Case-Cancel-Reservation"><a href="#Use-Case-Cancel-Reservation" class="headerlink" title="Use Case: Cancel Reservation"></a>Use Case: Cancel Reservation</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Party &#123;</span><br><span class="line">		int capacity</span><br><span class="line">	&#125;</span><br><span class="line">	class Restaurant&#123;</span><br><span class="line">		- List&lt;Table&gt; tables</span><br><span class="line">		- List&lt;Meal&gt; menu</span><br><span class="line">		- Map&lt;Table, List&lt;Order&gt;&gt; orders		</span><br><span class="line">		- Map&lt;Table, List&lt;Timeslot&gt;&gt; reservation</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Table &#123;</span><br><span class="line">		- Boolean available</span><br><span class="line">		- int capacity</span><br><span class="line">		- int cur_capacity</span><br><span class="line">	&#125;</span><br><span class="line">	class Order&#123;</span><br><span class="line">		- List&lt;Meal&gt; meals</span><br><span class="line">		- Table t</span><br><span class="line">		- Party p</span><br><span class="line">	&#125;</span><br><span class="line">	class Meal&#123;</span><br><span class="line">		- Float price</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	Party: + int getCapacigty()</span><br><span class="line">	Restaurant: +Table findTable()</span><br><span class="line">  Restaurant: +Table takeOrder(Order o)</span><br><span class="line">  Restaurant: +void checkout(Order o)</span><br><span class="line">  Restaurant: +Reservation findTableForReservation(Timeslot t)</span><br><span class="line">  Restaurant: +void confirmReservation(Reservation r)</span><br><span class="line">  Restaurant: +void cancelReservation(Reservation r)  </span><br><span class="line">	Table: + boolean isAvailable()</span><br><span class="line">	Table: + void markUnavailable()</span><br><span class="line">	Table: + void markAvailable()</span><br><span class="line">  Table: + int getCapacity()</span><br><span class="line">	Order: + float getPrice()</span><br><span class="line">	Meal: + float getPrice()</span><br></pre></td></tr></table></figure>



<h1 id="Hotel-Reservation"><a href="#Hotel-Reservation" class="headerlink" title="Hotel Reservation"></a>Hotel Reservation</h1><p>所有預定系統都有兩種潛在型問題：</p>
<ol>
<li>像Booking.com找一個地區的hotel</li>
<li>蒐的是某個具體的hotel得到詳細內容，直接針對一間hotel作預定</li>
</ol>
<ul>
<li><p>What? 是為一間設計還是Booking?</p>
<ul>
<li>先設計一間，再設計選擇酒店的系統，方間的人數和價格可能不同</li>
<li>What 針對的是 Search()後的 List<Result></li>
<li>關鍵字: Room</li>
</ul>
</li>
<li><p>Challenge</p>
<ul>
<li><p>設計房間類</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Room&#123;</span><br><span class="line">		- int capacity</span><br><span class="line">		- float price</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果Result是Room: List<Result> -&gt; List<Room></p>
<ul>
<li>跟現實不一樣，現實返回的是 RoomType</li>
</ul>
</li>
<li><p>How many room types do we have for this hotel?</p>
</li>
</ul>
</li>
<li><p>Restaurant V.S. Hotel</p>
<ul>
<li>什麼情況下需要考慮 Result Type (Room Type)?</li>
<li>主要是在價格、很多屬性不同時<ul>
<li>單人 vs 雙人</li>
<li>頭等 vs 經濟</li>
<li>大桌 vs 小桌</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Clarify-1"><a href="#Clarify-1" class="headerlink" title="Clarify"></a>Clarify</h2><ul>
<li>預等類的規則？N/A</li>
<li>當人滿教超過房間大小怎辦？<ul>
<li>用戶自己選房間數量<ul>
<li>外部自主發Request</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Core-ObjectType"><a href="#Core-ObjectType" class="headerlink" title="Core ObjectType"></a>Core ObjectType</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Request</span><br><span class="line">	class Hotel&#123;</span><br><span class="line">		- List&lt;Room&gt; rooms</span><br><span class="line">		- List&lt;Reservation&gt; reservations</span><br><span class="line">	&#125;</span><br><span class="line">	class Reservation&#123;</span><br><span class="line">		- List&lt;Room&gt; rooms</span><br><span class="line">	&#125;</span><br><span class="line">	class RoomType</span><br><span class="line">	class Room&#123;</span><br><span class="line">		- RoomType type</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h2><h3 id="Use-Cases"><a href="#Use-Cases" class="headerlink" title="Use Cases"></a>Use Cases</h3><ul>
<li>Hotel: <ul>
<li>Search for available rooms</li>
<li>Make reservation (SELECT)</li>
<li>Cancel reservation</li>
</ul>
</li>
</ul>
<ul>
<li>Search for available roome<ol>
<li>Based on serach criteria</li>
<li>Go thru rooms to check availability</li>
<li>list available <strong>room types</strong> and <strong>available count</strong></li>
<li>P.S. 不加人數沒影響，人數少以定總統房也OK</li>
</ol>
</li>
</ul>
<ol>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Request &#123;</span><br><span class="line">		- Date startDate</span><br><span class="line">		- Date endDate</span><br><span class="line">	&#125;</span><br><span class="line">	class Hotel&#123;</span><br><span class="line">		- List&lt;Room&gt; rooms</span><br><span class="line">		- List&lt;Reservation&gt; reservations</span><br><span class="line">	&#125;</span><br><span class="line">	class Reservation&#123;</span><br><span class="line">		- List&lt;Room&gt; rooms</span><br><span class="line">	&#125;</span><br><span class="line">	class RoomType</span><br><span class="line">	class Room&#123;</span><br><span class="line">		- RoomType type</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	Hotel: +Map&lt;RoomType, int&gt; handleSearchRequest(Request r)</span><br></pre></td></tr></table></figure>



</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">	Request --&gt; |Request|Hotel</span><br></pre></td></tr></table></figure>



<ol start="2">
<li>加個 List<Data>　單位都是 Date, 對於Hotel可能不需要再多寫 isRequestAvailable</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Request&#123;</span><br><span class="line">		- Date startDate</span><br><span class="line">		- Date endDate</span><br><span class="line">	&#125;</span><br><span class="line">	class Hotel&#123;</span><br><span class="line">		- List&lt;Room&gt; rooms</span><br><span class="line">		- List&lt;Reservation&gt; reservations</span><br><span class="line">		- Map&lt;Room, List&lt;Data&gt;&gt; roomReservations</span><br><span class="line">	&#125;</span><br><span class="line">	class Reservation&#123;</span><br><span class="line">		- List&lt;Room&gt; rooms</span><br><span class="line">	&#125;</span><br><span class="line"> 	class RoomType &#123;</span><br><span class="line"> 		&lt;&lt;Enumeration&gt;&gt;</span><br><span class="line">		SINGLE</span><br><span class="line">		DOUBLE</span><br><span class="line">	&#125;</span><br><span class="line">	class Room&#123;</span><br><span class="line">		- RoomType type</span><br><span class="line">		- List&lt;Data&gt; reservations</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">  Hotel: +Map&lt;RoomType, int&gt; handleSearchRequest(Request r)</span><br><span class="line">  Hotel: -isRequestAvailable(Request r, List&lt;Data&gt; dates)</span><br></pre></td></tr></table></figure>

<ul>
<li>Make Reservation (SELECT)<ol>
<li>Add room type and number of rooms in a request</li>
<li>send request to hotel  ==&gt; API</li>
<li>if there’s enough room left, confirm</li>
<li>not enough, throw exception</li>
</ol>
</li>
</ul>
<p>1.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Request&#123;</span><br><span class="line">		- Date startDate</span><br><span class="line">		- Date endDate</span><br><span class="line">	&#125;</span><br><span class="line">	class Hotel&#123;</span><br><span class="line">		- List&lt;Room&gt; rooms</span><br><span class="line">		- List&lt;Reservation&gt; reservations</span><br><span class="line">		- Map&lt;Room, List&lt;Data&gt;&gt; roomReservations</span><br><span class="line">	&#125;</span><br><span class="line">	class Reservation&#123;</span><br><span class="line">		- List&lt;Room&gt; rooms</span><br><span class="line">	&#125;</span><br><span class="line"> 	class RoomType &#123;</span><br><span class="line"> 		&lt;&lt;Enumeration&gt;&gt;</span><br><span class="line">		SINGLE</span><br><span class="line">		DOUBLE</span><br><span class="line">	&#125;</span><br><span class="line">	class Room&#123;</span><br><span class="line">		- RoomType type</span><br><span class="line">		- List&lt;Data&gt; reservations</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">  Hotel: +Map&lt;RoomType, int&gt; handleSearchRequest(Request r)</span><br><span class="line">  Hotel: -isRequestAvailable(Request r, List&lt;Data&gt; dates)</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	ReservationRequest --&gt; Hotel: SendRequest</span><br><span class="line">	class ReservationRequest&#123;</span><br><span class="line">		- Date startDate</span><br><span class="line">		- Date endDate</span><br><span class="line">		- Map&lt;RoomType, int&gt; roomsMNeede</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Hotel&#123;</span><br><span class="line">		- List&lt;Room&gt; rooms</span><br><span class="line">		- List&lt;Reservation&gt; reservations</span><br><span class="line">		- Map&lt;Room, List&lt;Data&gt;&gt; roomReservations</span><br><span class="line">		Hotel: +Map&lt;RoomType, int&gt; handleSearchRequest(Request r)</span><br><span class="line">		Hotel: -Boolean isRequestAvailable(Request r, List&lt;Data&gt; dates)	</span><br><span class="line">		Hotel: + Reservation makeReservation(ReservationRqeust r)</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class NotEnoughRoomForReservationException&#123;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>根據 roomReservations 再去看各類房型還有多少房, 或不夠</li>
</ul>
<table>
<thead>
<tr>
<th>Search for available rooms</th>
<th>Make reservation</th>
</tr>
</thead>
<tbody><tr>
<td>1. Based on search criteria</td>
<td>1. Add RoomType and number of  rooms in a request</td>
</tr>
<tr>
<td><strong>2. Go thru rooms to check availability</strong></td>
<td>2. Send request to Hotel</td>
</tr>
<tr>
<td><strong>3. list available room types and room count</strong>.</td>
<td><strong>3. If there’s enough room left, confirm the reservation</strong></td>
</tr>
<tr>
<td></td>
<td>4. if not, throw <strong>exception</strong></td>
</tr>
</tbody></table>
<ul>
<li>上面的黑體會被這兩個Use Cases常調用</li>
<li>Challenge<ul>
<li>Map&lt;RoomType, List<Room>&gt; map</li>
<li>Go thru, to check availability</li>
<li>Room enough then confirm</li>
<li>Not enough , throw exception</li>
<li>用 Cache!! for 這種預定類常見的蒐索<ul>
<li>LRU Cache!   Heavily Search Service</li>
<li>e.g. 已經保存了３～４號有100間房，有人訂了，就更新成98間，是一個Hash表，不需再全部過一遍。<ul>
<li>Multithread會有沒有不妥？LRU每個cell都是critical data，需要把這個data structure加上鎖</li>
<li>Java 裡提供了 LinkedHashMap, 聲明Capacity即可</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="LRU"><a href="#LRU" class="headerlink" title="LRU"></a>LRU</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	ReservationRequest --&gt; Hotel: SendRequest</span><br><span class="line"></span><br><span class="line">	class ReservationRequest&#123;</span><br><span class="line">		- Date startDate</span><br><span class="line">		- Date endDate</span><br><span class="line">		- Map&lt;RoomType, int&gt; roomsMNeede</span><br><span class="line">		- LRUCache&lt;Request, Map&lt;RoomType, Set&lt;Room&gt;&gt;&gt; Cache</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Hotel&#123;</span><br><span class="line">		- List&lt;Room&gt; rooms</span><br><span class="line">		- List&lt;Reservation&gt; reservations</span><br><span class="line">		- Map&lt;Room, List&lt;Data&gt;&gt; roomReservations</span><br><span class="line">		Hotel: +Map&lt;RoomType, int&gt; handleSearchRequest(Request r)</span><br><span class="line">		Hotel: -Boolean isRequestAvailable(Request r, List&lt;Data&gt; dates)	</span><br><span class="line">		Hotel: + Reservation makeReservation(ReservationRqeust r)</span><br><span class="line">		Hotel: + void cancelReservation(Reservation r)		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>過來的request就是1到３號，我返回單雙人間各還有哪幾間</strong></li>
<li>得知道哪些是Available的，以及「返回型式」該是怎樣的</li>
</ul>
<h2 id="v-s-Booking-com"><a href="#v-s-Booking-com" class="headerlink" title="v.s. Booking.com ?!"></a>v.s. Booking.com ?!</h2><p>區別在 Formula </p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gf2pq1otdbj31320dc101.jpg" alt="image-20200523213840045"></p>
<ul>
<li>Search B 是 A的子集</li>
</ul>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/15/OOD/2019-05-15-OOD%20for%20Management%20System/">OOD/2019-05-15-OOD for Management System</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-15</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/OOD/">OOD</a></span><div class="content"><h1 id="Strategy-Pattern"><a href="#Strategy-Pattern" class="headerlink" title="Strategy Pattern"></a>Strategy Pattern</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	Context *-- Strategy</span><br><span class="line">	Strategy &lt;|-- ConcreteStrategyA</span><br><span class="line">  Strategy &lt;|-- ConcreteStrategyB</span><br><span class="line">	Strategy : &lt;&lt;interface&gt;&gt;</span><br><span class="line">	Strategy : +execute()</span><br><span class="line">  ConcreteStrategyA : +execute()</span><br><span class="line">  ConcreteStrategyB : +execute()</span><br></pre></td></tr></table></figure>



<h1 id="Management-OOD"><a href="#Management-OOD" class="headerlink" title="Management OOD"></a>Management OOD</h1><ul>
<li>Gym </li>
<li>Parking lot</li>
<li>Restaurant</li>
<li>Library</li>
<li>Super market</li>
<li>Hotel</li>
</ul>
<p>– 模擬管理員的日常工作</p>
<h2 id="Clarify"><a href="#Clarify" class="headerlink" title="Clarify"></a>Clarify</h2><ul>
<li>parking lot</li>
<li>vehicle</li>
</ul>
<h2 id="Core-Object"><a href="#Core-Object" class="headerlink" title="Core Object"></a>Core Object</h2><ul>
<li>input?</li>
<li>output?</li>
<li>Elevator: Input: request; Output: elevator</li>
</ul>
<h2 id="Case"><a href="#Case" class="headerlink" title="Case"></a>Case</h2><ul>
<li>Reserve</li>
<li>Serve</li>
<li>Checkout</li>
</ul>
<h2 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h2><ul>
<li>收據形式以保管information</li>
<li>例子：圖書館管理裡別用User Class包個Book的list或Book Class 包個User；比較好是用個收據單紀錄哪個人借了什麼書</li>
</ul>
<h1 id="Design-Parking-lot"><a href="#Design-Parking-lot" class="headerlink" title="Design Parking lot"></a>Design Parking lot</h1><h2 id="Clarify-1"><a href="#Clarify-1" class="headerlink" title="Clarify"></a>Clarify</h2><ul>
<li><p>What, How, Who</p>
<ul>
<li>要管理什么？input? output?</li>
<li>Key words: parking lot、vehicle、parking spot </li>
<li>data member 性質的可不多考慮</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">	A[Vehicle] --&gt; B[ParkingLot] --&gt; C[Parking Spot]</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="Challenge"><a href="#Challenge" class="headerlink" title="Challenge"></a>Challenge</h3><ul>
<li><p>keywords 的各種種類的區別</p>
<ul>
<li><p>parking lot 類別</p>
<ul>
<li>露天：parking lot -&gt; parking spaces</li>
<li>停車塔多層樓: parking lot -&gt; parking level -&gt; parking spaces</li>
<li>室內機械室: parking lot -&gt; parking level (optional) -&gt;  -&gt;parking spaces -&gt; Upper/Lower space</li>
</ul>
</li>
<li><p>vehicle 類別</p>
<p>不同種類的車對設計的影響？</p>
<ul>
<li>Bus, </li>
<li>car, </li>
<li>motorcycle</li>
</ul>
</li>
<li><p>parking spot 類別</p>
<ul>
<li>殘疾人</li>
<li>充電車位</li>
</ul>
</li>
</ul>
</li>
<li><p>針對本題:</p>
<ul>
<li>考慮多層的Parking lot 沒錯層，考慮三種大小的車、不考慮殘疾、充電車位</li>
<li>當尋找合適車位時，要看是否為空　vs 特製化車位，彈性低不易擴展</li>
</ul>
</li>
</ul>
<p>How: </p>
<ul>
<li>如何車？<ul>
<li>已知信息：所有車位都是相同規格的</li>
</ul>
</li>
<li>角度：<ul>
<li>從車：開進停車場-&gt;經過每個位置看能否停-&gt;停進一個位置</li>
<li>從停車場: 開進停車場-&gt;返回一個能停的地方-&gt;停進一個位置</li>
</ul>
</li>
<li>規則：<ol>
<li>停車</li>
<li>收費</li>
</ol>
</li>
<li>假設針對時間收費</li>
</ul>
<h2 id="Core-Object-1"><a href="#Core-Object-1" class="headerlink" title="Core Object"></a>Core Object</h2><ul>
<li>What, Why, How</li>
<li>Core Ojbects 之間的 mapping 關係</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">	B[Bus] --&gt; P[ParkingLot]</span><br><span class="line">	C[Car] --&gt; P[ParkingLot]</span><br><span class="line">	M[Motorcycle] --&gt; P[ParkingLot]</span><br><span class="line">	P --&gt; Spot[Spot]</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Bad Desigs:　↓　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class ParkingLot</span><br><span class="line">	ParkingLot: - List&lt;Car&gt; cars</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Spot</span><br><span class="line">	Spot: - Car car</span><br></pre></td></tr></table></figure>



</li>
</ul>
<ul>
<li>不好的原因：<ol>
<li>停車場不可能去知道是不是停了什麼顏色的什麼車</li>
<li>Parking lot跟 Spot 都是靜態的Class, Car是個動態的東西；可以說Parking log 包含 spot；但靜態包動態的不好，停完車就出來了，車裡面放spot也無理</li>
<li>如果spot加了car也是加了一個不必要的dependency:<ul>
<li>假設Spot可叫讓Car拿他的車牌號叫get_plate()；但有天get_plate名字換了，Spot裡面的呼呼也要跟著變，但這是不合理的。</li>
<li>不必須的dependency, ParkingLot現在depend在Car, 把 cars刪了會無法 compile；車子的操作改變跟停車場沒鳥關係</li>
</ul>
</li>
<li>比較好是ParkingLog跟Splot有關係，用個parking ticket作紀錄，讓停車場去抽取這個關係就好</li>
</ol>
</li>
</ul>
<h2 id="Cases-Use-Case"><a href="#Cases-Use-Case" class="headerlink" title="Cases (Use Case)"></a>Cases (Use Case)</h2><ul>
<li><p>What, Why, How –  一份將做完的事的合約</p>
</li>
<li><p>根據類作思考，把自己想成是個去停車的人或把自己想像成自己是停車場 – Better!</p>
</li>
</ul>
<ol>
<li>車子 - 沒user Cases</li>
<li>Parking Lot ‘s features’<ul>
<li>Get available count</li>
<li>Park vehicle</li>
<li>Clear spot</li>
<li>Calculate price</li>
</ul>
</li>
<li>Spot <ul>
<li>N/A </li>
</ul>
</li>
</ol>
<h3 id="Management-常見-User-Case"><a href="#Management-常見-User-Case" class="headerlink" title="Management 常見 User Case:"></a>Management 常見 User Case:</h3><ul>
<li>Reservation: X</li>
<li><strong>Serve: Park vehicle</strong></li>
<li><strong>Check out: Clear spot + Calculate price</strong></li>
</ul>
<h2 id="Class-1"><a href="#Class-1" class="headerlink" title="Class"></a>Class</h2><ul>
<li>What, Why – 可交遞的東西, How – ?</li>
</ul>
<p>​    </p>
<table>
<thead>
<tr>
<th align="center">Use Cases</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><em>Get available count</em></td>
</tr>
<tr>
<td align="center">Park vehicle</td>
</tr>
<tr>
<td align="center">Clear Spot</td>
</tr>
<tr>
<td align="center">Calculate price</td>
</tr>
</tbody></table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">  class Vehicle &#123;</span><br><span class="line">  	- int size</span><br><span class="line">  &#125;</span><br><span class="line">	class ParkingLot &#123;</span><br><span class="line">		- List&lt;Level&gt; levels</span><br><span class="line">		- int availableCount</span><br><span class="line">	&#125;</span><br><span class="line">	class Level &#123;</span><br><span class="line">		- List&lt;Spot&gt; spots</span><br><span class="line">		- int availableCount</span><br><span class="line">	&#125;</span><br><span class="line">	class Spot &#123;</span><br><span class="line">		- boolean available</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	Vehicle: + int getSize()</span><br><span class="line">	ParkingLot: + int getAvailableCount()</span><br><span class="line">	ParkingLot: + List&lt;Spot&gt; findSpotsForBus(Bus b)</span><br><span class="line">	ParkingLot: + List&lt;Spot&gt; findSpotsForBus(Car c)</span><br><span class="line">  ParkingLot: + List&lt;Spot&gt; findSpotsForBus(Motorcycle m)</span><br><span class="line">	Level: + int getAvailableCount()</span><br><span class="line">	Spot: + boolean isAvailable()</span><br></pre></td></tr></table></figure>



<h3 id="Use-Case-Get-available-counts"><a href="#Use-Case-Get-available-counts" class="headerlink" title="Use Case: Get available counts"></a>Use Case: Get available counts</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class ParkingLot</span><br><span class="line">	ParkingLot: - List&lt;Car&gt; cars</span><br><span class="line">	ParkingLot: - int availableCountLevelOne</span><br><span class="line">	ParkingLot: - int availableCountLevelTwo</span><br><span class="line">	ParkingLot: + int getAvailableCountLevelOne()</span><br><span class="line">	ParkingLot: + int getAvailableCountLevelTwo()</span><br></pre></td></tr></table></figure>

<p>違背 O 原則</p>
<ul>
<li>比較好是建一個Level類來管理。</li>
</ul>
<blockquote>
<h5 id="单选题-视频中Bus，Car，Motorcycle的抽象类Vehicle有哪些成员变量和成员函数，如何定义？"><a href="#单选题-视频中Bus，Car，Motorcycle的抽象类Vehicle有哪些成员变量和成员函数，如何定义？" class="headerlink" title="[单选题]视频中Bus，Car，Motorcycle的抽象类Vehicle有哪些成员变量和成员函数，如何定义？"></a>[单选题]视频中Bus，Car，Motorcycle的抽象类Vehicle有哪些成员变量和成员函数，如何定义？</h5><p>A.<code>- int size,+ int getSize()</code>8.05% 选择</p>
<p>B.<code># int size,+ int getSize()</code>87.71% 选择</p>
<p>C.<code>- int size, # int getSize()</code>4.24% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是B</p>
<p><strong>正确答案:</strong>B</p>
</blockquote>
<h3 id="Use-Case-Park-vehicle"><a href="#Use-Case-Park-vehicle" class="headerlink" title="Use Case: Park vehicle"></a>Use Case: Park vehicle</h3><ul>
<li>parkinglot checks the size of vehicle</li>
<li>parkinglot find an available spot for this vehicle </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	Vehicle &lt;|-- Bus: Inheritance</span><br><span class="line">	Vehicle &lt;|-- Car: Inheritance</span><br><span class="line">	Vehicle &lt;|-- Motorcycle: Inheritance  </span><br><span class="line">  class Vehicle &#123;</span><br><span class="line">  	# int size</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">	Vehicle: + getSize()</span><br><span class="line">	</span><br><span class="line">	class ParkingLot&#123;</span><br><span class="line">		- List&lt;Level&gt; levels</span><br><span class="line">	&#125;</span><br><span class="line">	ParkingLot: + int getAvailableCount()</span><br><span class="line">	ParkingLot: - List&lt;Spot&gt; findSpotsForVehicle(Vehicle v)</span><br><span class="line">	ParkingLot: + void parkVehicle(Vehicle v)</span><br></pre></td></tr></table></figure>

<p>findSpotsForVehicle 只會被內部的 parkVehicle所調用，所以可設為是private</p>
<p>parkVehicle 成功還是失敗？最好的是加個Exception, 如 fullException。返回 T/F 不好；不同的Engineer看會有不同的理解，而且是二元的，只能handle兩種情況，所以避免用 bool，而是用Exception。</p>
<h3 id="Use-Case-Clear-spot"><a href="#Use-Case-Clear-spot" class="headerlink" title="Use Case: Clear spot"></a>Use Case: Clear spot</h3><ul>
<li><p>Parking lot find the spot to clear</p>
</li>
<li><p>Solution1: vehicle 找到車位，由Car作調用 –&gt; 不合理</p>
</li>
<li><p><strong>Solution with Receipt:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Ticket&#123; </span><br><span class="line">		- Vehicle v</span><br><span class="line">		- List&lt;Spot&gt; spots</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class ParkingLot&#123;</span><br><span class="line">		- List&lt;Level&gt; levels</span><br><span class="line">	&#125;</span><br><span class="line">	ParkingLot: + int getAvailableCount()</span><br><span class="line">	ParkingLot: - List&lt;Spot&gt; findSpotsForVehicle(Vehicle v)</span><br><span class="line">	ParkingLot: + Ticket parkVehicle(Vehicle v)	</span><br><span class="line">	ParkingLot: + void clearSpot(Ticket t)</span><br></pre></td></tr></table></figure>

<p>Bus需要三個車位；如果是車位不同大小的話，就就是改成把Spot用Inheritance處理</p>
<p>現在是Spot都一樣的，所以就是在停的時候也要找附近可以的車位</p>
<p>private function – findSpotsForVehicle 可以不重要，重要的是public的</p>
</li>
<li><p>客人對到幾號桌？ –&gt; 存到 receipt</p>
</li>
</ul>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Ticket&#123; </span><br><span class="line">		- Vehicle v</span><br><span class="line">		- List&lt;Spot&gt; spots</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class ParkingLot&#123;</span><br><span class="line">		- List&lt;Level&gt; levels</span><br><span class="line">	&#125;</span><br><span class="line">	ParkingLot: + int getAvailableCount()</span><br><span class="line">	ParkingLot: - List&lt;Spot&gt; findSpotsForVehicle(Vehicle v)</span><br><span class="line">	ParkingLot: + Ticket parkVehicle(Vehicle v)	</span><br><span class="line">	ParkingLot: + void clearSpot(Ticket t)</span><br></pre></td></tr></table></figure>

<h3 id="Use-Case-Calculate"><a href="#Use-Case-Calculate" class="headerlink" title="Use Case: Calculate $"></a>Use Case: Calculate $</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Ticket&#123; </span><br><span class="line">		- Vehicle v</span><br><span class="line">		- List&lt;Spot&gt; spots</span><br><span class="line">		- Time startTime</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class ParkingLot&#123;</span><br><span class="line">		- List&lt;Level&gt; levels</span><br><span class="line">		- float hourlyRate</span><br><span class="line">	&#125;</span><br><span class="line">	ParkingLot: + int getAvailableCount()</span><br><span class="line">	ParkingLot: - List&lt;Spot&gt; findSpotsForVehicle(Vehicle v)</span><br><span class="line">	ParkingLot: + Ticket parkVehicle(Vehicle v)	</span><br><span class="line">	ParkingLot: + void clearSpot(Ticket t)</span><br><span class="line">	ParkingLot: - float calculatePrice(Ticket t)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span>  <span class="title">calculatePrice</span>:</span></span><br><span class="line">	retun (time - startTime) * hourlyRate</span><br></pre></td></tr></table></figure>

<p>availableCount 不等於 spotCount</p>
<p>bus要找到三個在一起的空的才可以</p>
<ul>
<li>主人公是 Parkinglot 的視角</li>
</ul>
<h2 id="Correctness"><a href="#Correctness" class="headerlink" title="Correctness"></a>Correctness</h2><ul>
<li>Valid use cases</li>
<li>follow good practice, e.g. <ul>
<li>access modifier: private, public</li>
<li>exception: invalid ticket; fullParkingLot</li>
</ul>
</li>
<li>SOLID</li>
<li>Design Pattern</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class ParkingLotFullException&#123; </span><br><span class="line">	&#125;</span><br><span class="line">	class InvalidTicketException</span><br></pre></td></tr></table></figure>

<ul>
<li>每層的spots 怎麼排列？<ul>
<li>Sol1: 每行的都一樣，未考慮到畸零地或柱子</li>
<li>Sol2: Parkinglot =&gt; level =&gt; Row =&gt; Spot</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	class Spot&#123; </span><br><span class="line">		- boolean available</span><br><span class="line">		- Level l</span><br><span class="line">		+ boolean isAvailable()</span><br><span class="line">		+ void takeSpot()</span><br><span class="line">    + void leaveSpot()</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Level&#123;</span><br><span class="line">		- List&lt;Row&gt; rows</span><br><span class="line">		- int availableCount</span><br><span class="line">		+ int getAvailableCount()</span><br><span class="line">		+ voidi updateAvailableCount(int diff)</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class Row &#123;</span><br><span class="line">		- List&lt;Spot&gt; spots</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<h1 id="ParkingLot-in-Action"><a href="#ParkingLot-in-Action" class="headerlink" title="ParkingLot in Action"></a>ParkingLot in Action</h1><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gey7yd5u2nj30u207yaez.jpg" alt="image-20200520002106057" style="zoom:67%;" />

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gey7ybe0e7j30u207yaez.jpg" alt="image-20200520002124925" style="zoom:50%;" />





<h1 id="Singleton"><a href="#Singleton" class="headerlink" title="Singleton"></a>Singleton</h1><blockquote>
<h5 id="单选题-类中的成员在加上static修饰后，它会如何变化，下面哪句话是正确的："><a href="#单选题-类中的成员在加上static修饰后，它会如何变化，下面哪句话是正确的：" class="headerlink" title="[单选题]类中的成员在加上static修饰后，它会如何变化，下面哪句话是正确的："></a>[单选题]类中的成员在加上static修饰后，它会如何变化，下面哪句话是正确的：</h5><p>A.static关键字会改变类中成员的访问权限。6.29% 选择</p>
<p>B.static是修饰类的属性和方法，让他们成为属于类的成员属性和方法。71.46% 选择</p>
<p>C.static修饰的类的属性或者方法，这些属性或者方法它还是属于实例。22.25% 选择</p>
<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTM0MTgxMjgxODM5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjM3NjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxOC4xMiA1MTYuMTZtLTQ5MCAwYTQ5MCA0OTAgMCAxIDAgOTgwIDAgNDkwIDQ5MCAwIDEgMC05ODAgMFoiIGZpbGw9IiM1NkI0MzIiIHAtaWQ9IjM3NjMiPjwvcGF0aD48cGF0aCBkPSJNMzkzLjIxMzYxOSA2NjQuMzM1NDk1bTI4LjI4NDI3MS0yOC4yODQyNzFsMjk2Ljk4NDg0OS0yOTYuOTg0ODQ4cTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBsMCAwcTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDJsLTI5Ni45ODQ4NDggMjk2Ljk4NDg0OHEtMjguMjg0MjcxIDI4LjI4NDI3MS01Ni41Njg1NDMgMGwwIDBxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDJaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY0Ij48L3BhdGg+PHBhdGggZD0iTTI4OS40Njk4NCA0NTIuODQ3ODgzbTI4LjI4NDI3MSAyOC4yODQyNzFsMTU1LjU2MzQ5MiAxNTUuNTYzNDkycTI4LjI4NDI3MSAyOC4yODQyNzEgMCA1Ni41Njg1NDNsMCAwcS0yOC4yODQyNzEgMjguMjg0MjcxLTU2LjU2ODU0MyAwbC0xNTUuNTYzNDkxLTE1NS41NjM0OTJxLTI4LjI4NDI3MS0yOC4yODQyNzEgMC01Ni41Njg1NDNsMCAwcTI4LjI4NDI3MS0yOC4yODQyNzEgNTYuNTY4NTQyIDBaIiBmaWxsPSIjRkZGRkZGIiBwLWlkPSIzNzY1Ij48L3BhdGg+PC9zdmc+" alt="img">答对了，您选择的答案是B</p>
<p><strong>正确答案:</strong>B</p>
<p><strong>解析:</strong></p>
<p>解析：被static修饰的类的变量或者方法它是属于类的，而并不属于某一个具体的实例。static方法一般称作静态方法,对于静态方法来说，是没有this的，因为它不依附于任何对象。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParkingLot</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> List&lt;Level&gt; levels;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ParkingLot</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		levels = <span class="keyword">new</span> ArrayList&lt;Level&gt;();	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gey7ygky3bj30pi0jqqcz.jpg" alt="image-20200519224834175" style="zoom:50%;" />



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">classDiagram</span><br><span class="line">	SingletonPatternDemo --|&gt; SingleObject : asks</span><br><span class="line">	SingleObject -- SingletonPatternDemo</span><br><span class="line">	class SingletonPatternDemo &#123;</span><br><span class="line">		+ main(): void</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	class SingleObject &#123;</span><br><span class="line">		- instance: SingleObject</span><br><span class="line">		- SingleObject()</span><br><span class="line">		+ SingleObject getInstance()</span><br><span class="line">		+ void showMessage()</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">publist <span class="class"><span class="keyword">class</span> <span class="title">ParkingLot</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> ParkingLot _instance = <span class="keyword">null</span>;</span><br><span class="line">  <span class="keyword">private</span> List&lt;Level&gt; levels;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">ParkingLot</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    levels = <span class="keyword">new</span> ArrayList&lt;Level&gt;();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ParkingLot <span class="title">getInstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (_instance == <span class="keyword">null</span>)</span><br><span class="line">    &#123;  </span><br><span class="line">     	_instance = <span class="keyword">new</span> ParkingLot(); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>static –  和class associate在一起，而不是和instance綁一起的</li>
<li>因為getInstance要去訪問 _instance，所以 _instance得也要是static</li>
</ul>
<h4 id="Thread-Safe"><a href="#Thread-Safe" class="headerlink" title="Thread Safe"></a>Thread Safe</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">publist <span class="class"><span class="keyword">class</span> <span class="title">ParkingLot</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> ParkingLot _instance = <span class="keyword">null</span>;</span><br><span class="line">  <span class="keyword">private</span> List&lt;Level&gt; levels;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">ParkingLot</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    levels = <span class="keyword">new</span> ArrayList&lt;Level&gt;();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> ParkingLot <span class="title">getInstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (_instance == <span class="keyword">null</span>)</span><br><span class="line">    &#123;  </span><br><span class="line">     	_instance = <span class="keyword">new</span> ParkingLot(); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以免由於多線程生成兩個不同的，安全但不夠有效率</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">publist <span class="class"><span class="keyword">class</span> <span class="title">ParkingLot</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">ParkingLot</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">LazyParkingLot</span></span></span><br><span class="line"><span class="class">  </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> ParkingLot _instance = <span class="keyword">new</span> ParkingLot();</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ParkingLot <span class="title">getInstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> LazyParkingLot._instance;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>當類是static, 在build time就會把類裡的東西執行一次</p>
<p>​    <em>static final ParkingLot _instance = new ParkingLot();</em></p>
<p>這句話就已被執行了</p>
<h1 id="Law-of-Demeter"><a href="#Law-of-Demeter" class="headerlink" title="Law of Demeter"></a>Law of Demeter</h1><p>迪米特法則</p>
<p>在做OOD時的新法則，不在SOLID裡，但這個是新被重視的</p>
<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gey7yjmqqlj30oq0ru43l.jpg" alt="image-20200519225500096" style="zoom:33%;" />

<p>VS. </p>
<p>correct as following:</p>
<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gey7yn06vrj30hy0k4q3y.jpg" alt="image-20200519225632424" style="zoom:33%;" />

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/05/06/Data-Structure/SegmentTree/">Data-Structure/SegmentTree</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-05-06</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Languages/">Languages</a></span><div class="content"><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>查詢時將區間映射到樹上的各個節點並取出值作比節，達到 lg(N) 的級別。</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1geimzfa16cj31620oah0o.jpg" alt="image-20200506125234854"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class SegmentTreeNode &#123;</span><br><span class="line">    public int start, end, max;</span><br><span class="line">    public SegmentTreeNode left, right;</span><br><span class="line">    public SegmentTreeNode(int start, int end, int max) &#123;</span><br><span class="line">        this.start = start;</span><br><span class="line">        this.end = end;</span><br><span class="line">        this.max = max</span><br><span class="line">        this.left = this.right = null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>首先线段树是<code>一棵二叉树</code>, 平常我们所指的线段树都是指一维线段树。 故名思义, 线段树能解决的是线段上的问题, 这个线段也可指<code>区间</code>.<br>我们先来看线段树的逻辑结构。</p>
<p>一颗线段树的构造就是根据区间的性质的来构造的, 如下是一棵区间<code>[0, 3]</code>的线段树，每个<code>[start, end]</code>都是一个二叉树中的节点。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         [0,3]</span><br><span class="line">        &#x2F;     \</span><br><span class="line">   [0,1]       [2,3]</span><br><span class="line">   &#x2F;   \       &#x2F;   \</span><br><span class="line">[0,0] [1,1] [2,2] [3,3]</span><br></pre></td></tr></table></figure>

<p>区间划分大概就是上述的区间划分。可以看出每次都将区间的长度一分为二,数列长度为n,所以线段树的高度是<code>log(n)</code>,这是很多高效操作的基础。<br>上述的区间存储的只是区间的左右边界。我们可以将区间的最大值加入进来,也就是树中的Node需要存储left，right左右子节点外，还需要存储<code>start, end, val</code>区间的范围和区间内表示的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">            [0,3]</span><br><span class="line">           (val&#x3D;4)</span><br><span class="line">         &#x2F;         \</span><br><span class="line">     [0,1]         [2,3]</span><br><span class="line">    (val&#x3D;4)       (val&#x3D;3)</span><br><span class="line">    &#x2F;    \         &#x2F;    \</span><br><span class="line"> [0,0]  [1,1]   [2,2]  [3,3]</span><br><span class="line">(val&#x3D;1)(val&#x3D;4) (val&#x3D;2)(val&#x3D;3)</span><br></pre></td></tr></table></figure>

<p>区间的第三维就是区间的最大值。<br>加这一维的时候只需要在建完了左右区间之后，根据左右区间的最大值来更新当前区间的最大值即可，即当前子树的最大值是左子树的最大和右子树的最大值里面选出来的最大值。</p>
<p>因为每次将区间的长度一分为二,所有创造的节点个数，即底层有n个节点，那么倒数第二次约n/2个节点，倒数第三次约n/4个节点，依次类推：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    n + 1&#x2F;2 * n + 1&#x2F;4 * n + 1&#x2F;8 * n + ...</span><br><span class="line">&#x3D;   (1 + 1&#x2F;2 + 1&#x2F;4 + 1&#x2F;8 + ...) * n</span><br><span class="line">&#x3D;   2n</span><br><span class="line">所以构造线段树的时间复杂度和空间复杂度都为O(n)</span><br></pre></td></tr></table></figure></blockquote>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/63/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/63/">63</a><span class="page-number current">64</span><a class="page-number" href="/page/65/">65</a><span class="space">&hellip;</span><a class="page-number" href="/page/79/">79</a><a class="extend next" rel="next" href="/page/65/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2023 By Joe Huang</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>