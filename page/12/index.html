<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="Joe Huang"><meta name="copyright" content="Joe Huang"><title>Awaken Desparado</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-180692466-1', 'auto');
ga('send', 'pageview');</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.2.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Joe Huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">363</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">25</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">60</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Awaken Desparado</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Awaken Desparado</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/24/Musics/2020-02-24-N_Beats_Examples_and_ByteDance/">Musics/2020-02-24-N_Beats_Examples_and_ByteDance</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-24</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Music/">Music</a></span><div class="content"><h2 id="N-Beats-amp-Examples"><a href="#N-Beats-amp-Examples" class="headerlink" title="N Beats &amp; Examples"></a>N Beats &amp; Examples</h2><table>
<thead>
<tr>
<th>Beats</th>
<th>♩= Speed</th>
<th>Player</th>
<th>Music</th>
<th>Style</th>
</tr>
</thead>
<tbody><tr>
<td><strong><a href="#8Beats">8 Beats</a></strong></td>
<td>♩＝87</td>
<td>Cold Play</td>
<td>Yellow</td>
<td>另类摇滚</td>
</tr>
<tr>
<td></td>
<td>♩＝106</td>
<td>Green Day</td>
<td>Wake Me Up When September Ends</td>
<td><a name="rock"><strong>摇滚</strong></a></td>
</tr>
<tr>
<td></td>
<td>♩=128</td>
<td>Muse</td>
<td>Can’t Take My Eyes off You</td>
<td>前卫摇滚 (此外，这首被不同 Player 改成过很多种不同曲风及不同Beats, 经典)</td>
</tr>
<tr>
<td></td>
<td>♩＝125</td>
<td>Cranberry</td>
<td>Dreams</td>
<td>另类摇滚</td>
</tr>
<tr>
<td></td>
<td>♩＝82</td>
<td>Cranberry</td>
<td>Zombie</td>
<td>摇滚 + 民谣</td>
</tr>
<tr>
<td></td>
<td>♩＝74</td>
<td>MayDay</td>
<td>温柔</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩＝97</td>
<td>RHCP</td>
<td>Dani California</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩=126</td>
<td>Kylie Minoque</td>
<td>Can’t Get You Out of My Head</td>
<td>流行舞曲, Techno</td>
</tr>
<tr>
<td>(8 Beats, 但16也OK)</td>
<td>♩=100</td>
<td>Sixpence None the Richer</td>
<td>Kiss Me</td>
<td></td>
</tr>
<tr>
<td><strong><a href="#16Beats">16 Beats</a></strong></td>
<td>♩=95</td>
<td>Venessa Carlton</td>
<td>A Thousand Miles</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩=96</td>
<td>Natalie Imbruglia</td>
<td>Torn</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩=94</td>
<td>D’Sound</td>
<td>Play Me The Song</td>
<td>Fusion</td>
</tr>
<tr>
<td></td>
<td>♩=90</td>
<td>The Black Eyed Peas</td>
<td>Don’t Lie</td>
<td>舞曲, Pop, Rap</td>
</tr>
<tr>
<td></td>
<td>♩=94</td>
<td>Joss Stone</td>
<td>Super Duper Love</td>
<td></td>
</tr>
<tr>
<td>12 Beats</td>
<td>♩=120</td>
<td></td>
<td>小叮噹</td>
<td>Swing</td>
</tr>
<tr>
<td></td>
<td>♩＝147</td>
<td>西洋老歌</td>
<td>You Are My Sunshine</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩=66</td>
<td>Whitney Houston</td>
<td>Saving All My Love For You</td>
<td>Slow Rock; Jazz + Pop</td>
</tr>
<tr>
<td></td>
<td>♩=53</td>
<td>Gary Moore</td>
<td>Still Got The Blues</td>
<td>抒情蓝调</td>
</tr>
<tr>
<td>24 Beat</td>
<td>♩=89</td>
<td>Maroon5</td>
<td>Sunday Morning</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩=70</td>
<td>Westlife</td>
<td>Easy</td>
<td></td>
</tr>
<tr>
<td></td>
<td>♩=77</td>
<td>Macy Gary</td>
<td>I Try</td>
<td></td>
</tr>
</tbody></table>
<h3 id="4-4-拍："><a href="#4-4-拍：" class="headerlink" title="4/4 拍："></a><strong>4/4 拍：</strong></h3><ul>
<li><p><strong>4 Beats</strong> - 猪头,  1,     2,     3,     4</p>
</li>
<li><p><strong><a name="8Beats">8 Beats</a></strong> - 舞者，1n,     2n,     3n,     4n</p>
</li>
<li><p><strong><a name="16Beats">16 Beats</a></strong> - 鼓手, <strong><u>1</u></strong>234,     <u><strong>2</strong></u>234,     <strong><u>3</u></strong>234,     <u><strong>4</strong></u>234</p>
</li>
<li><p><strong><a name="24Beats">24 Beats</a></strong> </p>
</li>
</ul>
<h3 id="12-8-拍"><a href="#12-8-拍" class="headerlink" title="12/8 拍:"></a><strong>12/8 拍:</strong></h3><ul>
<li><strong>12 Beats</strong> - 像是 12/8 的音乐</li>
</ul>
<h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><strong>Speed 60</strong></td>
<td>♩＝ 64</td>
<td>LeAnn Rimes</td>
<td>How Do I Live</td>
</tr>
<tr>
<td><strong>Speed 140</strong></td>
<td>♩＝ 135</td>
<td>Roxette</td>
<td>Sleeping In My Car</td>
</tr>
<tr>
<td><strong>Speed 160</strong></td>
<td>♩＝160</td>
<td>Lindsay</td>
<td>Ultimate</td>
</tr>
<tr>
<td></td>
<td>♩＝159</td>
<td>金亚中</td>
<td>Maria</td>
</tr>
<tr>
<td></td>
<td>♩＝154</td>
<td>中岛美嘉</td>
<td>Glamorous Sky</td>
</tr>
<tr>
<td><a href="#rock"><strong>摇滚补充</strong></a></td>
<td></td>
<td>Avril Lavigne</td>
<td>Complicated<br/>My happy ending, 8 beats, ♩= 85<br/>Take Me Away<br/>Together<br/>Nobodys home</td>
</tr>
</tbody></table>
<h2 id="抖音"><a href="#抖音" class="headerlink" title="抖音"></a>抖音</h2><table>
<thead>
<tr>
<th>Beats</th>
<th>程式算出的Beats数</th>
<th>♩= Speed</th>
<th>Player</th>
<th>Song</th>
<th></th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>8 Beats</td>
<td>4</td>
<td>♩＝89</td>
<td>阿冗</td>
<td><strong>你的答案</strong></td>
<td></td>
<td>向着风，拥抱彩虹，勇敢的向前走</td>
</tr>
<tr>
<td>8 Beats</td>
<td>8</td>
<td>♩＝66</td>
<td>程响</td>
<td>世界这么大还是遇见你</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats or Single 16 Beats</td>
<td>8</td>
<td>♩＝66</td>
<td>司南</td>
<td>冬眠</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>4</td>
<td>♩＝128</td>
<td>R3hab</td>
<td>All Comes Back to You</td>
<td>电子舞曲</td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>4</td>
<td>♩＝110</td>
<td>Zico</td>
<td>Any Song (아무노래)</td>
<td>舞曲吧… 这首很特别</td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>4</td>
<td>♩＝100</td>
<td>阿悠悠</td>
<td>你若三冬</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>4</td>
<td>♩＝80</td>
<td>要不要买菜</td>
<td>下山</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>8</td>
<td>♩＝81</td>
<td>锦零</td>
<td>桃花笑</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>这个我重听</td>
<td>♩＝120</td>
<td>罗隽永</td>
<td>处处吻</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>8</td>
<td>♩＝66</td>
<td>八三夭</td>
<td><strong>想见你想见你想见你</strong></td>
<td>抒情</td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>4</td>
<td>♩＝90</td>
<td>孫子涵</td>
<td>是你啊</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>8</td>
<td>♩＝72</td>
<td>棉子</td>
<td>勇气</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>未跑</td>
<td>♩＝79</td>
<td>张韶涵</td>
<td>红红的太阳</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td>8</td>
<td>♩＝66</td>
<td>王二浪</td>
<td><strong>往后余生</strong></td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td></td>
<td>♩＝120</td>
<td>卢鑫玉浩</td>
<td>今天我要戴口罩</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td></td>
<td>♩＝108</td>
<td>Mesto</td>
<td>Leyla (Official Music Video)</td>
<td>舞曲/电子</td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td></td>
<td>♩＝83</td>
<td>李昕融</td>
<td>听我说谢谢你</td>
<td></td>
<td></td>
</tr>
<tr>
<td>8 Beats</td>
<td></td>
<td>♩＝81</td>
<td>李超</td>
<td>不放弃</td>
<td></td>
<td></td>
</tr>
<tr>
<td>More</td>
<td></td>
<td>More</td>
<td>More</td>
<td>More</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>我猜程式会跑出8Beats</td>
<td>♩＝70</td>
<td>柏松</td>
<td>世界美好与你环环相扣</td>
<td>抒情</td>
<td></td>
</tr>
<tr>
<td></td>
<td>我猜程式会跑出8Beats</td>
<td>♩＝80</td>
<td>林俊杰</td>
<td>可惜没如果</td>
<td>流行</td>
<td></td>
</tr>
<tr>
<td></td>
<td>我猜程式会跑出4Beats</td>
<td>♩＝123</td>
<td></td>
<td>无中生有</td>
<td>舞曲</td>
<td></td>
</tr>
<tr>
<td></td>
<td>我猜程式会跑出8Beats</td>
<td>♩＝53</td>
<td>张宇</td>
<td>囚鸟</td>
<td>流行</td>
<td></td>
</tr>
<tr>
<td></td>
<td>我猜程式会跑出4Beats</td>
<td>♩＝68</td>
<td>柏松</td>
<td>器张</td>
<td>抒情</td>
<td></td>
</tr>
</tbody></table>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/21/Pandas/2015-02-21-Pandas%20review/">Pandas/2015-02-21-Pandas review</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-21</time><div class="content"><h4 id="layout-post"><a href="#layout-post" class="headerlink" title="layout: post"></a>layout: post</h4><p>categories: Pandas<br>tag: []<br>date: 2015-02-21</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;</span><br><span class="line">  <span class="string">'Product ID'</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">  <span class="comment"># add Product Name and Color here</span></span><br><span class="line">  <span class="string">'Product Name'</span>:[<span class="string">'t-shirt'</span>, <span class="string">'t-shirt'</span>, <span class="string">'skirt'</span>, <span class="string">'skirt'</span>], </span><br><span class="line">  <span class="string">'Color'</span>:[<span class="string">'blue'</span>, <span class="string">'green'</span>, <span class="string">'red'</span>, <span class="string">'black'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4f7b94uej30py09qdg6.jpg" alt="image-20200221230441471" style="zoom:50%;" />

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df2 = pd.DataFrame([</span><br><span class="line">  [<span class="number">1</span>, <span class="string">'San Diego'</span>, <span class="number">100</span>],</span><br><span class="line">  [<span class="number">2</span>, <span class="string">'Los Angeles'</span>, <span class="number">120</span>],</span><br><span class="line">  <span class="comment"># Fill in rows 3 and 4</span></span><br><span class="line">  [<span class="number">3</span>, <span class="string">'San Francisco'</span>, <span class="number">90</span>],</span><br><span class="line">  [<span class="number">4</span>, <span class="string">'Sacramento'</span>, <span class="number">115</span>],</span><br><span class="line">],</span><br><span class="line">  columns=[</span><br><span class="line">    <span class="comment">#add column names here</span></span><br><span class="line">    <span class="string">'Store ID'</span>, <span class="string">'Location'</span>, <span class="string">'Number of Employees'</span></span><br><span class="line">  ])</span><br><span class="line"></span><br><span class="line">print(df2)</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4f7o819gj30pw0a8q3d.jpg" alt="image-20200221230502087" style="zoom: 50%;" />





<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4fgr9zz2j30xj0u0n2t.jpg" alt="image-20200221231348325" style="zoom:67%;" />



<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4flj5cvgj319q0ru44j.jpg" alt="image-20200221231823180" style="zoom:67%;" />

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">march = df.iloc[<span class="number">2</span>]	<span class="comment"># single row</span></span><br><span class="line">april_may_june = df.iloc[<span class="number">3</span>:<span class="number">6</span>]	<span class="comment"># multi row</span></span><br><span class="line">january = df[df.month == <span class="string">'January'</span>] <span class="comment"># condition, single row</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">month</th>
<th align="left">clinic_east</th>
<th align="left">clinic_north</th>
<th align="left">clinic_south</th>
<th>clinic_west</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">January</td>
<td align="left">100</td>
<td align="left">100</td>
<td align="left">23</td>
<td>100</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame([</span><br><span class="line">  [<span class="string">'January'</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">23</span>, <span class="number">100</span>],</span><br><span class="line">  [<span class="string">'February'</span>, <span class="number">51</span>, <span class="number">45</span>, <span class="number">145</span>, <span class="number">45</span>],</span><br><span class="line">  [<span class="string">'March'</span>, <span class="number">81</span>, <span class="number">96</span>, <span class="number">65</span>, <span class="number">96</span>],</span><br><span class="line">  [<span class="string">'April'</span>, <span class="number">80</span>, <span class="number">80</span>, <span class="number">54</span>, <span class="number">180</span>],</span><br><span class="line">  [<span class="string">'May'</span>, <span class="number">51</span>, <span class="number">54</span>, <span class="number">54</span>, <span class="number">154</span>],</span><br><span class="line">  [<span class="string">'June'</span>, <span class="number">112</span>, <span class="number">109</span>, <span class="number">79</span>, <span class="number">129</span>]],</span><br><span class="line">  columns=[<span class="string">'month'</span>, <span class="string">'clinic_east'</span>,</span><br><span class="line">           <span class="string">'clinic_north'</span>, <span class="string">'clinic_south'</span>,</span><br><span class="line">           <span class="string">'clinic_west'</span>])</span><br><span class="line"></span><br><span class="line">march_april = df[(df.month == <span class="string">'March'</span>) | (df.month == <span class="string">'April'</span>)]</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">month</th>
<th align="left">clinic_east</th>
<th align="left">clinic_north</th>
<th align="left">clinic_south</th>
<th align="left">clinic_west</th>
</tr>
</thead>
<tbody><tr>
<td align="left">2</td>
<td align="left">March</td>
<td align="left">81</td>
<td align="left">96</td>
<td align="left">65</td>
<td align="left">96</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">April</td>
<td align="left">80</td>
<td align="left">80</td>
<td align="left">54</td>
<td align="left">180</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">january_february_march = df[df.month.isin([<span class="string">'January'</span>, <span class="string">'February'</span>, <span class="string">'March'</span>])]</span><br><span class="line">print(january_february_march)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">month</th>
<th align="left">clinic_east</th>
<th align="left">clinic_north</th>
<th align="left">clinic_south</th>
<th>clinic_west</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">January</td>
<td align="left">100</td>
<td align="left">100</td>
<td align="left">23</td>
<td>100</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">February</td>
<td align="left">51</td>
<td align="left">45</td>
<td align="left">145</td>
<td>45</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">March</td>
<td align="left">81</td>
<td align="left">96</td>
<td align="left">65</td>
<td>96</td>
</tr>
</tbody></table>
<h3 id="setting-indices"><a href="#setting-indices" class="headerlink" title="setting indices"></a>setting indices</h3><table>
<thead>
<tr>
<th align="left"></th>
<th align="left">month</th>
<th align="left">clinic_east</th>
<th align="left">clinic_north</th>
<th align="left">clinic_south</th>
<th>clinic_west</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">February</td>
<td align="left">51</td>
<td align="left">45</td>
<td align="left">145</td>
<td>45</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">April</td>
<td align="left">80</td>
<td align="left">80</td>
<td align="left">54</td>
<td>180</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">June</td>
<td align="left">112</td>
<td align="left">109</td>
<td align="left">79</td>
<td>129</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df2 = df.loc[[<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(df2)</span></span><br><span class="line"></span><br><span class="line">df3 = df2.reset_index()</span><br><span class="line"></span><br><span class="line">print(df3)</span><br><span class="line"></span><br><span class="line">df2.reset_index(inplace = <span class="literal">True</span>, drop = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">print(df2)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">index</th>
<th align="left">month</th>
<th align="left">clinic_east</th>
<th align="left">clinic_north</th>
<th align="left">clinic_south</th>
<th align="left">clinic_west</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">February</td>
<td align="left">51</td>
<td align="left">45</td>
<td align="left">145</td>
<td align="left">45</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">3</td>
<td align="left">April</td>
<td align="left">80</td>
<td align="left">80</td>
<td align="left">54</td>
<td align="left">180</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">5</td>
<td align="left">June</td>
<td align="left">112</td>
<td align="left">109</td>
<td align="left">79</td>
<td align="left">129</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">month</th>
<th align="left">clinic_east</th>
<th align="left">clinic_north</th>
<th align="left">clinic_south</th>
<th align="left">clinic_west</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">February</td>
<td align="left">51</td>
<td align="left">45</td>
<td align="left">145</td>
<td align="left">45</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">April</td>
<td align="left">80</td>
<td align="left">80</td>
<td align="left">54</td>
<td align="left">180</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">June</td>
<td align="left">112</td>
<td align="left">109</td>
<td align="left">79</td>
<td align="left">129</td>
</tr>
</tbody></table>
<h2 id="Case-ShoeFly-com"><a href="#Case-ShoeFly-com" class="headerlink" title="Case : ShoeFly.com"></a>Case : ShoeFly.com</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">orders = pd.read_csv(<span class="string">'shoefly.csv'</span>)</span><br><span class="line">print(orders.iloc([:<span class="number">5</span>]))  <span class="comment"># check first 5 lines</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">id</th>
<th align="left">first_name</th>
<th align="left">last_name</th>
<th align="left">email</th>
<th align="left">shoe_type</th>
<th align="left">shoe_material</th>
<th align="left">shoe_color</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">54791</td>
<td align="left">Rebecca</td>
<td align="left">Lindsay</td>
<td align="left"><a href="mailto:RebeccaLindsay57@hotmail.com">RebeccaLindsay57@hotmail.com</a></td>
<td align="left">clogs</td>
<td align="left">faux-leather</td>
<td>black</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">53450</td>
<td align="left">Emily</td>
<td align="left">Joyce</td>
<td align="left"><a href="mailto:EmilyJoyce25@gmail.com">EmilyJoyce25@gmail.com</a></td>
<td align="left">ballet flats</td>
<td align="left">faux-leather</td>
<td>navy</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">91987</td>
<td align="left">Joyce</td>
<td align="left">Waller</td>
<td align="left"><a href="mailto:Joyce.Waller@gmail.com">Joyce.Waller@gmail.com</a></td>
<td align="left">sandals</td>
<td align="left">fabric</td>
<td>black</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">14437</td>
<td align="left">Justin</td>
<td align="left">Erickson</td>
<td align="left"><a href="mailto:Justin.Erickson@outlook.com">Justin.Erickson@outlook.com</a></td>
<td align="left">clogs</td>
<td align="left">faux-leather</td>
<td>red</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">79357</td>
<td align="left">Andrew</td>
<td align="left">Banks</td>
<td align="left"><a href="mailto:AB4318@gmail.com">AB4318@gmail.com</a></td>
<td align="left">boots</td>
<td align="left">leather</td>
<td>brown</td>
</tr>
</tbody></table>
<h3 id="Review"><a href="#Review" class="headerlink" title="Review"></a>Review</h3><p>You’ve completed the lesson! You’ve just learned the basics of working with a single table in Pandas, including:</p>
<ul>
<li>Create a table from scratch</li>
<li>Loading data from another file</li>
<li>Selecting certain rows or columns of a table</li>
</ul>
<p>Let’s practice what you’ve learned.</p>
<p>Instructions</p>
<p><strong>1.</strong></p>
<p>In this example, you’ll be the data analyst for ShoeFly.com, a fictional online shoe store. You’ve seen this data; now it’s your turn to work with it!</p>
<p>Load the data from <code>shoefly.csv</code> into the variable <code>orders</code>.</p>
<p>Hint</p>
<p>You’ll need to use <code>pd.read_csv</code>.</p>
<p><strong>2.</strong></p>
<p>Inspect the first 5 lines of the data.</p>
<p>Stuck? Get a hint</p>
<p><strong>3.</strong></p>
<p>Your marketing department wants to send out an email blast to everyone who ordered shoes!</p>
<p>Select all of the email addresses from the column <code>email</code> and save them to a variable called <code>emails</code>.</p>
<p>Stuck? Get a hint</p>
<p><strong>4.</strong></p>
<p>Frances Palmer claims that her order was wrong. What did Frances Palmer order?</p>
<p>Use logic to select that row of <code>orders</code> and save it to the variable <code>frances_palmer</code>.</p>
<p>Stuck? Get a hint</p>
<p><strong>5.</strong></p>
<p>We need some customer reviews for our comfortable shoes. Select all orders for <code>shoe_type</code>: <code>clogs</code>, <code>boots</code>, and <code>ballet flats</code> and save them to the variable <code>comfy_shoes</code>.</p>
<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4gjxbp5vj32380sin7i.jpg" alt="image-20200221235121135"></p>
<h2 id="Case-2"><a href="#Case-2" class="headerlink" title="Case 2:"></a>Case 2:</h2><p>Use the lambda function <code>get_last_name</code> to create a new column <code>last_name</code> with only the employees’ last name.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add columns here</span></span><br><span class="line">get_last_name = <span class="keyword">lambda</span> s: s.split()[<span class="number">-1</span>]</span><br><span class="line">df[<span class="string">'last_name'</span>] = df.name.apply(get_last_name)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">id</th>
<th align="left">name</th>
<th align="left">hourly_wage</th>
<th align="left">hours_worked</th>
<th>last_name</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">10310</td>
<td align="left">Lauren Durham</td>
<td align="left">19</td>
<td align="left">43</td>
<td>Durham</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">18656</td>
<td align="left">Grace Sellers</td>
<td align="left">17</td>
<td align="left">40</td>
<td>Sellers</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">61254</td>
<td align="left">Shirley Rasmussen</td>
<td align="left">16</td>
<td align="left">30</td>
<td>Rasmussen</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">16886</td>
<td align="left">Brian Rojas</td>
<td align="left">18</td>
<td align="left">47</td>
<td>Rojas</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">89010</td>
<td align="left">Samantha Mosley</td>
<td align="left">11</td>
<td align="left">38</td>
<td>Mosley</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">87246</td>
<td align="left">Louis Guzman</td>
<td align="left">14</td>
<td align="left">39</td>
<td>Guzman</td>
</tr>
</tbody></table>
<p>花俏。。，但就熟悉下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">total_earned = <span class="keyword">lambda</span> row: (row.hourly_wage * <span class="number">40</span>) + ((row.hourly_wage * <span class="number">1.5</span>) * (row.hours_worked - <span class="number">40</span>)) \</span><br><span class="line">	<span class="keyword">if</span> row.hours_worked &gt; <span class="number">40</span> \</span><br><span class="line">  <span class="keyword">else</span> row.hourly_wage * row.hours_worked</span><br><span class="line">  </span><br><span class="line">df[<span class="string">'total_earned'</span>] = df.apply(total_earned, axis = <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">id</th>
<th align="left">name</th>
<th align="left">hourly_wage</th>
<th align="left">hours_worked</th>
<th align="left">total_earned</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">10310</td>
<td align="left">Lauren Durham</td>
<td align="left">19</td>
<td align="left">43</td>
<td align="left">845.5</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">18656</td>
<td align="left">Grace Sellers</td>
<td align="left">17</td>
<td align="left">40</td>
<td align="left">680.0</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">61254</td>
<td align="left">Shirley Rasmussen</td>
<td align="left">16</td>
<td align="left">30</td>
<td align="left">480.0</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">16886</td>
<td align="left">Brian Rojas</td>
<td align="left">18</td>
<td align="left">47</td>
<td align="left">909.0</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">89010</td>
<td align="left">Samantha Mosley</td>
<td align="left">11</td>
<td align="left">38</td>
<td align="left">418.0</td>
</tr>
</tbody></table>
<h3 id="rename-column"><a href="#rename-column" class="headerlink" title="rename column"></a>rename column</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df.rename(columns=&#123;</span><br><span class="line">  <span class="string">'name'</span>: <span class="string">'movie_title'</span></span><br><span class="line">  &#125;, </span><br><span class="line">  inplace=<span class="literal">True</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>



<h2 id="Case-ShoeFly-com-1"><a href="#Case-ShoeFly-com-1" class="headerlink" title="Case ShoeFly.com"></a>Case ShoeFly.com</h2><h4 id="Add-Columns"><a href="#Add-Columns" class="headerlink" title="Add Columns"></a>Add Columns</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">orders[<span class="string">'shoe_source'</span>] = orders.shoe_material.apply(<span class="keyword">lambda</span> x: \</span><br><span class="line">                        	<span class="string">'animal'</span> <span class="keyword">if</span> x == <span class="string">'leather'</span><span class="keyword">else</span> <span class="string">'vegan'</span>)</span><br><span class="line"></span><br><span class="line">orders[<span class="string">'salutation'</span>] = orders.apply(<span class="keyword">lambda</span> row: \</span><br><span class="line">                                    <span class="string">'Dear Mr. '</span> + row[<span class="string">'last_name'</span>]</span><br><span class="line">                                    <span class="keyword">if</span> row[<span class="string">'gender'</span>] == <span class="string">'male'</span></span><br><span class="line">                                    <span class="keyword">else</span> <span class="string">'Dear Ms. '</span> + row[<span class="string">'last_name'</span>],</span><br><span class="line">                                    axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>



<h4 id="Pedal-Inventory"><a href="#Pedal-Inventory" class="headerlink" title="Pedal Inventory"></a>Pedal Inventory</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> codecademylib</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">inventory = pd.read_csv(<span class="string">'inventory.csv'</span>)</span><br><span class="line">print(inventory.head(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">staten_island = inventory[inventory[<span class="string">'location'</span>] == <span class="string">'Staten Island'</span>]</span><br><span class="line">print(staten_island.head(<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">product_request = staten_island[<span class="string">'product_description'</span>]</span><br><span class="line">print(product_request.head(<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">seed_request = inventory[(inventory.location == <span class="string">'Brooklyn'</span>) &amp; (inventory.product_type == <span class="string">'seeds'</span>)]</span><br><span class="line">print(seed_request.head(<span class="number">4</span>))</span><br><span class="line"><span class="comment"># print(inventory[inventory['location'] == 'Brooklyn' and inventory.product_type == 'seeds'])</span></span><br><span class="line"></span><br><span class="line">inventory[<span class="string">'in_stock'</span>] = inventory.quantity.apply(<span class="keyword">lambda</span> val: <span class="literal">True</span> <span class="keyword">if</span> val &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="literal">False</span>)</span><br><span class="line">print(inventory.head(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">inventory[<span class="string">'total_value'</span>] = inventory.apply(<span class="keyword">lambda</span> row: row.price * row.quantity, axis=<span class="number">1</span>)</span><br><span class="line">print(inventory.head(<span class="number">7</span>))</span><br><span class="line"></span><br><span class="line">combine_lambda = <span class="keyword">lambda</span> row: \</span><br><span class="line">    <span class="string">'&#123;&#125; - &#123;&#125;'</span>.format(row.product_type,</span><br><span class="line">                     row.product_description)</span><br><span class="line"></span><br><span class="line">inventory[<span class="string">'full_description'</span>] = inventory.apply(combine_lambda,</span><br><span class="line">                                               axis=<span class="number">1</span>)</span><br><span class="line">print(inventory.head(<span class="number">9</span>))</span><br></pre></td></tr></table></figure>



</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/21/LC/2020-02-22-LC%20SQL%20Easy/">LC/2020-02-22-LC SQL Easy</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/LC/">LC</a></span><div class="content"><h4 id="175-Combine-Two-Tables"><a href="#175-Combine-Two-Tables" class="headerlink" title="175. Combine Two Tables"></a>175. Combine Two Tables</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| PersonId    | int     |</span><br><span class="line">| FirstName   | varchar |</span><br><span class="line">| LastName    | varchar |</span><br><span class="line">+-------------+---------+</span><br><span class="line">PersonId is the primary key column for this table.</span><br></pre></td></tr></table></figure>

<p>Table: <code>Address</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+-------------+---------+</span><br><span class="line">| Column Name | Type    |</span><br><span class="line">+-------------+---------+</span><br><span class="line">| AddressId   | int     |</span><br><span class="line">| PersonId    | int     |</span><br><span class="line">| City        | varchar |</span><br><span class="line">| State       | varchar |</span><br><span class="line">+-------------+---------+</span><br><span class="line">AddressId is the primary key column for this table.</span><br></pre></td></tr></table></figure>

<p>Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for each of those people:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> FirstName, LastName, City, State</span><br><span class="line"><span class="keyword">FROM</span> Person </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Address</span><br><span class="line"><span class="keyword">ON</span> Person.PersonId = Address.PersonId</span><br></pre></td></tr></table></figure>



<h4 id="176-Second-Highest-Salary"><a href="#176-Second-Highest-Salary" class="headerlink" title="176. Second Highest Salary"></a>176. Second Highest Salary</h4><p>For example, given the above Employee table, the query should return <code>200</code> as the second highest salary. If there is no second highest salary, then the query should return <code>null</code>.</p>
<p>Write a SQL query to get the second highest salary from the <code>Employee</code> table.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+----+--------+</span><br><span class="line">| Id | Salary |</span><br><span class="line">+----+--------+</span><br><span class="line">| 1  | 100    |</span><br><span class="line">| 2  | 200    |</span><br><span class="line">| 3  | 300    |</span><br><span class="line">+----+--------+</span><br></pre></td></tr></table></figure>

<p>For example, given the above Employee table, the query should return <code>200</code> as the second highest salary. If there is no second highest salary, then the query should return <code>null</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+---------------------+</span><br><span class="line">| SecondHighestSalary |</span><br><span class="line">+---------------------+</span><br><span class="line">| 200                 |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(a.Salary) <span class="keyword">AS</span> SecondHighestSalary</span><br><span class="line"><span class="keyword">FROM</span> Employee <span class="keyword">AS</span> a</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> Employee <span class="keyword">as</span> b</span><br><span class="line"><span class="keyword">ON</span> a.Salary &lt; b.Salary</span><br></pre></td></tr></table></figure>



<h4 id="181-Employees-Earning-More-Than-Their-Managers"><a href="#181-Employees-Earning-More-Than-Their-Managers" class="headerlink" title="181. Employees Earning More Than Their Managers"></a>181. Employees Earning More Than Their Managers</h4><p>The <code>Employee</code> table holds all employees including their managers. Every employee has an Id, and there is also a column for the manager Id.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+--------+-----------+</span><br><span class="line">| Id | Name  | Salary | ManagerId |</span><br><span class="line">+----+-------+--------+-----------+</span><br><span class="line">| 1  | Joe   | 70000  | 3         |</span><br><span class="line">| 2  | Henry | 80000  | 4         |</span><br><span class="line">| 3  | Sam   | 60000  | NULL      |</span><br><span class="line">| 4  | Max   | 90000  | NULL      |</span><br><span class="line">+----+-------+--------+-----------+</span><br></pre></td></tr></table></figure>

<p>Given the <code>Employee</code> table, write a SQL query that finds out employees who earn more than their managers. For the above table, Joe is the only employee who earns more than his manager.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+----------+</span><br><span class="line">| Employee |</span><br><span class="line">+----------+</span><br><span class="line">| Joe      |</span><br><span class="line">+----------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> tb1.Name <span class="keyword">AS</span> Employee</span><br><span class="line"><span class="keyword">FROM</span> Employee <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> Employee <span class="keyword">as</span> tb2</span><br><span class="line"><span class="keyword">on</span> tb1.ManagerId = tb2.Id</span><br><span class="line"><span class="keyword">where</span> tb1.Salary &gt; tb2.Salary</span><br></pre></td></tr></table></figure>



<h4 id="182-Duplicate-Emails"><a href="#182-Duplicate-Emails" class="headerlink" title="182. Duplicate Emails"></a>182. Duplicate Emails</h4><p>Write a SQL query to find all duplicate emails in a table named <code>Person</code>.</p>
<p>For example, your query should return the following for the above table:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+---------+</span><br><span class="line">| Email   |</span><br><span class="line">+---------+</span><br><span class="line">| a@b.com |</span><br><span class="line">+---------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Email <span class="comment">#, COUNT(Email)</span></span><br><span class="line"><span class="keyword">FROM</span> Person</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Email</span><br><span class="line"><span class="comment"># ORDER BY COUNT(Email)</span></span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(Email) &gt; <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h4 id="183-Customers-Who-Never-Order"><a href="#183-Customers-Who-Never-Order" class="headerlink" title="183. Customers Who Never Order"></a>183. Customers Who Never Order</h4><p>Suppose that a website contains two tables, the <code>Customers</code> table and the <code>Orders</code> table. Write a SQL query to find all customers who never order anything.</p>
<p>Table: <code>Customers</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+</span><br><span class="line">| Id | Name  |</span><br><span class="line">+----+-------+</span><br><span class="line">| 1  | Joe   |</span><br><span class="line">| 2  | Henry |</span><br><span class="line">| 3  | Sam   |</span><br><span class="line">| 4  | Max   |</span><br><span class="line">+----+-------+</span><br></pre></td></tr></table></figure>

<p>Table: <code>Orders</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+----+------------+</span><br><span class="line">| Id | CustomerId |</span><br><span class="line">+----+------------+</span><br><span class="line">| 1  | 3          |</span><br><span class="line">| 2  | 1          |</span><br><span class="line">+----+------------+</span><br></pre></td></tr></table></figure>

<p>Using the above tables as example, return the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+-----------+</span><br><span class="line">| Customers |</span><br><span class="line">+-----------+</span><br><span class="line">| Henry     |</span><br><span class="line">| Max       |</span><br><span class="line">+-----------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> tb1.Name <span class="keyword">AS</span> Customers</span><br><span class="line"><span class="keyword">from</span> Customers <span class="keyword">as</span> tb1</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Orders </span><br><span class="line"><span class="keyword">ON</span> tb1.Id = Orders.CustomerId</span><br><span class="line"><span class="keyword">WHERE</span> Orders.CustomerId <span class="keyword">is</span> <span class="literal">NULL</span></span><br></pre></td></tr></table></figure>



<h4 id="196-Delete-Duplicate-Emails"><a href="#196-Delete-Duplicate-Emails" class="headerlink" title="196. Delete Duplicate Emails"></a>196. Delete Duplicate Emails</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> p1</span><br><span class="line"><span class="keyword">FROM</span> Person p1</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> Person p2</span><br><span class="line"><span class="keyword">WHERE</span> p1.Email = p2.Email</span><br><span class="line">	<span class="keyword">AND</span> p1.Id &gt; p2.Id;</span><br></pre></td></tr></table></figure>



<h4 id="197"><a href="#197" class="headerlink" title="197."></a>197.</h4><h4 id="511"><a href="#511" class="headerlink" title="511."></a>511.</h4><h4 id="512"><a href="#512" class="headerlink" title="512."></a>512.</h4></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/21/SQL/2020-02-21-SQL-Churn%20Rate%20with%20Case/">SQL/2020-02-21-SQL-Churn Rate with Case</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><blockquote>
<p>Codeflix, a streaming video startup, is interested in measuring their user churn rate. In this project, you’ll be helping them answer these questions about their churn:</p>
<p>\1. Get familiar with the company.</p>
<ul>
<li>How many months has the company been operating? Which months do you have enough information to calculate a churn rate?</li>
<li>What segments of users exist?</li>
</ul>
<p>\2. What is the overall churn trend since the company started?</p>
<p>\3. Compare the churn rates between user segments.</p>
<ul>
<li>Which segment of users should the company focus on expanding?</li>
</ul>
<hr>
<p>Start the following project, which will guide you through the queries you need to answer the above questions. Make sure to save your queries and results — you’ll be using them as well.</p>
<p>Then, create a set of slides using <a href="https://www.google.com/slides/about/" target="_blank" rel="noopener">Google Slides</a>, Microsoft Powerpoint, or some other presentation software. Your presentation should answer all of the questions listed above. Each answer should include a text explanation and data to support your claim. The queries used to find that data should be included in a separate <strong>.sql</strong> file.</p>
<ul>
<li><strong><a href="https://s3.amazonaws.com/codecademy-content/programs/learn-sql-from-scratch/SQL+Templates+ADwSQL.pptx" target="_blank" rel="noopener">Template:</a></strong> We recommend that you use the template linked here. This template contains examples of the types of slides you’ll want to use.</li>
<li><strong><a href="https://s3.amazonaws.com/codecademy-content/programs/learn-sql-from-scratch/calc-churn-proj/churn-rubric-for-learners-ADwSQL.pdf" target="_blank" rel="noopener">Rubric:</a></strong> You can share your work with your peers on Codecademy, who can give you feedback based on this rubric. Make sure to check your work before submitting!</li>
</ul>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- select * from subscriptions limit 20;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- select min(subscription_start), max(subscription_start)</span></span><br><span class="line"><span class="comment">-- from subscriptions;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">months</span> <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span></span><br><span class="line">   <span class="string">'2017-01-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">   <span class="string">'2017-01-31'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line"> <span class="keyword">UNION</span></span><br><span class="line"> <span class="keyword">SELECT</span></span><br><span class="line">   <span class="string">'2017-02-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">   <span class="string">'2017-02-28'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line"> <span class="keyword">UNION</span></span><br><span class="line"> <span class="keyword">SELECT</span></span><br><span class="line">   <span class="string">'2017-03-01'</span> <span class="keyword">as</span> first_day,</span><br><span class="line">   <span class="string">'2017-03-31'</span> <span class="keyword">as</span> <span class="keyword">last_day</span></span><br><span class="line">),</span><br><span class="line">cross_join <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> subscriptions <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> <span class="keyword">months</span></span><br><span class="line">),</span><br><span class="line"><span class="keyword">status</span> <span class="keyword">AS</span></span><br><span class="line">(<span class="keyword">SELECT</span> <span class="keyword">id</span>, first_day <span class="keyword">as</span> <span class="keyword">month</span>, </span><br><span class="line">  <span class="keyword">CASE</span></span><br><span class="line">   <span class="keyword">WHEN</span> <span class="keyword">segment</span> = <span class="number">87</span> <span class="keyword">AND</span> </span><br><span class="line">     (subscription_start &lt; first_day</span><br><span class="line">        <span class="keyword">AND</span></span><br><span class="line">        (</span><br><span class="line">          subscription_end &gt; first_day</span><br><span class="line">          <span class="keyword">OR</span></span><br><span class="line">          subscription_end <span class="keyword">is</span> <span class="literal">null</span></span><br><span class="line">        )</span><br><span class="line">     ) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">   <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line"> <span class="keyword">END</span> <span class="keyword">AS</span> is_active_87</span><br><span class="line"> ,</span><br><span class="line"> <span class="keyword">CASE</span></span><br><span class="line">   <span class="keyword">WHEN</span> <span class="keyword">segment</span> = <span class="number">30</span> <span class="keyword">AND</span> </span><br><span class="line">     (subscription_start &lt; first_day</span><br><span class="line">        <span class="keyword">AND</span></span><br><span class="line">        (</span><br><span class="line">          subscription_end &gt; first_day</span><br><span class="line">          <span class="keyword">OR</span></span><br><span class="line">          subscription_end <span class="keyword">is</span> <span class="literal">null</span></span><br><span class="line">        )</span><br><span class="line">     ) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">   <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line"> <span class="keyword">END</span> <span class="keyword">AS</span> is_active_30</span><br><span class="line"> ,</span><br><span class="line"> <span class="keyword">CASE</span> </span><br><span class="line">   <span class="keyword">WHEN</span> <span class="keyword">segment</span> = <span class="number">87</span> <span class="keyword">AND</span></span><br><span class="line">     (</span><br><span class="line">       subscription_end <span class="keyword">BETWEEN</span> first_day <span class="keyword">AND</span> <span class="keyword">last_day</span></span><br><span class="line">     ) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">   <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line"> <span class="keyword">END</span> <span class="keyword">AS</span> is_canceled_87</span><br><span class="line"> ,</span><br><span class="line"> <span class="keyword">CASE</span> </span><br><span class="line">   <span class="keyword">WHEN</span> <span class="keyword">segment</span> = <span class="number">30</span> <span class="keyword">AND</span></span><br><span class="line">     (</span><br><span class="line">       subscription_end <span class="keyword">BETWEEN</span> first_day <span class="keyword">AND</span> <span class="keyword">last_day</span></span><br><span class="line">     ) <span class="keyword">THEN</span> <span class="number">1</span></span><br><span class="line">   <span class="keyword">ELSE</span> <span class="number">0</span></span><br><span class="line"> <span class="keyword">END</span> <span class="keyword">AS</span> is_canceled_30</span><br><span class="line"> <span class="keyword">FROM</span> cross_join </span><br><span class="line">),</span><br><span class="line">status_aggregate <span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line">  <span class="keyword">SELECT</span>  <span class="keyword">month</span>, </span><br><span class="line">          <span class="keyword">SUM</span>(is_active_87) <span class="keyword">AS</span> sum_active_87,</span><br><span class="line">          <span class="keyword">SUM</span>(is_active_30) <span class="keyword">AS</span> sum_active_30,       </span><br><span class="line">          <span class="keyword">SUM</span>(is_canceled_87) <span class="keyword">AS</span> sum_canceled_87, </span><br><span class="line">          <span class="keyword">SUM</span>(is_canceled_30) <span class="keyword">AS</span> sum_canceled_30</span><br><span class="line">  <span class="keyword">FROM</span> <span class="keyword">status</span></span><br><span class="line">  <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">month</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> status_aggregate <span class="keyword">limit</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Query-Results-status-aggregate"><a href="#Query-Results-status-aggregate" class="headerlink" title="Query Results - status_aggregate"></a>Query Results - status_aggregate</h3><table>
<thead>
<tr>
<th align="center">month</th>
<th align="center">sum_active_87</th>
<th align="center">sum_active_30</th>
<th align="center">sum_canceled_87</th>
<th align="center">sum_canceled_30</th>
</tr>
</thead>
<tbody><tr>
<td align="center">2017-01-01</td>
<td align="center">278</td>
<td align="center">291</td>
<td align="center">70</td>
<td align="center">22</td>
</tr>
<tr>
<td align="center">2017-02-01</td>
<td align="center">462</td>
<td align="center">518</td>
<td align="center">148</td>
<td align="center">38</td>
</tr>
<tr>
<td align="center">2017-03-01</td>
<td align="center">531</td>
<td align="center">716</td>
<td align="center">258</td>
<td align="center">84</td>
</tr>
</tbody></table>
<p><strong>8.</strong></p>
<p>Calculate the churn rates for the two segments over the three month period. Which segment has a lower churn rate?</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- select * from status_aggregate limit 10;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span>  a.month, </span><br><span class="line">        <span class="number">1.0</span> * a.sum_canceled_87 / a.sum_active_87 <span class="keyword">AS</span> churn_87, </span><br><span class="line">        <span class="number">1.0</span> * a.sum_canceled_30 / a.sum_active_30 <span class="keyword">AS</span> churn_30</span><br><span class="line"><span class="keyword">FROM</span> status_aggregate <span class="keyword">as</span> a;</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/21/SQL/2020-02-21-SQL-UTM%20with%20Case/">SQL/2020-02-21-SQL-UTM with Case</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-21</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SQL/">SQL</a></span><div class="content"><h2 id="The-Attribution-Query-II"><a href="#The-Attribution-Query-II" class="headerlink" title="The Attribution Query II"></a>The Attribution Query II</h2><p>To get the UTM parameters, we’ll need to <code>JOIN</code> these results back with the original table.</p>
<p>We’ll join tables <code>first_touch</code>, aka<code>ft</code>, and <code>page_visits</code>, aka <code>pv</code>, on <code>user_id</code> and <code>timestamp</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ft.user_id &#x3D; pv.user_id</span><br><span class="line">AND ft.first_touch_at &#x3D; pv.timestamp</span><br></pre></td></tr></table></figure>

<p>Remember that <code>first_touch_at</code> is the earliest timestamp for each user. Here’s the simplified query:</p>
<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4dkxtc5wj31640tgdjo.jpg" alt="image-20200221220840486" style="zoom:67%;" />

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WITH</span> first_touch <span class="keyword">AS</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> user_id,</span><br><span class="line">      <span class="keyword">MIN</span>(<span class="built_in">timestamp</span>) <span class="keyword">AS</span> <span class="string">'first_touch_at'</span></span><br><span class="line">   <span class="keyword">FROM</span> page_visits</span><br><span class="line">   <span class="keyword">GROUP</span> <span class="keyword">BY</span> user_id)</span><br><span class="line"><span class="keyword">SELECT</span> ft.user_id,</span><br><span class="line">  ft.first_touch_at,</span><br><span class="line">  pv.utm_source</span><br><span class="line"><span class="keyword">FROM</span> first_touch <span class="keyword">AS</span> <span class="string">'ft'</span></span><br><span class="line"><span class="keyword">JOIN</span> page_visits <span class="keyword">AS</span> <span class="string">'pv'</span></span><br><span class="line">  <span class="keyword">ON</span> ft.user_id = pv.user_id</span><br><span class="line">  <span class="keyword">AND</span> ft.first_touch_at = pv.timestamp;</span><br></pre></td></tr></table></figure>



<h2 id="The-Attribution-Query-III"><a href="#The-Attribution-Query-III" class="headerlink" title="The Attribution Query III"></a>The Attribution Query III</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">WITH</span> last_touch <span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line">  <span class="keyword">SELECT</span> user_id,</span><br><span class="line">     <span class="keyword">MAX</span>(<span class="built_in">timestamp</span>) <span class="keyword">AS</span> <span class="string">'last_touch_at'</span></span><br><span class="line">  <span class="keyword">FROM</span> page_visits</span><br><span class="line">  <span class="comment">-- WHERE user_id = 10069</span></span><br><span class="line">  <span class="keyword">GROUP</span> <span class="keyword">BY</span> user_id</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- select * from last_touch limit 10;</span></span><br><span class="line"><span class="keyword">SELECT</span> lt.user_id, lt.last_touch_at, pv.utm_source</span><br><span class="line"><span class="keyword">FROM</span> last_touch <span class="keyword">as</span> <span class="string">'lt'</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> page_visits <span class="keyword">as</span> <span class="string">'pv'</span></span><br><span class="line">  <span class="keyword">ON</span> lt.user_id = pv.user_id </span><br><span class="line">  <span class="keyword">AND</span> lt.last_touch_at = pv.timestamp</span><br><span class="line"><span class="keyword">WHERE</span> lt.user_id = <span class="number">10069</span>;</span><br></pre></td></tr></table></figure>





<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gc4dypt1xnj30ps03aaa8.jpg" alt="image-20200221222149765" style="zoom:67%;" />

<h1 id="Review"><a href="#Review" class="headerlink" title="Review"></a>Review</h1><p>You can now wield SQL to find where, when, and how users are visiting a website. Well done! Here’s a summary of what you learned:</p>
<ul>
<li><em>UTM parameters</em> are a way of tracking visits to a website. Developers, marketers, and analysts use them to capture information like the time, attribution source, and attribution medium for each user visit.</li>
<li><em>First-touch attribution</em> only considers the first source for each customer. This is a good way of knowing how visitors initially discover a website.</li>
<li><em>Last-touch attribution</em> only considers the last source for each customer. This is a good way of knowing how visitors are drawn back to a website, especially for making a final purchase.</li>
<li>Find first and last touches by grouping <code>page_visits</code> by <code>user_id</code> and finding the <code>MIN</code> and <code>MAX</code> of <code>timestamp</code>.</li>
<li>To find first- and last-touch attribution, join that table back with the original <code>page_visits</code> table on <code>user_id</code> and <code>timestamp</code>.</li>
</ul>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/11/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/73/">73</a><a class="extend next" rel="next" href="/page/13/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2022 By Joe Huang</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>