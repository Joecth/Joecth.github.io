<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="Joe Huang"><meta name="copyright" content="Joe Huang"><title>Awaken Desparado</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-180692466-1', 'auto');
ga('send', 'pageview');</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.2.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Joe Huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">362</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">25</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">60</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Awaken Desparado</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Awaken Desparado</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/02/DevOps/2019-08-02-Docker-w-Pycharm/">DevOps/2019-08-02-Docker-w-Pycharm</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-02</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/DevOps/">DevOps</a></span><div class="content"><h3 id="docker-ssh配置"><a href="#docker-ssh配置" class="headerlink" title="docker ssh配置"></a>docker ssh配置</h3><h5 id="Concept"><a href="#Concept" class="headerlink" title="Concept"></a>Concept</h5><p>进行实验时用挂载的，让本地跟docker内的文件夹一样</p>
<p>#####新建docker container</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nvidia-docker run -it -p [host_port]:[container_port](<span class="keyword">do</span> not use 8888) --name:[container_name] [image_name] -v [container_path]:[host_path] /bin/bash</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nvidia-docker run -p 5592:5592 -p 5593:5593 -p 8022:22 --name=<span class="string">"liuzhen_tf"</span> -v ~/workspace/liuzhen/remote_workspace:/workspace/liuzhen/remote_workspace -it tensorflow/tensorflow:latest-gpu /bin/bash</span><br></pre></td></tr></table></figure>

<h5 id="配置ssh服务"><a href="#配置ssh服务" class="headerlink" title="配置ssh服务"></a>配置ssh服务</h5><p>在新建的容器内配置ssh，安装openssh-server</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ apt update</span><br><span class="line">$ apt install -y openssh-server</span><br></pre></td></tr></table></figure>

<p>设置ssh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir /var/run/sshd</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'root:passwd'</span> | chpasswd</span><br><span class="line"><span class="comment"># 这里使用你自己想设置的用户名和密码，passwd是此处设置的密码</span></span><br><span class="line">$ sed -i <span class="string">'s/PermitRootLogin prohibit-password/PermitRootLogin yes/'</span> /etc/ssh/sshd_config</span><br><span class="line">$ sed <span class="string">'s@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g'</span> -i /etc/pam.d/sshd</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"export VISIBLE=now"</span> &gt;&gt; /etc/profile</span><br></pre></td></tr></table></figure>

<h5 id="重启ssh激活配置"><a href="#重启ssh激活配置" class="headerlink" title="重启ssh激活配置"></a>重启ssh激活配置</h5><p>(<u>最常见的问题</u>就是docker容器停了以后里面的SSH服务也会相应停止，因此当你发现自己某一天连不上的时候，记得去docker里重启一下ssh服务：)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ service ssh restart</span><br></pre></td></tr></table></figure>

<p>在服务器（宿主机）上（不是服务器的docker里）测试刚刚新建docker容器中哪个端口转发到了服务器的22端口：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker port [your_container_name] 22</span><br><span class="line"><span class="comment"># 如果前面的配置生效了，你会看到如下输出</span></span><br><span class="line"><span class="comment"># 0.0.0.0:8022</span></span><br></pre></td></tr></table></figure>

<p>最后测试能否用SSH连接到远程docker：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh root@[your_host_ip] -p 8022</span><br><span class="line"><span class="comment"># 密码是你前面自己设置的</span></span><br></pre></td></tr></table></figure>

<h3 id="pycharm配置"><a href="#pycharm配置" class="headerlink" title="pycharm配置"></a>pycharm配置</h3><h5 id="打开本地代码"><a href="#打开本地代码" class="headerlink" title="打开本地代码"></a>打开本地代码</h5><p>打开PyCharm<code>Tools &gt; Deployment &gt; Configuration</code></p>
<p>#####新建服务器SFTP</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6gtkcxaeaj315r0u03zh.jpg" alt="image-20190828175349739"></p>
<p>输入如下图配置，注意这里的端口是你刚刚设置的映射到容器22端口的宿主机中的端口，我这里使用的是8022，账号密码是你刚刚自己设置的，这里的Root Path设置一个远程docker容器里的路径。</p>
<p>在Mappings中配置路径，这里的路径是你本地存放代码的路径，与刚刚配置的<em>Root Path</em>相互映射（意思是Mapping里本机的路径映射到远程的Root Path）<em>，</em>方便以后在本地和远程docker中进行代码和其他文件同步。</p>
<p>#####配置远程解释器</p>
<p>打开PyCharm<code>Preferences &gt; Project Interpreter</code></p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6gtlykktsj317a0u0q4w.jpg" alt="image-20190828190716498"></p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6gtrxo163j307705et8o.jpg" alt=""></p>
<p>新建ssh Interpreter</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6gtml7aj1j31d30u0aam.jpg" alt="image-20190828191025481"></p>
<h5 id="配置运行环境变量"><a href="#配置运行环境变量" class="headerlink" title="配置运行环境变量"></a>配置运行环境变量</h5><p><code>run &gt; edit confuriguration</code></p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6ly1g6gtmztm35j30r80sk758.jpg" alt="image-20190828191253964"></p>
<h3 id="docker-jupyter使用"><a href="#docker-jupyter使用" class="headerlink" title="docker jupyter使用"></a>docker jupyter使用</h3><p>jupyter-notebook的默认端口号是8888，映射几个外部端口，如前面的5592</p>
<p>更新apt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br></pre></td></tr></table></figure>

<p>安装jupyter</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install jupyter</span><br></pre></td></tr></table></figure>

<p>(注意pip install jupyter notebook==5.7.5，高版本有bug)</p>
<p>配置jupyter</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">生成jupyter配置文件，这个会生成配置文件.jupyter/jupyter_notebook_config.py</span></span><br><span class="line">jupyter notebook --generate-config</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">使用ipython生成密码</span></span><br><span class="line">In [1]: from notebook.auth import passwd</span><br><span class="line">In [2]: passwd()</span><br><span class="line">Enter password: </span><br><span class="line">Verify password: </span><br><span class="line">Out[2]: 'sha1:38a5ecdf288b:c82dace8d3c7a212ec0bd49bbb99c9af3bae076e'</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">去配置文件.jupyter/jupyter_notebook_config.py中修改以下参数</span></span><br><span class="line">c.NotebookApp.ip='*'                          #绑定所有地址</span><br><span class="line">c.NotebookApp.password = u'sha1:38a5ecdf288b:c82dace8d3c7a212ec0bd49bbb99c9af3bae076e'</span><br><span class="line">c.NotebookApp.open_browser = False            #启动后是否在浏览器中自动打开</span><br><span class="line">c.NotebookApp.port =5592                      #指定一个访问端口，默认8888，注意和映射的docker端口对应</span><br><span class="line">c.NotebookApp.allow_remote_access = True</span><br><span class="line">c.NotebookApp.allow_root = True               #allow the user to run the notebook as root</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> jupyter notebook</span></span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/08/01/DevOps/2019-08-01-Rebase/">DevOps/2019-08-01-Rebase</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-08-01</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/DevOps/">DevOps</a></span><div class="content"><p>ref: <a href="https://git-scm.com/book/zh/v2/Git-分支-变基" target="_blank" rel="noopener">https://git-scm.com/book/zh/v2/Git-%E5%88%86%E6%94%AF-%E5%8F%98%E5%9F%BA</a></p>
<h2 id="变基"><a href="#变基" class="headerlink" title="变基"></a>变基</h2><p>在 Git 中整合来自不同分支的修改主要有两种方法：<code>merge</code> 以及 <code>rebase</code>。 在本节中我们将学习什么是“变基”，怎样使用“变基”，并将展示该操作的惊艳之处，以及指出在何种情况下你应避免使用它。</p>
<h3 id="变基的基本操作"><a href="#变基的基本操作" class="headerlink" title="变基的基本操作"></a>变基的基本操作</h3><p>请回顾之前在 <a href="https://git-scm.com/book/zh/v2/ch00/r_basic_merging" target="_blank" rel="noopener">分支的合并</a> 中的一个例子，你会看到开发任务分叉到两个不同分支，又各自提交了更新。</p>
<p><img src="https://git-scm.com/book/en/v2/images/basic-rebase-1.png" alt="分叉的提交历史。"></p>
<p>Figure 35. 分叉的提交历史</p>
<p>之前介绍过，整合分支最容易的方法是 <code>merge</code> 命令。 它会把两个分支的最新快照（<code>C3</code> 和 <code>C4</code>）以及二者最近的共同祖先（<code>C2</code>）进行三方合并，合并的结果是生成一个新的快照（并提交）。</p>
<p><img src="https://git-scm.com/book/en/v2/images/basic-rebase-2.png" alt="通过合并操作来整合分叉了的历史。"></p>
<p>Figure 36. 通过合并操作来整合分叉了的历史</p>
<p>其实，还有一种方法：你可以提取在 <code>C4</code> 中引入的补丁和修改，然后在 <code>C3</code> 的基础上应用一次。 在 Git 中，这种操作就叫做 <em>变基</em>。 你可以使用 <code>rebase</code> 命令将提交到某一分支上的所有修改都移至另一分支上，就好像“重新播放”一样。</p>
<p>在上面这个例子中，运行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout experiment</span><br><span class="line">$ git rebase master</span><br><span class="line">First, rewinding head to replay your work on top of it...</span><br><span class="line">Applying: added staged <span class="built_in">command</span></span><br></pre></td></tr></table></figure>

<p>它的原理是首先找到这两个分支（即当前分支 <code>experiment</code>、变基操作的目标基底分支 <code>master</code>）的最近共同祖先 <code>C2</code>，然后对比当前分支相对于该祖先的历次提交，提取相应的修改并存为临时文件，然后将当前分支指向目标基底 <code>C3</code>, 最后以此将之前另存为临时文件的修改依序应用。（译注：写明了 commit id，以便理解，下同）</p>
<p><img src="https://git-scm.com/book/en/v2/images/basic-rebase-3.png" alt="将 `C4` 中的修改变基到 `C3` 上。"></p>
<p>Figure 37. 将 <code>C4</code> 中的修改变基到 <code>C3</code> 上</p>
<p>现在回到 <code>master</code> 分支，进行一次快进合并。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout master</span><br><span class="line">$ git merge experiment</span><br></pre></td></tr></table></figure>

<p><img src="https://git-scm.com/book/en/v2/images/basic-rebase-4.png" alt="master 分支的快进合并。"></p>
<p>Figure 38. master 分支的快进合并</p>
<p>此时，<code>C4&#39;</code> 指向的快照就和上面使用 <code>merge</code> 命令的例子中 <code>C5</code> 指向的快照一模一样了。 这两种整合方法的最终结果没有任何区别，但是变基使得提交历史更加整洁。 你在查看一个经过变基的分支的历史记录时会发现，尽管实际的开发工作是并行的，但它们看上去就像是串行的一样，提交历史是一条直线没有分叉。</p>
<p>一般我们这样做的目的是为了确保在向远程分支推送时能保持提交历史的整洁——例如向某个其他人维护的项目贡献代码时。 在这种情况下，你首先在自己的分支里进行开发，当开发完成时你需要先将你的代码变基到 <code>origin/master</code> 上，然后再向主项目提交修改。 这样的话，该项目的维护者就不再需要进行整合工作，只需要快进合并便可。</p>
<p>请注意，无论是通过变基，还是通过三方合并，整合的最终结果所指向的快照始终是一样的，只不过提交历史不同罢了。 变基是将一系列提交按照原有次序依次应用到另一分支上，而合并是把最终结果合在一起。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/07/31/FFmpeg/2019-07-31-ffmepg-cmds-2/">FFmpeg/2019-07-31-ffmepg-cmds-2</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-07-31</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/ffmpeg/">ffmpeg</a></span><div class="content"><p>1.通过ffmpeg对AE直接导出的大文件压缩，(a.mov:16M，a.mp4:2.7M)，(b.mov:13M，a.mp4:1.6M)<br><code>ffmpeg -i a.mov -vcodec png a.mp4</code></p>
<p>2.对模板视频时长进行改变，(a.mp4:2.7M，a_fittime.mp4:2.6M)<br><code>ffmpeg -i a.mp4 -vf setpts=0.96*PTS -vcodec png a_fittime.mp4</code><br>模板6.25秒，素材6秒，经过上面的操作模板变成6.08秒</p>
<p>3.视频叠加，(intro_3_4.mp4:1.1M，a_fit_add.mp4:424k)<br><code>ffmpeg -i intro_3_4.mp4 -i a_fittime.mp4 -filter_complex overlay -strict -2 a_fit_add.mp4</code></p>
<p>4.Preset</p>
<p><img src="https://tva1.sinaimg.cn/large/006y8mN6gy1g7akqezzvtj30rv0j9dkl.jpg" alt="image"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ffoutputs += <span class="string">"[1:v]scale=if(gt(&#123;0&#125;/iw\, &#123;1&#125;/ih)\, -1\, &#123;0&#125;)"</span> \</span><br><span class="line">                       <span class="string">":if(gt(&#123;0&#125;/iw\, &#123;1&#125;/ih)\, &#123;1&#125;\, -1)[video];"</span>.format(dest_w, dest_h)</span><br></pre></td></tr></table></figure>







<h3 id="Twice-Speed"><a href="#Twice-Speed" class="headerlink" title="Twice Speed"></a>Twice Speed</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash"> ffmpeg -i input.mkv -an -filter:v <span class="string">"setpts=0.5*PTS"</span> output.mkv</span></span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/07/27/Algo.%20Ult./SweepLine/">Algo. Ult./SweepLine</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-07-27</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/AlgoUlt/">AlgoUlt.</a></span><div class="content"><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gh183sdp68j30yg0l6tga.jpg" alt="image-20200723212415520"></p>
<ul>
<li>特殊情况一</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gh187qkq9xj318u0k4wie.jpg" alt="image-20200723212802223"></p>
<ul>
<li>特殊情况二</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gh189d2j9ij316o0lowls.jpg" alt="image-20200723212936289"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gh18g8id22j313e0lsq9l.jpg" alt="image-20200723213612332"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gh18hqgd80j31b40s4e03.jpg" alt="image-20200723213731671"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gh1bougq5ij313a0k2k47.jpg" alt="image-20200723232816866"></p>
<ul>
<li><p>Edge Cases</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gh1bpbkz0kj30oo0eggrg.jpg" alt="image-20200723232845013"></p>
</li>
</ul>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/07/26/Algo.%20Ult./BiBFS-arrangement/">Algo. Ult./BiBFS-arrangement</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-07-26</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/AlgoUlt/">AlgoUlt.</a></span><div class="content"><h1 id="Bi-BFS"><a href="#Bi-BFS" class="headerlink" title="Bi-BFS"></a>Bi-BFS</h1><h3 id="LC1197-Minimum-Knight-Moves"><a href="#LC1197-Minimum-Knight-Moves" class="headerlink" title="LC1197 Minimum Knight Moves"></a>LC1197 Minimum Knight Moves</h3><p>In an <strong>infinite</strong> chess board with coordinates from <code>-infinity</code> to <code>+infinity</code>, you have a <strong>knight</strong> at square <code>[0, 0]</code>.</p>
<p>A knight has 8 possible moves it can make, as illustrated below. Each move is two squares in a cardinal direction, then one square in an orthogonal direction.</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h2ufl4y2kzj20ba0ba3yu.jpg" alt="img"></p>
<p>Return <em>the minimum number of steps needed to move the knight to the square</em> <code>[x, y]</code>. It is guaranteed the answer exists.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: x &#x3D; 2, y &#x3D; 1</span><br><span class="line">Output: 1</span><br><span class="line">Explanation: [0, 0] → [2, 1]</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: x &#x3D; 5, y &#x3D; 5</span><br><span class="line">Output: 4</span><br><span class="line">Explanation: [0, 0] → [2, 1] → [4, 2] → [3, 4] → [5, 5]</span><br></pre></td></tr></table></figure>



<p><strong>Constraints:</strong></p>
<ul>
<li><code>-300 &lt;= x, y &lt;= 300</code></li>
<li><code>0 &lt;= |x| + |y| &lt;= 300</code></li>
</ul>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">DIRECTIONS = [</span><br><span class="line">                [<span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">-2</span>], [<span class="number">-1</span>, <span class="number">2</span>], [<span class="number">-1</span>, <span class="number">-2</span>],</span><br><span class="line">                [<span class="number">2</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">-1</span>], [<span class="number">-2</span>, <span class="number">1</span>], [<span class="number">-2</span>, <span class="number">-1</span>],</span><br><span class="line">               ]</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minKnightMoves</span><span class="params">(self, x: int, y: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="comment"># return self.my_20220602(x, y) # AC</span></span><br><span class="line">        <span class="keyword">return</span> self.my_20220602B(x, y)  <span class="comment"># AC</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">my_20220602B</span><span class="params">(self, x, y)</span>:</span></span><br><span class="line">        que = deque([(<span class="number">0</span>, <span class="number">0</span>)])</span><br><span class="line">        <span class="comment"># visited = &#123;(0, 0): 0&#125;</span></span><br><span class="line">        visited = set([(<span class="number">0</span>, <span class="number">0</span>)])</span><br><span class="line">        back_que = deque([(x, y)])</span><br><span class="line">        back_visited = set([(x, y)])</span><br><span class="line">        steps = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> que:</span><br><span class="line">            <span class="keyword">if</span> len(que) &gt; len(back_que):</span><br><span class="line">                que, back_que = back_que, que</span><br><span class="line">                visited, back_visited = back_visited, visited</span><br><span class="line">                </span><br><span class="line">            len_que = len(que)</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(len_que):</span><br><span class="line">                i, j = que.popleft()</span><br><span class="line">                <span class="comment"># if (i, j) == (x, y):</span></span><br><span class="line">                <span class="comment">#     return steps</span></span><br><span class="line">                <span class="keyword">if</span> (i, j) <span class="keyword">in</span> back_visited:</span><br><span class="line">                    <span class="keyword">return</span> steps</span><br><span class="line">                <span class="keyword">for</span> di, dj <span class="keyword">in</span> DIRECTIONS:</span><br><span class="line">                    ni, nj = i + di, j + dj</span><br><span class="line">                    <span class="comment"># if 0 &lt;= ni &lt; </span></span><br><span class="line">                    <span class="keyword">if</span> (ni, nj) <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">                        que.append((ni, nj))</span><br><span class="line">                        visited.add((ni, nj))</span><br><span class="line">            steps += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">my_20220602</span><span class="params">(self, x, y)</span>:</span></span><br><span class="line">        que = deque([(<span class="number">0</span>, <span class="number">0</span>)])</span><br><span class="line">        visited = set([(<span class="number">0</span>, <span class="number">0</span>)])</span><br><span class="line">        <span class="comment"># visited[(0, 0)] =</span></span><br><span class="line">        steps = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> que:</span><br><span class="line">            len_que = len(que)</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(len_que):</span><br><span class="line">                i, j = que.popleft()</span><br><span class="line">                <span class="keyword">if</span> (i, j) == (x, y):</span><br><span class="line">                    <span class="keyword">return</span> steps</span><br><span class="line">                <span class="keyword">for</span> di, dj <span class="keyword">in</span> DIRECTIONS:</span><br><span class="line">                    ni, nj = i + di, j + dj</span><br><span class="line">                    <span class="comment"># if 0 &lt;= ni &lt; </span></span><br><span class="line">                    <span class="keyword">if</span> (ni, nj) <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">                        que.append((ni, nj))</span><br><span class="line">                        visited.add((ni, nj))   <span class="comment"># important!</span></span><br><span class="line">            steps += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br></pre></td></tr></table></figure>





<h3 id="LC1345-Jump-Game-IV"><a href="#LC1345-Jump-Game-IV" class="headerlink" title="LC1345 Jump Game IV"></a>LC1345 Jump Game IV</h3><p>Beside word ladder II, there’s interesting pattern of Bi-BFS in LC1345</p>
<p>Instead of just using ‘steps as a set’, I prefer to use a dictionay to remember the steps of each index. </p>
<p>And I fix it to AC. </p>
<h5 id="Special-Take-away"><a href="#Special-Take-away" class="headerlink" title="Special Take away:"></a>Special Take away:</h5><blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> len(Q) &gt; len(back_Q):</span><br><span class="line">    Q, back_Q = back_Q, Q</span><br><span class="line">    visited, visited_back = visited_back, visited</span><br></pre></td></tr></table></figure>
</blockquote>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="keyword">from</span> sortedcontainers <span class="keyword">import</span> SortedDict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minJumps</span><span class="params">(self, arr: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="comment"># return self.my_20220114(arr)	# AC</span></span><br><span class="line">        <span class="keyword">return</span> self.my_20220114_opt_bibfs(arr)	<span class="comment"># AC</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">my_20220114_opt_bibfs</span><span class="params">(self, arr)</span>:</span></span><br><span class="line">        n = len(arr)</span><br><span class="line">        <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        mapping = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i, val <span class="keyword">in</span> enumerate(arr):</span><br><span class="line">            <span class="comment"># mapping[val] = mapping.get(val, []) + [i] # 這行導致不 AC - . -... 無言啦!, 下面fix</span></span><br><span class="line">            <span class="keyword">if</span> val <span class="keyword">in</span> mapping:</span><br><span class="line">                mapping[val].append(i)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                mapping[val] = [i]</span><br><span class="line">            </span><br><span class="line">        <span class="comment"># print(mapping)</span></span><br><span class="line">        Q = deque([<span class="number">0</span>])</span><br><span class="line">        back_Q = deque([n - <span class="number">1</span>])</span><br><span class="line">        visited = SortedDict([])</span><br><span class="line">        visited[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">        <span class="comment"># visited[n - 1] = 0</span></span><br><span class="line">        visited_back = SortedDict([])</span><br><span class="line">        visited_back[n - <span class="number">1</span>] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            <span class="keyword">if</span> len(Q) &gt; len(back_Q):</span><br><span class="line">                Q, back_Q = back_Q, Q</span><br><span class="line">                visited, visited_back = visited_back, visited</span><br><span class="line">                </span><br><span class="line">            next_Q = deque([])</span><br><span class="line">            len_Q = len(Q)</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(len_Q):</span><br><span class="line">                now = Q.popleft()</span><br><span class="line">                <span class="comment"># fly first!</span></span><br><span class="line">                <span class="keyword">for</span> nxt <span class="keyword">in</span> mapping[arr[now]]:</span><br><span class="line">                    <span class="comment"># if nxt in back_Q:</span></span><br><span class="line">                    <span class="keyword">if</span> nxt <span class="keyword">in</span> visited_back:</span><br><span class="line">                        <span class="comment"># return visited.get(nxt, 0) * 2 + 1    # BUG</span></span><br><span class="line">                        <span class="keyword">return</span> visited.get(now, <span class="number">0</span>) + <span class="number">1</span> + visited_back.get(nxt, <span class="number">0</span>)   <span class="comment"># BUG</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0</span> &lt;= nxt &lt;= n - <span class="number">1</span>):</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    <span class="keyword">if</span> nxt <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">                        <span class="comment"># visited[nxt] = min(visited[now], visited.get(nxt, n))</span></span><br><span class="line">                        visited[nxt] = min(visited[now] + <span class="number">1</span>, visited.get(nxt, n))</span><br><span class="line">                        next_Q.append(nxt)</span><br><span class="line">                </span><br><span class="line">                mapping[arr[now]].clear()</span><br><span class="line">                <span class="comment"># then step one or -1                </span></span><br><span class="line">                <span class="keyword">for</span> delta <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">-1</span>]:</span><br><span class="line">                    <span class="comment"># if nxt in back_Q:</span></span><br><span class="line">                    nxt = now + delta</span><br><span class="line">                    <span class="keyword">if</span> nxt <span class="keyword">in</span> visited_back:</span><br><span class="line">                        <span class="keyword">return</span> visited.get(now, <span class="number">0</span>) + <span class="number">1</span> + visited_back.get(nxt, <span class="number">0</span>) <span class="comment"># BUG</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0</span> &lt;= nxt &lt;= n - <span class="number">1</span>):</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    visited[nxt] = min(visited[now] + <span class="number">1</span>, visited.get(nxt, n))</span><br><span class="line">                    <span class="keyword">if</span> visited[nxt] == visited[now] + <span class="number">1</span>:</span><br><span class="line">                        next_Q.append(nxt)</span><br><span class="line">            Q = next_Q</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        <span class="comment"># return visited[n - 1]</span></span><br><span class="line">        <span class="comment">#     print(next_Q)</span></span><br><span class="line">        <span class="comment">#     print(visited)</span></span><br><span class="line">        <span class="comment"># print(visited)</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">my_20220114</span><span class="params">(self, arr)</span>:</span></span><br><span class="line">        n = len(arr)</span><br><span class="line">        mapping = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i, val <span class="keyword">in</span> enumerate(arr):</span><br><span class="line">            <span class="comment"># mapping[val] = mapping.get(val, []) + [i] # 這行導致不 AC - . -... 無言啦!, 下面fix</span></span><br><span class="line">            <span class="keyword">if</span> val <span class="keyword">in</span> mapping:</span><br><span class="line">                mapping[val].append(i)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                mapping[val] = [i]</span><br><span class="line">            </span><br><span class="line">        <span class="comment"># print(mapping)</span></span><br><span class="line">        Q = deque([<span class="number">0</span>])</span><br><span class="line">        visited = SortedDict([])</span><br><span class="line">        visited[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> Q:</span><br><span class="line">            next_Q = deque([])</span><br><span class="line">            len_Q = len(Q)</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(len_Q):</span><br><span class="line">                now = Q.popleft()</span><br><span class="line">                <span class="keyword">if</span> now == n - <span class="number">1</span>:            <span class="comment"># early return, still TLE... </span></span><br><span class="line">                    <span class="keyword">return</span> visited[now]</span><br><span class="line">                <span class="comment"># fly first!</span></span><br><span class="line">                <span class="keyword">for</span> nxt <span class="keyword">in</span> mapping[arr[now]]:</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0</span> &lt;= nxt &lt;= n - <span class="number">1</span>):</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    <span class="keyword">if</span> nxt <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">                        <span class="comment"># visited[nxt] = min(visited[now], visited.get(nxt, n))</span></span><br><span class="line">                        visited[nxt] = min(visited[now] + <span class="number">1</span>, visited.get(nxt, n))</span><br><span class="line">                        next_Q.append(nxt)</span><br><span class="line">                </span><br><span class="line">                mapping[arr[now]].clear()</span><br><span class="line">                <span class="comment"># then step one or -1                </span></span><br><span class="line">                <span class="keyword">for</span> delta <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">-1</span>]:</span><br><span class="line">                    nxt = now + delta</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0</span> &lt;= nxt &lt;= n - <span class="number">1</span>):</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    visited[nxt] = min(visited[now] + <span class="number">1</span>, visited.get(nxt, n))</span><br><span class="line">                    <span class="keyword">if</span> visited[nxt] == visited[now] + <span class="number">1</span>:</span><br><span class="line">                        next_Q.append(nxt)</span><br><span class="line">            Q = next_Q</span><br><span class="line">        <span class="keyword">return</span> visited[n - <span class="number">1</span>]</span><br><span class="line">        <span class="comment">#     print(next_Q)</span></span><br><span class="line">        <span class="comment">#     print(visited)</span></span><br><span class="line">        <span class="comment"># print(visited)</span></span><br></pre></td></tr></table></figure>



</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/53/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/53/">53</a><span class="page-number current">54</span><a class="page-number" href="/page/55/">55</a><span class="space">&hellip;</span><a class="page-number" href="/page/73/">73</a><a class="extend next" rel="next" href="/page/55/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2022 By Joe Huang</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>