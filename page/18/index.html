<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content=""><meta name="keywords" content=""><meta name="author" content="Joe Huang"><meta name="copyright" content="Joe Huang"><title>Awaken Desparado</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-180692466-1', 'auto');
ga('send', 'pageview');</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.2.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Joe Huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">384</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">26</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">66</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Awaken Desparado</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Awaken Desparado</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/10/LC/2020-02-10-LC%20Recurssion%20Arrangement/">LC/2020-02-10-LC Recurssion Arrangement</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-10</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/LC/">LC</a></span><div class="content"><h2 id="Binary-Tree"><a href="#Binary-Tree" class="headerlink" title="Binary Tree"></a>Binary Tree</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>[Maximum depth of Binary Tree]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Symmetric Tree]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Path Sum]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>[Count Univalue Subtrees]</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th>status</th>
<th>coded</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><a href="#39">39 Combination Sum</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#40">40 Combination Sum Ⅱ</a></td>
<td></td>
<td></td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#77">77 Combinations</a></td>
<td></td>
<td>easy</td>
<td></td>
<td>v</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td><a href="#">79 Word Search</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="39"><a href="#39" class="headerlink" title="39"></a><a name="39">39</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">combinationSum</span><span class="params">(self, candidates: List[int], target: int)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> candidates: </span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        self.result = []</span><br><span class="line">        <span class="comment"># self.counters = &#123;&#125;</span></span><br><span class="line">        l = sorted(candidates, key=<span class="keyword">lambda</span> val: val)</span><br><span class="line">        self.helper(l, <span class="number">0</span>, target, [], <span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.result</span><br><span class="line"></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, l, idx, rem, item, level)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> rem == <span class="number">0</span>:</span><br><span class="line">            self.result.append(item.copy())</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> idx == len(l) <span class="keyword">or</span> rem &lt; l[idx] <span class="keyword">or</span> rem &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 2 3 6 7     7               2</span></span><br><span class="line">        elem = l[idx]</span><br><span class="line">        item.append(elem)</span><br><span class="line">        rem -= elem</span><br><span class="line">        <span class="comment"># if rem &lt; elem:        SHOULDN'T TRUNCATE HERE </span></span><br><span class="line">        <span class="comment">#     return      #1 &lt; 2       2 2 </span></span><br><span class="line">        self.helper(l, idx, rem, item, level+<span class="number">1</span>)</span><br><span class="line">        item.pop()</span><br><span class="line">        rem += elem</span><br><span class="line">        self.helper(l, idx+<span class="number">1</span>, rem, item, level+<span class="number">1</span>)</span><br></pre></td></tr></table></figure>



<h3 id="77"><a href="#77" class="headerlink" title="77"></a><a name="77">77</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">combine</span><span class="params">(self, n: int, k: int)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        self.result = []</span><br><span class="line">        self.helper(n, k, <span class="number">0</span>, []) </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> self.result</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, n, k, idx, item)</span>:</span>    <span class="comment"># 4, 2 # no level since already have len(item)</span></span><br><span class="line">        <span class="keyword">if</span> len(item) == k:</span><br><span class="line">            self.result.append(item.copy())</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(idx, n):</span><br><span class="line">            item.append(i+<span class="number">1</span>)</span><br><span class="line">            self.helper(n, k, i+<span class="number">1</span>, item)    <span class="comment"># i, level</span></span><br><span class="line">            item.pop()</span><br></pre></td></tr></table></figure>



<h3 id="40"><a href="#40" class="headerlink" title="40"></a><a name="40">40</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">combinationSum2</span><span class="params">(self, candidates: List[int], target: int)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        self.target = target</span><br><span class="line">        result = []</span><br><span class="line">        candidates.sort()</span><br><span class="line">        self.gen(<span class="number">0</span>, candidates, [], result, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gen</span><span class="params">(self, i, nums, items, result, total)</span>:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> i == len(nums):</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        items.append(nums[i])</span><br><span class="line">        total += nums[i]</span><br><span class="line">        <span class="comment"># if sum(items) == self.target:</span></span><br><span class="line">        <span class="keyword">if</span> total == self.target:</span><br><span class="line">            <span class="keyword">if</span> items <span class="keyword">not</span> <span class="keyword">in</span> result:</span><br><span class="line">                result.append(items)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> total &lt;= self.target:   <span class="comment"># to prune as early as possible</span></span><br><span class="line">            self.gen(i+<span class="number">1</span>, nums, items.copy(), result, total)</span><br><span class="line">            </span><br><span class="line">        items.pop()</span><br><span class="line">        total -= nums[i]</span><br><span class="line">        self.gen(i+<span class="number">1</span>, nums, items.copy(), result, total)</span><br></pre></td></tr></table></figure>



<h3 id="79"><a href="#79" class="headerlink" title="79"></a><a name="79">79</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="comment"># from collections import deque</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">exist</span><span class="params">(self, board: List[List[str]], word: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> board <span class="keyword">or</span> <span class="keyword">not</span> board[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        </span><br><span class="line">        ans = <span class="literal">False</span></span><br><span class="line">        <span class="comment"># visited = [[False for j in range(len(board[0]))]for i in range(len(board))]</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(board)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>])):</span><br><span class="line">                <span class="keyword">if</span> board[i][j] == word[<span class="number">0</span>]:</span><br><span class="line">                    visited = [[<span class="literal">False</span> <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>]))]<span class="keyword">for</span> i <span class="keyword">in</span> range(len(board))]</span><br><span class="line">                    ans = self.helper(board, i, j, word, <span class="literal">False</span>, visited) <span class="keyword">or</span> ans  </span><br><span class="line">                    <span class="keyword">if</span> ans:</span><br><span class="line">                        <span class="keyword">return</span> ans</span><br><span class="line">        <span class="keyword">return</span> ans</span><br><span class="line">    </span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    First version failed AT:</span></span><br><span class="line"><span class="string">    [["C","A","A"],</span></span><br><span class="line"><span class="string">     ["A","A","A"],</span></span><br><span class="line"><span class="string">     ["B","C","D"]]</span></span><br><span class="line"><span class="string">    "AAB"</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, board, row, col, item, ans, visited)</span>:</span></span><br><span class="line">        <span class="comment"># if not item:</span></span><br><span class="line">        <span class="comment">#     return True</span></span><br><span class="line">        <span class="keyword">if</span> visited[row][col] == <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> board[row][col] == item[<span class="number">0</span>]:</span><br><span class="line">            visited[row][col] = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> len(item) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                item = item[<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> row &lt; len(board)<span class="number">-1</span>:</span><br><span class="line">            <span class="comment"># print(row, col)</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row+<span class="number">1</span>][col]:</span><br><span class="line">                tmp = visited[row+<span class="number">1</span>][col]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row+1, col, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row+<span class="number">1</span>, col, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row+<span class="number">1</span>][col] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> row &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row<span class="number">-1</span>][col]:</span><br><span class="line">                tmp = visited[row<span class="number">-1</span>][col]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row-1, col, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row<span class="number">-1</span>, col, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row<span class="number">-1</span>][col] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> col &lt; len(board[<span class="number">0</span>])<span class="number">-1</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row][col+<span class="number">1</span>]:</span><br><span class="line">                tmp = visited[row][col+<span class="number">1</span>]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row, col+1, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row, col+<span class="number">1</span>, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row][col+<span class="number">1</span>] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> col &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> visited[row][col<span class="number">-1</span>]:</span><br><span class="line">                tmp = visited[row][col<span class="number">-1</span>]</span><br><span class="line">                <span class="comment"># ans = self.helper(board, row, col-1, item, ans, deepcopy(visited)) or ans</span></span><br><span class="line">                ans = self.helper(board, row, col<span class="number">-1</span>, item, ans, visited) <span class="keyword">or</span> ans</span><br><span class="line">                visited[row][col<span class="number">-1</span>] = tmp</span><br><span class="line">            <span class="keyword">if</span> ans:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/08/System-Design/2020-02-08-System%20Design%20xcode%20-%20Design%20Netflix/">System-Design/2020-02-08-System Design xcode - Design Netflix</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-08</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/System/">System</a></span><div class="content"><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h1 id="Design-Netflix"><a href="#Design-Netflix" class="headerlink" title="Design Netflix"></a>Design Netflix</h1><ol>
<li><strong>Processing Queue:</strong> Each uploaded video will be pushed to a processing queue, to be de-queued later for encoding, thumbnail generation, and storage.</li>
<li><strong>Encoder:</strong> To encode each uploaded video into multiple formats.</li>
<li><strong>Thumbnails generator:</strong> We need to have a few thumbnails for each video.</li>
<li><strong>Video and Thumbnail storage:</strong> We need to store video and thumbnail files in some distributed file storage.</li>
<li><strong>User Database:</strong> We would need some database to store user’s information, e.g., name, email, address, etc.</li>
<li><strong>Video metadata storage:</strong> Metadata database will store all the information about videos like title, file path in the system, uploading user, total views, likes, dislikes, etc. Also, it will be used to store all the video comments.</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gic3oe2dd1j30yk0doadp.jpg" alt="image-20200902103236968"></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/07/System-Design/2020-02-07-System%20Design%20xcode%20-%20CDN/">System-Design/2020-02-07-System Design xcode - CDN</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-07</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/System/">System</a></span><div class="content"><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h1 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h1><p>CDN　content distributed network，也是緩存，更像file system。縣到市市到省</p>
<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1ghxfthrialj30rs0ff3zy.jpg" alt="img" style="zoom:67%;" />





<ul>
<li><p>一般是租用全球的，會把同個file replicate 到各個server，fewer hops</p>
</li>
<li><p>如果miss了會一層層往上要，最後到orig server</p>
</li>
</ul>
<blockquote>
<p>A content delivery network (CDN) is a globally distributed network of proxy servers, serving content from locations closer to the user. Generally, static files such as HTML/CSS/JS, photos, and videos are served from CDN, although some CDNs such as Amazon’s CloudFront support dynamic content. The site’s DNS resolution will tell clients which server to contact.</p>
<p>Serving content from CDNs can significantly improve performance in two ways:</p>
<ul>
<li>Users receive content from data centers close to them</li>
<li>Your servers do not have to serve requests that the CDN fulfills</li>
</ul>
</blockquote>
<p>愈近愈快，網路傳輸很常是很大的bottleneck，netflix有個經典問題，話題帶到如算法優化時，跟disk的io、network的io不值一提哈。</p>
<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1ghxg0wj7fkj30y40gsnab.jpg" alt="image-20200820181620952" style="zoom:50%;" />



<p>一般而言readability比runtime更重要！因為在實際工作中，網路、disk的latency遠超過算法的runtime。</p>
<p>Q-select就剩個幾個nano seconds，在系統設計面前不值得一提…。</p>
<h2 id="補充："><a href="#補充：" class="headerlink" title="補充："></a>補充：</h2><h3 id="秒殺"><a href="#秒殺" class="headerlink" title="秒殺"></a>秒殺</h3><p>系統忙不過來，所以商品介紹可以放靜態file在cdn好處理高併發</p>
<h3 id="Youtube-Netflix"><a href="#Youtube-Netflix" class="headerlink" title="Youtube/Netflix"></a>Youtube/Netflix</h3><p>分佈在世界各地、按geolocation，把比較hot的放在cdn，用戶可以放在local cdn去取，會更好</p>
<h2 id="Push-CDNs"><a href="#Push-CDNs" class="headerlink" title="Push CDNs"></a>Push CDNs</h2><blockquote>
<p>Push CDNs receive new content whenever changes occur on your server. You take full responsibility for providing content, uploading directly to the CDN and rewriting URLs to point to the CDN. You can configure when content expires and when it is updated. Content is uploaded only when it is new or changed, <strong>minimizing traffic, but maximizing storage</strong>.</p>
<p>Sites with a small amount of traffic or sites with content that isn’t often updated work well with push CDNs. Content is placed on the CDNs once, instead of being re-pulled at regular intervals.</p>
</blockquote>
<p>如果file 內容更新了，得要去告訴cdn server更新，或是就設expire，如cache miss時的情況，如沒找到或expire時沒找到</p>
<p>更新會主動 Push Client，而不是不斷去拿；<strong>但一般是Pull比較多</strong>。</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1ghxg1ie3myj30vi0jyn5m.jpg" alt="image-20200820181656677"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1ghxg03u9ggj30vu0k2alt.jpg" alt="image-20200820181534739"></p>
<h2 id="PULL-CDNs"><a href="#PULL-CDNs" class="headerlink" title="PULL CDNs"></a>PULL CDNs</h2><blockquote>
<p>Pull CDNs grab new content from your server when the first user requests the content. You leave the content on your server and rewrite URLs to point to the CDN. This results in a slower request until the content is cached on the CDN.</p>
<p>A <a href="https://en.wikipedia.org/wiki/Time_to_live" target="_blank" rel="noopener">time-to-live (TTL)</a> determines how long content is cached. Pull CDNs minimize storage space on the CDN, but can create redundant traffic if files expire and are pulled before they have actually changed.</p>
<p>Sites with heavy traffic work well with pull CDNs, as traffic is spread out more evenly with only recently-requested content remaining on the CDN.</p>
</blockquote>
<ul>
<li>不斷地pull要是它沒有expire就白pull了。</li>
</ul>
<h2 id="Disadvantage-s-CDN"><a href="#Disadvantage-s-CDN" class="headerlink" title="Disadvantage(s): CDN"></a>Disadvantage(s): CDN</h2><p>一般不會那麼複雜</p>
<p>一般就是第三方全球性的，自己小公司做不到。</p>
<ul>
<li>CDN <strong>costs</strong> could be significant depending on traffic, although this should be weighed with additional costs you would incur not using a CDN.  – 租別人要花錢；有時不一定要用，貴呀</li>
<li>Content might be stale if it is updated before the TTL expires it.  – 我們一般操作會給file設TTLE，有可能TTL還沒有過期，但我更新了源頭的file了，但本地的CDN還沒有expire它，這時去讀到的CDN就是個stale的，不是最新的版本，因為我還沒讓它過期，我以為它是最新的，但它實際不是最新的。</li>
<li>CDNs require changing URLs for static content to point to the CDN.  – 我拿CDN時每個file都會有個unique的URL，我要是新的話，我得去改URL，後綴什麼的，畢竟就是不同的FILE了呀。一般可能加個參數如timestamp或版本什麼的，browser會以為是不同的URL，讓cache失效，如在URL後面加  <strong>?v=1&amp;t=2</strong> 這類的，其實就是說URL我必須要改到，去point到新的CDN的file。</li>
<li>dropbox就要跟file相關啦!</li>
</ul>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/07/System-Design/2020-02-07-System%20Design%20xcode%20-%20Design%20FB%20Messenger/">System-Design/2020-02-07-System Design xcode - Design FB Messenger</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-07</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/SystemDesign/">SystemDesign</a></span><div class="content"><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1ghn80sqe3xj30pg0dadie.jpg" alt="image-20200811220346038"></p>
<h3 id="Long-Polling-V-S-WebSocket"><a href="#Long-Polling-V-S-WebSocket" class="headerlink" title="Long-Polling V.S. WebSocket"></a>Long-Polling V.S. WebSocket</h3><p>去查要發給的user1是跟哪台server連結著的</p>
<img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1ghn81z78ipj30na0eitan.jpg" alt="image-20200811220456942" style="zoom:33%;" />



<h3 id="Storage-R-amp-W-heavy-and-Sequential"><a href="#Storage-R-amp-W-heavy-and-Sequential" class="headerlink" title="Storage R &amp; W heavy, and Sequential"></a>Storage R &amp; W heavy, and Sequential</h3><p>Both Write</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/02/06/System-Design/2020-02-05-System%20Design%20-%20Push%20vs%20Pull/">System-Design/2020-02-05-System Design - Push vs Pull</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-02-06</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/System/">System</a></span><div class="content"><h1 id="Long-Polling-vs-WebSockets-vs-Server-Sent-Events"><a href="#Long-Polling-vs-WebSockets-vs-Server-Sent-Events" class="headerlink" title="Long-Polling vs WebSockets vs Server-Sent Events"></a>Long-Polling vs WebSockets vs Server-Sent Events</h1><h2 id="push-vs-pull"><a href="#push-vs-pull" class="headerlink" title="push vs pull"></a>push vs pull</h2><p>一般經常用到的service architecture 有 queuing, REST, RPC(Remote Procedure Call) 是服務之間怎麼交流</p>
<p>![image-20200206230736407](/Users/joe/Library/Application Support/typora-user-images/image-20200206230736407.png)</p>
<p>S 不一定要知道 C 的 ip, 上網看用戶的就是 C。 </p>
<p>![image-20200206231014572](/Users/joe/Library/Application Support/typora-user-images/image-20200206231014572.png)</p>
<p>定點對應服務</p>
<p>基本http請求就是 push請求</p>
<h3 id="Long-Polling"><a href="#Long-Polling" class="headerlink" title="Long-Polling"></a>Long-Polling</h3><p>什麼是HTTP </p>
<ul>
<li>用戶開connection 並向server請求data</li>
<li>server 算response</li>
<li>server送回response</li>
</ul>
<h4 id="Ajax-Polling-對應的也是-PUSH"><a href="#Ajax-Polling-對應的也是-PUSH" class="headerlink" title="Ajax Polling 對應的也是 PUSH"></a>Ajax Polling 對應的也是 PUSH</h4><p>每隔一段時間發一個請求去問好了沒，每0.5秒發一次</p>
<img src="/Users/joe/Library/Application Support/typora-user-images/image-20200206231603559.png" alt="image-20200206231603559" style="zoom:50%;" />

<p>老有人來煩server。</p>
<p>中間也有個latency</p>
<h4 id="HTTP-Long-Polling-對應的也是-PUSH"><a href="#HTTP-Long-Polling-對應的也是-PUSH" class="headerlink" title="HTTP Long Polling - 對應的也是 PUSH"></a>HTTP Long Polling - 對應的也是 PUSH</h4><p>不是馬上response回來，connection一直hold，等在那邊直到好了被通知再發一個真正的請求過去</p>
<p>之前的請求只是要知道「什麼時候好」</p>
<p>有個timeout　</p>
<h3 id="WebSockets-PULL"><a href="#WebSockets-PULL" class="headerlink" title="WebSockets - PULL"></a>WebSockets - PULL</h3><h4 id="Full-duplex"><a href="#Full-duplex" class="headerlink" title="Full-duplex"></a>Full-duplex</h4><p>bidirectional</p>
<p>![image-20200725122407012](/Users/joe/Library/Application Support/typora-user-images/image-20200725122407012.png)</p>
<p><strong>C、S兩邊都可以發請求，同時的</strong>。half-duplex 是只有一邊發。</p>
<p>小負擔、幾乎實時、S不需要C的請求，也可以發過去。</p>
<img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbn4dopv4ij30w40ggag2.jpg" alt="image-20200206232250565" style="zoom:50%;" />

<p>Server可以PUSH, 發請求，即時拿到。</p>
<p>一般C對S發的Socket是收到response後就關掉了</p>
<p>是「不斷的」所以S可以找到C。</p>
<h4 id="SSE"><a href="#SSE" class="headerlink" title="SSE"></a>SSE</h4><p>用的是長連結</p>
<p><img src="https://tva1.sinaimg.cn/large/0082zybpgy1gbn4dvvbxfj310e0fqgu4.jpg" alt="image-20200206232544827"></p>
<p>S 可以即時PUSH!</p>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/17/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><span class="page-number current">18</span><a class="page-number" href="/page/19/">19</a><span class="space">&hellip;</span><a class="page-number" href="/page/77/">77</a><a class="extend next" rel="next" href="/page/19/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2023 By Joe Huang</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>