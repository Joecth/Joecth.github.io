<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Java/2019-09-18-Java Concurrency - Thread pool"><meta name="keywords" content=""><meta name="author" content="Joe Huang"><meta name="copyright" content="Joe Huang"><title>Java/2019-09-18-Java Concurrency - Thread pool | Awaken Desparado</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><meta name="generator" content="Hexo 4.1.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-Concurrency-線程池原理剖析"><span class="toc-number">1.</span> <span class="toc-text">Java Concurrency 線程池原理剖析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Q-什麼是線程池？"><span class="toc-number">1.0.1.</span> <span class="toc-text">Q: 什麼是線程池？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q-為什麼使用線程池？"><span class="toc-number">1.0.2.</span> <span class="toc-text">Q: 為什麼使用線程池？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q-線程池的優勢"><span class="toc-number">1.0.3.</span> <span class="toc-text">Q: 線程池的優勢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q-線程池的核心參數"><span class="toc-number">1.0.4.</span> <span class="toc-text">Q: 線程池的核心參數</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#JDK源碼"><span class="toc-number">1.0.4.0.1.</span> <span class="toc-text">JDK源碼</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q-線程池的工作流程"><span class="toc-number">1.0.5.</span> <span class="toc-text">Q: 線程池的工作流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q-線程池的拒絕策略"><span class="toc-number">1.0.6.</span> <span class="toc-text">Q: 線程池的拒絕策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q-如何合理设置線程池參數"><span class="toc-number">1.0.7.</span> <span class="toc-text">Q: 如何合理设置線程池參數</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#★原則★"><span class="toc-number">1.0.7.0.1.</span> <span class="toc-text">★原則★</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#拓展點：Java內置線程池"><span class="toc-number">1.0.8.</span> <span class="toc-text">拓展點：Java內置線程池</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#不建議用Executor"><span class="toc-number">1.0.8.0.1.</span> <span class="toc-text">不建議用Executor</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q-跟kafka、rabbitMQ差別？"><span class="toc-number">1.0.9.</span> <span class="toc-text">Q: 跟kafka、rabbitMQ差別？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q-怎知道機器可以開到幾個thread"><span class="toc-number">1.0.10.</span> <span class="toc-text">Q: 怎知道機器可以開到幾個thread?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q-除了JDK線程池，有什麼第三方線程池實現"><span class="toc-number">1.0.11.</span> <span class="toc-text">Q: 除了JDK線程池，有什麼第三方線程池實現?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q-Jmeter-性能測試步驟"><span class="toc-number">1.0.12.</span> <span class="toc-text">Q: Jmeter 性能測試步驟</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Q-你心裡的題目呢？"><span class="toc-number">1.0.13.</span> <span class="toc-text">Q: 你心裡的題目呢？</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#環境"><span class="toc-number">1.0.13.0.1.</span> <span class="toc-text">環境</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">Joe Huang</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">298</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">25</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">45</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Awaken Desparado</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">Java/2019-09-18-Java Concurrency - Thread pool</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-09-16</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Java/">Java</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h1 id="Java-Concurrency-線程池原理剖析"><a href="#Java-Concurrency-線程池原理剖析" class="headerlink" title="Java Concurrency 線程池原理剖析"></a>Java Concurrency 線程池原理剖析</h1><ol>
<li>為什麼用線程池？優勢是什麼？</li>
<li>線程池如何使用？</li>
<li>線程池有哪些重要的參數？</li>
<li>線程池底層的工作原理？</li>
<li>線程池工作中用過嗎？生產上如何合理配置參數？</li>
</ol>
<h3 id="Q-什麼是線程池？"><a href="#Q-什麼是線程池？" class="headerlink" title="Q: 什麼是線程池？"></a>Q: 什麼是線程池？</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv27v5cqdj31d00l8129.jpg" alt="image-20200918200748942"></p>
<h3 id="Q-為什麼使用線程池？"><a href="#Q-為什麼使用線程池？" class="headerlink" title="Q: 為什麼使用線程池？"></a>Q: 為什麼使用線程池？</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv28klsm1j31j40oye82.jpg" alt="image-20200918200827930"></p>
<ul>
<li>車管所對車作統一管理、上牌，上下班限號限行，如果沒有這套管理任車輛隨便走大家會水洩不通。</li>
</ul>
<h3 id="Q-線程池的優勢"><a href="#Q-線程池的優勢" class="headerlink" title="Q: 線程池的優勢"></a>Q: 線程池的優勢</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv29ae47hj31ia0hwwpt.jpg" alt="image-20200918200913889"></p>
<ul>
<li><p>我在創建、銷毀線程都是需要時間和資源的。</p>
<p>希望可以直接把時間花在執行的時間</p>
</li>
<li><p>不需要線程的創建時間的等待，可以直接把線程拉出來用了就對</p>
</li>
<li><p>方便管控很重要！因為JAVA跑時是要內存，很多個線程加在一起容易OOM溢出，也讓響應速度慢了</p>
</li>
</ul>
<h3 id="Q-線程池的核心參數"><a href="#Q-線程池的核心參數" class="headerlink" title="Q: 線程池的核心參數"></a>Q: 線程池的核心參數</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2cl8hcij318c0nc7ez.jpg" alt="image-20200918201224070"></p>
<ul>
<li>7個全都要記！</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2dar15cj31kk0q2h5v.jpg" alt="image-20200918201305020"></p>
<ul>
<li>線程工廠後面會有例子</li>
<li>拒絕策略很特別！</li>
</ul>
<h5 id="JDK源碼"><a href="#JDK源碼" class="headerlink" title="JDK源碼"></a>JDK源碼</h5><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2gdt8hzj30u00x6wz7.jpg" alt="image-20200918201600363"></p>
<h3 id="Q-線程池的工作流程"><a href="#Q-線程池的工作流程" class="headerlink" title="Q: 線程池的工作流程"></a>Q: 線程池的工作流程</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2hmjki1j31jg0n2dv4.jpg" alt="image-20200918201714577"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2i0k4q3j31eq0n4qci.jpg" alt="image-20200918201737476"></p>
<ul>
<li>線程要是飽和，就要使用任務拒絕策略</li>
</ul>
<h3 id="Q-線程池的拒絕策略"><a href="#Q-線程池的拒絕策略" class="headerlink" title="Q: 線程池的拒絕策略"></a>Q: 線程池的拒絕策略</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2k7e7ylj31f60pqala.jpg" alt="image-20200918201943676"></p>
<ul>
<li>要看業務去選擇</li>
</ul>
<h3 id="Q-如何合理设置線程池參數"><a href="#Q-如何合理设置線程池參數" class="headerlink" title="Q: 如何合理设置線程池參數"></a>Q: 如何合理设置線程池參數</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2li0mkvj31gq0d4n2a.jpg" alt="image-20200918202058230"></p>
<ul>
<li>一直不放掉，對系統也不好</li>
</ul>
<h5 id="★原則★"><a href="#★原則★" class="headerlink" title="★原則★"></a>★原則★</h5><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2m6lo65j31iy0nsww5.jpg" alt="image-20200918202136955"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2rsxdnzj30xc0tcwpw.jpg" alt="image-20200918202701617"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2t9jb54j30wm0to7ga.jpg" alt="image-20200918202826058"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2uriudlj31bu0dg106.jpg" alt="image-20200918202952663"></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2vd08q9j30wg0j8gu5.jpg" alt="image-20200918203026969"></p>
<p>Then OK! 10任務</p>
<h3 id="拓展點：Java內置線程池"><a href="#拓展點：Java內置線程池" class="headerlink" title="拓展點：Java內置線程池"></a>拓展點：Java內置線程池</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2xhnundj31jw0ownaw.jpg" alt="image-20200918203229606"></p>
<h5 id="不建議用Executor"><a href="#不建議用Executor" class="headerlink" title="不建議用Executor"></a>不建議用Executor</h5><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv2xudrzjj31iu0i0tiv.jpg" alt="image-20200918203250443"></p>
<h3 id="Q-跟kafka、rabbitMQ差別？"><a href="#Q-跟kafka、rabbitMQ差別？" class="headerlink" title="Q: 跟kafka、rabbitMQ差別？"></a>Q: 跟kafka、rabbitMQ差別？</h3><ul>
<li><p>不是線程池的工作，這邊是自定義任務</p>
</li>
<li><p>我創建線程池</p>
</li>
<li><p>下單，建訂單就不能拋了</p>
</li>
</ul>
<h3 id="Q-怎知道機器可以開到幾個thread"><a href="#Q-怎知道機器可以開到幾個thread" class="headerlink" title="Q: 怎知道機器可以開到幾個thread?"></a>Q: 怎知道機器可以開到幾個thread?</h3><ul>
<li>雲機器可以配置的？會有一輪壓測，不斷把系統用非常大的QPS去壓，對機器作監控去把線程池一點點一點點地調大</li>
</ul>
<h3 id="Q-除了JDK線程池，有什麼第三方線程池實現"><a href="#Q-除了JDK線程池，有什麼第三方線程池實現" class="headerlink" title="Q: 除了JDK線程池，有什麼第三方線程池實現?"></a>Q: 除了JDK線程池，有什麼第三方線程池實現?</h3><ul>
<li><p>RPC框架也有自己的線程池</p>
</li>
<li><p>阿里的double一定有他的線程池的，他的rabbitMQ也是有線程池的</p>
</li>
</ul>
<h3 id="Q-Jmeter-性能測試步驟"><a href="#Q-Jmeter-性能測試步驟" class="headerlink" title="Q: Jmeter 性能測試步驟"></a>Q: Jmeter 性能測試步驟</h3><p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv379irz9j316c0t2ndf.jpg" alt="image-20200918204152805"></p>
<h3 id="Q-你心裡的題目呢？"><a href="#Q-你心裡的題目呢？" class="headerlink" title="Q: 你心裡的題目呢？"></a>Q: 你心裡的題目呢？</h3><p>最长回文子串</p>
<p>动规 - 股票</p>
<p>k个一组链表反转!!!</p>
<p>数组中第k大的元素</p>
<p>git项目把公司出现的面试题作汇总</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1giv3bwtkg5j316e0syn5e.jpg" alt="image-20200918204620820"></p>
<ul>
<li><a href="https://github.com/afatcoder/LeetcodeTop/blob/master/baidu/backend.md" target="_blank" rel="noopener">https://github.com/afatcoder/LeetcodeTop/blob/master/baidu/backend.md</a></li>
</ul>
<h5 id="環境"><a href="#環境" class="headerlink" title="環境"></a>環境</h5><ul>
<li><p>spring mybatis redis mq mysql 設計模式</p>
<p>spring mybatis redis mq mysql 設計模式</p>
<p>spring boot, tomcat</p>
<p>Java體系相關的中間件，Java的高級特性，spring必須會，spring Cloud springboot tomcat</p>
<p>每個工作會有他自己技術棧，阿里、美團、拼多多、JD都是java寫的</p>
<p>go也是跟java比較像</p>
</li>
</ul>
<p>  java的問題: 相對實現重，而且基於JVM；阿里</p>
<p>  go: 天生可高併發；開發快，小</p>
<ul>
<li><p>Java EE 原聲的那一套，什麼 JSF，是不是完全不用學了</p>
</li>
<li><ul>
<li>springcloud rocketMQ sentinel Redis MySQL</li>
</ul>
</li>
</ul>
<ul>
<li><p>SSH 現在還考的多嗎</p>
</li>
<li><ul>
<li>小公司會再問，CRUD、SSM</li>
</ul>
</li>
<li><p>restful vs rpc?</p>
</li>
<li><ul>
<li><p>自己可以先RPC demo級別的，自己實現一個就ok</p>
</li>
<li><ul>
<li><p>重要的是：</p>
</li>
<li><ul>
<li>rpc線程池</li>
<li>serialization</li>
<li>異常處理</li>
</ul>
</li>
</ul>
</li>
<li><p>去看dubbo ， HSF，spring Cloud吧</p>
</li>
</ul>
</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Joe Huang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2019/09/16/Java/2019-09-18-Java%20Concurrency%20-%20Thread%20pool/">http://yoursite.com/2019/09/16/Java/2019-09-18-Java%20Concurrency%20-%20Thread%20pool/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/09/16/DP%20Ult./DP-1-Intro/"><i class="fa fa-chevron-left">  </i><span>DP Ult./DP-1-Intro</span></a></div><div class="next-post pull-right"><a href="/2019/09/15/Concurrency/Multi-threading%201%20--%20Huahua/"><span>Concurrency/Multi-threading 1 -- Huahua</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By Joe Huang</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>